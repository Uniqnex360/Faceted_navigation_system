(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var gr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function xv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Rp={exports:{}},Vl={},Ip={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var to=Symbol.for("react.element"),mv=Symbol.for("react.portal"),gv=Symbol.for("react.fragment"),vv=Symbol.for("react.strict_mode"),_v=Symbol.for("react.profiler"),yv=Symbol.for("react.provider"),wv=Symbol.for("react.context"),kv=Symbol.for("react.forward_ref"),Ev=Symbol.for("react.suspense"),Tv=Symbol.for("react.memo"),Sv=Symbol.for("react.lazy"),ed=Symbol.iterator;function Cv(e){return e===null||typeof e!="object"?null:(e=ed&&e[ed]||e["@@iterator"],typeof e=="function"?e:null)}var Dp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Lp=Object.assign,jp={};function Rs(e,t,r){this.props=e,this.context=t,this.refs=jp,this.updater=r||Dp}Rs.prototype.isReactComponent={};Rs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Rs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Mp(){}Mp.prototype=Rs.prototype;function Tu(e,t,r){this.props=e,this.context=t,this.refs=jp,this.updater=r||Dp}var Su=Tu.prototype=new Mp;Su.constructor=Tu;Lp(Su,Rs.prototype);Su.isPureReactComponent=!0;var td=Array.isArray,Bp=Object.prototype.hasOwnProperty,Cu={current:null},Up={key:!0,ref:!0,__self:!0,__source:!0};function $p(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Bp.call(t,n)&&!Up.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:to,type:e,key:s,ref:i,props:a,_owner:Cu.current}}function Av(e,t){return{$$typeof:to,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Au(e){return typeof e=="object"&&e!==null&&e.$$typeof===to}function bv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var rd=/\/+/g;function _c(e,t){return typeof e=="object"&&e!==null&&e.key!=null?bv(""+e.key):t.toString(36)}function Xo(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case to:case mv:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+_c(i,0):n,td(a)?(r="",e!=null&&(r=e.replace(rd,"$&/")+"/"),Xo(a,t,r,"",function(c){return c})):a!=null&&(Au(a)&&(a=Av(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(rd,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",td(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+_c(s,o);i+=Xo(s,t,r,l,a)}else if(l=Cv(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+_c(s,o++),i+=Xo(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function vo(e,t,r){if(e==null)return e;var n=[],a=0;return Xo(e,n,"","",function(s){return t.call(r,s,a++)}),n}function Fv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var nr={current:null},qo={transition:null},Nv={ReactCurrentDispatcher:nr,ReactCurrentBatchConfig:qo,ReactCurrentOwner:Cu};function Hp(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:vo,forEach:function(e,t,r){vo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return vo(e,function(){t++}),t},toArray:function(e){return vo(e,function(t){return t})||[]},only:function(e){if(!Au(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Me.Component=Rs;Me.Fragment=gv;Me.Profiler=_v;Me.PureComponent=Tu;Me.StrictMode=vv;Me.Suspense=Ev;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nv;Me.act=Hp;Me.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Lp({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Cu.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Bp.call(t,l)&&!Up.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:to,type:e.type,key:a,ref:s,props:n,_owner:i}};Me.createContext=function(e){return e={$$typeof:wv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:yv,_context:e},e.Consumer=e};Me.createElement=$p;Me.createFactory=function(e){var t=$p.bind(null,e);return t.type=e,t};Me.createRef=function(){return{current:null}};Me.forwardRef=function(e){return{$$typeof:kv,render:e}};Me.isValidElement=Au;Me.lazy=function(e){return{$$typeof:Sv,_payload:{_status:-1,_result:e},_init:Fv}};Me.memo=function(e,t){return{$$typeof:Tv,type:e,compare:t===void 0?null:t}};Me.startTransition=function(e){var t=qo.transition;qo.transition={};try{e()}finally{qo.transition=t}};Me.unstable_act=Hp;Me.useCallback=function(e,t){return nr.current.useCallback(e,t)};Me.useContext=function(e){return nr.current.useContext(e)};Me.useDebugValue=function(){};Me.useDeferredValue=function(e){return nr.current.useDeferredValue(e)};Me.useEffect=function(e,t){return nr.current.useEffect(e,t)};Me.useId=function(){return nr.current.useId()};Me.useImperativeHandle=function(e,t,r){return nr.current.useImperativeHandle(e,t,r)};Me.useInsertionEffect=function(e,t){return nr.current.useInsertionEffect(e,t)};Me.useLayoutEffect=function(e,t){return nr.current.useLayoutEffect(e,t)};Me.useMemo=function(e,t){return nr.current.useMemo(e,t)};Me.useReducer=function(e,t,r){return nr.current.useReducer(e,t,r)};Me.useRef=function(e){return nr.current.useRef(e)};Me.useState=function(e){return nr.current.useState(e)};Me.useSyncExternalStore=function(e,t,r){return nr.current.useSyncExternalStore(e,t,r)};Me.useTransition=function(){return nr.current.useTransition()};Me.version="18.3.1";Ip.exports=Me;var xe=Ip.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ov=xe,Pv=Symbol.for("react.element"),Rv=Symbol.for("react.fragment"),Iv=Object.prototype.hasOwnProperty,Dv=Ov.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lv={key:!0,ref:!0,__self:!0,__source:!0};function zp(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)Iv.call(t,n)&&!Lv.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Pv,type:e,key:s,ref:i,props:a,_owner:Dv.current}}Vl.Fragment=Rv;Vl.jsx=zp;Vl.jsxs=zp;Rp.exports=Vl;var h=Rp.exports,Vp={exports:{}},yr={},Wp={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ne,M){var oe=ne.length;ne.push(M);e:for(;0<oe;){var se=oe-1>>>1,F=ne[se];if(0<a(F,M))ne[se]=M,ne[oe]=F,oe=se;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var M=ne[0],oe=ne.pop();if(oe!==M){ne[0]=oe;e:for(var se=0,F=ne.length,U=F>>>1;se<U;){var H=2*(se+1)-1,B=ne[H],Z=H+1,de=ne[Z];if(0>a(B,oe))Z<F&&0>a(de,B)?(ne[se]=de,ne[Z]=oe,se=Z):(ne[se]=B,ne[H]=oe,se=H);else if(Z<F&&0>a(de,oe))ne[se]=de,ne[Z]=oe,se=Z;else break e}}return M}function a(ne,M){var oe=ne.sortIndex-M.sortIndex;return oe!==0?oe:ne.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,f=null,d=3,x=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(ne){for(var M=r(c);M!==null;){if(M.callback===null)n(c);else if(M.startTime<=ne)n(c),M.sortIndex=M.expirationTime,t(l,M);else break;M=r(c)}}function S(ne){if(g=!1,p(ne),!m)if(r(l)!==null)m=!0,fe(P);else{var M=r(c);M!==null&&te(S,M.startTime-ne)}}function P(ne,M){m=!1,g&&(g=!1,v(w),w=-1),x=!0;var oe=d;try{for(p(M),f=r(l);f!==null&&(!(f.expirationTime>M)||ne&&!j());){var se=f.callback;if(typeof se=="function"){f.callback=null,d=f.priorityLevel;var F=se(f.expirationTime<=M);M=e.unstable_now(),typeof F=="function"?f.callback=F:f===r(l)&&n(l),p(M)}else n(l);f=r(l)}if(f!==null)var U=!0;else{var H=r(c);H!==null&&te(S,H.startTime-M),U=!1}return U}finally{f=null,d=oe,x=!1}}var C=!1,E=null,w=-1,k=5,O=-1;function j(){return!(e.unstable_now()-O<k)}function L(){if(E!==null){var ne=e.unstable_now();O=ne;var M=!0;try{M=E(!0,ne)}finally{M?Q():(C=!1,E=null)}}else C=!1}var Q;if(typeof _=="function")Q=function(){_(L)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,re=K.port2;K.port1.onmessage=L,Q=function(){re.postMessage(null)}}else Q=function(){y(L,0)};function fe(ne){E=ne,C||(C=!0,Q())}function te(ne,M){w=y(function(){ne(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){m||x||(m=!0,fe(P))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ne){switch(d){case 1:case 2:case 3:var M=3;break;default:M=d}var oe=d;d=M;try{return ne()}finally{d=oe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,M){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var oe=d;d=ne;try{return M()}finally{d=oe}},e.unstable_scheduleCallback=function(ne,M,oe){var se=e.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?se+oe:se):oe=se,ne){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=oe+F,ne={id:u++,callback:M,priorityLevel:ne,startTime:oe,expirationTime:F,sortIndex:-1},oe>se?(ne.sortIndex=oe,t(c,ne),r(l)===null&&ne===r(c)&&(g?(v(w),w=-1):g=!0,te(S,oe-se))):(ne.sortIndex=F,t(l,ne),m||x||(m=!0,fe(P))),ne},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(ne){var M=d;return function(){var oe=d;d=M;try{return ne.apply(this,arguments)}finally{d=oe}}}})(Gp);Wp.exports=Gp;var jv=Wp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mv=xe,vr=jv;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kp=new Set,Fi={};function Ra(e,t){ks(e,t),ks(e+"Capture",t)}function ks(e,t){for(Fi[e]=t,e=0;e<t.length;e++)Kp.add(t[e])}var vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u0=Object.prototype.hasOwnProperty,Bv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nd={},ad={};function Uv(e){return u0.call(ad,e)?!0:u0.call(nd,e)?!1:Bv.test(e)?ad[e]=!0:(nd[e]=!0,!1)}function $v(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Hv(e,t,r,n){if(t===null||typeof t>"u"||$v(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ar(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Lt[e]=new ar(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Lt[t]=new ar(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Lt[e]=new ar(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Lt[e]=new ar(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Lt[e]=new ar(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Lt[e]=new ar(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Lt[e]=new ar(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Lt[e]=new ar(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Lt[e]=new ar(e,5,!1,e.toLowerCase(),null,!1,!1)});var bu=/[\-:]([a-z])/g;function Fu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(bu,Fu);Lt[t]=new ar(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(bu,Fu);Lt[t]=new ar(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(bu,Fu);Lt[t]=new ar(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Lt[e]=new ar(e,1,!1,e.toLowerCase(),null,!1,!1)});Lt.xlinkHref=new ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Lt[e]=new ar(e,1,!1,e.toLowerCase(),null,!0,!0)});function Nu(e,t,r,n){var a=Lt.hasOwnProperty(t)?Lt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Hv(t,r,a,n)&&(r=null),n||a===null?Uv(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var En=Mv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_o=Symbol.for("react.element"),Za=Symbol.for("react.portal"),es=Symbol.for("react.fragment"),Ou=Symbol.for("react.strict_mode"),f0=Symbol.for("react.profiler"),Xp=Symbol.for("react.provider"),qp=Symbol.for("react.context"),Pu=Symbol.for("react.forward_ref"),d0=Symbol.for("react.suspense"),h0=Symbol.for("react.suspense_list"),Ru=Symbol.for("react.memo"),Pn=Symbol.for("react.lazy"),Yp=Symbol.for("react.offscreen"),sd=Symbol.iterator;function Vs(e){return e===null||typeof e!="object"?null:(e=sd&&e[sd]||e["@@iterator"],typeof e=="function"?e:null)}var lt=Object.assign,yc;function Zs(e){if(yc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);yc=t&&t[1]||""}return`
`+yc+e}var wc=!1;function kc(e,t){if(!e||wc)return"";wc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{wc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Zs(e):""}function zv(e){switch(e.tag){case 5:return Zs(e.type);case 16:return Zs("Lazy");case 13:return Zs("Suspense");case 19:return Zs("SuspenseList");case 0:case 2:case 15:return e=kc(e.type,!1),e;case 11:return e=kc(e.type.render,!1),e;case 1:return e=kc(e.type,!0),e;default:return""}}function p0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case es:return"Fragment";case Za:return"Portal";case f0:return"Profiler";case Ou:return"StrictMode";case d0:return"Suspense";case h0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case qp:return(e.displayName||"Context")+".Consumer";case Xp:return(e._context.displayName||"Context")+".Provider";case Pu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ru:return t=e.displayName||null,t!==null?t:p0(e.type)||"Memo";case Pn:t=e._payload,e=e._init;try{return p0(e(t))}catch{}}return null}function Vv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return p0(t);case 8:return t===Ou?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Qn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Jp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Wv(e){var t=Jp(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yo(e){e._valueTracker||(e._valueTracker=Wv(e))}function Qp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Jp(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function il(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function x0(e,t){var r=t.checked;return lt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function id(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Qn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zp(e,t){t=t.checked,t!=null&&Nu(e,"checked",t,!1)}function m0(e,t){Zp(e,t);var r=Qn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?g0(e,t.type,r):t.hasOwnProperty("defaultValue")&&g0(e,t.type,Qn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function od(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function g0(e,t,r){(t!=="number"||il(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ei=Array.isArray;function hs(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Qn(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function v0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return lt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ld(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(pe(92));if(ei(r)){if(1<r.length)throw Error(pe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Qn(r)}}function e1(e,t){var r=Qn(t.value),n=Qn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function cd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function t1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?t1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wo,r1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wo=wo||document.createElement("div"),wo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ni(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var li={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gv=["Webkit","ms","Moz","O"];Object.keys(li).forEach(function(e){Gv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),li[t]=li[e]})});function n1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||li.hasOwnProperty(e)&&li[e]?(""+t).trim():t+"px"}function a1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=n1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Kv=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function y0(e,t){if(t){if(Kv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function w0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var k0=null;function Iu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var E0=null,ps=null,xs=null;function ud(e){if(e=ao(e)){if(typeof E0!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=ql(t),E0(e.stateNode,e.type,t))}}function s1(e){ps?xs?xs.push(e):xs=[e]:ps=e}function i1(){if(ps){var e=ps,t=xs;if(xs=ps=null,ud(e),t)for(e=0;e<t.length;e++)ud(t[e])}}function o1(e,t){return e(t)}function l1(){}var Ec=!1;function c1(e,t,r){if(Ec)return e(t,r);Ec=!0;try{return o1(e,t,r)}finally{Ec=!1,(ps!==null||xs!==null)&&(l1(),i1())}}function Oi(e,t){var r=e.stateNode;if(r===null)return null;var n=ql(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(pe(231,t,typeof r));return r}var T0=!1;if(vn)try{var Ws={};Object.defineProperty(Ws,"passive",{get:function(){T0=!0}}),window.addEventListener("test",Ws,Ws),window.removeEventListener("test",Ws,Ws)}catch{T0=!1}function Xv(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var ci=!1,ol=null,ll=!1,S0=null,qv={onError:function(e){ci=!0,ol=e}};function Yv(e,t,r,n,a,s,i,o,l){ci=!1,ol=null,Xv.apply(qv,arguments)}function Jv(e,t,r,n,a,s,i,o,l){if(Yv.apply(this,arguments),ci){if(ci){var c=ol;ci=!1,ol=null}else throw Error(pe(198));ll||(ll=!0,S0=c)}}function Ia(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function u1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function fd(e){if(Ia(e)!==e)throw Error(pe(188))}function Qv(e){var t=e.alternate;if(!t){if(t=Ia(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return fd(a),e;if(s===n)return fd(a),t;s=s.sibling}throw Error(pe(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(pe(189))}}if(r.alternate!==n)throw Error(pe(190))}if(r.tag!==3)throw Error(pe(188));return r.stateNode.current===r?e:t}function f1(e){return e=Qv(e),e!==null?d1(e):null}function d1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=d1(e);if(t!==null)return t;e=e.sibling}return null}var h1=vr.unstable_scheduleCallback,dd=vr.unstable_cancelCallback,Zv=vr.unstable_shouldYield,e2=vr.unstable_requestPaint,ht=vr.unstable_now,t2=vr.unstable_getCurrentPriorityLevel,Du=vr.unstable_ImmediatePriority,p1=vr.unstable_UserBlockingPriority,cl=vr.unstable_NormalPriority,r2=vr.unstable_LowPriority,x1=vr.unstable_IdlePriority,Wl=null,tn=null;function n2(e){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Wl,e,void 0,(e.current.flags&128)===128)}catch{}}var Wr=Math.clz32?Math.clz32:i2,a2=Math.log,s2=Math.LN2;function i2(e){return e>>>=0,e===0?32:31-(a2(e)/s2|0)|0}var ko=64,Eo=4194304;function ti(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ul(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=ti(o):(s&=i,s!==0&&(n=ti(s)))}else i=r&~a,i!==0?n=ti(i):s!==0&&(n=ti(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Wr(t),a=1<<r,n|=e[r],t&=~a;return n}function o2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Wr(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=o2(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function C0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function m1(){var e=ko;return ko<<=1,!(ko&4194240)&&(ko=64),e}function Tc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ro(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Wr(t),e[t]=r}function c2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Wr(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Lu(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Wr(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Xe=0;function g1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var v1,ju,_1,y1,w1,A0=!1,To=[],zn=null,Vn=null,Wn=null,Pi=new Map,Ri=new Map,In=[],u2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hd(e,t){switch(e){case"focusin":case"focusout":zn=null;break;case"dragenter":case"dragleave":Vn=null;break;case"mouseover":case"mouseout":Wn=null;break;case"pointerover":case"pointerout":Pi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ri.delete(t.pointerId)}}function Gs(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=ao(t),t!==null&&ju(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function f2(e,t,r,n,a){switch(t){case"focusin":return zn=Gs(zn,e,t,r,n,a),!0;case"dragenter":return Vn=Gs(Vn,e,t,r,n,a),!0;case"mouseover":return Wn=Gs(Wn,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Pi.set(s,Gs(Pi.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Ri.set(s,Gs(Ri.get(s)||null,e,t,r,n,a)),!0}return!1}function k1(e){var t=ga(e.target);if(t!==null){var r=Ia(t);if(r!==null){if(t=r.tag,t===13){if(t=u1(r),t!==null){e.blockedOn=t,w1(e.priority,function(){_1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=b0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);k0=n,r.target.dispatchEvent(n),k0=null}else return t=ao(r),t!==null&&ju(t),e.blockedOn=r,!1;t.shift()}return!0}function pd(e,t,r){Yo(e)&&r.delete(t)}function d2(){A0=!1,zn!==null&&Yo(zn)&&(zn=null),Vn!==null&&Yo(Vn)&&(Vn=null),Wn!==null&&Yo(Wn)&&(Wn=null),Pi.forEach(pd),Ri.forEach(pd)}function Ks(e,t){e.blockedOn===t&&(e.blockedOn=null,A0||(A0=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,d2)))}function Ii(e){function t(a){return Ks(a,e)}if(0<To.length){Ks(To[0],e);for(var r=1;r<To.length;r++){var n=To[r];n.blockedOn===e&&(n.blockedOn=null)}}for(zn!==null&&Ks(zn,e),Vn!==null&&Ks(Vn,e),Wn!==null&&Ks(Wn,e),Pi.forEach(t),Ri.forEach(t),r=0;r<In.length;r++)n=In[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<In.length&&(r=In[0],r.blockedOn===null);)k1(r),r.blockedOn===null&&In.shift()}var ms=En.ReactCurrentBatchConfig,fl=!0;function h2(e,t,r,n){var a=Xe,s=ms.transition;ms.transition=null;try{Xe=1,Mu(e,t,r,n)}finally{Xe=a,ms.transition=s}}function p2(e,t,r,n){var a=Xe,s=ms.transition;ms.transition=null;try{Xe=4,Mu(e,t,r,n)}finally{Xe=a,ms.transition=s}}function Mu(e,t,r,n){if(fl){var a=b0(e,t,r,n);if(a===null)Ic(e,t,n,dl,r),hd(e,n);else if(f2(a,e,t,r,n))n.stopPropagation();else if(hd(e,n),t&4&&-1<u2.indexOf(e)){for(;a!==null;){var s=ao(a);if(s!==null&&v1(s),s=b0(e,t,r,n),s===null&&Ic(e,t,n,dl,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Ic(e,t,n,null,r)}}var dl=null;function b0(e,t,r,n){if(dl=null,e=Iu(n),e=ga(e),e!==null)if(t=Ia(e),t===null)e=null;else if(r=t.tag,r===13){if(e=u1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return dl=e,null}function E1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(t2()){case Du:return 1;case p1:return 4;case cl:case r2:return 16;case x1:return 536870912;default:return 16}default:return 16}}var Bn=null,Bu=null,Jo=null;function T1(){if(Jo)return Jo;var e,t=Bu,r=t.length,n,a="value"in Bn?Bn.value:Bn.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Jo=a.slice(e,1<n?1-n:void 0)}function Qo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function So(){return!0}function xd(){return!1}function wr(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?So:xd,this.isPropagationStopped=xd,this}return lt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=So)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=So)},persist:function(){},isPersistent:So}),t}var Is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uu=wr(Is),no=lt({},Is,{view:0,detail:0}),x2=wr(no),Sc,Cc,Xs,Gl=lt({},no,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$u,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xs&&(Xs&&e.type==="mousemove"?(Sc=e.screenX-Xs.screenX,Cc=e.screenY-Xs.screenY):Cc=Sc=0,Xs=e),Sc)},movementY:function(e){return"movementY"in e?e.movementY:Cc}}),md=wr(Gl),m2=lt({},Gl,{dataTransfer:0}),g2=wr(m2),v2=lt({},no,{relatedTarget:0}),Ac=wr(v2),_2=lt({},Is,{animationName:0,elapsedTime:0,pseudoElement:0}),y2=wr(_2),w2=lt({},Is,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),k2=wr(w2),E2=lt({},Is,{data:0}),gd=wr(E2),T2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function A2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=C2[e])?!!t[e]:!1}function $u(){return A2}var b2=lt({},no,{key:function(e){if(e.key){var t=T2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Qo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?S2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$u,charCode:function(e){return e.type==="keypress"?Qo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Qo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),F2=wr(b2),N2=lt({},Gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vd=wr(N2),O2=lt({},no,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$u}),P2=wr(O2),R2=lt({},Is,{propertyName:0,elapsedTime:0,pseudoElement:0}),I2=wr(R2),D2=lt({},Gl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),L2=wr(D2),j2=[9,13,27,32],Hu=vn&&"CompositionEvent"in window,ui=null;vn&&"documentMode"in document&&(ui=document.documentMode);var M2=vn&&"TextEvent"in window&&!ui,S1=vn&&(!Hu||ui&&8<ui&&11>=ui),_d=" ",yd=!1;function C1(e,t){switch(e){case"keyup":return j2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function A1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ts=!1;function B2(e,t){switch(e){case"compositionend":return A1(t);case"keypress":return t.which!==32?null:(yd=!0,_d);case"textInput":return e=t.data,e===_d&&yd?null:e;default:return null}}function U2(e,t){if(ts)return e==="compositionend"||!Hu&&C1(e,t)?(e=T1(),Jo=Bu=Bn=null,ts=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return S1&&t.locale!=="ko"?null:t.data;default:return null}}var $2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!$2[e.type]:t==="textarea"}function b1(e,t,r,n){s1(n),t=hl(t,"onChange"),0<t.length&&(r=new Uu("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var fi=null,Di=null;function H2(e){B1(e,0)}function Kl(e){var t=as(e);if(Qp(t))return e}function z2(e,t){if(e==="change")return t}var F1=!1;if(vn){var bc;if(vn){var Fc="oninput"in document;if(!Fc){var kd=document.createElement("div");kd.setAttribute("oninput","return;"),Fc=typeof kd.oninput=="function"}bc=Fc}else bc=!1;F1=bc&&(!document.documentMode||9<document.documentMode)}function Ed(){fi&&(fi.detachEvent("onpropertychange",N1),Di=fi=null)}function N1(e){if(e.propertyName==="value"&&Kl(Di)){var t=[];b1(t,Di,e,Iu(e)),c1(H2,t)}}function V2(e,t,r){e==="focusin"?(Ed(),fi=t,Di=r,fi.attachEvent("onpropertychange",N1)):e==="focusout"&&Ed()}function W2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kl(Di)}function G2(e,t){if(e==="click")return Kl(t)}function K2(e,t){if(e==="input"||e==="change")return Kl(t)}function X2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xr=typeof Object.is=="function"?Object.is:X2;function Li(e,t){if(Xr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!u0.call(t,a)||!Xr(e[a],t[a]))return!1}return!0}function Td(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Sd(e,t){var r=Td(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Td(r)}}function O1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?O1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function P1(){for(var e=window,t=il();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=il(e.document)}return t}function zu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function q2(e){var t=P1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&O1(r.ownerDocument.documentElement,r)){if(n!==null&&zu(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Sd(r,s);var i=Sd(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Y2=vn&&"documentMode"in document&&11>=document.documentMode,rs=null,F0=null,di=null,N0=!1;function Cd(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;N0||rs==null||rs!==il(n)||(n=rs,"selectionStart"in n&&zu(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),di&&Li(di,n)||(di=n,n=hl(F0,"onSelect"),0<n.length&&(t=new Uu("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=rs)))}function Co(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ns={animationend:Co("Animation","AnimationEnd"),animationiteration:Co("Animation","AnimationIteration"),animationstart:Co("Animation","AnimationStart"),transitionend:Co("Transition","TransitionEnd")},Nc={},R1={};vn&&(R1=document.createElement("div").style,"AnimationEvent"in window||(delete ns.animationend.animation,delete ns.animationiteration.animation,delete ns.animationstart.animation),"TransitionEvent"in window||delete ns.transitionend.transition);function Xl(e){if(Nc[e])return Nc[e];if(!ns[e])return e;var t=ns[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in R1)return Nc[e]=t[r];return e}var I1=Xl("animationend"),D1=Xl("animationiteration"),L1=Xl("animationstart"),j1=Xl("transitionend"),M1=new Map,Ad="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ra(e,t){M1.set(e,t),Ra(t,[e])}for(var Oc=0;Oc<Ad.length;Oc++){var Pc=Ad[Oc],J2=Pc.toLowerCase(),Q2=Pc[0].toUpperCase()+Pc.slice(1);ra(J2,"on"+Q2)}ra(I1,"onAnimationEnd");ra(D1,"onAnimationIteration");ra(L1,"onAnimationStart");ra("dblclick","onDoubleClick");ra("focusin","onFocus");ra("focusout","onBlur");ra(j1,"onTransitionEnd");ks("onMouseEnter",["mouseout","mouseover"]);ks("onMouseLeave",["mouseout","mouseover"]);ks("onPointerEnter",["pointerout","pointerover"]);ks("onPointerLeave",["pointerout","pointerover"]);Ra("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ra("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ra("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ra("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ra("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ra("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z2=new Set("cancel close invalid load scroll toggle".split(" ").concat(ri));function bd(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Jv(n,t,void 0,e),e.currentTarget=null}function B1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;bd(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;bd(a,o,c),s=l}}}if(ll)throw e=S0,ll=!1,S0=null,e}function et(e,t){var r=t[D0];r===void 0&&(r=t[D0]=new Set);var n=e+"__bubble";r.has(n)||(U1(t,e,2,!1),r.add(n))}function Rc(e,t,r){var n=0;t&&(n|=4),U1(r,e,n,t)}var Ao="_reactListening"+Math.random().toString(36).slice(2);function ji(e){if(!e[Ao]){e[Ao]=!0,Kp.forEach(function(r){r!=="selectionchange"&&(Z2.has(r)||Rc(r,!1,e),Rc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ao]||(t[Ao]=!0,Rc("selectionchange",!1,t))}}function U1(e,t,r,n){switch(E1(t)){case 1:var a=h2;break;case 4:a=p2;break;default:a=Mu}r=a.bind(null,t,r,e),a=void 0,!T0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Ic(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ga(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}c1(function(){var c=s,u=Iu(r),f=[];e:{var d=M1.get(e);if(d!==void 0){var x=Uu,m=e;switch(e){case"keypress":if(Qo(r)===0)break e;case"keydown":case"keyup":x=F2;break;case"focusin":m="focus",x=Ac;break;case"focusout":m="blur",x=Ac;break;case"beforeblur":case"afterblur":x=Ac;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=md;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=g2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=P2;break;case I1:case D1:case L1:x=y2;break;case j1:x=I2;break;case"scroll":x=x2;break;case"wheel":x=L2;break;case"copy":case"cut":case"paste":x=k2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=vd}var g=(t&4)!==0,y=!g&&e==="scroll",v=g?d!==null?d+"Capture":null:d;g=[];for(var _=c,p;_!==null;){p=_;var S=p.stateNode;if(p.tag===5&&S!==null&&(p=S,v!==null&&(S=Oi(_,v),S!=null&&g.push(Mi(_,S,p)))),y)break;_=_.return}0<g.length&&(d=new x(d,m,null,r,u),f.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",d&&r!==k0&&(m=r.relatedTarget||r.fromElement)&&(ga(m)||m[_n]))break e;if((x||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,x?(m=r.relatedTarget||r.toElement,x=c,m=m?ga(m):null,m!==null&&(y=Ia(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(x=null,m=c),x!==m)){if(g=md,S="onMouseLeave",v="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(g=vd,S="onPointerLeave",v="onPointerEnter",_="pointer"),y=x==null?d:as(x),p=m==null?d:as(m),d=new g(S,_+"leave",x,r,u),d.target=y,d.relatedTarget=p,S=null,ga(u)===c&&(g=new g(v,_+"enter",m,r,u),g.target=p,g.relatedTarget=y,S=g),y=S,x&&m)t:{for(g=x,v=m,_=0,p=g;p;p=za(p))_++;for(p=0,S=v;S;S=za(S))p++;for(;0<_-p;)g=za(g),_--;for(;0<p-_;)v=za(v),p--;for(;_--;){if(g===v||v!==null&&g===v.alternate)break t;g=za(g),v=za(v)}g=null}else g=null;x!==null&&Fd(f,d,x,g,!1),m!==null&&y!==null&&Fd(f,y,m,g,!0)}}e:{if(d=c?as(c):window,x=d.nodeName&&d.nodeName.toLowerCase(),x==="select"||x==="input"&&d.type==="file")var P=z2;else if(wd(d))if(F1)P=K2;else{P=W2;var C=V2}else(x=d.nodeName)&&x.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(P=G2);if(P&&(P=P(e,c))){b1(f,P,r,u);break e}C&&C(e,d,c),e==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&g0(d,"number",d.value)}switch(C=c?as(c):window,e){case"focusin":(wd(C)||C.contentEditable==="true")&&(rs=C,F0=c,di=null);break;case"focusout":di=F0=rs=null;break;case"mousedown":N0=!0;break;case"contextmenu":case"mouseup":case"dragend":N0=!1,Cd(f,r,u);break;case"selectionchange":if(Y2)break;case"keydown":case"keyup":Cd(f,r,u)}var E;if(Hu)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else ts?C1(e,r)&&(w="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(w="onCompositionStart");w&&(S1&&r.locale!=="ko"&&(ts||w!=="onCompositionStart"?w==="onCompositionEnd"&&ts&&(E=T1()):(Bn=u,Bu="value"in Bn?Bn.value:Bn.textContent,ts=!0)),C=hl(c,w),0<C.length&&(w=new gd(w,e,null,r,u),f.push({event:w,listeners:C}),E?w.data=E:(E=A1(r),E!==null&&(w.data=E)))),(E=M2?B2(e,r):U2(e,r))&&(c=hl(c,"onBeforeInput"),0<c.length&&(u=new gd("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=E))}B1(f,t)})}function Mi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function hl(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Oi(e,r),s!=null&&n.unshift(Mi(e,s,a)),s=Oi(e,t),s!=null&&n.push(Mi(e,s,a))),e=e.return}return n}function za(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Fd(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Oi(r,s),l!=null&&i.unshift(Mi(r,l,o))):a||(l=Oi(r,s),l!=null&&i.push(Mi(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var e_=/\r\n?/g,t_=/\u0000|\uFFFD/g;function Nd(e){return(typeof e=="string"?e:""+e).replace(e_,`
`).replace(t_,"")}function bo(e,t,r){if(t=Nd(t),Nd(e)!==t&&r)throw Error(pe(425))}function pl(){}var O0=null,P0=null;function R0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var I0=typeof setTimeout=="function"?setTimeout:void 0,r_=typeof clearTimeout=="function"?clearTimeout:void 0,Od=typeof Promise=="function"?Promise:void 0,n_=typeof queueMicrotask=="function"?queueMicrotask:typeof Od<"u"?function(e){return Od.resolve(null).then(e).catch(a_)}:I0;function a_(e){setTimeout(function(){throw e})}function Dc(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Ii(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Ii(t)}function Gn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Pd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ds=Math.random().toString(36).slice(2),en="__reactFiber$"+Ds,Bi="__reactProps$"+Ds,_n="__reactContainer$"+Ds,D0="__reactEvents$"+Ds,s_="__reactListeners$"+Ds,i_="__reactHandles$"+Ds;function ga(e){var t=e[en];if(t)return t;for(var r=e.parentNode;r;){if(t=r[_n]||r[en]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Pd(e);e!==null;){if(r=e[en])return r;e=Pd(e)}return t}e=r,r=e.parentNode}return null}function ao(e){return e=e[en]||e[_n],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function as(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function ql(e){return e[Bi]||null}var L0=[],ss=-1;function na(e){return{current:e}}function tt(e){0>ss||(e.current=L0[ss],L0[ss]=null,ss--)}function Qe(e,t){ss++,L0[ss]=e.current,e.current=t}var Zn={},Gt=na(Zn),cr=na(!1),Sa=Zn;function Es(e,t){var r=e.type.contextTypes;if(!r)return Zn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ur(e){return e=e.childContextTypes,e!=null}function xl(){tt(cr),tt(Gt)}function Rd(e,t,r){if(Gt.current!==Zn)throw Error(pe(168));Qe(Gt,t),Qe(cr,r)}function $1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(pe(108,Vv(e)||"Unknown",a));return lt({},r,n)}function ml(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Zn,Sa=Gt.current,Qe(Gt,e),Qe(cr,cr.current),!0}function Id(e,t,r){var n=e.stateNode;if(!n)throw Error(pe(169));r?(e=$1(e,t,Sa),n.__reactInternalMemoizedMergedChildContext=e,tt(cr),tt(Gt),Qe(Gt,e)):tt(cr),Qe(cr,r)}var fn=null,Yl=!1,Lc=!1;function H1(e){fn===null?fn=[e]:fn.push(e)}function o_(e){Yl=!0,H1(e)}function aa(){if(!Lc&&fn!==null){Lc=!0;var e=0,t=Xe;try{var r=fn;for(Xe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}fn=null,Yl=!1}catch(a){throw fn!==null&&(fn=fn.slice(e+1)),h1(Du,aa),a}finally{Xe=t,Lc=!1}}return null}var is=[],os=0,gl=null,vl=0,Sr=[],Cr=0,Ca=null,dn=1,hn="";function da(e,t){is[os++]=vl,is[os++]=gl,gl=e,vl=t}function z1(e,t,r){Sr[Cr++]=dn,Sr[Cr++]=hn,Sr[Cr++]=Ca,Ca=e;var n=dn;e=hn;var a=32-Wr(n)-1;n&=~(1<<a),r+=1;var s=32-Wr(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,dn=1<<32-Wr(t)+a|r<<a|n,hn=s+e}else dn=1<<s|r<<a|n,hn=e}function Vu(e){e.return!==null&&(da(e,1),z1(e,1,0))}function Wu(e){for(;e===gl;)gl=is[--os],is[os]=null,vl=is[--os],is[os]=null;for(;e===Ca;)Ca=Sr[--Cr],Sr[Cr]=null,hn=Sr[--Cr],Sr[Cr]=null,dn=Sr[--Cr],Sr[Cr]=null}var mr=null,xr=null,nt=!1,$r=null;function V1(e,t){var r=Ar(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Dd(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,mr=e,xr=Gn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,mr=e,xr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ca!==null?{id:dn,overflow:hn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ar(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,mr=e,xr=null,!0):!1;default:return!1}}function j0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function M0(e){if(nt){var t=xr;if(t){var r=t;if(!Dd(e,t)){if(j0(e))throw Error(pe(418));t=Gn(r.nextSibling);var n=mr;t&&Dd(e,t)?V1(n,r):(e.flags=e.flags&-4097|2,nt=!1,mr=e)}}else{if(j0(e))throw Error(pe(418));e.flags=e.flags&-4097|2,nt=!1,mr=e}}}function Ld(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;mr=e}function Fo(e){if(e!==mr)return!1;if(!nt)return Ld(e),nt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!R0(e.type,e.memoizedProps)),t&&(t=xr)){if(j0(e))throw W1(),Error(pe(418));for(;t;)V1(e,t),t=Gn(t.nextSibling)}if(Ld(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){xr=Gn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}xr=null}}else xr=mr?Gn(e.stateNode.nextSibling):null;return!0}function W1(){for(var e=xr;e;)e=Gn(e.nextSibling)}function Ts(){xr=mr=null,nt=!1}function Gu(e){$r===null?$r=[e]:$r.push(e)}var l_=En.ReactCurrentBatchConfig;function qs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(pe(309));var n=r.stateNode}if(!n)throw Error(pe(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(pe(284));if(!r._owner)throw Error(pe(290,e))}return e}function No(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function jd(e){var t=e._init;return t(e._payload)}function G1(e){function t(v,_){if(e){var p=v.deletions;p===null?(v.deletions=[_],v.flags|=16):p.push(_)}}function r(v,_){if(!e)return null;for(;_!==null;)t(v,_),_=_.sibling;return null}function n(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function a(v,_){return v=Yn(v,_),v.index=0,v.sibling=null,v}function s(v,_,p){return v.index=p,e?(p=v.alternate,p!==null?(p=p.index,p<_?(v.flags|=2,_):p):(v.flags|=2,_)):(v.flags|=1048576,_)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,_,p,S){return _===null||_.tag!==6?(_=zc(p,v.mode,S),_.return=v,_):(_=a(_,p),_.return=v,_)}function l(v,_,p,S){var P=p.type;return P===es?u(v,_,p.props.children,S,p.key):_!==null&&(_.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Pn&&jd(P)===_.type)?(S=a(_,p.props),S.ref=qs(v,_,p),S.return=v,S):(S=sl(p.type,p.key,p.props,null,v.mode,S),S.ref=qs(v,_,p),S.return=v,S)}function c(v,_,p,S){return _===null||_.tag!==4||_.stateNode.containerInfo!==p.containerInfo||_.stateNode.implementation!==p.implementation?(_=Vc(p,v.mode,S),_.return=v,_):(_=a(_,p.children||[]),_.return=v,_)}function u(v,_,p,S,P){return _===null||_.tag!==7?(_=ka(p,v.mode,S,P),_.return=v,_):(_=a(_,p),_.return=v,_)}function f(v,_,p){if(typeof _=="string"&&_!==""||typeof _=="number")return _=zc(""+_,v.mode,p),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case _o:return p=sl(_.type,_.key,_.props,null,v.mode,p),p.ref=qs(v,null,_),p.return=v,p;case Za:return _=Vc(_,v.mode,p),_.return=v,_;case Pn:var S=_._init;return f(v,S(_._payload),p)}if(ei(_)||Vs(_))return _=ka(_,v.mode,p,null),_.return=v,_;No(v,_)}return null}function d(v,_,p,S){var P=_!==null?_.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return P!==null?null:o(v,_,""+p,S);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case _o:return p.key===P?l(v,_,p,S):null;case Za:return p.key===P?c(v,_,p,S):null;case Pn:return P=p._init,d(v,_,P(p._payload),S)}if(ei(p)||Vs(p))return P!==null?null:u(v,_,p,S,null);No(v,p)}return null}function x(v,_,p,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(p)||null,o(_,v,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case _o:return v=v.get(S.key===null?p:S.key)||null,l(_,v,S,P);case Za:return v=v.get(S.key===null?p:S.key)||null,c(_,v,S,P);case Pn:var C=S._init;return x(v,_,p,C(S._payload),P)}if(ei(S)||Vs(S))return v=v.get(p)||null,u(_,v,S,P,null);No(_,S)}return null}function m(v,_,p,S){for(var P=null,C=null,E=_,w=_=0,k=null;E!==null&&w<p.length;w++){E.index>w?(k=E,E=null):k=E.sibling;var O=d(v,E,p[w],S);if(O===null){E===null&&(E=k);break}e&&E&&O.alternate===null&&t(v,E),_=s(O,_,w),C===null?P=O:C.sibling=O,C=O,E=k}if(w===p.length)return r(v,E),nt&&da(v,w),P;if(E===null){for(;w<p.length;w++)E=f(v,p[w],S),E!==null&&(_=s(E,_,w),C===null?P=E:C.sibling=E,C=E);return nt&&da(v,w),P}for(E=n(v,E);w<p.length;w++)k=x(E,v,w,p[w],S),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?w:k.key),_=s(k,_,w),C===null?P=k:C.sibling=k,C=k);return e&&E.forEach(function(j){return t(v,j)}),nt&&da(v,w),P}function g(v,_,p,S){var P=Vs(p);if(typeof P!="function")throw Error(pe(150));if(p=P.call(p),p==null)throw Error(pe(151));for(var C=P=null,E=_,w=_=0,k=null,O=p.next();E!==null&&!O.done;w++,O=p.next()){E.index>w?(k=E,E=null):k=E.sibling;var j=d(v,E,O.value,S);if(j===null){E===null&&(E=k);break}e&&E&&j.alternate===null&&t(v,E),_=s(j,_,w),C===null?P=j:C.sibling=j,C=j,E=k}if(O.done)return r(v,E),nt&&da(v,w),P;if(E===null){for(;!O.done;w++,O=p.next())O=f(v,O.value,S),O!==null&&(_=s(O,_,w),C===null?P=O:C.sibling=O,C=O);return nt&&da(v,w),P}for(E=n(v,E);!O.done;w++,O=p.next())O=x(E,v,w,O.value,S),O!==null&&(e&&O.alternate!==null&&E.delete(O.key===null?w:O.key),_=s(O,_,w),C===null?P=O:C.sibling=O,C=O);return e&&E.forEach(function(L){return t(v,L)}),nt&&da(v,w),P}function y(v,_,p,S){if(typeof p=="object"&&p!==null&&p.type===es&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case _o:e:{for(var P=p.key,C=_;C!==null;){if(C.key===P){if(P=p.type,P===es){if(C.tag===7){r(v,C.sibling),_=a(C,p.props.children),_.return=v,v=_;break e}}else if(C.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Pn&&jd(P)===C.type){r(v,C.sibling),_=a(C,p.props),_.ref=qs(v,C,p),_.return=v,v=_;break e}r(v,C);break}else t(v,C);C=C.sibling}p.type===es?(_=ka(p.props.children,v.mode,S,p.key),_.return=v,v=_):(S=sl(p.type,p.key,p.props,null,v.mode,S),S.ref=qs(v,_,p),S.return=v,v=S)}return i(v);case Za:e:{for(C=p.key;_!==null;){if(_.key===C)if(_.tag===4&&_.stateNode.containerInfo===p.containerInfo&&_.stateNode.implementation===p.implementation){r(v,_.sibling),_=a(_,p.children||[]),_.return=v,v=_;break e}else{r(v,_);break}else t(v,_);_=_.sibling}_=Vc(p,v.mode,S),_.return=v,v=_}return i(v);case Pn:return C=p._init,y(v,_,C(p._payload),S)}if(ei(p))return m(v,_,p,S);if(Vs(p))return g(v,_,p,S);No(v,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,_!==null&&_.tag===6?(r(v,_.sibling),_=a(_,p),_.return=v,v=_):(r(v,_),_=zc(p,v.mode,S),_.return=v,v=_),i(v)):r(v,_)}return y}var Ss=G1(!0),K1=G1(!1),_l=na(null),yl=null,ls=null,Ku=null;function Xu(){Ku=ls=yl=null}function qu(e){var t=_l.current;tt(_l),e._currentValue=t}function B0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function gs(e,t){yl=e,Ku=ls=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(lr=!0),e.firstContext=null)}function Fr(e){var t=e._currentValue;if(Ku!==e)if(e={context:e,memoizedValue:t,next:null},ls===null){if(yl===null)throw Error(pe(308));ls=e,yl.dependencies={lanes:0,firstContext:e}}else ls=ls.next=e;return t}var va=null;function Yu(e){va===null?va=[e]:va.push(e)}function X1(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Yu(t)):(r.next=a.next,a.next=r),t.interleaved=r,yn(e,n)}function yn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Rn=!1;function Ju(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function q1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Kn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,He&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,yn(e,r)}return a=n.interleaved,a===null?(t.next=t,Yu(n)):(t.next=a.next,a.next=t),n.interleaved=t,yn(e,r)}function Zo(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Lu(e,r)}}function Md(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function wl(e,t,r,n){var a=e.updateQueue;Rn=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=a.baseState;i=0,u=c=l=null,o=s;do{var d=o.lane,x=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(d=t,x=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(x,f,d);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(x,f,d):m,d==null)break e;f=lt({},f,d);break e;case 2:Rn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else x={eventTime:x,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=x,l=f):u=u.next=x,i|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);ba|=i,e.lanes=i,e.memoizedState=f}}function Bd(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(pe(191,a));a.call(n)}}}var so={},rn=na(so),Ui=na(so),$i=na(so);function _a(e){if(e===so)throw Error(pe(174));return e}function Qu(e,t){switch(Qe($i,t),Qe(Ui,e),Qe(rn,so),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_0(t,e)}tt(rn),Qe(rn,t)}function Cs(){tt(rn),tt(Ui),tt($i)}function Y1(e){_a($i.current);var t=_a(rn.current),r=_0(t,e.type);t!==r&&(Qe(Ui,e),Qe(rn,r))}function Zu(e){Ui.current===e&&(tt(rn),tt(Ui))}var it=na(0);function kl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var jc=[];function ef(){for(var e=0;e<jc.length;e++)jc[e]._workInProgressVersionPrimary=null;jc.length=0}var el=En.ReactCurrentDispatcher,Mc=En.ReactCurrentBatchConfig,Aa=0,ot=null,wt=null,At=null,El=!1,hi=!1,Hi=0,c_=0;function Mt(){throw Error(pe(321))}function tf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xr(e[r],t[r]))return!1;return!0}function rf(e,t,r,n,a,s){if(Aa=s,ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,el.current=e===null||e.memoizedState===null?h_:p_,e=r(n,a),hi){s=0;do{if(hi=!1,Hi=0,25<=s)throw Error(pe(301));s+=1,At=wt=null,t.updateQueue=null,el.current=x_,e=r(n,a)}while(hi)}if(el.current=Tl,t=wt!==null&&wt.next!==null,Aa=0,At=wt=ot=null,El=!1,t)throw Error(pe(300));return e}function nf(){var e=Hi!==0;return Hi=0,e}function Qr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?ot.memoizedState=At=e:At=At.next=e,At}function Nr(){if(wt===null){var e=ot.alternate;e=e!==null?e.memoizedState:null}else e=wt.next;var t=At===null?ot.memoizedState:At.next;if(t!==null)At=t,wt=e;else{if(e===null)throw Error(pe(310));wt=e,e={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},At===null?ot.memoizedState=At=e:At=At.next=e}return At}function zi(e,t){return typeof t=="function"?t(e):t}function Bc(e){var t=Nr(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=wt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var u=c.lane;if((Aa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,i=n):l=l.next=f,ot.lanes|=u,ba|=u}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,Xr(n,t.memoizedState)||(lr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,ot.lanes|=s,ba|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Uc(e){var t=Nr(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Xr(s,t.memoizedState)||(lr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function J1(){}function Q1(e,t){var r=ot,n=Nr(),a=t(),s=!Xr(n.memoizedState,a);if(s&&(n.memoizedState=a,lr=!0),n=n.queue,af(tx.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||At!==null&&At.memoizedState.tag&1){if(r.flags|=2048,Vi(9,ex.bind(null,r,n,a,t),void 0,null),bt===null)throw Error(pe(349));Aa&30||Z1(r,t,a)}return a}function Z1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ot.updateQueue,t===null?(t={lastEffect:null,stores:null},ot.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function ex(e,t,r,n){t.value=r,t.getSnapshot=n,rx(t)&&nx(e)}function tx(e,t,r){return r(function(){rx(t)&&nx(e)})}function rx(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xr(e,r)}catch{return!0}}function nx(e){var t=yn(e,1);t!==null&&Gr(t,e,1,-1)}function Ud(e){var t=Qr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:e},t.queue=e,e=e.dispatch=d_.bind(null,ot,e),[t.memoizedState,e]}function Vi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ot.updateQueue,t===null?(t={lastEffect:null,stores:null},ot.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ax(){return Nr().memoizedState}function tl(e,t,r,n){var a=Qr();ot.flags|=e,a.memoizedState=Vi(1|t,r,void 0,n===void 0?null:n)}function Jl(e,t,r,n){var a=Nr();n=n===void 0?null:n;var s=void 0;if(wt!==null){var i=wt.memoizedState;if(s=i.destroy,n!==null&&tf(n,i.deps)){a.memoizedState=Vi(t,r,s,n);return}}ot.flags|=e,a.memoizedState=Vi(1|t,r,s,n)}function $d(e,t){return tl(8390656,8,e,t)}function af(e,t){return Jl(2048,8,e,t)}function sx(e,t){return Jl(4,2,e,t)}function ix(e,t){return Jl(4,4,e,t)}function ox(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lx(e,t,r){return r=r!=null?r.concat([e]):null,Jl(4,4,ox.bind(null,t,e),r)}function sf(){}function cx(e,t){var r=Nr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&tf(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ux(e,t){var r=Nr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&tf(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function fx(e,t,r){return Aa&21?(Xr(r,t)||(r=m1(),ot.lanes|=r,ba|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,lr=!0),e.memoizedState=r)}function u_(e,t){var r=Xe;Xe=r!==0&&4>r?r:4,e(!0);var n=Mc.transition;Mc.transition={};try{e(!1),t()}finally{Xe=r,Mc.transition=n}}function dx(){return Nr().memoizedState}function f_(e,t,r){var n=qn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},hx(e))px(t,r);else if(r=X1(e,t,r,n),r!==null){var a=er();Gr(r,e,n,a),xx(r,t,n)}}function d_(e,t,r){var n=qn(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(hx(e))px(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Xr(o,i)){var l=t.interleaved;l===null?(a.next=a,Yu(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=X1(e,t,a,n),r!==null&&(a=er(),Gr(r,e,n,a),xx(r,t,n))}}function hx(e){var t=e.alternate;return e===ot||t!==null&&t===ot}function px(e,t){hi=El=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function xx(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Lu(e,r)}}var Tl={readContext:Fr,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},h_={readContext:Fr,useCallback:function(e,t){return Qr().memoizedState=[e,t===void 0?null:t],e},useContext:Fr,useEffect:$d,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,tl(4194308,4,ox.bind(null,t,e),r)},useLayoutEffect:function(e,t){return tl(4194308,4,e,t)},useInsertionEffect:function(e,t){return tl(4,2,e,t)},useMemo:function(e,t){var r=Qr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Qr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=f_.bind(null,ot,e),[n.memoizedState,e]},useRef:function(e){var t=Qr();return e={current:e},t.memoizedState=e},useState:Ud,useDebugValue:sf,useDeferredValue:function(e){return Qr().memoizedState=e},useTransition:function(){var e=Ud(!1),t=e[0];return e=u_.bind(null,e[1]),Qr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ot,a=Qr();if(nt){if(r===void 0)throw Error(pe(407));r=r()}else{if(r=t(),bt===null)throw Error(pe(349));Aa&30||Z1(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,$d(tx.bind(null,n,s,e),[e]),n.flags|=2048,Vi(9,ex.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Qr(),t=bt.identifierPrefix;if(nt){var r=hn,n=dn;r=(n&~(1<<32-Wr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Hi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=c_++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},p_={readContext:Fr,useCallback:cx,useContext:Fr,useEffect:af,useImperativeHandle:lx,useInsertionEffect:sx,useLayoutEffect:ix,useMemo:ux,useReducer:Bc,useRef:ax,useState:function(){return Bc(zi)},useDebugValue:sf,useDeferredValue:function(e){var t=Nr();return fx(t,wt.memoizedState,e)},useTransition:function(){var e=Bc(zi)[0],t=Nr().memoizedState;return[e,t]},useMutableSource:J1,useSyncExternalStore:Q1,useId:dx,unstable_isNewReconciler:!1},x_={readContext:Fr,useCallback:cx,useContext:Fr,useEffect:af,useImperativeHandle:lx,useInsertionEffect:sx,useLayoutEffect:ix,useMemo:ux,useReducer:Uc,useRef:ax,useState:function(){return Uc(zi)},useDebugValue:sf,useDeferredValue:function(e){var t=Nr();return wt===null?t.memoizedState=e:fx(t,wt.memoizedState,e)},useTransition:function(){var e=Uc(zi)[0],t=Nr().memoizedState;return[e,t]},useMutableSource:J1,useSyncExternalStore:Q1,useId:dx,unstable_isNewReconciler:!1};function Mr(e,t){if(e&&e.defaultProps){t=lt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function U0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:lt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ql={isMounted:function(e){return(e=e._reactInternals)?Ia(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=er(),a=qn(e),s=xn(n,a);s.payload=t,r!=null&&(s.callback=r),t=Kn(e,s,a),t!==null&&(Gr(t,e,a,n),Zo(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=er(),a=qn(e),s=xn(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Kn(e,s,a),t!==null&&(Gr(t,e,a,n),Zo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=er(),n=qn(e),a=xn(r,n);a.tag=2,t!=null&&(a.callback=t),t=Kn(e,a,n),t!==null&&(Gr(t,e,n,r),Zo(t,e,n))}};function Hd(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Li(r,n)||!Li(a,s):!0}function mx(e,t,r){var n=!1,a=Zn,s=t.contextType;return typeof s=="object"&&s!==null?s=Fr(s):(a=ur(t)?Sa:Gt.current,n=t.contextTypes,s=(n=n!=null)?Es(e,a):Zn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ql,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function zd(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ql.enqueueReplaceState(t,t.state,null)}function $0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Ju(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Fr(s):(s=ur(t)?Sa:Gt.current,a.context=Es(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(U0(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Ql.enqueueReplaceState(a,a.state,null),wl(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function As(e,t){try{var r="",n=t;do r+=zv(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function $c(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function H0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var m_=typeof WeakMap=="function"?WeakMap:Map;function gx(e,t,r){r=xn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Cl||(Cl=!0,Q0=n),H0(e,t)},r}function vx(e,t,r){r=xn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){H0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){H0(e,t),typeof n!="function"&&(Xn===null?Xn=new Set([this]):Xn.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Vd(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new m_;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=N_.bind(null,e,t,r),t.then(e,e))}function Wd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Gd(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=xn(-1,1),t.tag=2,Kn(r,t,1))),r.lanes|=1),e)}var g_=En.ReactCurrentOwner,lr=!1;function Yt(e,t,r,n){t.child=e===null?K1(t,null,r,n):Ss(t,e.child,r,n)}function Kd(e,t,r,n,a){r=r.render;var s=t.ref;return gs(t,a),n=rf(e,t,r,n,s,a),r=nf(),e!==null&&!lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,wn(e,t,a)):(nt&&r&&Vu(t),t.flags|=1,Yt(e,t,n,a),t.child)}function Xd(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!pf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,_x(e,t,s,n,a)):(e=sl(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Li,r(i,n)&&e.ref===t.ref)return wn(e,t,a)}return t.flags|=1,e=Yn(s,n),e.ref=t.ref,e.return=t,t.child=e}function _x(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Li(s,n)&&e.ref===t.ref)if(lr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(lr=!0);else return t.lanes=e.lanes,wn(e,t,a)}return z0(e,t,r,n,a)}function yx(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(us,dr),dr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qe(us,dr),dr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Qe(us,dr),dr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Qe(us,dr),dr|=n;return Yt(e,t,a,r),t.child}function wx(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function z0(e,t,r,n,a){var s=ur(r)?Sa:Gt.current;return s=Es(t,s),gs(t,a),r=rf(e,t,r,n,s,a),n=nf(),e!==null&&!lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,wn(e,t,a)):(nt&&n&&Vu(t),t.flags|=1,Yt(e,t,r,a),t.child)}function qd(e,t,r,n,a){if(ur(r)){var s=!0;ml(t)}else s=!1;if(gs(t,a),t.stateNode===null)rl(e,t),mx(t,r,n),$0(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Fr(c):(c=ur(r)?Sa:Gt.current,c=Es(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&zd(t,i,n,c),Rn=!1;var d=t.memoizedState;i.state=d,wl(t,n,i,a),l=t.memoizedState,o!==n||d!==l||cr.current||Rn?(typeof u=="function"&&(U0(t,r,u,n),l=t.memoizedState),(o=Rn||Hd(t,r,o,n,d,l,c))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,q1(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Mr(t.type,o),i.props=c,f=t.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Fr(l):(l=ur(r)?Sa:Gt.current,l=Es(t,l));var x=r.getDerivedStateFromProps;(u=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||d!==l)&&zd(t,i,n,l),Rn=!1,d=t.memoizedState,i.state=d,wl(t,n,i,a);var m=t.memoizedState;o!==f||d!==m||cr.current||Rn?(typeof x=="function"&&(U0(t,r,x,n),m=t.memoizedState),(c=Rn||Hd(t,r,c,n,d,m,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,m,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,m,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return V0(e,t,r,n,s,a)}function V0(e,t,r,n,a,s){wx(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Id(t,r,!1),wn(e,t,s);n=t.stateNode,g_.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Ss(t,e.child,null,s),t.child=Ss(t,null,o,s)):Yt(e,t,o,s),t.memoizedState=n.state,a&&Id(t,r,!0),t.child}function kx(e){var t=e.stateNode;t.pendingContext?Rd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rd(e,t.context,!1),Qu(e,t.containerInfo)}function Yd(e,t,r,n,a){return Ts(),Gu(a),t.flags|=256,Yt(e,t,r,n),t.child}var W0={dehydrated:null,treeContext:null,retryLane:0};function G0(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ex(e,t,r){var n=t.pendingProps,a=it.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Qe(it,a&1),e===null)return M0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=tc(i,n,0,null),e=ka(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=G0(r),t.memoizedState=W0,e):of(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return v_(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Yn(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Yn(o,s):(s=ka(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?G0(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=W0,n}return s=e.child,e=s.sibling,n=Yn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function of(e,t){return t=tc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Oo(e,t,r,n){return n!==null&&Gu(n),Ss(t,e.child,null,r),e=of(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function v_(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=$c(Error(pe(422))),Oo(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=tc({mode:"visible",children:n.children},a,0,null),s=ka(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ss(t,e.child,null,i),t.child.memoizedState=G0(i),t.memoizedState=W0,s);if(!(t.mode&1))return Oo(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(pe(419)),n=$c(s,n,void 0),Oo(e,t,i,n)}if(o=(i&e.childLanes)!==0,lr||o){if(n=bt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,yn(e,a),Gr(n,e,a,-1))}return hf(),n=$c(Error(pe(421))),Oo(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=O_.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,xr=Gn(a.nextSibling),mr=t,nt=!0,$r=null,e!==null&&(Sr[Cr++]=dn,Sr[Cr++]=hn,Sr[Cr++]=Ca,dn=e.id,hn=e.overflow,Ca=t),t=of(t,n.children),t.flags|=4096,t)}function Jd(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),B0(e.return,t,r)}function Hc(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Tx(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Yt(e,t,n.children,r),n=it.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Jd(e,r,t);else if(e.tag===19)Jd(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Qe(it,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&kl(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Hc(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&kl(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Hc(t,!0,r,null,s);break;case"together":Hc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function wn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ba|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,r=Yn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Yn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function __(e,t,r){switch(t.tag){case 3:kx(t),Ts();break;case 5:Y1(t);break;case 1:ur(t.type)&&ml(t);break;case 4:Qu(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Qe(_l,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Qe(it,it.current&1),t.flags|=128,null):r&t.child.childLanes?Ex(e,t,r):(Qe(it,it.current&1),e=wn(e,t,r),e!==null?e.sibling:null);Qe(it,it.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Tx(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Qe(it,it.current),n)break;return null;case 22:case 23:return t.lanes=0,yx(e,t,r)}return wn(e,t,r)}var Sx,K0,Cx,Ax;Sx=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};K0=function(){};Cx=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,_a(rn.current);var s=null;switch(r){case"input":a=x0(e,a),n=x0(e,n),s=[];break;case"select":a=lt({},a,{value:void 0}),n=lt({},n,{value:void 0}),s=[];break;case"textarea":a=v0(e,a),n=v0(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=pl)}y0(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fi.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fi.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&et("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Ax=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ys(e,t){if(!nt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Bt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function y_(e,t,r){var n=t.pendingProps;switch(Wu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(t),null;case 1:return ur(t.type)&&xl(),Bt(t),null;case 3:return n=t.stateNode,Cs(),tt(cr),tt(Gt),ef(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Fo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$r!==null&&(tu($r),$r=null))),K0(e,t),Bt(t),null;case 5:Zu(t);var a=_a($i.current);if(r=t.type,e!==null&&t.stateNode!=null)Cx(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(pe(166));return Bt(t),null}if(e=_a(rn.current),Fo(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[en]=t,n[Bi]=s,e=(t.mode&1)!==0,r){case"dialog":et("cancel",n),et("close",n);break;case"iframe":case"object":case"embed":et("load",n);break;case"video":case"audio":for(a=0;a<ri.length;a++)et(ri[a],n);break;case"source":et("error",n);break;case"img":case"image":case"link":et("error",n),et("load",n);break;case"details":et("toggle",n);break;case"input":id(n,s),et("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},et("invalid",n);break;case"textarea":ld(n,s),et("invalid",n)}y0(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&bo(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&bo(n.textContent,o,e),a=["children",""+o]):Fi.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&et("scroll",n)}switch(r){case"input":yo(n),od(n,s,!0);break;case"textarea":yo(n),cd(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=pl)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=t1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[en]=t,e[Bi]=n,Sx(e,t,!1,!1),t.stateNode=e;e:{switch(i=w0(r,n),r){case"dialog":et("cancel",e),et("close",e),a=n;break;case"iframe":case"object":case"embed":et("load",e),a=n;break;case"video":case"audio":for(a=0;a<ri.length;a++)et(ri[a],e);a=n;break;case"source":et("error",e),a=n;break;case"img":case"image":case"link":et("error",e),et("load",e),a=n;break;case"details":et("toggle",e),a=n;break;case"input":id(e,n),a=x0(e,n),et("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=lt({},n,{value:void 0}),et("invalid",e);break;case"textarea":ld(e,n),a=v0(e,n),et("invalid",e);break;default:a=n}y0(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?a1(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&r1(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ni(e,l):typeof l=="number"&&Ni(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Fi.hasOwnProperty(s)?l!=null&&s==="onScroll"&&et("scroll",e):l!=null&&Nu(e,s,l,i))}switch(r){case"input":yo(e),od(e,n,!1);break;case"textarea":yo(e),cd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Qn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?hs(e,!!n.multiple,s,!1):n.defaultValue!=null&&hs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=pl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Bt(t),null;case 6:if(e&&t.stateNode!=null)Ax(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(pe(166));if(r=_a($i.current),_a(rn.current),Fo(t)){if(n=t.stateNode,r=t.memoizedProps,n[en]=t,(s=n.nodeValue!==r)&&(e=mr,e!==null))switch(e.tag){case 3:bo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&bo(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[en]=t,t.stateNode=n}return Bt(t),null;case 13:if(tt(it),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(nt&&xr!==null&&t.mode&1&&!(t.flags&128))W1(),Ts(),t.flags|=98560,s=!1;else if(s=Fo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(pe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(pe(317));s[en]=t}else Ts(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Bt(t),s=!1}else $r!==null&&(tu($r),$r=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||it.current&1?kt===0&&(kt=3):hf())),t.updateQueue!==null&&(t.flags|=4),Bt(t),null);case 4:return Cs(),K0(e,t),e===null&&ji(t.stateNode.containerInfo),Bt(t),null;case 10:return qu(t.type._context),Bt(t),null;case 17:return ur(t.type)&&xl(),Bt(t),null;case 19:if(tt(it),s=t.memoizedState,s===null)return Bt(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Ys(s,!1);else{if(kt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=kl(e),i!==null){for(t.flags|=128,Ys(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Qe(it,it.current&1|2),t.child}e=e.sibling}s.tail!==null&&ht()>bs&&(t.flags|=128,n=!0,Ys(s,!1),t.lanes=4194304)}else{if(!n)if(e=kl(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ys(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!nt)return Bt(t),null}else 2*ht()-s.renderingStartTime>bs&&r!==1073741824&&(t.flags|=128,n=!0,Ys(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ht(),t.sibling=null,r=it.current,Qe(it,n?r&1|2:r&1),t):(Bt(t),null);case 22:case 23:return df(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?dr&1073741824&&(Bt(t),t.subtreeFlags&6&&(t.flags|=8192)):Bt(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function w_(e,t){switch(Wu(t),t.tag){case 1:return ur(t.type)&&xl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Cs(),tt(cr),tt(Gt),ef(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Zu(t),null;case 13:if(tt(it),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));Ts()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tt(it),null;case 4:return Cs(),null;case 10:return qu(t.type._context),null;case 22:case 23:return df(),null;case 24:return null;default:return null}}var Po=!1,Ht=!1,k_=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function cs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ct(e,t,n)}else r.current=null}function X0(e,t,r){try{r()}catch(n){ct(e,t,n)}}var Qd=!1;function E_(e,t){if(O0=fl,e=P1(),zu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,f=e,d=null;t:for(;;){for(var x;f!==r||a!==0&&f.nodeType!==3||(o=i+a),f!==s||n!==0&&f.nodeType!==3||(l=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(x=f.firstChild)!==null;)d=f,f=x;for(;;){if(f===e)break t;if(d===r&&++c===a&&(o=i),d===s&&++u===n&&(l=i),(x=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=x}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(P0={focusedElem:e,selectionRange:r},fl=!1,Ee=t;Ee!==null;)if(t=Ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ee=e;else for(;Ee!==null;){t=Ee;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Mr(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(S){ct(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Ee=e;break}Ee=t.return}return m=Qd,Qd=!1,m}function pi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&X0(t,r,s)}a=a.next}while(a!==n)}}function Zl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function q0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function bx(e){var t=e.alternate;t!==null&&(e.alternate=null,bx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[en],delete t[Bi],delete t[D0],delete t[s_],delete t[i_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fx(e){return e.tag===5||e.tag===3||e.tag===4}function Zd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Y0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=pl));else if(n!==4&&(e=e.child,e!==null))for(Y0(e,t,r),e=e.sibling;e!==null;)Y0(e,t,r),e=e.sibling}function J0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(J0(e,t,r),e=e.sibling;e!==null;)J0(e,t,r),e=e.sibling}var Ot=null,Br=!1;function bn(e,t,r){for(r=r.child;r!==null;)Nx(e,t,r),r=r.sibling}function Nx(e,t,r){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Wl,r)}catch{}switch(r.tag){case 5:Ht||cs(r,t);case 6:var n=Ot,a=Br;Ot=null,bn(e,t,r),Ot=n,Br=a,Ot!==null&&(Br?(e=Ot,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ot.removeChild(r.stateNode));break;case 18:Ot!==null&&(Br?(e=Ot,r=r.stateNode,e.nodeType===8?Dc(e.parentNode,r):e.nodeType===1&&Dc(e,r),Ii(e)):Dc(Ot,r.stateNode));break;case 4:n=Ot,a=Br,Ot=r.stateNode.containerInfo,Br=!0,bn(e,t,r),Ot=n,Br=a;break;case 0:case 11:case 14:case 15:if(!Ht&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&X0(r,t,i),a=a.next}while(a!==n)}bn(e,t,r);break;case 1:if(!Ht&&(cs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){ct(r,t,o)}bn(e,t,r);break;case 21:bn(e,t,r);break;case 22:r.mode&1?(Ht=(n=Ht)||r.memoizedState!==null,bn(e,t,r),Ht=n):bn(e,t,r);break;default:bn(e,t,r)}}function eh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new k_),t.forEach(function(n){var a=P_.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ir(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Ot=o.stateNode,Br=!1;break e;case 3:Ot=o.stateNode.containerInfo,Br=!0;break e;case 4:Ot=o.stateNode.containerInfo,Br=!0;break e}o=o.return}if(Ot===null)throw Error(pe(160));Nx(s,i,a),Ot=null,Br=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){ct(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ox(t,e),t=t.sibling}function Ox(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ir(t,e),qr(e),n&4){try{pi(3,e,e.return),Zl(3,e)}catch(g){ct(e,e.return,g)}try{pi(5,e,e.return)}catch(g){ct(e,e.return,g)}}break;case 1:Ir(t,e),qr(e),n&512&&r!==null&&cs(r,r.return);break;case 5:if(Ir(t,e),qr(e),n&512&&r!==null&&cs(r,r.return),e.flags&32){var a=e.stateNode;try{Ni(a,"")}catch(g){ct(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Zp(a,s),w0(o,i);var c=w0(o,s);for(i=0;i<l.length;i+=2){var u=l[i],f=l[i+1];u==="style"?a1(a,f):u==="dangerouslySetInnerHTML"?r1(a,f):u==="children"?Ni(a,f):Nu(a,u,f,c)}switch(o){case"input":m0(a,s);break;case"textarea":e1(a,s);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?hs(a,!!s.multiple,x,!1):d!==!!s.multiple&&(s.defaultValue!=null?hs(a,!!s.multiple,s.defaultValue,!0):hs(a,!!s.multiple,s.multiple?[]:"",!1))}a[Bi]=s}catch(g){ct(e,e.return,g)}}break;case 6:if(Ir(t,e),qr(e),n&4){if(e.stateNode===null)throw Error(pe(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){ct(e,e.return,g)}}break;case 3:if(Ir(t,e),qr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ii(t.containerInfo)}catch(g){ct(e,e.return,g)}break;case 4:Ir(t,e),qr(e);break;case 13:Ir(t,e),qr(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(uf=ht())),n&4&&eh(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Ht=(c=Ht)||u,Ir(t,e),Ht=c):Ir(t,e),qr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ee=e,u=e.child;u!==null;){for(f=Ee=u;Ee!==null;){switch(d=Ee,x=d.child,d.tag){case 0:case 11:case 14:case 15:pi(4,d,d.return);break;case 1:cs(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){ct(n,r,g)}}break;case 5:cs(d,d.return);break;case 22:if(d.memoizedState!==null){rh(f);continue}}x!==null?(x.return=d,Ee=x):rh(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=n1("display",i))}catch(g){ct(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(g){ct(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ir(t,e),qr(e),n&4&&eh(e);break;case 21:break;default:Ir(t,e),qr(e)}}function qr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Fx(r)){var n=r;break e}r=r.return}throw Error(pe(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ni(a,""),n.flags&=-33);var s=Zd(e);J0(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Zd(e);Y0(e,o,i);break;default:throw Error(pe(161))}}catch(l){ct(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function T_(e,t,r){Ee=e,Px(e)}function Px(e,t,r){for(var n=(e.mode&1)!==0;Ee!==null;){var a=Ee,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Po;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Ht;o=Po;var c=Ht;if(Po=i,(Ht=l)&&!c)for(Ee=a;Ee!==null;)i=Ee,l=i.child,i.tag===22&&i.memoizedState!==null?nh(a):l!==null?(l.return=i,Ee=l):nh(a);for(;s!==null;)Ee=s,Px(s),s=s.sibling;Ee=a,Po=o,Ht=c}th(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ee=s):th(e)}}function th(e){for(;Ee!==null;){var t=Ee;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ht||Zl(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ht)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Mr(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Bd(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Bd(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Ii(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}Ht||t.flags&512&&q0(t)}catch(d){ct(t,t.return,d)}}if(t===e){Ee=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function rh(e){for(;Ee!==null;){var t=Ee;if(t===e){Ee=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function nh(e){for(;Ee!==null;){var t=Ee;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Zl(4,t)}catch(l){ct(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){ct(t,a,l)}}var s=t.return;try{q0(t)}catch(l){ct(t,s,l)}break;case 5:var i=t.return;try{q0(t)}catch(l){ct(t,i,l)}}}catch(l){ct(t,t.return,l)}if(t===e){Ee=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ee=o;break}Ee=t.return}}var S_=Math.ceil,Sl=En.ReactCurrentDispatcher,lf=En.ReactCurrentOwner,br=En.ReactCurrentBatchConfig,He=0,bt=null,gt=null,Rt=0,dr=0,us=na(0),kt=0,Wi=null,ba=0,ec=0,cf=0,xi=null,ir=null,uf=0,bs=1/0,cn=null,Cl=!1,Q0=null,Xn=null,Ro=!1,Un=null,Al=0,mi=0,Z0=null,nl=-1,al=0;function er(){return He&6?ht():nl!==-1?nl:nl=ht()}function qn(e){return e.mode&1?He&2&&Rt!==0?Rt&-Rt:l_.transition!==null?(al===0&&(al=m1()),al):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:E1(e.type)),e):1}function Gr(e,t,r,n){if(50<mi)throw mi=0,Z0=null,Error(pe(185));ro(e,r,n),(!(He&2)||e!==bt)&&(e===bt&&(!(He&2)&&(ec|=r),kt===4&&Dn(e,Rt)),fr(e,n),r===1&&He===0&&!(t.mode&1)&&(bs=ht()+500,Yl&&aa()))}function fr(e,t){var r=e.callbackNode;l2(e,t);var n=ul(e,e===bt?Rt:0);if(n===0)r!==null&&dd(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&dd(r),t===1)e.tag===0?o_(ah.bind(null,e)):H1(ah.bind(null,e)),n_(function(){!(He&6)&&aa()}),r=null;else{switch(g1(n)){case 1:r=Du;break;case 4:r=p1;break;case 16:r=cl;break;case 536870912:r=x1;break;default:r=cl}r=Ux(r,Rx.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Rx(e,t){if(nl=-1,al=0,He&6)throw Error(pe(327));var r=e.callbackNode;if(vs()&&e.callbackNode!==r)return null;var n=ul(e,e===bt?Rt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=bl(e,n);else{t=n;var a=He;He|=2;var s=Dx();(bt!==e||Rt!==t)&&(cn=null,bs=ht()+500,wa(e,t));do try{b_();break}catch(o){Ix(e,o)}while(!0);Xu(),Sl.current=s,He=a,gt!==null?t=0:(bt=null,Rt=0,t=kt)}if(t!==0){if(t===2&&(a=C0(e),a!==0&&(n=a,t=eu(e,a))),t===1)throw r=Wi,wa(e,0),Dn(e,n),fr(e,ht()),r;if(t===6)Dn(e,n);else{if(a=e.current.alternate,!(n&30)&&!C_(a)&&(t=bl(e,n),t===2&&(s=C0(e),s!==0&&(n=s,t=eu(e,s))),t===1))throw r=Wi,wa(e,0),Dn(e,n),fr(e,ht()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(pe(345));case 2:ha(e,ir,cn);break;case 3:if(Dn(e,n),(n&130023424)===n&&(t=uf+500-ht(),10<t)){if(ul(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){er(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=I0(ha.bind(null,e,ir,cn),t);break}ha(e,ir,cn);break;case 4:if(Dn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Wr(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*S_(n/1960))-n,10<n){e.timeoutHandle=I0(ha.bind(null,e,ir,cn),n);break}ha(e,ir,cn);break;case 5:ha(e,ir,cn);break;default:throw Error(pe(329))}}}return fr(e,ht()),e.callbackNode===r?Rx.bind(null,e):null}function eu(e,t){var r=xi;return e.current.memoizedState.isDehydrated&&(wa(e,t).flags|=256),e=bl(e,t),e!==2&&(t=ir,ir=r,t!==null&&tu(t)),e}function tu(e){ir===null?ir=e:ir.push.apply(ir,e)}function C_(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Xr(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dn(e,t){for(t&=~cf,t&=~ec,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Wr(t),n=1<<r;e[r]=-1,t&=~n}}function ah(e){if(He&6)throw Error(pe(327));vs();var t=ul(e,0);if(!(t&1))return fr(e,ht()),null;var r=bl(e,t);if(e.tag!==0&&r===2){var n=C0(e);n!==0&&(t=n,r=eu(e,n))}if(r===1)throw r=Wi,wa(e,0),Dn(e,t),fr(e,ht()),r;if(r===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ha(e,ir,cn),fr(e,ht()),null}function ff(e,t){var r=He;He|=1;try{return e(t)}finally{He=r,He===0&&(bs=ht()+500,Yl&&aa())}}function Fa(e){Un!==null&&Un.tag===0&&!(He&6)&&vs();var t=He;He|=1;var r=br.transition,n=Xe;try{if(br.transition=null,Xe=1,e)return e()}finally{Xe=n,br.transition=r,He=t,!(He&6)&&aa()}}function df(){dr=us.current,tt(us)}function wa(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,r_(r)),gt!==null)for(r=gt.return;r!==null;){var n=r;switch(Wu(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&xl();break;case 3:Cs(),tt(cr),tt(Gt),ef();break;case 5:Zu(n);break;case 4:Cs();break;case 13:tt(it);break;case 19:tt(it);break;case 10:qu(n.type._context);break;case 22:case 23:df()}r=r.return}if(bt=e,gt=e=Yn(e.current,null),Rt=dr=t,kt=0,Wi=null,cf=ec=ba=0,ir=xi=null,va!==null){for(t=0;t<va.length;t++)if(r=va[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}va=null}return e}function Ix(e,t){do{var r=gt;try{if(Xu(),el.current=Tl,El){for(var n=ot.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}El=!1}if(Aa=0,At=wt=ot=null,hi=!1,Hi=0,lf.current=null,r===null||r.return===null){kt=1,Wi=t,gt=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=Rt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var x=Wd(i);if(x!==null){x.flags&=-257,Gd(x,i,o,s,t),x.mode&1&&Vd(s,c,t),t=x,l=c;var m=t.updateQueue;if(m===null){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}else{if(!(t&1)){Vd(s,c,t),hf();break e}l=Error(pe(426))}}else if(nt&&o.mode&1){var y=Wd(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Gd(y,i,o,s,t),Gu(As(l,o));break e}}s=l=As(l,o),kt!==4&&(kt=2),xi===null?xi=[s]:xi.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=gx(s,l,t);Md(s,v);break e;case 1:o=l;var _=s.type,p=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Xn===null||!Xn.has(p)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=vx(s,o,t);Md(s,S);break e}}s=s.return}while(s!==null)}jx(r)}catch(P){t=P,gt===r&&r!==null&&(gt=r=r.return);continue}break}while(!0)}function Dx(){var e=Sl.current;return Sl.current=Tl,e===null?Tl:e}function hf(){(kt===0||kt===3||kt===2)&&(kt=4),bt===null||!(ba&268435455)&&!(ec&268435455)||Dn(bt,Rt)}function bl(e,t){var r=He;He|=2;var n=Dx();(bt!==e||Rt!==t)&&(cn=null,wa(e,t));do try{A_();break}catch(a){Ix(e,a)}while(!0);if(Xu(),He=r,Sl.current=n,gt!==null)throw Error(pe(261));return bt=null,Rt=0,kt}function A_(){for(;gt!==null;)Lx(gt)}function b_(){for(;gt!==null&&!Zv();)Lx(gt)}function Lx(e){var t=Bx(e.alternate,e,dr);e.memoizedProps=e.pendingProps,t===null?jx(e):gt=t,lf.current=null}function jx(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=w_(r,t),r!==null){r.flags&=32767,gt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{kt=6,gt=null;return}}else if(r=y_(r,t,dr),r!==null){gt=r;return}if(t=t.sibling,t!==null){gt=t;return}gt=t=e}while(t!==null);kt===0&&(kt=5)}function ha(e,t,r){var n=Xe,a=br.transition;try{br.transition=null,Xe=1,F_(e,t,r,n)}finally{br.transition=a,Xe=n}return null}function F_(e,t,r,n){do vs();while(Un!==null);if(He&6)throw Error(pe(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(c2(e,s),e===bt&&(gt=bt=null,Rt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ro||(Ro=!0,Ux(cl,function(){return vs(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=br.transition,br.transition=null;var i=Xe;Xe=1;var o=He;He|=4,lf.current=null,E_(e,r),Ox(r,e),q2(P0),fl=!!O0,P0=O0=null,e.current=r,T_(r),e2(),He=o,Xe=i,br.transition=s}else e.current=r;if(Ro&&(Ro=!1,Un=e,Al=a),s=e.pendingLanes,s===0&&(Xn=null),n2(r.stateNode),fr(e,ht()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Cl)throw Cl=!1,e=Q0,Q0=null,e;return Al&1&&e.tag!==0&&vs(),s=e.pendingLanes,s&1?e===Z0?mi++:(mi=0,Z0=e):mi=0,aa(),null}function vs(){if(Un!==null){var e=g1(Al),t=br.transition,r=Xe;try{if(br.transition=null,Xe=16>e?16:e,Un===null)var n=!1;else{if(e=Un,Un=null,Al=0,He&6)throw Error(pe(331));var a=He;for(He|=4,Ee=e.current;Ee!==null;){var s=Ee,i=s.child;if(Ee.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ee=c;Ee!==null;){var u=Ee;switch(u.tag){case 0:case 11:case 15:pi(8,u,s)}var f=u.child;if(f!==null)f.return=u,Ee=f;else for(;Ee!==null;){u=Ee;var d=u.sibling,x=u.return;if(bx(u),u===c){Ee=null;break}if(d!==null){d.return=x,Ee=d;break}Ee=x}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Ee=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ee=i;else e:for(;Ee!==null;){if(s=Ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:pi(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Ee=v;break e}Ee=s.return}}var _=e.current;for(Ee=_;Ee!==null;){i=Ee;var p=i.child;if(i.subtreeFlags&2064&&p!==null)p.return=i,Ee=p;else e:for(i=_;Ee!==null;){if(o=Ee,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Zl(9,o)}}catch(P){ct(o,o.return,P)}if(o===i){Ee=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,Ee=S;break e}Ee=o.return}}if(He=a,aa(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Wl,e)}catch{}n=!0}return n}finally{Xe=r,br.transition=t}}return!1}function sh(e,t,r){t=As(r,t),t=gx(e,t,1),e=Kn(e,t,1),t=er(),e!==null&&(ro(e,1,t),fr(e,t))}function ct(e,t,r){if(e.tag===3)sh(e,e,r);else for(;t!==null;){if(t.tag===3){sh(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Xn===null||!Xn.has(n))){e=As(r,e),e=vx(t,e,1),t=Kn(t,e,1),e=er(),t!==null&&(ro(t,1,e),fr(t,e));break}}t=t.return}}function N_(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=er(),e.pingedLanes|=e.suspendedLanes&r,bt===e&&(Rt&r)===r&&(kt===4||kt===3&&(Rt&130023424)===Rt&&500>ht()-uf?wa(e,0):cf|=r),fr(e,t)}function Mx(e,t){t===0&&(e.mode&1?(t=Eo,Eo<<=1,!(Eo&130023424)&&(Eo=4194304)):t=1);var r=er();e=yn(e,t),e!==null&&(ro(e,t,r),fr(e,r))}function O_(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Mx(e,r)}function P_(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(pe(314))}n!==null&&n.delete(t),Mx(e,r)}var Bx;Bx=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||cr.current)lr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return lr=!1,__(e,t,r);lr=!!(e.flags&131072)}else lr=!1,nt&&t.flags&1048576&&z1(t,vl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;rl(e,t),e=t.pendingProps;var a=Es(t,Gt.current);gs(t,r),a=rf(null,t,n,e,a,r);var s=nf();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ur(n)?(s=!0,ml(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Ju(t),a.updater=Ql,t.stateNode=a,a._reactInternals=t,$0(t,n,e,r),t=V0(null,t,n,!0,s,r)):(t.tag=0,nt&&s&&Vu(t),Yt(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(rl(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=I_(n),e=Mr(n,e),a){case 0:t=z0(null,t,n,e,r);break e;case 1:t=qd(null,t,n,e,r);break e;case 11:t=Kd(null,t,n,e,r);break e;case 14:t=Xd(null,t,n,Mr(n.type,e),r);break e}throw Error(pe(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),z0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),qd(e,t,n,a,r);case 3:e:{if(kx(t),e===null)throw Error(pe(387));n=t.pendingProps,s=t.memoizedState,a=s.element,q1(e,t),wl(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=As(Error(pe(423)),t),t=Yd(e,t,n,r,a);break e}else if(n!==a){a=As(Error(pe(424)),t),t=Yd(e,t,n,r,a);break e}else for(xr=Gn(t.stateNode.containerInfo.firstChild),mr=t,nt=!0,$r=null,r=K1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ts(),n===a){t=wn(e,t,r);break e}Yt(e,t,n,r)}t=t.child}return t;case 5:return Y1(t),e===null&&M0(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,R0(n,a)?i=null:s!==null&&R0(n,s)&&(t.flags|=32),wx(e,t),Yt(e,t,i,r),t.child;case 6:return e===null&&M0(t),null;case 13:return Ex(e,t,r);case 4:return Qu(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ss(t,null,n,r):Yt(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),Kd(e,t,n,a,r);case 7:return Yt(e,t,t.pendingProps,r),t.child;case 8:return Yt(e,t,t.pendingProps.children,r),t.child;case 12:return Yt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Qe(_l,n._currentValue),n._currentValue=i,s!==null)if(Xr(s.value,i)){if(s.children===a.children&&!cr.current){t=wn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=xn(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),B0(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(pe(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),B0(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Yt(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,gs(t,r),a=Fr(a),n=n(a),t.flags|=1,Yt(e,t,n,r),t.child;case 14:return n=t.type,a=Mr(n,t.pendingProps),a=Mr(n.type,a),Xd(e,t,n,a,r);case 15:return _x(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Mr(n,a),rl(e,t),t.tag=1,ur(n)?(e=!0,ml(t)):e=!1,gs(t,r),mx(t,n,a),$0(t,n,a,r),V0(null,t,n,!0,e,r);case 19:return Tx(e,t,r);case 22:return yx(e,t,r)}throw Error(pe(156,t.tag))};function Ux(e,t){return h1(e,t)}function R_(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ar(e,t,r,n){return new R_(e,t,r,n)}function pf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function I_(e){if(typeof e=="function")return pf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Pu)return 11;if(e===Ru)return 14}return 2}function Yn(e,t){var r=e.alternate;return r===null?(r=Ar(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function sl(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")pf(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case es:return ka(r.children,a,s,t);case Ou:i=8,a|=8;break;case f0:return e=Ar(12,r,t,a|2),e.elementType=f0,e.lanes=s,e;case d0:return e=Ar(13,r,t,a),e.elementType=d0,e.lanes=s,e;case h0:return e=Ar(19,r,t,a),e.elementType=h0,e.lanes=s,e;case Yp:return tc(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xp:i=10;break e;case qp:i=9;break e;case Pu:i=11;break e;case Ru:i=14;break e;case Pn:i=16,n=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=Ar(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function ka(e,t,r,n){return e=Ar(7,e,n,t),e.lanes=r,e}function tc(e,t,r,n){return e=Ar(22,e,n,t),e.elementType=Yp,e.lanes=r,e.stateNode={isHidden:!1},e}function zc(e,t,r){return e=Ar(6,e,null,t),e.lanes=r,e}function Vc(e,t,r){return t=Ar(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function D_(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tc(0),this.expirationTimes=Tc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tc(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function xf(e,t,r,n,a,s,i,o,l){return e=new D_(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ar(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ju(s),e}function L_(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Za,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function $x(e){if(!e)return Zn;e=e._reactInternals;e:{if(Ia(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ur(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var r=e.type;if(ur(r))return $1(e,r,t)}return t}function Hx(e,t,r,n,a,s,i,o,l){return e=xf(r,n,!0,e,a,s,i,o,l),e.context=$x(null),r=e.current,n=er(),a=qn(r),s=xn(n,a),s.callback=t??null,Kn(r,s,a),e.current.lanes=a,ro(e,a,n),fr(e,n),e}function rc(e,t,r,n){var a=t.current,s=er(),i=qn(a);return r=$x(r),t.context===null?t.context=r:t.pendingContext=r,t=xn(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Kn(a,t,i),e!==null&&(Gr(e,a,i,s),Zo(e,a,i)),i}function Fl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ih(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function mf(e,t){ih(e,t),(e=e.alternate)&&ih(e,t)}function j_(){return null}var zx=typeof reportError=="function"?reportError:function(e){console.error(e)};function gf(e){this._internalRoot=e}nc.prototype.render=gf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));rc(e,t,null,null)};nc.prototype.unmount=gf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fa(function(){rc(null,e,null,null)}),t[_n]=null}};function nc(e){this._internalRoot=e}nc.prototype.unstable_scheduleHydration=function(e){if(e){var t=y1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<In.length&&t!==0&&t<In[r].priority;r++);In.splice(r,0,e),r===0&&k1(e)}};function vf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ac(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function oh(){}function M_(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Fl(i);s.call(c)}}var i=Hx(t,n,e,0,null,!1,!1,"",oh);return e._reactRootContainer=i,e[_n]=i.current,ji(e.nodeType===8?e.parentNode:e),Fa(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Fl(l);o.call(c)}}var l=xf(e,0,!1,null,null,!1,!1,"",oh);return e._reactRootContainer=l,e[_n]=l.current,ji(e.nodeType===8?e.parentNode:e),Fa(function(){rc(t,l,r,n)}),l}function sc(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Fl(i);o.call(l)}}rc(t,i,e,a)}else i=M_(r,t,e,a,n);return Fl(i)}v1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ti(t.pendingLanes);r!==0&&(Lu(t,r|1),fr(t,ht()),!(He&6)&&(bs=ht()+500,aa()))}break;case 13:Fa(function(){var n=yn(e,1);if(n!==null){var a=er();Gr(n,e,1,a)}}),mf(e,1)}};ju=function(e){if(e.tag===13){var t=yn(e,134217728);if(t!==null){var r=er();Gr(t,e,134217728,r)}mf(e,134217728)}};_1=function(e){if(e.tag===13){var t=qn(e),r=yn(e,t);if(r!==null){var n=er();Gr(r,e,t,n)}mf(e,t)}};y1=function(){return Xe};w1=function(e,t){var r=Xe;try{return Xe=e,t()}finally{Xe=r}};E0=function(e,t,r){switch(t){case"input":if(m0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=ql(n);if(!a)throw Error(pe(90));Qp(n),m0(n,a)}}}break;case"textarea":e1(e,r);break;case"select":t=r.value,t!=null&&hs(e,!!r.multiple,t,!1)}};o1=ff;l1=Fa;var B_={usingClientEntryPoint:!1,Events:[ao,as,ql,s1,i1,ff]},Js={findFiberByHostInstance:ga,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},U_={bundleType:Js.bundleType,version:Js.version,rendererPackageName:Js.rendererPackageName,rendererConfig:Js.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:En.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=f1(e),e===null?null:e.stateNode},findFiberByHostInstance:Js.findFiberByHostInstance||j_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Io=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Io.isDisabled&&Io.supportsFiber)try{Wl=Io.inject(U_),tn=Io}catch{}}yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B_;yr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vf(t))throw Error(pe(200));return L_(e,t,null,r)};yr.createRoot=function(e,t){if(!vf(e))throw Error(pe(299));var r=!1,n="",a=zx;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=xf(e,1,!1,null,null,r,!1,n,a),e[_n]=t.current,ji(e.nodeType===8?e.parentNode:e),new gf(t)};yr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=f1(t),e=e===null?null:e.stateNode,e};yr.flushSync=function(e){return Fa(e)};yr.hydrate=function(e,t,r){if(!ac(t))throw Error(pe(200));return sc(null,e,t,!0,r)};yr.hydrateRoot=function(e,t,r){if(!vf(e))throw Error(pe(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=zx;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Hx(t,null,e,1,r??null,a,!1,s,i),e[_n]=t.current,ji(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new nc(t)};yr.render=function(e,t,r){if(!ac(t))throw Error(pe(200));return sc(null,e,t,!1,r)};yr.unmountComponentAtNode=function(e){if(!ac(e))throw Error(pe(40));return e._reactRootContainer?(Fa(function(){sc(null,null,e,!1,function(){e._reactRootContainer=null,e[_n]=null})}),!0):!1};yr.unstable_batchedUpdates=ff;yr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ac(r))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return sc(e,t,r,!1,n)};yr.version="18.3.1-next-f1338f8080-20240426";function Vx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Vx)}catch(e){console.error(e)}}Vx(),Vp.exports=yr;var $_=Vp.exports,Wx,lh=$_;Wx=lh.createRoot,lh.hydrateRoot;const H_="modulepreload",z_=function(e){return"/"+e},ch={},io=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=z_(l),l in ch)return;ch[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":H_,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((d,x)=>{f.addEventListener("load",d),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},V_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>io(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class _f extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class W_ extends _f{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class uh extends _f{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class fh extends _f{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var ru;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(ru||(ru={}));var G_=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class K_{constructor(t,{headers:r={},customFetch:n,region:a=ru.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=V_(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return G_(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const f=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(g=>{throw new W_(g)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new uh(f);if(!f.ok)throw new fh(f);let x=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return x==="application/json"?m=yield f.json():x==="application/octet-stream"?m=yield f.blob():x==="text/event-stream"?m=f:x==="multipart/form-data"?m=yield f.formData():m=yield f.text(),{data:m,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof fh||a instanceof uh?a.context:void 0}}})}}var or={},yf={},ic={},oo={},oc={},lc={},X_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Fs=X_();const q_=Fs.fetch,Gx=Fs.fetch.bind(Fs),Kx=Fs.Headers,Y_=Fs.Request,J_=Fs.Response,Ls=Object.freeze(Object.defineProperty({__proto__:null,Headers:Kx,Request:Y_,Response:J_,default:Gx,fetch:q_},Symbol.toStringTag,{value:"Module"})),Q_=xv(Ls);var cc={};Object.defineProperty(cc,"__esModule",{value:!0});let Z_=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};cc.default=Z_;var Xx=gr&&gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lc,"__esModule",{value:!0});const ey=Xx(Q_),ty=Xx(cc);let ry=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=ey.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l,c;let u=null,f=null,d=null,x=s.status,m=s.statusText;if(s.ok){if(this.method!=="HEAD"){const _=await s.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?f=_:f=JSON.parse(_))}const y=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");y&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,d=null,x=406,m="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const y=await s.text();try{u=JSON.parse(y),Array.isArray(u)&&s.status===404&&(f=[],u=null,x=200,m="OK")}catch{s.status===404&&y===""?(x=204,m="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,x=200,m="OK"),u&&this.shouldThrowOnError)throw new ty.default(u)}return{error:u,data:f,count:d,status:x,statusText:m}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};lc.default=ry;var ny=gr&&gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oc,"__esModule",{value:!0});const ay=ny(lc);let sy=class extends ay.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};oc.default=sy;var iy=gr&&gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oo,"__esModule",{value:!0});const oy=iy(oc);let ly=class extends oy.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};oo.default=ly;var cy=gr&&gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ic,"__esModule",{value:!0});const Qs=cy(oo);let uy=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new Qs.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Qs.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Qs.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Qs.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Qs.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};ic.default=uy;var qx=gr&&gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yf,"__esModule",{value:!0});const fy=qx(ic),dy=qx(oo);let hy=class Yx{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new fy.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Yx(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([f,d])=>d!==void 0).map(([f,d])=>[f,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([f,d])=>{l.searchParams.append(f,d)})):(o="POST",c=r);const u=new Headers(this.headers);return s&&u.set("Prefer",`count=${s}`),new dy.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};yf.default=hy;var js=gr&&gr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(or,"__esModule",{value:!0});or.PostgrestError=or.PostgrestBuilder=or.PostgrestTransformBuilder=or.PostgrestFilterBuilder=or.PostgrestQueryBuilder=or.PostgrestClient=void 0;const Jx=js(yf);or.PostgrestClient=Jx.default;const Qx=js(ic);or.PostgrestQueryBuilder=Qx.default;const Zx=js(oo);or.PostgrestFilterBuilder=Zx.default;const em=js(oc);or.PostgrestTransformBuilder=em.default;const tm=js(lc);or.PostgrestBuilder=tm.default;const rm=js(cc);or.PostgrestError=rm.default;var py=or.default={PostgrestClient:Jx.default,PostgrestQueryBuilder:Qx.default,PostgrestFilterBuilder:Zx.default,PostgrestTransformBuilder:em.default,PostgrestBuilder:tm.default,PostgrestError:rm.default};const{PostgrestClient:xy,PostgrestQueryBuilder:JF,PostgrestFilterBuilder:QF,PostgrestTransformBuilder:ZF,PostgrestBuilder:eN,PostgrestError:tN}=py;class my{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const gy="2.15.5",vy=`realtime-js/${gy}`,_y="1.0.0",nu=1e4,yy=1e3,wy=100;var gi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(gi||(gi={}));var vt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(vt||(vt={}));var Ur;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ur||(Ur={}));var au;(function(e){e.websocket="websocket"})(au||(au={}));var xa;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(xa||(xa={}));class ky{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class nm{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Je;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Je||(Je={}));const dh=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=Ey(i,e,t,a),s),{})},Ey=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?am(s,i):su(i)},am=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Ay(t,r)}switch(e){case Je.bool:return Ty(t);case Je.float4:case Je.float8:case Je.int2:case Je.int4:case Je.int8:case Je.numeric:case Je.oid:return Sy(t);case Je.json:case Je.jsonb:return Cy(t);case Je.timestamp:return by(t);case Je.abstime:case Je.date:case Je.daterange:case Je.int4range:case Je.int8range:case Je.money:case Je.reltime:case Je.text:case Je.time:case Je.timestamptz:case Je.timetz:case Je.tsrange:case Je.tstzrange:return su(t);default:return su(t)}},su=e=>e,Ty=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Sy=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Cy=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Ay=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>am(t,o))}return e},by=e=>typeof e=="string"?e.replace(" ","T"):e,sm=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Wc{constructor(t,r,n={},a=nu){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var hh;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(hh||(hh={}));class vi{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vi.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=vi.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=vi.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const f=s[c];if(f){const d=u.map(y=>y.presence_ref),x=f.map(y=>y.presence_ref),m=u.filter(y=>x.indexOf(y.presence_ref)<0),g=f.filter(y=>d.indexOf(y.presence_ref)<0);m.length>0&&(o[c]=m),g.length>0&&(l[c]=g)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(x=>x.presence_ref),d=u.filter(x=>f.indexOf(x.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ph;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ph||(ph={}));var _i;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(_i||(_i={}));var un;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(un||(un={}));class wf{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=vt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Wc(this,Ur.join,this.params,this.timeout),this.rejoinTimer=new nm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=vt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=vt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=vt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=vt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=vt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ur.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new vi(this),this.broadcastEndpointURL=sm(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==vt.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(x=>x.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[_i.PRESENCE]&&this.bindings[_i.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},d={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(x=>t==null?void 0:t(un.CHANNEL_ERROR,x)),this._onClose(()=>t==null?void 0:t(un.CLOSED)),this.updateJoinPayload(Object.assign({config:d},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:x})=>{var m;if(this.socket.setAuth(),x===void 0){t==null||t(un.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,v=[];for(let _=0;_<y;_++){const p=g[_],{filter:{event:S,schema:P,table:C,filter:E}}=p,w=x&&x[_];if(w&&w.event===S&&w.schema===P&&w.table===C&&w.filter===E)v.push(Object.assign(Object.assign({},p),{id:w.id}));else{this.unsubscribe(),this.state=vt.errored,t==null||t(un.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(un.SUBSCRIBED);return}}).receive("error",x=>{this.state=vt.errored,t==null||t(un.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(un.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===vt.joined&&t===_i.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=vt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ur.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Wc(this,Ur.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=vt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Wc(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>wy){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Ur;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let d=this._onMessage(i,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(x=>{var m,g,y;return((m=x.filter)===null||m===void 0?void 0:m.event)==="*"||((y=(g=x.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(x=>x.callback(d,n)):(s=this.bindings[i])===null||s===void 0||s.filter(x=>{var m,g,y,v,_,p;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in x){const S=x.id,P=(m=x.filter)===null||m===void 0?void 0:m.event;return S&&((g=r.ids)===null||g===void 0?void 0:g.includes(S))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const S=(_=(v=x==null?void 0:x.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return S==="*"||S===((p=r==null?void 0:r.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===i}).map(x=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:g,table:y,commit_timestamp:v,type:_,errors:p}=m;d=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:v,eventType:_,new:{},old:{},errors:p}),this._getPayloadRecords(m))}x.callback(d,n)})}_isClosed(){return this.state===vt.closed}_isJoined(){return this.state===vt.joined}_isJoining(){return this.state===vt.joining}_isLeaving(){return this.state===vt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&wf.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ur.close,{},t)}_onError(t){this._on(Ur.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=vt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=dh(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=dh(t.columns,t.old_record)),r}}const Gc=()=>{},Do={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Fy=[1e3,2e3,5e3,1e4],Ny=1e4,Oy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Py{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=nu,this.transport=null,this.heartbeatIntervalMs=Do.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Gc,this.ref=0,this.reconnectTimer=null,this.logger=Gc,this.conn=null,this.sendBuffer=[],this.serializer=new ky,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>io(async()=>{const{default:o}=await Promise.resolve().then(()=>Ls);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${au.websocket}`,this.httpEndpoint=sm(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=my.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:_y}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case gi.connecting:return xa.Connecting;case gi.open:return xa.Open;case gi.closing:return xa.Closing;default:return xa.Closed}}isConnected(){return this.connectionState()===xa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new wf(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(yy,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Do.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ur.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Oy],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:vy};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ur.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new nm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Do.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:nu,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Do.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Gc,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:f=>Fy[f-1]||Ny,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(f,d)=>d(JSON.stringify(f)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class kf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function _t(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Ry extends kf{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class iu extends kf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Iy=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const im=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>io(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Dy=()=>Iy(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield io(()=>Promise.resolve().then(()=>Ls),void 0)).Response:Response}),ou=e=>{if(Array.isArray(e))return e.map(r=>ou(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=ou(n)}),t},Ly=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Da=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Kc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),jy=(e,t,r)=>Da(void 0,void 0,void 0,function*(){const n=yield Dy();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,i=(a==null?void 0:a.statusCode)||s+"";t(new Ry(Kc(a),s,i))}).catch(a=>{t(new iu(Kc(a),a))}):t(new iu(Kc(e),e))}),My=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Ly(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function lo(e,t,r,n,a,s){return Da(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,My(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>jy(l,o,n))})})}function Nl(e,t,r,n){return Da(this,void 0,void 0,function*(){return lo(e,"GET",t,r,n)})}function Zr(e,t,r,n,a){return Da(this,void 0,void 0,function*(){return lo(e,"POST",t,n,a,r)})}function lu(e,t,r,n,a){return Da(this,void 0,void 0,function*(){return lo(e,"PUT",t,n,a,r)})}function By(e,t,r,n){return Da(this,void 0,void 0,function*(){return lo(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function om(e,t,r,n,a){return Da(this,void 0,void 0,function*(){return lo(e,"DELETE",t,n,a,r)})}var qt=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Uy={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},xh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class $y{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=im(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return qt(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},xh),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield(t=="PUT"?lu:Zr)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(_t(s))return{data:null,error:s};throw s}})}upload(t,r,n){return qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return qt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:xh.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield lu(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(_t(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return qt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Zr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new kf("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_t(n))return{data:null,error:n};throw n}})}update(t,r,n){return qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return qt(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_t(a))return{data:null,error:a};throw a}})}copy(t,r,n){return qt(this,void 0,void 0,function*(){try{return{data:{path:(yield Zr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_t(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return qt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Zr(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_t(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return qt(this,void 0,void 0,function*(){try{const a=yield Zr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_t(a))return{data:null,error:a};throw a}})}download(t,r){return qt(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Nl(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(_t(o))return{data:null,error:o};throw o}})}info(t){return qt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Nl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ou(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_t(n))return{data:null,error:n};throw n}})}exists(t){return qt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield By(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_t(n)&&n instanceof iu){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return qt(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}})}list(t,r,n){return qt(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Uy),r),{prefix:t||""});return{data:yield Zr(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(_t(a))return{data:null,error:a};throw a}})}listV2(t,r){return qt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Zr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_t(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Hy="2.12.1",zy={"X-Client-Info":`storage-js/${Hy}`};var Va=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class Vy{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},zy),r),this.fetch=im(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Va(this,void 0,void 0,function*(){try{return{data:yield Nl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(_t(t))return{data:null,error:t};throw t}})}getBucket(t){return Va(this,void 0,void 0,function*(){try{return{data:yield Nl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Va(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_t(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Va(this,void 0,void 0,function*(){try{return{data:yield lu(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_t(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Va(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Va(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}})}}class Wy extends Vy{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new $y(this.url,this.headers,t,this.fetch)}}const Gy="2.57.4";let ni="";typeof Deno<"u"?ni="deno":typeof document<"u"?ni="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ni="react-native":ni="node";const Ky={"X-Client-Info":`supabase-js-${ni}/${Gy}`},Xy={headers:Ky},qy={schema:"public"},Yy={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Jy={};var Qy=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Zy=e=>{let t;return e?t=e:typeof fetch>"u"?t=Gx:t=fetch,(...r)=>t(...r)},ew=()=>typeof Headers>"u"?Kx:Headers,tw=(e,t,r)=>{const n=Zy(r),a=ew();return(s,i)=>Qy(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var rw=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function nw(e){return e.endsWith("/")?e:e+"/"}function aw(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,d={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>rw(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function sw(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(nw(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const lm="2.71.1",Ya=30*1e3,cu=3,Xc=cu*Ya,iw="http://localhost:9999",ow="supabase.auth.token",lw={"X-Client-Info":`gotrue-js/${lm}`},uu="X-Supabase-Api-Version",cm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},cw=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,uw=10*60*1e3;class Ef extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Pe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class fw extends Ef{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function dw(e){return Pe(e)&&e.name==="AuthApiError"}class um extends Ef{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class sa extends Ef{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class On extends sa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function hw(e){return Pe(e)&&e.name==="AuthSessionMissingError"}class Lo extends sa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class jo extends sa{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Mo extends sa{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function pw(e){return Pe(e)&&e.name==="AuthImplicitGrantRedirectError"}class mh extends sa{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class fu extends sa{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function qc(e){return Pe(e)&&e.name==="AuthRetryableFetchError"}class gh extends sa{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class du extends sa{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ol="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),vh=` 	
\r=`.split(""),xw=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<vh.length;t+=1)e[vh[t].charCodeAt(0)]=-2;for(let t=0;t<Ol.length;t+=1)e[Ol[t].charCodeAt(0)]=t;return e})();function _h(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ol[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ol[n]),t.queuedBits-=6}}function fm(e,t,r){const n=xw[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function yh(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{vw(i,n,r)};for(let i=0;i<e.length;i+=1)fm(e.charCodeAt(i),a,s);return t.join("")}function mw(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function gw(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}mw(n,t)}}function vw(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function _w(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)fm(e.charCodeAt(a),r,n);return new Uint8Array(t)}function yw(e){const t=[];return gw(e,r=>t.push(r)),new Uint8Array(t)}function ww(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>_h(a,r,n)),_h(null,r,n),t.join("")}function kw(e){return Math.round(Date.now()/1e3)+e}function Ew(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const jr=()=>typeof window<"u"&&typeof document<"u",ua={tested:!1,writable:!1},dm=()=>{if(!jr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ua.tested)return ua.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ua.tested=!0,ua.writable=!0}catch{ua.tested=!0,ua.writable=!1}return ua.writable};function Tw(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const hm=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>io(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Sw=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ja=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},fa=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Fn=async(e,t)=>{await e.removeItem(t)};class uc{constructor(){this.promise=new uc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}uc.promiseConstructor=Promise;function Yc(e){const t=e.split(".");if(t.length!==3)throw new du("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!cw.test(t[n]))throw new du("JWT not in base64url format");return{header:JSON.parse(yh(t[0])),payload:JSON.parse(yh(t[1])),signature:_w(t[2]),raw:{header:t[0],payload:t[1]}}}async function Cw(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Aw(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function bw(e){return("0"+e.toString(16)).substr(-2)}function Fw(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,bw).join("")}async function Nw(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function Ow(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Nw(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wa(e,t,r=!1){const n=Fw();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Ja(e,`${t}-code-verifier`,a);const s=await Ow(n);return[s,n===s?"plain":"s256"]}const Pw=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Rw(e){const t=e.headers.get(uu);if(!t||!t.match(Pw))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Iw(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Dw(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Lw=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ga(e){if(!Lw.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Jc(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function wh(e){return JSON.parse(JSON.stringify(e))}var jw=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const pa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Mw=[502,503,504];async function kh(e){var t;if(!Sw(e))throw new fu(pa(e),0);if(Mw.includes(e.status))throw new fu(pa(e),e.status);let r;try{r=await e.json()}catch(s){throw new um(pa(s),s)}let n;const a=Rw(e);if(a&&a.getTime()>=cm["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new gh(pa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new On}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new gh(pa(r),e.status,r.weak_password.reasons);throw new fw(pa(r),e.status||500,n)}const Bw=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function je(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[uu]||(s[uu]=cm["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await Uw(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Uw(e,t,r,n,a,s){const i=Bw(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new fu(pa(l),0)}if(o.ok||await kh(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await kh(l)}}function ln(e){var t;let r=null;Vw(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=kw(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Eh(e){const t=ln(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ln(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function $w(e){return{data:e,error:null}}function Hw(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=jw(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function zw(e){return e}function Vw(e){return e.access_token&&e.refresh_token&&e.expires_in}const Qc=["global","local","others"];var Ww=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class Gw{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=hm(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Qc[0]){if(Qc.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Qc.join(", ")}`);try{return await je(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await je(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ln})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Ww(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await je(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Hw,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await je(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ln})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await je(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:zw});if(u.error)throw u.error;const f=await u.json(),d=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,x=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return x.length>0&&(x.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(m.split(";")[1].split("=")[1]);c[`${y}Page`]=g}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Pe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Ga(t);try{return await je(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ln})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ga(t);try{return await je(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ln})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Ga(t);try{return await je(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ln})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ga(t.userId);try{const{data:r,error:n}=await je(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ga(t.userId),Ga(t.id);try{return{data:await je(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}}function Th(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Kw(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ka={debug:!!(globalThis&&dm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class pm extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Xw extends pm{}async function qw(e,t,r){Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Xw(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ka.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Kw();const Yw={url:iw,storageKey:ow,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:lw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Sh(e,t,r){return await r()}const Xa={};class Gi{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Gi.nextInstanceID,Gi.nextInstanceID+=1,this.instanceID>0&&jr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Yw),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Gw({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=hm(a.fetch),this.lock=a.lock||Sh,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:jr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=qw:this.lock=Sh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:dm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Th(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Th(this.memoryStorage)),jr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Xa[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Xa[this.storageKey]=Object.assign(Object.assign({},Xa[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Xa[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Xa[this.storageKey]=Object.assign(Object.assign({},Xa[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${lm}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Tw(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),jr()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),pw(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pe(r)?{error:r}:{error:new um("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:ln}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:u,password:f,options:d}=t;let x=null,m=null;this.flowType==="pkce"&&([x,m]=await Wa(this.storage,this.storageKey)),s=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:x,code_challenge_method:m},xform:ln})}else if("phone"in t){const{phone:u,password:f,options:d}=t;s=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:ln})}else throw new jo("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Eh})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Eh})}else throw new jo("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Lo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,l,c,u,f,d,x;let m,g;if("message"in t)m=t.message,g=t.signature;else{const{chain:y,wallet:v,statement:_,options:p}=t;let S;if(jr())if(typeof v=="object")S=v;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))S=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=v}const P=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const C=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),_?{statement:_}:null));let E;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")E=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)E=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)m=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),g=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${P.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(a=(n=p==null?void 0:p.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=p==null?void 0:p.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((f=(u=p==null?void 0:p.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...p.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const C=await S.signMessage(new TextEncoder().encode(m),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:y,error:v}=await je(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:ww(g)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:ln});if(v)throw v;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Lo}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:v})}catch(y){if(Pe(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const r=await fa(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await je(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ln});if(await Fn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Lo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Pe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ln}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Lo}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Wa(this.storage,this.storageKey));const{error:f}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new jo("You must provide either an email or phone number.")}catch(o){if(Pe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await je(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:ln});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Pe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Wa(this.storage,this.storageKey)),await je(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:$w})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new On;const{error:a}=await je(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Pe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await je(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await je(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new jo("You must provide either an email or phone number and a type")}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await fa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Xc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await fa(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Jc()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ln}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new On}:await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Ln})})}catch(r){if(Pe(r))return hw(r)&&(await this._removeSession(),await Fn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new On;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Wa(this.storage,this.storageKey));const{data:c,error:u}=await je(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Ln});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new On;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=Yc(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Pe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new On;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!jr())throw new Mo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Mo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new mh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Mo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new mh("No code detected.");const{data:_,error:p}=await this._exchangeCodeForSession(t.code);if(p)throw p;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new Mo("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const x=d-u;x*1e3<=Ya&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${f}s`);const m=d-f;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:g,error:y}=await this._getUser(s);if(y)throw y;const v={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:f,expires_at:d,refresh_token:i,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(n){if(Pe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await fa(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(dw(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Fn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Ew(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Wa(this.storage,this.storageKey,!0));try{return await je(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,u;const{data:f,error:d}=s;if(d)throw d;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await je(this.fetch,"GET",x,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return jr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Pe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await je(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Aw(async a=>(a>0&&await Cw(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await je(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ln})),(a,s)=>{const i=200*Math.pow(2,a);return s&&qc(s)&&Date.now()+i-n<Ya})}catch(n){if(this._debug(r,"error",n),Pe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),jr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await fa(this.storage,this.storageKey);if(a&&this.userStorage){let i=await fa(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await Ja(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Jc()}else if(a&&!a.user&&!a.user){const i=await fa(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await Fn(this.storage,this.storageKey+"-user"),await Ja(this.storage,this.storageKey,a)):a.user=Jc()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Xc;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Xc}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),qc(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new On;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new uc;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new On;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Pe(s)){const i={session:null,error:s};return qc(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ja(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=wh(a);await Ja(this.storage,this.storageKey,s)}else{const a=wh(r);await Ja(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Fn(this.storage,this.storageKey),await Fn(this.storage,this.storageKey+"-code-verifier"),await Fn(this.storage,this.storageKey+"-user"),this.userStorage&&await Fn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&jr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ya);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Ya);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ya}ms, refresh threshold is ${cu} ticks`),a<=cu&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof pm)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!jr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Wa(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await je(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await je(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await je(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await je(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Yc(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+uw>a)return n;const{data:s,error:i}=await je(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:x,error:m}=await this.getSession();if(m||!x.session)return{data:null,error:m};n=x.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=Yc(n);r!=null&&r.allowExpired||Iw(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:s,header:a,signature:i},error:null}}const u=Dw(a.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,i,yw(`${o}.${l}`)))throw new du("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}}Gi.nextInstanceID=0;const Jw=Gi;class Qw extends Jw{constructor(t){super(t)}}var Zw=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class ek{constructor(t,r,n){var a,s,i;this.supabaseUrl=t,this.supabaseKey=r;const o=sw(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:qy,realtime:Jy,auth:Object.assign(Object.assign({},Yy),{storageKey:l}),global:Xy},u=aw(n??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=tw(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new xy(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Wy(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new K_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Zw(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:i,flowType:o,lock:l,debug:c},u,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qw({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:o,lock:l,debug:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Py(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const tk=(e,t,r)=>new ek(e,t,r);function rk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}rk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const nk="https://rqairbvsiwohklvsxyre.supabase.co",ak="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYWlyYnZzaXdvaGtsdnN4eXJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5Nzk2NTcsImV4cCI6MjA4MjU1NTY1N30.6Uyi42A_4Pqe1G40qnx4M8ST38XRgh9x8o7mCtiVr18",Se=tk(nk,ak),xm=xe.createContext(void 0);function sk({children:e}){const[t,r]=xe.useState(null),[n,a]=xe.useState(!0);xe.useEffect(()=>{s();const{data:c}=Se.auth.onAuthStateChange(()=>{(async()=>await s())()});return()=>{var u;(u=c==null?void 0:c.subscription)==null||u.unsubscribe()}},[]);const s=async()=>{try{const{data:{user:c}}=await Se.auth.getUser();if(c){const{data:u}=await Se.from("user_profiles").select("*").eq("id",c.id).maybeSingle();r(u)}else r(null)}catch(c){console.error("Error checking user:",c),r(null)}finally{a(!1)}},i=async(c,u)=>{const{error:f}=await Se.auth.signInWithPassword({email:c,password:u});if(f)throw f;await s()},o=async(c,u,f,d,x)=>{const{data:m,error:g}=await Se.auth.signUp({email:c,password:u});if(g)throw g;if(!m.user)throw new Error("User creation failed");const{error:y}=await Se.from("user_profiles").insert({id:m.user.id,email:c,full_name:f,role:d,client_id:x||null,is_active:!0});if(y)throw y;await s()},l=async()=>{const{error:c}=await Se.auth.signOut();if(c)throw c;r(null)};return h.jsx(xm.Provider,{value:{user:t,loading:n,signIn:i,signUp:o,signOut:l},children:e})}function ia(){const e=xe.useContext(xm);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ik={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Le=(e,t)=>{const r=xe.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},u)=>xe.createElement("svg",{ref:u,...ik,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${ok(e)}`,o].join(" "),...c},[...t.map(([f,d])=>xe.createElement(f,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mm=Le("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ch=Le("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lk=Le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=Le("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=Le("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=Le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=Le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=Le("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=Le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=Le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=Le("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=Le("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=Le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ah=Le("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=Le("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=Le("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=Le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=Le("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=Le("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=Le("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=Le("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=Le("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=Le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=Le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=Le("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=Le("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ck=Le("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=Le("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=Le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=Le("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=Le("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=Le("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cf=Le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nk=Le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=Le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=Le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=Le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Ok(){const{signIn:e}=ia(),[t,r]=xe.useState(""),[n,a]=xe.useState(""),[s,i]=xe.useState(!1),[o,l]=xe.useState(""),c=async u=>{u.preventDefault(),l(""),i(!0);try{await e(t,n)}catch(f){l(f instanceof Error?f.message:"Failed to sign in")}finally{i(!1)}};return h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center p-6",children:h.jsx("div",{className:"w-full max-w-md",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:h.jsx(bh,{className:"w-8 h-8 text-white"})}),h.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Facet Builder Pro"}),h.jsx("p",{className:"text-slate-600",children:"Sign in to your account"})]}),h.jsxs("form",{onSubmit:c,className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-2",children:"Email Address"}),h.jsx("input",{type:"email",id:"email",value:t,onChange:u=>r(u.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"you@company.com",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),h.jsx("input",{type:"password",id:"password",value:n,onChange:u=>a(u.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"",required:!0})]}),o&&h.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:o}),h.jsx("button",{type:"submit",disabled:s,className:"w-full py-3 px-6 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:s?h.jsxs(h.Fragment,{children:[h.jsx(co,{className:"w-5 h-5 animate-spin"}),"Signing In..."]}):h.jsxs(h.Fragment,{children:[h.jsx(bh,{className:"w-5 h-5"}),"Sign In"]})})]}),h.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-200 text-center text-sm text-slate-600",children:[h.jsx("p",{children:"Demo Credentials:"}),h.jsxs("p",{className:"mt-2 font-mono text-xs",children:["Admin: admin@demo.com / Admin@123",h.jsx("br",{}),"Client: client@demo.com / Client@123"]})]})]})})})}function Pk(){const{user:e}=ia(),[t,r]=xe.useState([]),[n,a]=xe.useState({}),[s,i]=xe.useState(""),[o,l]=xe.useState(null),[c,u]=xe.useState(!1),[f,d]=xe.useState(!1),[x,m]=xe.useState([]),[g,y]=xe.useState(!1);xe.useEffect(()=>{_()},[e]);const v=async C=>{if(C){l(C),u(!0),y(!0),m([]);try{const{data:E,error:w}=await Se.from("facet_generation_jobs").select("id").eq("project_name",C.project_name);if(w)throw w;const k=(E||[]).map(O=>O.id);if(k.length>0){const{data:O,error:j}=await Se.from("recommended_facets").select("*, categories (name)").in("job_id",k).order("sort_order");if(j)throw j;m(O||[])}}catch(E){console.error("Error loading project details:",E)}finally{y(!1)}}},_=async()=>{if(!e)return;const C=Se.from("facet_generation_jobs").select("*").order("created_at",{ascending:!1});e.role!=="super_admin"&&C.eq("client_id",e.client_id);const{data:E,error:w}=await C;if(w)return;const k=Array.from(new Set((E||[]).flatMap(O=>O.category_ids||[])));if(k.length>0){const{data:O}=await Se.from("categories").select("id,name").in("id",k),j={};O==null||O.forEach(L=>j[L.id]=L.name),a(j)}r(E||[])},p=async()=>{if(!(!s.trim()||!e)){d(!0);try{const{error:C}=await Se.from("facet_generation_jobs").insert({client_id:e.client_id||e.id,project_name:s,category_ids:[],status:"pending",created_by:e.id});if(C)throw C;i(""),await _()}catch(C){console.error("Error creating project:",C)}finally{d(!1)}}},S=async C=>{confirm("Are you sure you want to delete this project?")&&(await Se.from("facet_generation_jobs").delete().eq("id",C),await _())},P=C=>{switch(C){case"completed":return"bg-green-100 text-green-700";case"processing":return"bg-blue-100 text-blue-700";case"failed":return"bg-red-100 text-red-700";default:return"bg-yellow-100 text-yellow-700"}};return h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Project Management"}),h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[h.jsx("h3",{className:"font-semibold text-slate-900 mb-4",children:"Create New Project"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("input",{type:"text",value:s,onChange:C=>i(C.target.value),placeholder:"Enter project name",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),h.jsxs("button",{onClick:p,disabled:f||!s.trim(),className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[h.jsx(mk,{className:"w-5 h-5"}),"Create Project"]})]})]}),h.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Breadcrumbs"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Status"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Categories"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Progress"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Created"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Actions"})]})}),h.jsxs("tbody",{className:"divide-y divide-slate-200",children:[t.map(C=>h.jsxs("tr",{className:"hover:bg-slate-50",children:[h.jsx("div",{className:"flex flex-wrap items-center gap-1 px-6 py-4",children:C.category_ids&&C.category_ids.length>0?C.category_ids.map((E,w)=>h.jsxs("span",{className:"flex items-center text-[11px] text-slate-500",children:[h.jsx("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded border border-slate-200",children:n[E]||"Loading..."}),w<C.category_ids.length-1&&h.jsx("span",{className:"mx-1 text-slate-300",children:"/"})]},E)):h.jsx("span",{className:"text-xs text-slate-400 italic",children:"No categories linked!"})}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(C.status)}`,children:C.status})}),h.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:C.total_categories}),h.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[C.progress,"%"]}),h.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:new Date(C.created_at).toLocaleDateString()}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>v(C),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:h.jsx(dk,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>S(C.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:h.jsx(Cf,{className:"w-4 h-4"})})]})})]},C.id)),t.length===0&&h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-slate-500",children:"No projects yet. Create your first project to get started."})})]})]})}),c&&o&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col",children:[h.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between z-10",children:[h.jsxs("h3",{className:"text-xl font-semibold text-slate-900",children:["Project Details: ",o.project_name||"Untitled Project"]}),h.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-slate-100 rounded-full",children:h.jsx(Ns,{className:"w-5 h-5"})})]}),h.jsx("div",{className:"p-6 overflow-y-auto",children:g?h.jsx("div",{className:"text-center py-12",children:h.jsx("p",{className:"text-slate-500",children:"Loading project history..."})}):h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Status"}),h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(o.status)}`,children:o.status})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Created"}),h.jsx("p",{className:"text-slate-800",children:new Date(o.created_at).toLocaleDateString()})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Generated Facet History"}),x.length>0?h.jsx("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-slate-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-600",children:"Category"}),h.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-600",children:"Facet Name"}),h.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold text-slate-600",children:"Priority"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-200",children:x.map(C=>{var E;return h.jsxs("tr",{children:[h.jsx("td",{className:"px-4 py-2 text-sm text-slate-500",children:((E=C.categories)==null?void 0:E.name)||"N/A"}),h.jsx("td",{className:"px-4 py-2 text-sm font-medium text-slate-800",children:C.facet_name}),h.jsx("td",{className:"px-4 py-2 text-sm",children:h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${C.priority==="High"?"bg-red-100 text-red-700":C.priority==="Medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:C.priority})})]},C.id)})})]})}):h.jsx("div",{className:"text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:h.jsx("p",{className:"text-slate-500",children:"No facets have been generated for this project yet."})})]})]})}),h.jsx("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end",children:h.jsx("button",{onClick:()=>u(!1),className:"px-6 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300",children:"Close"})})]})})]})}const fs=["Industry Analysis","Geography","Business Rules","Customer Intent","Competitive Analysis","Use Case Scenarios","Seasonal & Trends","Master Prompt"],ym=xe.createContext(void 0);function Rk({children:e}){const[t,r]=xe.useState([]),n=xe.useCallback(i=>{r(o=>o.filter(l=>l.id!==i))},[]),a=xe.useCallback((i,o,l)=>{const c=Math.random().toString(36).substring(7);if(r([{id:c,message:i,type:o,options:l}]),o!=="confirm"){const f=(l==null?void 0:l.duration)||4e3;setTimeout(()=>{n(c)},f)}},[n]),s={success:(i,o)=>a(i,"success",o),error:(i,o)=>a(i,"error",o),info:(i,o)=>a(i,"info",o),warning:(i,o)=>a(i,"warning",o),confirm:(i,o,l)=>a(i,"confirm",{...l,onConfirm:o}),dismiss:n};return h.jsxs(ym.Provider,{value:{toast:s},children:[e,h.jsx(Ik,{toasts:t,dismiss:n})]})}function Ik({toasts:e,dismiss:t}){var i,o;if(e.length===0)return null;const r=e[0],a={success:{icon:Tf,border:"border-green-500/50",bg:"bg-slate-900/95",text:"text-green-400",glow:"shadow-green-500/20"},error:{icon:mm,border:"border-red-500/50",bg:"bg-slate-900/95",text:"text-red-400",glow:"shadow-red-500/20"},warning:{icon:Ch,border:"border-yellow-500/50",bg:"bg-slate-900/95",text:"text-yellow-400",glow:"shadow-yellow-500/20"},info:{icon:vk,border:"border-blue-500/50",bg:"bg-slate-900/95",text:"text-blue-400",glow:"shadow-blue-500/20"},confirm:{icon:Ch,border:"border-purple-500/50",bg:"bg-slate-900/95",text:"text-purple-400",glow:"shadow-purple-500/20"}}[r.type],s=a.icon;return h.jsxs("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-[100] flex flex-col items-center justify-center pointer-events-none",children:[h.jsxs("div",{className:`
          pointer-events-auto
          flex items-center gap-4 px-5 py-4 
          rounded-2xl border ${a.border} ${a.bg} backdrop-blur-md
          shadow-xl ${a.glow}
          animate-in slide-in-from-bottom-5 fade-in duration-300
          min-w-[320px] max-w-[90vw]
        `,children:[h.jsx("div",{className:`p-2 rounded-full bg-white/5 ${a.text}`,children:h.jsx(s,{className:"w-5 h-5"})}),h.jsx("div",{className:"flex-1",children:h.jsx("p",{className:"text-sm font-medium text-white",children:r.message})}),r.type==="confirm"?h.jsxs("div",{className:"flex gap-2 ml-2",children:[h.jsx("button",{onClick:()=>{var l;(l=r.options)!=null&&l.onCancel&&r.options.onCancel(),t(r.id)},className:"px-3 py-1.5 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/10 rounded-md transition-colors",children:((i=r.options)==null?void 0:i.cancelText)||"Cancel"}),h.jsx("button",{onClick:()=>{var l,c;(c=(l=r.options)==null?void 0:l.onConfirm)==null||c.call(l),t(r.id)},className:"px-3 py-1.5 text-xs font-bold text-slate-900 bg-white hover:bg-slate-200 rounded-md transition-colors shadow-lg shadow-white/10",children:((o=r.options)==null?void 0:o.confirmText)||"Confirm"})]}):h.jsx("button",{onClick:()=>t(r.id),className:"text-slate-500 hover:text-white transition-colors",children:h.jsx(Ns,{className:"w-4 h-4"})})]}),r.type!=="confirm"&&h.jsx("div",{className:"w-full h-1 mt-2 overflow-hidden rounded-full max-w-[300px]",children:h.jsx("div",{className:"h-full bg-white/20 animate-shrink-width",style:{animationDuration:"4s"}})})]})}function fc(){const e=xe.useContext(ym);if(e===void 0)throw new Error("useToast must be used within a ToastProvider");return e.toast}function Dk(){const e=fc(),{user:t}=ia(),[r,n]=xe.useState([]),[a,s]=xe.useState(null),[i,o]=xe.useState(!1),[l,c]=xe.useState(""),[u,f]=xe.useState(""),[d,x]=xe.useState(!1),[m,g]=xe.useState(!1),[y,v]=xe.useState({}),[_,p]=xe.useState(!1),[S,P]=xe.useState([]),[C,E]=xe.useState(!1),[w,k]=xe.useState(null);xe.useState({});const[O,j]=xe.useState(null),[L,Q]=xe.useState(Array(5).fill("")),[K,re]=xe.useState(!1),[fe,te]=xe.useState({name:"",template:"",level:1});xe.useEffect(()=>{M()},[t]);const ne=async z=>{if(z){s(z),p(!0),E(!0);try{const{data:A,error:ve}=await Se.from("prompt_versions").select("*").eq("prompt_template_id",z.id).order("version",{ascending:!1});if(ve)throw ve;P(A||[])}catch(A){console.error("Error loading prompt history:",A),j("Failed to load version history.")}finally{E(!1)}}},M=async()=>{if(!t)return;j(null);const z=Se.from("prompt_templates").select("*").eq("is_active",!0);t.role!=="admin"&&z.or(`client_id.eq.${t.client_id},client_id.is.null`);const{data:A,error:ve}=await z;if(ve)console.error("Error loading prompts:",ve),j(`Failed to load prompts: ${ve.message}`),n([]);else{const Y=(A||[]).sort((V,X)=>{const ue=fs.indexOf(V.name),ce=fs.indexOf(X.name);return(ue===-1?1/0:ue)-(ce===-1?1/0:ce)});n(Y)}},oe=z=>{!a||!t||e.confirm(`Restore v${z.version}? This creates a new version.`,async()=>{o(!0);try{const A=(a.current_version||0)+1,ve=z.metadata||a.metadata||{},{error:ye}=await Se.from("prompt_versions").insert({prompt_template_id:a.id,version:A,template_content:z.template_content,variables:z.variables,edited_by:t.id,metadata:ve,change_notes:`Restored from Version ${z.version}`,is_active:!0});if(ye)throw ye;await Se.from("prompt_versions").update({is_active:!1}).eq("prompt_template_id",a.id).neq("version",A);const{error:Y}=await Se.from("prompt_templates").update({template:z.template_content,current_version:A,metadata:ve,updated_at:new Date().toISOString()}).eq("id",a.id);if(Y)throw Y;e.success(`Restored successfully as v${A}`),p(!1),await M()}catch(A){console.error("Error restoring version",A),e.error(`Failed to restore ${A.message}`)}finally{o(!1)}},{confirmText:"Yes,Restore",cancelText:"Cancel"})},se=async(z,A)=>{if(!z){alert("There is no content to copy.");return}try{await navigator.clipboard.writeText(z),k(A),setTimeout(()=>{k(null)},2e3)}catch(ve){console.error("Failed to copy text:",ve),alert("Failed to copy content to clipboard.")}},F=async()=>{if(!fe.name.trim()||!fe.template.trim()){j("Prompt name and template content are required.");return}if(t){j(null),g(!0);try{const{error:z}=await Se.from("prompt_templates").insert({name:fe.name,template:fe.template,type:fe.type,level:fe.level,client_id:t.client_id,current_version:1});if(z)throw z;re(!1),te({name:"",template:"",level:1}),await M()}catch(z){console.error("Error creating prompt:",z),e.error("Prompt created successfully!"),j(`Failed to create prompt: ${z.message}`)}finally{g(!1)}}},U=a?(()=>{var z;if(l!==a.template)return!0;if(a.name==="Industry Analysis"){const A=((z=a.metadata)==null?void 0:z.industry_levels)||{};return JSON.stringify(y)!==JSON.stringify(A)}return!1})():!1,H=z=>{var A;if(j(null),s(z),c(z.template),f(""),x(!0),v({}),z.name==="Industry Analysis"){const ve=((A=z.metadata)==null?void 0:A.industry_levels)||{};v(ve)}Q(Array(5).fill(""))},B=()=>{const z=Object.keys(y).map(Number),A=z.length>0?Math.max(...z)+1:2;v(ve=>({...ve,[A]:""}))},Z=z=>{v(A=>{const ve={...A};return delete ve[z],ve})},de=(z,A)=>{v(ve=>({...ve,[z]:A}))},le=async()=>{if(!(!a||!t)){j(null),g(!0);try{const z=(a.current_version||1)+1;let A=l,ve={...a.metadata||{}};await Se.from("prompt_versions").insert({prompt_template_id:a.id,version:z,template_content:A,variables:a.variables,edited_by:t.id,change_notes:u,is_active:!0}),await Se.from("prompt_versions").update({is_active:!1}).eq("prompt_template_id",a.id).neq("version",z);const ye={template:l,current_version:z,updated_at:new Date().toISOString(),metadata:a.metadata||{}};if(a.name==="Industry Analysis"){const X=Object.fromEntries(Object.entries(y).filter(([ue,ce])=>ce.trim()!==""));ve.industry_levels=X}const{error:Y}=await Se.from("prompt_versions").insert({prompt_template_id:a.id,version:z,template_content:A,variables:a.variables,metadata:ve,edited_by:t.id,change_notes:u,is_active:!0});if(Y)throw Y;await Se.from("prompt_versions").update({is_active:!1}).eq("prompt_template_id",a.id).neq("version",z);const{error:V}=await Se.from("prompt_templates").update({template:A,current_version:z,updated_at:new Date().toISOString(),metadata:ve}).eq("id",a.id);if(V)throw V;e.success("New version saved successfully"),x(!1),s(null),await M()}catch(z){e.error(`Save failed: ${z.message}`),console.error("Error saving prompt version:",z),j(`Save failed: ${z.message}`)}finally{g(!1)}}},ie=async(z,A)=>{t&&(A?await Se.from("master_templates").delete().eq("prompt_template_id",z):await Se.from("master_templates").insert({client_id:t.client_id||t.id,prompt_template_id:z,level_start:2,level_end:10,is_master:!0}),await M())},ae=async z=>{const{data:A}=await Se.from("master_templates").select("id").eq("prompt_template_id",z).maybeSingle();return!!A};return h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Prompt Template Management"}),!d&&h.jsxs("button",{onClick:()=>re(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[h.jsx(Pl,{className:"w-5 h-5"}),"New Prompt"]})]}),d&&a?h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[h.jsxs("h3",{className:"font-semibold text-slate-900 mb-4",children:["Edit: ",a.name]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:a.name==="Industry Analysis"?"Level 1 Keywords":"Template Content"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{onClick:()=>se(l,"main-content"),className:"text-xs inline-flex items-center gap-1 text-slate-500 hover:text-slate-800",children:[h.jsx(Zc,{className:"w-3 h-3"})," Copy"]}),w==="main-content"&&h.jsx("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 bg-slate-800 text-white text-xs rounded py-1 px-2",children:"Copied!"})]}),h.jsx("textarea",{value:l,onChange:z=>c(z.target.value),rows:8,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]}),a.name==="Industry Analysis"&&h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Sub-Level Templates"}),h.jsxs("button",{onClick:B,className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-sm",children:[h.jsx(Pl,{className:"w-3 h-3"})," Add Level"]})]}),Object.keys(y).length===0&&h.jsx("p",{className:"text-sm text-slate-500 italic mb-4",children:'No sub-levels defined. Click "Add Level" to create additional processing levels.'}),h.jsx("div",{className:"space-y-6",children:Object.entries(y).map(([z,A])=>h.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 relative",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3",children:[h.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Level ",z]}),h.jsx("button",{onClick:()=>Z(Number(z)),className:"text-red-500 hover:text-red-700",title:"Remove this level",children:h.jsx(Ns,{className:"w-4 h-4"})})]}),h.jsxs("div",{className:"relative mb-1",children:[h.jsxs("button",{onClick:()=>se(A,`level-${z}`),className:"text-xs inline-flex items-center gap-1 text-slate-500 hover:text-slate-800",children:[h.jsx(Zc,{className:"w-3 h-3"})," Copy"]}),w===`level-${z}`&&h.jsx("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 bg-slate-800 text-white text-xs rounded py-1 px-2",children:"Copied!"})]}),h.jsx("textarea",{value:A,onChange:ve=>de(Number(z),ve.target.value),rows:8,placeholder:`Enter template for level ${z}...`,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]},z))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Change Notes"}),h.jsx("input",{type:"text",value:u,onChange:z=>f(z.target.value),placeholder:"Describe what you changed...",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),h.jsxs("div",{className:"flex gap-3",children:[U&&h.jsxs("button",{onClick:le,disabled:m,className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[h.jsx(Fh,{className:"w-4 h-4"}),m?"Saving...":"Save New Version"]}),h.jsx("button",{onClick:()=>{x(!1),j(null),s(null)},className:"px-6 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:U?"Cancel":"Close"})]})]}),O&&h.jsxs("div",{className:"bg-red-50 border border-red-200 text-sm text-red-700 px-4 py-3 rounded-lg mb-4",role:"alert",children:[h.jsx("strong",{className:"font-bold",children:"Error: "}),h.jsx("span",{children:O})]})]}):h.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Name"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Level"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Version"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Master Template"}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-200",children:r.map(z=>h.jsxs("tr",{className:"hover:bg-slate-50",children:[h.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:z.name}),h.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:["Level ",z.level]}),h.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:["v",z.current_version||1]}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("button",{onClick:async()=>{const A=await ae(z.id);ie(z.id,A)},className:"text-yellow-500 hover:text-yellow-600",children:h.jsx(Fk,{className:"w-5 h-5"})})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>H(z),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:h.jsx(Tk,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>ne(z),className:"p-1 text-slate-600 hover:bg-slate-50 rounded",children:h.jsx(gk,{className:"w-4 h-4"})})]})})]},z.id))})]})}),h.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[h.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Version Control"}),h.jsx("p",{className:"text-sm text-slate-600",children:"All prompt edits are automatically versioned. The system uses the latest version for facet generation. Mark prompts with Level 2-10 as master templates for comprehensive facet building."})]}),K&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full",children:[h.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:h.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"Create New Prompt Template"})}),h.jsxs("div",{className:"p-6 space-y-4",children:[O&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-sm text-red-700 px-4 py-3 rounded-lg",role:"alert",children:O}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Prompt Name"}),h.jsx("input",{type:"text",placeholder:"e.g., 'Technical Specifications'",value:fe.name,onChange:z=>te({...fe,name:z.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Template Content (Level 1)"}),h.jsx("textarea",{rows:8,placeholder:"Enter the main prompt content here...",value:fe.template,onChange:z=>te({...fe,template:z.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500"})]}),h.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Level"}),h.jsx("input",{type:"number",min:"1",value:fe.level,onChange:z=>te({...fe,level:parseInt(z.target.value,10)||1}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})})]}),h.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>{re(!1),j(null),te({name:"",template:"",level:1})},className:"px-6 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200",children:"Cancel"}),h.jsxs("button",{onClick:F,disabled:m,className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[h.jsx(Fh,{className:"w-4 h-4"}),m?"Creating...":"Create Prompt"]})]})]})}),_&&a&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[h.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between",children:[h.jsxs("h3",{className:"text-xl font-semibold text-slate-900",children:["Version History: ",a.name]}),h.jsx("button",{onClick:()=>p(!1),className:"p-2 hover:bg-slate-100 rounded-full",children:h.jsx(Ns,{className:"w-5 h-5"})})]}),h.jsx("div",{className:"p-6 overflow-y-auto",children:C?h.jsx("p",{className:"text-center text-slate-500",children:"Loading history..."}):h.jsxs("div",{className:"space-y-6",children:[S.map((z,A)=>{var ye,Y;const ve=A===0;return h.jsxs("div",{className:`border rounded-lg transition-all ${ve?"border-blue-300 ring-1 ring-blue-100":"border-slate-200"}`,children:[h.jsxs("div",{className:"bg-slate-50 p-3 flex justify-between items-center text-sm border-b rounded-t-lg",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("span",{className:"font-semibold text-slate-900",children:["Version ",z.version]}),ve?h.jsx("span",{className:"text-xs font-medium bg-green-100 text-green-700 px-2 py-0.5 rounded-full border border-green-200",children:"Current Active"}):h.jsx("span",{className:"text-xs text-slate-500",children:new Date(z.created_at).toLocaleDateString()})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"text-slate-500 hidden sm:block",children:[h.jsx("span",{className:"font-medium",children:"By:"})," ",((ye=z.users)==null?void 0:ye.email)||"Unknown"]}),!ve&&h.jsxs("button",{onClick:()=>oe(z),disabled:i,className:"flex items-center gap-1 text-xs font-medium bg-white border border-slate-300 text-slate-700 px-3 py-1.5 rounded hover:bg-slate-100 hover:text-blue-600 transition-colors shadow-sm",title:"Restore this version",children:[h.jsx(Ck,{className:"w-3 h-3"}),i?"Restoring...":"Restore"]})]})]}),h.jsxs("div",{className:"p-4 space-y-3 bg-white rounded-b-lg",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-slate-800 text-xs uppercase tracking-wider mb-1",children:"Change Notes"}),h.jsx("p",{className:"text-sm text-slate-600 italic",children:z.change_notes||"No notes provided."})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"font-semibold text-slate-800 text-xs uppercase tracking-wider mb-1 flex justify-between",children:[h.jsx("span",{children:"Template Content"}),h.jsxs("button",{onClick:()=>se(z.template_content,`v-${z.version}`),className:"text-blue-600 hover:text-blue-800 normal-case font-normal flex items-center gap-1",children:[h.jsx(Zc,{className:"w-3 h-3"})," Copy"]})]}),h.jsxs("div",{className:"relative",children:[h.jsx("pre",{className:"bg-slate-50 border border-slate-100 p-3 rounded-md text-xs font-mono whitespace-pre-wrap overflow-x-auto max-h-60",children:z.template_content}),((Y=z.metadata)==null?void 0:Y.industry_levels)&&Object.keys(z.metadata.industry_levels).length>0&&h.jsxs("div",{className:"mt-3 border-t border-slate-100 pt-3",children:[h.jsx("h4",{className:"font-semibold text-slate-800 text-xs uppercase tracking-wider mb-2",children:"Included Sub-Levels"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(z.metadata.industry_levels).map(V=>h.jsxs("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded border border-slate-200",children:["Level ",V]},V))})]}),w===`v-${z.version}`&&h.jsx("span",{className:"absolute top-2 right-2 bg-slate-800 text-white text-[10px] rounded py-0.5 px-1.5 opacity-90",children:"Copied"})]})]})]})]},z.id)}),S.length===0&&h.jsx("p",{className:"text-center text-slate-500",children:"No version history found."})]})}),h.jsx("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end",children:h.jsx("button",{onClick:()=>p(!1),className:"px-6 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300",children:"Close"})})]})})]})}function Lk({onComplete:e}){const t=fc(),{user:r}=ia(),[n,a]=xe.useState({input_taxonomy:"A. Input Taxonomy",end_category:"B. End Category (C3)",facet_name:"C. Filter Attributes",possible_values:"D. Possible Values",filling_percentage:"E. Filling Percentage (Approx.)",priority:"F. Priority (High / Medium / Low)",confidence_score:"G. Confidence Score (110)",num_sources:"H. # of available sources",source_urls:"I. List the sources URL"}),[s,i]=xe.useState([]),[o,l]=xe.useState([]),[c,u]=xe.useState(new Set),[f,d]=xe.useState(new Set),[x,m]=xe.useState(""),[g,y]=xe.useState(""),[v,_]=xe.useState(!1);xe.useState(!0);const[p,S]=xe.useState({1:"",2:"",3:"",4:"",5:"",6:""}),[P,C]=xe.useState(!1),[E,w]=xe.useState([]),[k,O]=xe.useState({}),[j,L]=xe.useState(null),[Q,K]=xe.useState(null),[re,fe]=xe.useState({}),[te,ne]=xe.useState(null),[M,oe]=xe.useState({});xe.useMemo(()=>{var V;const Y=o.find(X=>X.name==="Geography");if(Y&&Array.isArray((V=Y.metadata)==null?void 0:V.country_templates)){const X=Y.metadata.country_templates.map(ue=>ue.country);return X.length>1?X:[]}return[]},[o]),xe.useEffect(()=>{de()},[r]);const se=(Y,V)=>{oe(X=>{const ue={...X},ce=new Set(ue[Y]||[]);return ce.has(V)?ce.delete(V):ce.add(V),ue[Y]=ce,ue})},F=Y=>{if(Y===1)return Array.from(new Set(s.map(be=>be.category_path.split(">")[0].trim()))).sort().map(be=>({id:be,name:be}));const V=[];for(let Te=1;Te<Y;Te++)if(p[Te])V.push(p[Te]);else return[];const X=V.join(" > "),ue=s.filter(Te=>Te.category_path.startsWith(X+" >")||Te.category_path===X);return Array.from(new Set(ue.map(Te=>{var Ve;return(Ve=Te.category_path.split(">")[Y-1])==null?void 0:Ve.trim()}))).filter(Boolean).sort().map(Te=>({id:Te,name:Te}))},U=()=>{if(!p[1]||!p[2]){t.error("Please select at least Level 1 and Level 2!");return}const V=Object.values(p).filter(Boolean).join(" > ");let X=s.find(ue=>ue.category_path.trim()===V.trim());if(X||(X=s.find(ue=>ue.category_path.trim().startsWith(V.trim()))),X){le(X.id);const ue=c.has(X.id);t.success(ue?`Removed: ${V}`:`Added: ${V}`)}else t.error("No matching data found for this selection.")},H=(Y,V)=>{const X={...p,[Y]:V};for(let ue=Y+1;ue<=6;ue++)X[ue]="";S(X)};s.filter(Y=>{const V=Y.name.toLowerCase().includes(g.toLowerCase())||(Y.category_path||"").toLowerCase().includes(g.toLowerCase());return v?V&&c.has(Y.id):V});const B=(Y,V)=>{oe(X=>{const ue={...X},ce=ue[Y]||new Set,Te=V.map(be=>be.id);return ce.size===Te.length?ue[Y]=new Set:ue[Y]=new Set(Te),ue})},Z=Object.values(M).reduce((Y,V)=>Y+V.size,0),de=async()=>{if(!r)return;const Y=r.role==="super_admin"?{}:{client_id:r.client_id},[V,X]=await Promise.all([Se.from("categories").select("*").match(Y).order("category_path"),Se.from("prompt_templates").select("*").order("level").eq("is_active",!0).order("execution_order")]),ce=(X.data||[]).sort((Ve,Ce)=>{const De=fs.indexOf(Ve.name),qe=fs.indexOf(Ce.name);return(De===-1?1/0:De)-(qe===-1?1/0:qe)});i(V.data||[]),l(ce);const Te=["Industry Analysis","Master Prompt"],be=ce.filter(Ve=>Te.includes(Ve.name)).map(Ve=>Ve.id);d(new Set(be))},le=Y=>{const V=new Set(c);V.has(Y)?V.delete(Y):V.add(Y),u(V)},ie=Y=>{const V=new Set(f);V.has(Y)?(V.delete(Y),fe(X=>{const ue={...X};return delete ue[Y],ue})):V.add(Y),d(V)},ae=()=>{f.size===o.length?d(new Set):d(new Set(o.map(Y=>Y.id)))},z=async()=>{if(!r)return null;const Y=Array.from(c).sort().join(","),V=Array.from(f).sort().join(","),{data:X}=await Se.from("facet_generation_jobs").select("*").eq("client_id",r.client_id).eq("status","completed").order("created_at",{ascending:!1}).limit(20);return X?X.find(ce=>{const Te=(ce.category_ids||[]).sort().join(","),be=(ce.selected_prompts||[]).sort().join(",");return Te===Y&&be===V}):null},A=async Y=>{C(!0);try{t.info("Loading existing results.....");const{data:V}=await Se.from("recommended_facets").select("*").eq("job_id",Y).order("sort_order"),X=V||[];w(X),L(Y);const ue=X.reduce((ce,Te)=>{const be=Te.category_id;return ce[be]||(ce[be]=[]),ce[be].push(Te),ce},{});O(ue),t.success("Loaded existing results successfully!")}catch(V){console.error("Error loading existing:",V),t.error("Failed to load existing results.")}finally{C(!1)}},ve=async(Y=!1)=>{var X,ue;if(c.size===0)return;if(!Y){const ce=await z();if(ce){const Te=new Date(ce.created_at).toLocaleDateString();t.confirm(`Idenfical results found from ${Te}.Load them to save credits?`,()=>{A(ce.id)},{confirmText:"Load Existing (Free)",cancelText:"Generate New (Cost)",onCancel:()=>{ve(!0)}});return}}if(!r){K("You must be logged in to perform this action.");return}const V=r.client_id;if(!V){K("Your user profile is not associated with a client. Cannot create job."),C(!1);return}if(c.size!==0){C(!0),K(null);try{ne(null);for(const we of f){const Ke=o.find(Ie=>Ie.id===we)}const ce=o.filter(we=>f.has(we.id));ce.sort((we,Ke)=>{const Ie=we.name.trim(),St=Ke.name.trim();if(Ie==="Industry Analysis")return-1;if(St==="Industry Analysis"||Ie==="Master Prompt")return 1;if(St==="Master Prompt")return-1;const Rr=fs.indexOf(Ie),Sn=fs.indexOf(St);return(Rr===-1?999:Rr)-(Sn===-1?999:Sn)});const Te=ce.map(we=>{if(!we)return null;const Ie=Object.values(p).filter(Boolean).length,St=Array.from(c).map(Sn=>{const Cn=s.find(la=>la.id===Sn);if(!Cn)return null;const An=Cn.category_path.split(" > "),Ha=An.slice(0,Ie).join(" > ");return{...Cn,category_path:Ha,level:Ie,name:An[Ie-1]}}).filter(Boolean);let Rr;return we.name==="Industry Analysis"?Rr=we.template||"":Rr=we.template,{id:we.id,name:we.name,content:Rr,metadata:we.metadata,context_categories:St}}).filter(we=>we!==null),{data:be,error:Ve}=await Se.from("facet_generation_jobs").insert({client_id:V,project_name:x,category_ids:Array.from(c),selected_prompts:Array.from(f),status:"processing",total_categories:c.size,processed_categories:0,created_by:r.id}).select().maybeSingle();if(Ve||!be)throw Ve;L(be.id);const De=await fetch("https://rqairbvsiwohklvsxyre.supabase.co/functions/v1/generate-facets-ai",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYWlyYnZzaXdvaGtsdnN4eXJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5Nzk2NTcsImV4cCI6MjA4MjU1NTY1N30.6Uyi42A_4Pqe1G40qnx4M8ST38XRgh9x8o7mCtiVr18","Content-Type":"application/json"},body:JSON.stringify({job_id:be.id,category_ids:Array.from(c),prompts:Te})});if(!De.ok){const we=await De.text();throw new Error(`Generation failed with status ${De.status}: ${we}`)}const qe=await De.json();if(console.log(" API RESPONSE:",qe),qe.facets_generated===0){C(!1),K("The AI was unable to generate any facets for this selection. Please try again later!"),t.error("Generation Failed: 0 facets produced."),await Se.from("facet_generation_jobs").update({status:"failed"}).eq("id",be.id);return}const{data:We}=await Se.from("recommended_facets").select("*").eq("job_id",be.id).order("sort_order"),Ye=We||[];w(Ye);const{data:Ge}=await Se.from("facet_generation_jobs").select("metadata").eq("id",be.id).single();if((ue=(X=Ge==null?void 0:Ge.metadata)==null?void 0:X.output_format)!=null&&ue.columns){const we=Ge.metadata.output_format.columns;a({input_taxonomy:we[0]||"A. Input Taxonomy",end_category:we[1]||"B. End Category (C3)",facet_name:we[2]||"C. Filter Attributes",possible_values:we[3]||"D. Possible Values",filling_percentage:we[4]||"E. Filling Percentage (Approx.)",priority:we[5]||"F. Priority (High / Medium / Low)",confidence_score:we[6]||"G. Confidence Score (110)",num_sources:we[7]||"H. # of available sources",source_urls:we[8]||"I. List the sources URL"})}const Nt=new Map(s.map(we=>[we.id,we.name])),Fe=Ye.reduce((we,Ke)=>{const Ie=Ke.category_id;return we[Ie]||(we[Ie]=[]),we[Ie].push(Ke),we},{});O(Fe),await Se.from("facet_generation_jobs").update({status:"completed",progress:100,processed_categories:c.size,completed_at:new Date().toISOString()}).eq("id",be.id)}catch(ce){console.error("Error generating facets:",ce),K(`Failed to generate facets: ${ce.message}`),j&&await Se.from("facet_generation_jobs").update({status:"failed"}).eq("id",j)}finally{C(!1)}}},ye=async()=>{const Y=new Set(Object.values(M).flatMap(Ce=>Array.from(Ce)));if(Y.size===0){console.log("No facets selected for export.");return}const V=E.filter(Ce=>Y.has(Ce.id)),X=new Map(s.map(Ce=>[Ce.id,Ce.name])),ce=["Input Taxonomy,End Category (C3),Filter Attributes,Possible Values,Filling Percentage (Approx.),Priority (High / Medium / Low),Confidence Score (110),# of available sources,List the sources URL",...V.map(Ce=>{var la;const De=((la=s.find(mc=>mc.id===Ce.category_id))==null?void 0:la.category_path)||"N/A",qe=X.get(Ce.category_id)||"Unknown Category",We=Ce["Input Taxonomy"]||Ce["A. Input Taxonomy"]||De,Ye=Ce["End Category (C3)"]||Ce["B. End Category (C3)"]||qe,Ge=Ce.facet_name||Ce["Filter Attributes"]||Ce["C. Filter Attributes"]||"",Nt=Ce.possible_values||Ce["Possible Values"]||Ce["D. Possible Values"]||"",Fe=Ce.filling_percentage||Ce["Filling Percentage (Approx.)"]||Ce["E. Filling Percentage (Approx.)"]||0,we=Ce.priority||Ce["Priority (High / Medium / Low)"]||Ce["F. Priority (High / Medium / Low)"]||"Medium",Ke=Ce.confidence_score||Ce["Confidence Score (110)"]||Ce["G. Confidence Score (110)"]||5,Ie=Ce.num_sources||Ce["# of available sources"]||Ce["H. # of available sources"]||0,St=Ce.source_urls||Ce["List the sources URL"]||Ce["I. List the sources URL"]||"N/A",Rr=`"${String(We).replace(/"/g,'""')}"`,Sn=`"${String(Ye).replace(/"/g,'""')}"`,Cn=`"${String(Ge).replace(/"/g,'""')}"`,An=`"${String(Nt).replace(/"/g,'""')}"`,Ha=`"${String(St).replace(/"/g,'""')}"`;return[Rr,Sn,Cn,An,Fe,we,Ke,Ie,Ha].join(",")})].join(`
`),Te=new Blob([ce],{type:"text/csv"}),be=URL.createObjectURL(Te),Ve=document.createElement("a");Ve.href=be,Ve.download=`facets-${x||j}.csv`,Ve.click(),URL.revokeObjectURL(be),await Se.from("export_history").insert({job_id:j,client_id:r==null?void 0:r.client_id,category_ids:Array.from(c),format:"csv",exported_by:r==null?void 0:r.id})};if(E.length>0){const Y=new Map(s.map(V=>[V.id,V.name]));return h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Generated Facets"}),h.jsx("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"font-semibold text-slate-900",children:[E.length," facets generated"]}),h.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["For ",c.size," categories"]})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsxs("button",{disabled:Z===0,onClick:ye,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx(Sf,{className:"w-4 h-4"}),"Export"," ",Z>0?`(${Z})`:""]}),h.jsx("button",{onClick:e,className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:"Back to Dashboard"})]})]})}),h.jsx("div",{className:"space-y-8",children:Object.entries(k).map(([V,X])=>{var ue;return h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:[h.jsxs("div",{className:"bg-slate-50 px-6 py-4 border-b border-slate-200",children:[h.jsx("h4",{className:"text-lg font-semibold text-slate-900",children:Y.get(V)||"Unknown Category"}),h.jsxs("p",{className:"text-sm text-slate-600",children:[X.length," facets"]})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"border-b border-slate-200",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-3 w-12 text-left",children:h.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:(((ue=M[V])==null?void 0:ue.size)||0)===X.length&&X.length>0,onChange:()=>B(V,X)})}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.input_taxonomy}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.end_category}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.facet_name}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.possible_values}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.filling_percentage}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.priority}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.confidence_score}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.num_sources}),h.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:n.source_urls})]})}),h.jsx("tbody",{className:"divide-y divide-slate-200",children:X.map(ce=>{var Te;return h.jsxs("tr",{className:"hover:bg-slate-50",children:[h.jsx("td",{className:"px-4 py-4",children:h.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500",checked:(M[V]||new Set).has(ce.id),onChange:()=>se(V,ce.id)})}),h.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-xs truncate",children:ce["Input Taxonomy"]||ce["A. Input Taxonomy"]||((Te=s.find(be=>be.id===V))==null?void 0:Te.category_path)||"N/A"}),h.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:ce["End Category (C3)"]||ce["B. End Category (C3)"]||Y.get(V)||"N/A"}),h.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:ce.facet_name||ce["Filter Attributes"]||ce["C. Filter Attributes"]||"N/A"}),h.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-md truncate",children:ce.possible_values||ce["Possible Values"]||ce["D. Possible Values"]||"N/A"}),h.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[ce.filling_percentage||ce["Filling Percentage (Approx.)"]||ce["E. Filling Percentage (Approx.)"]||0,"%"]}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(ce.priority||ce["Priority (High / Medium / Low)"]||ce["F. Priority (High / Medium / Low)"])==="High"?"bg-red-100 text-red-700":(ce.priority||ce["Priority (High / Medium / Low)"]||ce["F. Priority (High / Medium / Low)"])==="Medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:ce.priority||ce["Priority (High / Medium / Low)"]||ce["F. Priority (High / Medium / Low)"]||"Medium"})}),h.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[ce.confidence_score||ce["Confidence Score (110)"]||ce["G. Confidence Score (110)"]||5,"/10"]}),h.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:ce.num_sources||ce["# of available sources"]||ce["H. # of available sources"]||0}),h.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-xs truncate",children:ce.source_urls||ce["List the sources URL"]||ce["I. List the sources URL"]||"N/A"})]},ce.id)})})]})})]},V)})})]})}return h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Generate Facets"}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 flex flex-col h-[500px]",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[h.jsx(xk,{className:"w-4 h-4 text-blue-600"})," Category Schema"]}),h.jsx("button",{onClick:()=>S({1:"",2:"",3:"",4:"",5:"",6:""}),className:"text-xs text-blue-600 hover:underline font-semibold",children:"Reset Filters"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[1,2,3].map(Y=>{const V=F(Y),X=Y>1&&!p[Y-1];return h.jsxs("div",{className:"space-y-1",children:[h.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:["Level ",Y]}),h.jsxs("select",{disabled:X,value:p[Y],onChange:ue=>H(Y,ue.target.value),className:`w-full p-2 text-sm border rounded-lg outline-none transition-all ${X?"bg-slate-50 border-slate-100 text-slate-300":"bg-white border-slate-200 focus:ring-2 focus:ring-blue-500"}`,children:[h.jsx("option",{value:"",children:"Select Category"}),V.map(ue=>h.jsx("option",{value:ue.id,children:ue.name},ue.id))]})]},Y)})}),Object.values(p).some(Y=>Y!=="")&&h.jsx("div",{className:"mt-2 p-4 bg-blue-50 rounded-xl border border-blue-100 animate-in fade-in slide-in-from-top-2",children:h.jsxs("div",{className:"flex items-center justify-between gap-4",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-[10px] font-bold text-blue-400 uppercase",children:"Current Selection"}),h.jsx("p",{className:"text-sm font-medium text-blue-900 truncate",children:(()=>{var X;const Y=Object.values(p).filter(Boolean),V=Y[Y.length-1];return(X=s.find(ue=>ue.id===V))==null?void 0:X.category_path})()})]}),h.jsx("button",{onClick:U,disabled:!p[1]||!p[2],className:`px-4 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${(()=>{const Y=Object.values(p).filter(Boolean).join(" > "),V=s.find(X=>X.category_path.startsWith(Y));return V&&c.has(V.id)})()?"bg-red-100 text-red-600 hover:bg-red-200":"bg-blue-600 text-white hover:bg-blue-700 shadow-md"}`,children:(()=>{const Y=Object.values(p).filter(Boolean).join(" > "),V=s.find(X=>X.category_path===Y);return V&&c.has(V.id)?"Remove from Job":"Add to Job"})()})]})}),h.jsxs("div",{className:"mt-auto pt-4 border-t border-slate-100 flex flex-col gap-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("div",{className:"flex flex-col",children:h.jsxs("span",{className:"text-xs font-bold text-slate-700 uppercase tracking-tighter",children:["Processing Queue (",c.size,")"]})}),c.size>0&&h.jsx("button",{onClick:()=>u(new Set),className:"text-[10px] text-red-500 font-bold hover:underline uppercase",children:"Clear Queue"})]}),h.jsx("div",{className:"max-h-[120px] overflow-y-auto space-y-1 pr-1 custom-scrollbar",children:c.size>0?Array.from(c).map(Y=>{const V=s.find(X=>X.id===Y);return h.jsxs("div",{className:"flex items-center justify-between bg-slate-50 border border-slate-200 px-2 py-1.5 rounded-md group hover:border-blue-300 transition-colors",children:[h.jsx("span",{className:"text-[13px] text-slate-600 truncate flex-1 pr-2 font-medium",children:(V==null?void 0:V.category_path)||"Unknown Category"}),h.jsx("button",{onClick:()=>le(Y),className:"text-slate-400 hover:text-red-500 transition-colors",title:"Remove from queue",children:h.jsx(Ns,{className:"w-3 h-3"})})]},Y)}):h.jsx("div",{className:"text-[12px] text-slate-400  py-2 text-center border border-dashed border-slate-200 rounded-md",children:"No categories added to the job yet."})})]})]}),h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("h3",{className:"font-semibold text-slate-900",children:["Select Prompts (",f.size,")"]}),h.jsx("button",{onClick:ae,className:"text-sm text-blue-600 hover:text-blue-700",children:f.size===o.length?"Deselect All":"Select All"})]}),te&&h.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-sm text-yellow-800 px-4 py-2 rounded-lg mb-4",role:"alert",children:te}),h.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:o.map(Y=>h.jsx("div",{className:"p-3 hover:bg-slate-50 rounded-lg transition-colors",children:h.jsxs("button",{onClick:()=>ie(Y.id),className:"w-full flex items-center gap-3 text-left",children:[f.has(Y.id)?h.jsx(ck,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}):h.jsx(bk,{className:"w-5 h-5 text-slate-400 flex-shrink-0"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"text-sm font-medium text-slate-900",children:Y.name}),h.jsxs("p",{className:"text-xs text-slate-500",children:["Level ",Y.level,"  ",Y.type]})]})]})},Y.id))})]})]}),Q&&h.jsxs("div",{className:"relative text-center bg-red-50 border border-red-200 text-sm text-red-700 px-10 py-3 rounded-lg mb-4 max-w-4xl mx-auto animate-in fade-in zoom-in duration-300",role:"alert",children:[h.jsx("strong",{className:"font-bold",children:"An error occurred: "}),h.jsx("span",{children:Q}),h.jsx("button",{onClick:()=>K(null),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 hover:bg-red-100 rounded-full transition-colors",title:"Dismiss",children:h.jsx(Ns,{className:"w-4 h-4 text-red-400"})})]}),h.jsx("div",{className:"flex justify-center",children:h.jsx("button",{onClick:()=>ve(!1),disabled:P||c.size===0,className:"inline-flex items-center gap-2 px-8 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:P?h.jsxs(h.Fragment,{children:[h.jsx(gm,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):h.jsxs(h.Fragment,{children:[h.jsx(Sk,{className:"w-5 h-5"}),"Generate Facets"]})})})]})}function jk(){const{user:e}=ia(),t=fc(),[r,n]=xe.useState("list"),[a,s]=xe.useState(null),[i,o]=xe.useState(""),[l,c]=xe.useState([]),[u,f]=xe.useState([]),[d,x]=xe.useState(""),[m,g]=xe.useState(""),[y,v]=xe.useState("client_user"),[_,p]=xe.useState(!1),[S,P]=xe.useState(!0);xe.useEffect(()=>{C()},[e]);const C=async()=>{e&&(e.role==="super_admin"?(await w(),n("list")):e.role==="client_admin"&&(n("details"),await E()),P(!1))},E=async()=>{if(!(e!=null&&e.client_id))return;const{data:K}=await Se.from("clients").select("*").eq("id",e.client_id).single();if(K){s(K);const{data:re}=await Se.from("user_profiles").select("*").eq("client_id",e.client_id);f(re||[])}},w=async()=>{const{data:K,error:re}=await Se.from("clients").select("*").order("created_at",{ascending:!1});re?t.error("Failed to load clients"):c(K||[])},k=async()=>{if(d.trim()){p(!0);try{const{error:K}=await Se.from("clients").insert({name:d.trim(),contact_email:i.trim()||null,is_active:!0,created_by:e==null?void 0:e.id});if(K)throw K.code==="23505"?new Error("Client or email already exists."):K;t.success("Client created successfully"),x(""),o(""),w()}catch(K){t.error(K.message)}finally{p(!1)}}},O=K=>{if(K.id===(e==null?void 0:e.id)){t.error("You cannot delete your own account.");return}if((e==null?void 0:e.role)==="client_admin"&&K.role!=="client_user"){t.error("You only have permission to delete regular users.");return}t.confirm(`Are you sure you want to remove ${K.email}?`,()=>j(K),{confirmText:"Delete User",cancelText:"Keep User"})},j=async K=>{p(!0);try{const{error:re}=await Se.from("user_profiles").delete().eq("id",K.id);if(re)throw re;t.success(`${K.email} has been removed.`);const fe=(e==null?void 0:e.role)==="client_admin"?e.client_id:a==null?void 0:a.id,{data:te}=await Se.from("user_profiles").select("*").eq("client_id",fe);f(te||[])}catch(re){t.error(re.message)}finally{p(!1)}},L=async K=>{s(K),n("details"),f([]);const{data:re,error:fe}=await Se.from("user_profiles").select("*").eq("client_id",K.id);fe?t.error("Failed to load users"):f(re||[])},Q=async()=>{const K=(e==null?void 0:e.role)==="client_admin"?e.client_id:a==null?void 0:a.id;if(!(!m.trim()||!K)){p(!0);try{const re=await fetch("https://rqairbvsiwohklvsxyre.supabase.co/functions/v1/invite-user",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYWlyYnZzaXdvaGtsdnN4eXJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5Nzk2NTcsImV4cCI6MjA4MjU1NTY1N30.6Uyi42A_4Pqe1G40qnx4M8ST38XRgh9x8o7mCtiVr18","Content-Type":"application/json"},body:JSON.stringify({email:m,role:y,client_id:K,full_name:m.split("@")[0]})}),fe=await re.json();if(!re.ok)throw new Error(fe.error);t.success(`Invitation sent to ${m}`),g("");const{data:te}=await Se.from("user_profiles").select("*").eq("client_id",K);f(te||[])}catch(re){t.error(`Invite failed: ${re.message}`)}finally{p(!1)}}};return S?h.jsx("div",{className:"p-8 text-center",children:h.jsx(co,{className:"animate-spin mx-auto"})}):(e==null?void 0:e.role)!=="super_admin"&&(e==null?void 0:e.role)!=="client_admin"?h.jsx("div",{className:"p-8 text-center text-slate-500",children:"Access Denied"}):r==="list"&&e.role==="super_admin"?h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Client Management"}),h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[h.jsx("h3",{className:"font-semibold text-slate-900 mb-4",children:"Add New Client"}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsx("input",{type:"text",value:d,onChange:K=>x(K.target.value),placeholder:"Company Name",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"}),h.jsx("input",{type:"email",value:i,onChange:K=>o(K.target.value),placeholder:"Contact Email",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"}),h.jsxs("button",{onClick:k,disabled:_||!d,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[h.jsx(Pl,{className:"w-5 h-5 inline mr-1"})," Create"]})]})]}),h.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-900 font-semibold",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3",children:"Company"}),h.jsx("th",{className:"px-6 py-3",children:"Status"}),h.jsx("th",{className:"px-6 py-3",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-200",children:l.map(K=>h.jsxs("tr",{className:"hover:bg-slate-50",children:[h.jsx("td",{className:"px-6 py-4 font-medium",children:K.name}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${K.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:K.is_active?"Active":"Inactive"})}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("button",{onClick:()=>L(K),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[h.jsx(_m,{className:"w-4 h-4"})," Manage"]})})]},K.id))})]})})]}):h.jsxs("div",{children:[e.role==="super_admin"&&h.jsxs("button",{onClick:()=>n("list"),className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 mb-6",children:[h.jsx(lk,{className:"w-4 h-4"})," Back to Clients"]}),h.jsx("div",{className:"flex items-center justify-between mb-6",children:h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:(a==null?void 0:a.name)||"Loading..."}),h.jsx("p",{className:"text-slate-500",children:"User Management"})]})}),h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[h.jsxs("h3",{className:"font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[h.jsx(Ek,{className:"w-4 h-4 text-blue-600"})," Invite New User"]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsx("input",{type:"email",value:m,onChange:K=>g(K.target.value),placeholder:"User Email Address",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"}),h.jsxs("select",{value:y,onChange:K=>v(K.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg bg-white",children:[h.jsx("option",{value:"client_user",children:"Regular User"}),e.role==="super_admin"&&h.jsx("option",{value:"client_admin",children:"Client Admin"})]}),h.jsx("button",{onClick:Q,disabled:_||!m,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Send Invite"})]})]}),h.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3",children:"User"}),h.jsx("th",{className:"px-6 py-3",children:"Role"}),h.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-200",children:u.map(K=>h.jsxs("tr",{className:"hover:bg-slate-50",children:[h.jsxs("td",{className:"px-6 py-4",children:[h.jsx("div",{className:"font-medium",children:K.email}),h.jsx("div",{className:"text-xs text-slate-500",children:K.full_name||"Invited"})]}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${K.role==="client_admin"?"bg-purple-100 text-purple-700":"bg-slate-100 text-slate-700"}`,children:[K.role==="client_admin"&&h.jsx(Ak,{className:"w-3 h-3"}),K.role==="client_admin"?"Admin":"User"]})}),h.jsx("td",{className:"px-6 py-4",children:K.last_sign_in_at?h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:[h.jsx(uk,{className:"w-3 h-3"})," Active"]}):h.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:"Pending Setup"})}),h.jsx("td",{className:"px-6 py-4 text-right",children:h.jsx("button",{onClick:()=>O(K),disabled:K.id===(e==null?void 0:e.id)||(e==null?void 0:e.role)==="client_admin"&&K.role!=="client_user",className:`p-1 rounded-md transition-colors ${K.id===(e==null?void 0:e.id)||(e==null?void 0:e.role)==="client_admin"&&K.role!=="client_user"?"text-slate-300 cursor-not-allowed":"text-red-600 hover:bg-red-50"}`,title:K.id===(e==null?void 0:e.id)?"You cannot delete yourself":"Delete User",children:h.jsx(Cf,{className:"w-4 h-4"})})})]},K.id))})]})})]})}var wm={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(gr,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,s=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(w){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(k){var O=P(k);O.chunkSize=parseInt(O.chunkSize),k.step||k.chunk||(O.chunkSize=null),this._handle=new g(O),(this._handle.streamer=this)._config=O}).call(this,w),this.parseChunk=function(k,O){var j=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<j){let Q=this._config.newline;Q||(L=this._config.quoteChar||'"',Q=this._handle.guessLineEndings(k,L)),k=[...k.split(Q).slice(j)].join(Q)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(L=this._config.beforeFirstChunk(k))!==void 0&&(k=L),this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+k,L=(this._partialLine="",this._handle.parse(j,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(k=L.meta.cursor,j=(this._finished||(this._partialLine=j.substring(k-this._baseIndex),this._baseIndex=k),L&&L.data&&(this._rowCount+=L.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)n.postMessage({results:L,workerId:c.WORKER_ID,finished:j});else if(E(this._config.chunk)&&!O){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=L=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!j||!E(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),j||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(k){E(this._config.error)?this._config.error(k):i&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:k,finished:!1})}}function f(w){var k;(w=w||{}).chunkSize||(w.chunkSize=c.RemoteChunkSize),u.call(this,w),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(O){this._input=O,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(k=new XMLHttpRequest,this._config.withCredentials&&(k.withCredentials=this._config.withCredentials),s||(k.onload=C(this._chunkLoaded,this),k.onerror=C(this._chunkError,this)),k.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var O,j=this._config.downloadRequestHeaders;for(O in j)k.setRequestHeader(O,j[O])}var L;this._config.chunkSize&&(L=this._start+this._config.chunkSize-1,k.setRequestHeader("Range","bytes="+this._start+"-"+L));try{k.send(this._config.downloadRequestBody)}catch(Q){this._chunkError(Q.message)}s&&k.status===0&&this._chunkError()}},this._chunkLoaded=function(){k.readyState===4&&(k.status<200||400<=k.status?this._chunkError():(this._start+=this._config.chunkSize||k.responseText.length,this._finished=!this._config.chunkSize||this._start>=(O=>(O=O.getResponseHeader("Content-Range"))!==null?parseInt(O.substring(O.lastIndexOf("/")+1)):-1)(k),this.parseChunk(k.responseText)))},this._chunkError=function(O){O=k.statusText||O,this._sendError(new Error(O))}}function d(w){(w=w||{}).chunkSize||(w.chunkSize=c.LocalChunkSize),u.call(this,w);var k,O,j=typeof FileReader<"u";this.stream=function(L){this._input=L,O=L.slice||L.webkitSlice||L.mozSlice,j?((k=new FileReader).onload=C(this._chunkLoaded,this),k.onerror=C(this._chunkError,this)):k=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var L=this._input,Q=(this._config.chunkSize&&(Q=Math.min(this._start+this._config.chunkSize,this._input.size),L=O.call(L,this._start,Q)),k.readAsText(L,this._config.encoding));j||this._chunkLoaded({target:{result:Q}})},this._chunkLoaded=function(L){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(L.target.result)},this._chunkError=function(){this._sendError(k.error)}}function x(w){var k;u.call(this,w=w||{}),this.stream=function(O){return k=O,this._nextChunk()},this._nextChunk=function(){var O,j;if(!this._finished)return O=this._config.chunkSize,k=O?(j=k.substring(0,O),k.substring(O)):(j=k,""),this._finished=!k,this.parseChunk(j)}}function m(w){u.call(this,w=w||{});var k=[],O=!0,j=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(L){this._input=L,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){j&&k.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),k.length?this.parseChunk(k.shift()):O=!0},this._streamData=C(function(L){try{k.push(typeof L=="string"?L:L.toString(this._config.encoding)),O&&(O=!1,this._checkIsFinished(),this.parseChunk(k.shift()))}catch(Q){this._streamError(Q)}},this),this._streamError=C(function(L){this._streamCleanUp(),this._sendError(L)},this),this._streamEnd=C(function(){this._streamCleanUp(),j=!0,this._streamData("")},this),this._streamCleanUp=C(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function g(w){var k,O,j,L,Q=Math.pow(2,53),K=-Q,re=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,fe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,te=this,ne=0,M=0,oe=!1,se=!1,F=[],U={data:[],errors:[],meta:{}};function H(le){return w.skipEmptyLines==="greedy"?le.join("").trim()==="":le.length===1&&le[0].length===0}function B(){if(U&&j&&(de("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),j=!1),w.skipEmptyLines&&(U.data=U.data.filter(function(A){return!H(A)})),Z()){let A=function(ve,ye){E(w.transformHeader)&&(ve=w.transformHeader(ve,ye)),F.push(ve)};var z=A;if(U)if(Array.isArray(U.data[0])){for(var le=0;Z()&&le<U.data.length;le++)U.data[le].forEach(A);U.data.splice(0,1)}else U.data.forEach(A)}function ie(A,ve){for(var ye=w.header?{}:[],Y=0;Y<A.length;Y++){var V=Y,X=A[Y],X=((ue,ce)=>(Te=>(w.dynamicTypingFunction&&w.dynamicTyping[Te]===void 0&&(w.dynamicTyping[Te]=w.dynamicTypingFunction(Te)),(w.dynamicTyping[Te]||w.dynamicTyping)===!0))(ue)?ce==="true"||ce==="TRUE"||ce!=="false"&&ce!=="FALSE"&&((Te=>{if(re.test(Te)&&(Te=parseFloat(Te),K<Te&&Te<Q))return 1})(ce)?parseFloat(ce):fe.test(ce)?new Date(ce):ce===""?null:ce):ce)(V=w.header?Y>=F.length?"__parsed_extra":F[Y]:V,X=w.transform?w.transform(X,V):X);V==="__parsed_extra"?(ye[V]=ye[V]||[],ye[V].push(X)):ye[V]=X}return w.header&&(Y>F.length?de("FieldMismatch","TooManyFields","Too many fields: expected "+F.length+" fields but parsed "+Y,M+ve):Y<F.length&&de("FieldMismatch","TooFewFields","Too few fields: expected "+F.length+" fields but parsed "+Y,M+ve)),ye}var ae;U&&(w.header||w.dynamicTyping||w.transform)&&(ae=1,!U.data.length||Array.isArray(U.data[0])?(U.data=U.data.map(ie),ae=U.data.length):U.data=ie(U.data,0),w.header&&U.meta&&(U.meta.fields=F),M+=ae)}function Z(){return w.header&&F.length===0}function de(le,ie,ae,z){le={type:le,code:ie,message:ae},z!==void 0&&(le.row=z),U.errors.push(le)}E(w.step)&&(L=w.step,w.step=function(le){U=le,Z()?B():(B(),U.data.length!==0&&(ne+=le.data.length,w.preview&&ne>w.preview?O.abort():(U.data=U.data[0],L(U,te))))}),this.parse=function(le,ie,ae){var z=w.quoteChar||'"',z=(w.newline||(w.newline=this.guessLineEndings(le,z)),j=!1,w.delimiter?E(w.delimiter)&&(w.delimiter=w.delimiter(le),U.meta.delimiter=w.delimiter):((z=((A,ve,ye,Y,V)=>{var X,ue,ce,Te;V=V||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var be=0;be<V.length;be++){for(var Ve,Ce=V[be],De=0,qe=0,We=0,Ye=(ce=void 0,new v({comments:Y,delimiter:Ce,newline:ve,preview:10}).parse(A)),Ge=0;Ge<Ye.data.length;Ge++)ye&&H(Ye.data[Ge])?We++:(Ve=Ye.data[Ge].length,qe+=Ve,ce===void 0?ce=Ve:0<Ve&&(De+=Math.abs(Ve-ce),ce=Ve));0<Ye.data.length&&(qe/=Ye.data.length-We),(ue===void 0||De<=ue)&&(Te===void 0||Te<qe)&&1.99<qe&&(ue=De,X=Ce,Te=qe)}return{successful:!!(w.delimiter=X),bestDelimiter:X}})(le,w.newline,w.skipEmptyLines,w.comments,w.delimitersToGuess)).successful?w.delimiter=z.bestDelimiter:(j=!0,w.delimiter=c.DefaultDelimiter),U.meta.delimiter=w.delimiter),P(w));return w.preview&&w.header&&z.preview++,k=le,O=new v(z),U=O.parse(k,ie,ae),B(),oe?{meta:{paused:!0}}:U||{meta:{paused:!1}}},this.paused=function(){return oe},this.pause=function(){oe=!0,O.abort(),k=E(w.chunk)?"":k.substring(O.getCharIndex())},this.resume=function(){te.streamer._halted?(oe=!1,te.streamer.parseChunk(k,!0)):setTimeout(te.resume,3)},this.aborted=function(){return se},this.abort=function(){se=!0,O.abort(),U.meta.aborted=!0,E(w.complete)&&w.complete(U),k=""},this.guessLineEndings=function(A,z){A=A.substring(0,1048576);var z=new RegExp(y(z)+"([^]*?)"+y(z),"gm"),ae=(A=A.replace(z,"")).split("\r"),z=A.split(`
`),A=1<z.length&&z[0].length<ae[0].length;if(ae.length===1||A)return`
`;for(var ve=0,ye=0;ye<ae.length;ye++)ae[ye][0]===`
`&&ve++;return ve>=ae.length/2?`\r
`:"\r"}}function y(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(w){var k=(w=w||{}).delimiter,O=w.newline,j=w.comments,L=w.step,Q=w.preview,K=w.fastMode,re=null,fe=!1,te=w.quoteChar==null?'"':w.quoteChar,ne=te;if(w.escapeChar!==void 0&&(ne=w.escapeChar),(typeof k!="string"||-1<c.BAD_DELIMITERS.indexOf(k))&&(k=","),j===k)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<c.BAD_DELIMITERS.indexOf(j))&&(j=!1),O!==`
`&&O!=="\r"&&O!==`\r
`&&(O=`
`);var M=0,oe=!1;this.parse=function(se,F,U){if(typeof se!="string")throw new Error("Input must be a string");var H=se.length,B=k.length,Z=O.length,de=j.length,le=E(L),ie=[],ae=[],z=[],A=M=0;if(!se)return De();if(K||K!==!1&&se.indexOf(te)===-1){for(var ve=se.split(O),ye=0;ye<ve.length;ye++){if(z=ve[ye],M+=z.length,ye!==ve.length-1)M+=O.length;else if(U)return De();if(!j||z.substring(0,de)!==j){if(le){if(ie=[],Te(z.split(k)),qe(),oe)return De()}else Te(z.split(k));if(Q&&Q<=ye)return ie=ie.slice(0,Q),De(!0)}}return De()}for(var Y=se.indexOf(k,M),V=se.indexOf(O,M),X=new RegExp(y(ne)+y(te),"g"),ue=se.indexOf(te,M);;)if(se[M]===te)for(ue=M,M++;;){if((ue=se.indexOf(te,ue+1))===-1)return U||ae.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ie.length,index:M}),Ve();if(ue===H-1)return Ve(se.substring(M,ue).replace(X,te));if(te===ne&&se[ue+1]===ne)ue++;else if(te===ne||ue===0||se[ue-1]!==ne){Y!==-1&&Y<ue+1&&(Y=se.indexOf(k,ue+1));var ce=be((V=V!==-1&&V<ue+1?se.indexOf(O,ue+1):V)===-1?Y:Math.min(Y,V));if(se.substr(ue+1+ce,B)===k){z.push(se.substring(M,ue).replace(X,te)),se[M=ue+1+ce+B]!==te&&(ue=se.indexOf(te,M)),Y=se.indexOf(k,M),V=se.indexOf(O,M);break}if(ce=be(V),se.substring(ue+1+ce,ue+1+ce+Z)===O){if(z.push(se.substring(M,ue).replace(X,te)),Ce(ue+1+ce+Z),Y=se.indexOf(k,M),ue=se.indexOf(te,M),le&&(qe(),oe))return De();if(Q&&ie.length>=Q)return De(!0);break}ae.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ie.length,index:M}),ue++}}else if(j&&z.length===0&&se.substring(M,M+de)===j){if(V===-1)return De();M=V+Z,V=se.indexOf(O,M),Y=se.indexOf(k,M)}else if(Y!==-1&&(Y<V||V===-1))z.push(se.substring(M,Y)),M=Y+B,Y=se.indexOf(k,M);else{if(V===-1)break;if(z.push(se.substring(M,V)),Ce(V+Z),le&&(qe(),oe))return De();if(Q&&ie.length>=Q)return De(!0)}return Ve();function Te(We){ie.push(We),A=M}function be(We){var Ye=0;return Ye=We!==-1&&(We=se.substring(ue+1,We))&&We.trim()===""?We.length:Ye}function Ve(We){return U||(We===void 0&&(We=se.substring(M)),z.push(We),M=H,Te(z),le&&qe()),De()}function Ce(We){M=We,Te(z),z=[],V=se.indexOf(O,M)}function De(We){if(w.header&&!F&&ie.length&&!fe){var Ye=ie[0],Ge=Object.create(null),Nt=new Set(Ye);let Fe=!1;for(let we=0;we<Ye.length;we++){let Ke=Ye[we];if(Ge[Ke=E(w.transformHeader)?w.transformHeader(Ke,we):Ke]){let Ie,St=Ge[Ke];for(;Ie=Ke+"_"+St,St++,Nt.has(Ie););Nt.add(Ie),Ye[we]=Ie,Ge[Ke]++,Fe=!0,(re=re===null?{}:re)[Ie]=Ke}else Ge[Ke]=1,Ye[we]=Ke;Nt.add(Ke)}Fe&&console.warn("Duplicate headers found and renamed."),fe=!0}return{data:ie,errors:ae,meta:{delimiter:k,linebreak:O,aborted:oe,truncated:!!We,cursor:A+(F||0),renamedHeaders:re}}}function qe(){L(De()),ie=[],ae=[]}},this.abort=function(){oe=!0},this.getCharIndex=function(){return M}}function _(w){var k=w.data,O=o[k.workerId],j=!1;if(k.error)O.userError(k.error,k.file);else if(k.results&&k.results.data){var L={abort:function(){j=!0,p(k.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:S,resume:S};if(E(O.userStep)){for(var Q=0;Q<k.results.data.length&&(O.userStep({data:k.results.data[Q],errors:k.results.errors,meta:k.results.meta},L),!j);Q++);delete k.results}else E(O.userChunk)&&(O.userChunk(k.results,L,k.file),delete k.results)}k.finished&&!j&&p(k.workerId,k.results)}function p(w,k){var O=o[w];E(O.userComplete)&&O.userComplete(k),O.terminate(),delete o[w]}function S(){throw new Error("Not implemented.")}function P(w){if(typeof w!="object"||w===null)return w;var k,O=Array.isArray(w)?[]:{};for(k in w)O[k]=P(w[k]);return O}function C(w,k){return function(){w.apply(k,arguments)}}function E(w){return typeof w=="function"}return c.parse=function(w,k){var O=(k=k||{}).dynamicTyping||!1;if(E(O)&&(k.dynamicTypingFunction=O,O={}),k.dynamicTyping=O,k.transform=!!E(k.transform)&&k.transform,!k.worker||!c.WORKERS_SUPPORTED)return O=null,c.NODE_STREAM_INPUT,typeof w=="string"?(w=(j=>j.charCodeAt(0)!==65279?j:j.slice(1))(w),O=new(k.download?f:x)(k)):w.readable===!0&&E(w.read)&&E(w.on)?O=new m(k):(n.File&&w instanceof File||w instanceof Object)&&(O=new d(k)),O.stream(w);(O=(()=>{var j;return!!c.WORKERS_SUPPORTED&&(j=(()=>{var L=n.URL||n.webkitURL||null,Q=r.toString();return c.BLOB_URL||(c.BLOB_URL=L.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Q,")();"],{type:"text/javascript"})))})(),(j=new n.Worker(j)).onmessage=_,j.id=l++,o[j.id]=j)})()).userStep=k.step,O.userChunk=k.chunk,O.userComplete=k.complete,O.userError=k.error,k.step=E(k.step),k.chunk=E(k.chunk),k.complete=E(k.complete),k.error=E(k.error),delete k.worker,O.postMessage({input:w,config:k,workerId:O.id})},c.unparse=function(w,k){var O=!1,j=!0,L=",",Q=`\r
`,K='"',re=K+K,fe=!1,te=null,ne=!1,M=((()=>{if(typeof k=="object"){if(typeof k.delimiter!="string"||c.BAD_DELIMITERS.filter(function(F){return k.delimiter.indexOf(F)!==-1}).length||(L=k.delimiter),typeof k.quotes!="boolean"&&typeof k.quotes!="function"&&!Array.isArray(k.quotes)||(O=k.quotes),typeof k.skipEmptyLines!="boolean"&&typeof k.skipEmptyLines!="string"||(fe=k.skipEmptyLines),typeof k.newline=="string"&&(Q=k.newline),typeof k.quoteChar=="string"&&(K=k.quoteChar),typeof k.header=="boolean"&&(j=k.header),Array.isArray(k.columns)){if(k.columns.length===0)throw new Error("Option columns is empty");te=k.columns}k.escapeChar!==void 0&&(re=k.escapeChar+K),k.escapeFormulae instanceof RegExp?ne=k.escapeFormulae:typeof k.escapeFormulae=="boolean"&&k.escapeFormulae&&(ne=/^[=+\-@\t\r].*$/)}})(),new RegExp(y(K),"g"));if(typeof w=="string"&&(w=JSON.parse(w)),Array.isArray(w)){if(!w.length||Array.isArray(w[0]))return oe(null,w,fe);if(typeof w[0]=="object")return oe(te||Object.keys(w[0]),w,fe)}else if(typeof w=="object")return typeof w.data=="string"&&(w.data=JSON.parse(w.data)),Array.isArray(w.data)&&(w.fields||(w.fields=w.meta&&w.meta.fields||te),w.fields||(w.fields=Array.isArray(w.data[0])?w.fields:typeof w.data[0]=="object"?Object.keys(w.data[0]):[]),Array.isArray(w.data[0])||typeof w.data[0]=="object"||(w.data=[w.data])),oe(w.fields||[],w.data||[],fe);throw new Error("Unable to serialize unrecognized input");function oe(F,U,H){var B="",Z=(typeof F=="string"&&(F=JSON.parse(F)),typeof U=="string"&&(U=JSON.parse(U)),Array.isArray(F)&&0<F.length),de=!Array.isArray(U[0]);if(Z&&j){for(var le=0;le<F.length;le++)0<le&&(B+=L),B+=se(F[le],le);0<U.length&&(B+=Q)}for(var ie=0;ie<U.length;ie++){var ae=(Z?F:U[ie]).length,z=!1,A=Z?Object.keys(U[ie]).length===0:U[ie].length===0;if(H&&!Z&&(z=H==="greedy"?U[ie].join("").trim()==="":U[ie].length===1&&U[ie][0].length===0),H==="greedy"&&Z){for(var ve=[],ye=0;ye<ae;ye++){var Y=de?F[ye]:ye;ve.push(U[ie][Y])}z=ve.join("").trim()===""}if(!z){for(var V=0;V<ae;V++){0<V&&!A&&(B+=L);var X=Z&&de?F[V]:V;B+=se(U[ie][X],V)}ie<U.length-1&&(!H||0<ae&&!A)&&(B+=Q)}}return B}function se(F,U){var H,B;return F==null?"":F.constructor===Date?JSON.stringify(F).slice(1,25):(B=!1,ne&&typeof F=="string"&&ne.test(F)&&(F="'"+F,B=!0),H=F.toString().replace(M,re),(B=B||O===!0||typeof O=="function"&&O(F,U)||Array.isArray(O)&&O[U]||((Z,de)=>{for(var le=0;le<de.length;le++)if(-1<Z.indexOf(de[le]))return!0;return!1})(H,c.BAD_DELIMITERS)||-1<H.indexOf(L)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?K+H+K:H)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!s&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=v,c.ParserHandle=g,c.NetworkStreamer=f,c.FileStreamer=d,c.StringStreamer=x,c.ReadableStreamStreamer=m,n.jQuery&&((a=n.jQuery).fn.parse=function(w){var k=w.config||{},O=[];return this.each(function(Q){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var K=0;K<this.files.length;K++)O.push({file:this.files[K],inputElem:this,instanceConfig:a.extend({},k)})}),j(),this;function j(){if(O.length===0)E(w.complete)&&w.complete();else{var Q,K,re,fe,te=O[0];if(E(w.before)){var ne=w.before(te.file,te.inputElem);if(typeof ne=="object"){if(ne.action==="abort")return Q="AbortError",K=te.file,re=te.inputElem,fe=ne.reason,void(E(w.error)&&w.error({name:Q},K,re,fe));if(ne.action==="skip")return void L();typeof ne.config=="object"&&(te.instanceConfig=a.extend(te.instanceConfig,ne.config))}else if(ne==="skip")return void L()}var M=te.instanceConfig.complete;te.instanceConfig.complete=function(oe){E(M)&&M(oe,te.file,te.inputElem),L()},c.parse(te.file,te.instanceConfig)}}function L(){O.splice(0,1),j()}}),i&&(n.onmessage=function(w){w=w.data,c.WORKER_ID===void 0&&w&&(c.WORKER_ID=w.workerId),typeof w.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(w.input,w.config),finished:!0}):(n.File&&w.input instanceof File||w.input instanceof Object)&&(w=c.parse(w.input,w.config))&&n.postMessage({workerId:c.WORKER_ID,results:w,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(d.prototype=Object.create(u.prototype)).constructor=d,(x.prototype=Object.create(x.prototype)).constructor=x,(m.prototype=Object.create(u.prototype)).constructor=m,c})})(wm);var Mk=wm.exports;const Bk=pv(Mk);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var km=1252,Uk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Af={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bf=function(e){Uk.indexOf(e)!=-1&&(km=Af[0]=e)};function $k(){bf(1252)}var zr=function(e){bf(e)};function Em(){zr(1200),$k()}function Nh(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Hk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Tm(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ai=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Hk(e.slice(2)):t==254&&r==255?Tm(e.slice(2)):t==65279?e.slice(1):e},Bo=function(t){return String.fromCharCode(t)},Oh=function(t){return String.fromCharCode(t)},jn,$n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ph(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=$n.charAt(s)+$n.charAt(i)+$n.charAt(o)+$n.charAt(l);return t}function _r(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=$n.indexOf(e.charAt(c++)),i=$n.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=$n.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=$n.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Be=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),La=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ea(e){return Be?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Rh(e){return Be?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return Be?La(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ja(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ff(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ff(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Mn=Be?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:La(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zk(e){for(var t=[],r=0,n=e.length+250,a=ea(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ea(65535),n=65530)}return t.push(a.slice(0,r)),Mn(t)}var tr=/\u0000/g,si=/[\u0001-\u0006]/g;function _s(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Vr(e,t){var r=""+e;return r.length>=t?r:ut("0",t-r.length)+r}function Nf(e,t){var r=""+e;return r.length>=t?r:ut(" ",t-r.length)+r}function Rl(e,t){var r=""+e;return r.length>=t?r:r+ut(" ",t-r.length)}function Vk(e,t){var r=""+Math.round(e);return r.length>=t?r:ut("0",t-r.length)+r}function Wk(e,t){var r=""+e;return r.length>=t?r:ut("0",t-r.length)+r}var Ih=Math.pow(2,32);function qa(e,t){if(e>Ih||e<-Ih)return Vk(e,t);var r=Math.round(e);return Wk(r,t)}function Il(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Dh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],e0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Gk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Re={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Lh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Kk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dl(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*i+s,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function ya(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Zk(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Sm=new Date(1899,11,31,0,0,0),Xk=Sm.getTime(),qk=new Date(1900,2,1,0,0,0);function Cm(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=qk&&(r+=24*60*60*1e3),(r-(Xk+(e.getTimezoneOffset()-Sm.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Of(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Yk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Jk(e){var t=e<0?12:11,r=Of(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Qk(e){var t=Of(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ki(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Jk(e):t===10?r=e.toFixed(10).substr(0,12):r=Qk(e),Of(Yk(r.toUpperCase()))}function Na(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ki(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Or(14,Cm(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Zk(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function eE(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return e0[r.m-1][1];case 5:return e0[r.m-1][0];default:return e0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Dh[r.q][0];default:return Dh[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Vr(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Vr(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Vr(l,c):"";return u}function Hn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Am=/%/g;function tE(e,t,r){var n=t.replace(Am,""),a=t.length-n.length;return mn(e,n,r*Math.pow(10,2*a))+ut("%",a)}function rE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return mn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function bm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+bm(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Fm=/# (\?+)( ?)\/( ?)(\d+)/;function nE(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?ut(" ",e[1].length+1+e[4].length):Nf(i,e[1].length)+e[2]+"/"+e[3]+Vr(o,e[4].length))}function aE(e,t,r){return r+(t===0?"":""+t)+ut(" ",e[1].length+2+e[4].length)}var Nm=/^#*0*\.([0#]+)/,Om=/\).*[0#]/,Pm=/\(###\) ###\\?-####/;function Jt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function jh(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Mh(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function sE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function iE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Er(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Om)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Er("n",n,r):"("+Er("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return rE(e,t,r);if(t.indexOf("%")!==-1)return tE(e,t,r);if(t.indexOf("E")!==-1)return bm(t,r);if(t.charCodeAt(0)===36)return"$"+Er(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+qa(l,t.length);if(t.match(/^[#?]+$/))return a=qa(r,0),a==="0"&&(a=""),a.length>t.length?a:Jt(t.substr(0,t.length-a.length))+a;if(s=t.match(Fm))return nE(s,l,c);if(t.match(/^#+0+$/))return c+qa(l,t.length-t.indexOf("0"));if(s=t.match(Nm))return a=jh(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Jt(s[1])).replace(/\.$/,"."+Jt(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+ut("0",Jt(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+jh(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Hn(qa(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Er(e,t,-r):Hn(""+(Math.floor(r)+sE(r,s[1].length)))+"."+Vr(Mh(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Er(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(Er(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<a.length?a.charAt(i++):m==="0"?"0":""}));if(t.match(Pm))return a=Er(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Dl(l,Math.pow(10,i)-1,!1),a=""+c,u=mn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Rl(o[2],i),u.length<s[4].length&&(u=Jt(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Dl(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Nf(o[1],i)+s[2]+"/"+s[3]+Rl(o[2],i):ut(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=qa(r,0),t.length<=a.length?a:Jt(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,d=t.length-a.length-f;return Jt(t.substr(0,f)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Mh(r,s[1].length),r<0?"-"+Er(e,t,-r):Hn(iE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Vr(0,3-m.length):"")+m})+"."+Vr(i,s[1].length);switch(t){case"###,##0.00":return Er(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Hn(qa(l,0));return x!=="0"?c+x:"";case"###,###.00":return Er(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Er(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function oE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return mn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function lE(e,t,r){var n=t.replace(Am,""),a=t.length-n.length;return mn(e,n,r*Math.pow(10,2*a))+ut("%",a)}function Rm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Rm(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Om)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",n,r):"("+Jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return oE(e,t,r);if(t.indexOf("%")!==-1)return lE(e,t,r);if(t.indexOf("E")!==-1)return Rm(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Vr(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Jt(t.substr(0,t.length-a.length))+a;if(s=t.match(Fm))return aE(s,l,c);if(t.match(/^#+0+$/))return c+Vr(l,t.length-t.indexOf("0"));if(s=t.match(Nm))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Jt(s[1])).replace(/\.$/,"."+Jt(s[1])),a=a.replace(/\.(\d*)$/,function(m,g){return"."+g+ut("0",Jt(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Hn(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Hn(""+r)+"."+ut("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_s(Jr(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<a.length?a.charAt(i++):m==="0"?"0":""}));if(t.match(Pm))return a=Jr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Dl(l,Math.pow(10,i)-1,!1),a=""+c,u=mn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Rl(o[2],i),u.length<s[4].length&&(u=Jt(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Dl(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Nf(o[1],i)+s[2]+"/"+s[3]+Rl(o[2],i):ut(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Jt(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,d=t.length-a.length-f;return Jt(t.substr(0,f)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Hn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Vr(0,3-m.length):"")+m})+"."+Vr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Hn(""+l);return x!=="0"?c+x:"";default:if(t.match(/\.[0#?]*$/))return Jr(e,t.slice(0,t.lastIndexOf(".")),r)+Jt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function mn(e,t,r){return(r|0)===r?Jr(e,t,r):Er(e,t,r)}function cE(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Im=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ms(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Il(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Im))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function uE(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,u,f,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Il(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var x=e.charAt(++i),m=x==="("||x===")"?x:"t";a[a.length]={t:m,v:x},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ya(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ya(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=ya(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",i+=5,d="h"):(g.t="t",++i),c==null&&g.t==="T")return"";a[a.length]=g,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Im)){if(c==null&&(c=ya(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ms(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var y=0,v=0,_;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=d,l="h",y<1&&(y=1);break;case"s":(_=a[i].v.match(/\.0+$/))&&(v=Math.max(v,_[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[i].v.match(/[Hh]/)&&(y=1),y<2&&a[i].v.match(/[Mm]/)&&(y=2),y<3&&a[i].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var p="",S;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=eE(a[i].t.charCodeAt(0),a[i].v,c,v),a[i].t="t";break;case"n":case"?":for(S=i+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[i].v+=a[S].v,a[S]={v:"",t:";"},++S;p+=a[i].v,i=S-1;break;case"G":a[i].t="t",a[i].v=Na(t,r);break}var P="",C,E;if(p.length>0){p.charCodeAt(0)==40?(C=t<0&&p.charCodeAt(0)===45?-t:t,E=mn("n",p,C)):(C=t<0&&n>1?-t:t,E=mn("n",p,C),C<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),S=E.length-1;var w=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){w=i;break}var k=a.length;if(w===a.length&&E.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(S>=a[i].v.length-1?(S-=a[i].v.length,a[i].v=E.substr(S+1,a[i].v.length)):S<0?a[i].v="":(a[i].v=E.substr(0,S+1),S=-1),a[i].t="t",k=i);S>=0&&k<a.length&&(a[k].v=E.substr(0,S+1)+a[k].v)}else if(w!==a.length&&E.indexOf("E")===-1){for(S=E.indexOf(".")-1,i=w;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===w?a[i].v.indexOf(".")-1:a[i].v.length-1,P=a[i].v.substr(u+1);u>=0;--u)S>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(P=E.charAt(S--)+P);a[i].v=P,a[i].t="t",k=i}for(S>=0&&k<a.length&&(a[k].v=E.substr(0,S+1)+a[k].v),S=E.indexOf(".")+1,i=w;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==w)){for(u=a[i].v.indexOf(".")>-1&&i===w?a[i].v.indexOf(".")+1:0,P=a[i].v.substr(0,u);u<a[i].v.length;++u)S<E.length&&(P+=E.charAt(S++));a[i].v=P,a[i].t="t",k=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(C=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=mn(a[i].t,a[i].v,C),a[i].t="t");var O="";for(i=0;i!==a.length;++i)a[i]!=null&&(O+=a[i].v);return O}var Bh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uh(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function fE(e,t){var r=cE(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Bh),o=r[1].match(Bh);return Uh(t,i)?[n,r[0]]:Uh(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function Or(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Re)[e],n==null&&(n=r.table&&r.table[Lh[e]]||Re[Lh[e]]),n==null&&(n=Kk[e]||"General");break}if(Il(n,0))return Na(t,r);t instanceof Date&&(t=Cm(t,r.date1904));var a=fE(n,t);if(Il(a[1]))return Na(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return uE(a[1],t,r,a[0])}function Ea(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Re[r]==null){t<0&&(t=r);continue}if(Re[r]==e){t=r;break}}t<0&&(t=391)}return Re[t]=e,t}function Dm(){Re=Gk()}var dE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Lm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function hE(e){var t=typeof e=="number"?Re[e]:e;return t=t.replace(Lm,"(\\d+)"),new RegExp("^"+t+"$")}function pE(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(Lm)||[]).forEach(function(f,d){var x=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":i=x;break;case"s":l=x;break;case"m":i>=0?o=x:a=x;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var xE=function(){var e={};e.version="1.2.0";function t(){for(var E=0,w=new Array(256),k=0;k!=256;++k)E=k,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,w[k]=E;return typeof Int32Array<"u"?new Int32Array(w):w}var r=t();function n(E){var w=0,k=0,O=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)j[O]=E[O];for(O=0;O!=256;++O)for(k=E[O],w=256+O;w<4096;w+=256)k=j[w]=k>>>8^E[k&255];var L=[];for(O=1;O!=16;++O)L[O-1]=typeof Int32Array<"u"?j.subarray(O*256,O*256+256):j.slice(O*256,O*256+256);return L}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],d=a[7],x=a[8],m=a[9],g=a[10],y=a[11],v=a[12],_=a[13],p=a[14];function S(E,w){for(var k=w^-1,O=0,j=E.length;O<j;)k=k>>>8^r[(k^E.charCodeAt(O++))&255];return~k}function P(E,w){for(var k=w^-1,O=E.length-15,j=0;j<O;)k=p[E[j++]^k&255]^_[E[j++]^k>>8&255]^v[E[j++]^k>>16&255]^y[E[j++]^k>>>24]^g[E[j++]]^m[E[j++]]^x[E[j++]]^d[E[j++]]^f[E[j++]]^u[E[j++]]^c[E[j++]]^l[E[j++]]^o[E[j++]]^i[E[j++]]^s[E[j++]]^r[E[j++]];for(O+=15;j<O;)k=k>>>8^r[(k^E[j++])&255];return~k}function C(E,w){for(var k=w^-1,O=0,j=E.length,L=0,Q=0;O<j;)L=E.charCodeAt(O++),L<128?k=k>>>8^r[(k^L)&255]:L<2048?(k=k>>>8^r[(k^(192|L>>6&31))&255],k=k>>>8^r[(k^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,Q=E.charCodeAt(O++)&1023,k=k>>>8^r[(k^(240|L>>8&7))&255],k=k>>>8^r[(k^(128|L>>2&63))&255],k=k>>>8^r[(k^(128|Q>>6&15|(L&3)<<4))&255],k=k>>>8^r[(k^(128|Q&63))&255]):(k=k>>>8^r[(k^(224|L>>12&15))&255],k=k>>>8^r[(k^(128|L>>6&63))&255],k=k>>>8^r[(k^(128|L&63))&255]);return~k}return e.table=r,e.bstr=S,e.buf=P,e.str=C,e}(),Ue=function(){var t={};t.version="1.2.1";function r(T,R){for(var b=T.split("/"),N=R.split("/"),I=0,D=0,G=Math.min(b.length,N.length);I<G;++I){if(D=b[I].length-N[I].length)return D;if(b[I]!=N[I])return b[I]<N[I]?-1:1}return b.length-N.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var R=T.lastIndexOf("/");return R===-1?T:T.slice(0,R+1)}function a(T){if(T.charAt(T.length-1)=="/")return a(T.slice(0,-1));var R=T.lastIndexOf("/");return R===-1?T:T.slice(R+1)}function s(T,R){typeof R=="string"&&(R=new Date(R));var b=R.getHours();b=b<<6|R.getMinutes(),b=b<<5|R.getSeconds()>>>1,T.write_shift(2,b);var N=R.getFullYear()-1980;N=N<<4|R.getMonth()+1,N=N<<5|R.getDate(),T.write_shift(2,N)}function i(T){var R=T.read_shift(2)&65535,b=T.read_shift(2)&65535,N=new Date,I=b&31;b>>>=5;var D=b&15;b>>>=4,N.setMilliseconds(0),N.setFullYear(b+1980),N.setMonth(D-1),N.setDate(I);var G=R&31;R>>>=5;var ee=R&63;return R>>>=6,N.setHours(R),N.setMinutes(ee),N.setSeconds(G<<1),N}function o(T){Pt(T,0);for(var R={},b=0;T.l<=T.length-4;){var N=T.read_shift(2),I=T.read_shift(2),D=T.l+I,G={};switch(N){case 21589:b=T.read_shift(1),b&1&&(G.mtime=T.read_shift(4)),I>5&&(b&2&&(G.atime=T.read_shift(4)),b&4&&(G.ctime=T.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}T.l=D,R[N]=G}return R}var l;function c(){return l||(l={})}function u(T,R){if(T[0]==80&&T[1]==75)return la(T,R);if((T[0]|32)==109&&(T[1]|32)==105)return lv(T,R);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var b=3,N=512,I=0,D=0,G=0,ee=0,W=0,q=[],J=T.slice(0,512);Pt(J,0);var he=f(J);switch(b=he[0],b){case 3:N=512;break;case 4:N=4096;break;case 0:if(he[1]==0)return la(T,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+b)}N!==512&&(J=T.slice(0,N),Pt(J,28));var ge=T.slice(0,N);d(J,b);var ke=J.read_shift(4,"i");if(b===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);J.l+=4,G=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ee=J.read_shift(4,"i"),I=J.read_shift(4,"i"),W=J.read_shift(4,"i"),D=J.read_shift(4,"i");for(var me=-1,_e=0;_e<109&&(me=J.read_shift(4,"i"),!(me<0));++_e)q[_e]=me;var Oe=x(T,N);y(W,D,Oe,N,q);var at=_(Oe,G,q,N);at[G].name="!Directory",I>0&&ee!==Q&&(at[ee].name="!MiniFAT"),at[q[0]].name="!FAT",at.fat_addrs=q,at.ssz=N;var st={},jt=[],$s=[],Hs=[];p(G,at,Oe,jt,I,st,$s,ee),m($s,Hs,jt),jt.shift();var zs={FileIndex:$s,FullPaths:Hs};return R&&R.raw&&(zs.raw={header:ge,sectors:Oe}),zs}function f(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(K,"Header Signature: "),T.l+=16;var R=T.read_shift(2,"u");return[T.read_shift(2,"u"),R]}function d(T,R){var b=9;switch(T.l+=2,b=T.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+b);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+b);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+b)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function x(T,R){for(var b=Math.ceil(T.length/R)-1,N=[],I=1;I<b;++I)N[I-1]=T.slice(I*R,(I+1)*R);return N[b-1]=T.slice(b*R),N}function m(T,R,b){for(var N=0,I=0,D=0,G=0,ee=0,W=b.length,q=[],J=[];N<W;++N)q[N]=J[N]=N,R[N]=b[N];for(;ee<J.length;++ee)N=J[ee],I=T[N].L,D=T[N].R,G=T[N].C,q[N]===N&&(I!==-1&&q[I]!==I&&(q[N]=q[I]),D!==-1&&q[D]!==D&&(q[N]=q[D])),G!==-1&&(q[G]=N),I!==-1&&N!=q[N]&&(q[I]=q[N],J.lastIndexOf(I)<ee&&J.push(I)),D!==-1&&N!=q[N]&&(q[D]=q[N],J.lastIndexOf(D)<ee&&J.push(D));for(N=1;N<W;++N)q[N]===N&&(D!==-1&&q[D]!==D?q[N]=q[D]:I!==-1&&q[I]!==I&&(q[N]=q[I]));for(N=1;N<W;++N)if(T[N].type!==0){if(ee=N,ee!=q[ee])do ee=q[ee],R[N]=R[ee]+"/"+R[N];while(ee!==0&&q[ee]!==-1&&ee!=q[ee]);q[N]=-1}for(R[0]+="/",N=1;N<W;++N)T[N].type!==2&&(R[N]+="/")}function g(T,R,b){for(var N=T.start,I=T.size,D=[],G=N;b&&I>0&&G>=0;)D.push(R.slice(G*L,G*L+L)),I-=L,G=ma(b,G*4);return D.length===0?yt(0):Mn(D).slice(0,T.size)}function y(T,R,b,N,I){var D=Q;if(T===Q){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var G=b[T],ee=(N>>>2)-1;if(!G)return;for(var W=0;W<ee&&(D=ma(G,W*4))!==Q;++W)I.push(D);y(ma(G,N-4),R-1,b,N,I)}}function v(T,R,b,N,I){var D=[],G=[];I||(I=[]);var ee=N-1,W=0,q=0;for(W=R;W>=0;){I[W]=!0,D[D.length]=W,G.push(T[W]);var J=b[Math.floor(W*4/N)];if(q=W*4&ee,N<4+q)throw new Error("FAT boundary crossed: "+W+" 4 "+N);if(!T[J])break;W=ma(T[J],q)}return{nodes:D,data:Yh([G])}}function _(T,R,b,N){var I=T.length,D=[],G=[],ee=[],W=[],q=N-1,J=0,he=0,ge=0,ke=0;for(J=0;J<I;++J)if(ee=[],ge=J+R,ge>=I&&(ge-=I),!G[ge]){W=[];var me=[];for(he=ge;he>=0;){me[he]=!0,G[he]=!0,ee[ee.length]=he,W.push(T[he]);var _e=b[Math.floor(he*4/N)];if(ke=he*4&q,N<4+ke)throw new Error("FAT boundary crossed: "+he+" 4 "+N);if(!T[_e]||(he=ma(T[_e],ke),me[he]))break}D[ge]={nodes:ee,data:Yh([W])}}return D}function p(T,R,b,N,I,D,G,ee){for(var W=0,q=N.length?2:0,J=R[T].data,he=0,ge=0,ke;he<J.length;he+=128){var me=J.slice(he,he+128);Pt(me,64),ge=me.read_shift(2),ke=Lf(me,0,ge-q),N.push(ke);var _e={name:ke,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Oe=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Oe!==0&&(_e.ct=S(me,me.l-8));var at=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);at!==0&&(_e.mt=S(me,me.l-8)),_e.start=me.read_shift(4,"i"),_e.size=me.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=Q,_e.name=""),_e.type===5?(W=_e.start,I>0&&W!==Q&&(R[W].name="!StreamData")):_e.size>=4096?(_e.storage="fat",R[_e.start]===void 0&&(R[_e.start]=v(b,_e.start,R.fat_addrs,R.ssz)),R[_e.start].name=_e.name,_e.content=R[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:W!==Q&&_e.start!==Q&&R[W]&&(_e.content=g(_e,R[W].data,(R[ee]||{}).data))),_e.content&&Pt(_e.content,0),D[ke]=_e,G.push(_e)}}function S(T,R){return new Date((hr(T,R+4)/1e7*Math.pow(2,32)+hr(T,R)/1e7-11644473600)*1e3)}function P(T,R){return c(),u(l.readFileSync(T),R)}function C(T,R){var b=R&&R.type;switch(b||Be&&Buffer.isBuffer(T)&&(b="buffer"),b||"base64"){case"file":return P(T,R);case"base64":return u(Hr(_r(T)),R);case"binary":return u(Hr(T),R)}return u(T,R)}function E(T,R){var b=R||{},N=b.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=N+"/",T.FileIndex[0]={name:N,type:5}),b.CLSID&&(T.FileIndex[0].clsid=b.CLSID),w(T)}function w(T){var R="Sh33tJ5";if(!Ue.find(T,"/"+R)){var b=yt(4);b[0]=55,b[1]=b[3]=50,b[2]=54,T.FileIndex.push({name:R,type:2,content:b,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+R),k(T)}}function k(T,R){E(T);for(var b=!1,N=!1,I=T.FullPaths.length-1;I>=0;--I){var D=T.FileIndex[I];switch(D.type){case 0:N?b=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(D.R*D.L*D.C)&&(b=!0),D.R>-1&&D.L>-1&&D.R==D.L&&(b=!0);break;default:b=!0;break}}if(!(!b&&!R)){var G=new Date(1987,1,19),ee=0,W=Object.create?Object.create(null):{},q=[];for(I=0;I<T.FullPaths.length;++I)W[T.FullPaths[I]]=!0,T.FileIndex[I].type!==0&&q.push([T.FullPaths[I],T.FileIndex[I]]);for(I=0;I<q.length;++I){var J=n(q[I][0]);N=W[J],N||(q.push([J,{name:a(J).replace("/",""),type:1,clsid:fe,ct:G,mt:G,content:null}]),W[J]=!0)}for(q.sort(function(ke,me){return r(ke[0],me[0])}),T.FullPaths=[],T.FileIndex=[],I=0;I<q.length;++I)T.FullPaths[I]=q[I][0],T.FileIndex[I]=q[I][1];for(I=0;I<q.length;++I){var he=T.FileIndex[I],ge=T.FullPaths[I];if(he.name=a(ge).replace("/",""),he.L=he.R=he.C=-(he.color=1),he.size=he.content?he.content.length:0,he.start=0,he.clsid=he.clsid||fe,I===0)he.C=q.length>1?1:-1,he.size=0,he.type=5;else if(ge.slice(-1)=="/"){for(ee=I+1;ee<q.length&&n(T.FullPaths[ee])!=ge;++ee);for(he.C=ee>=q.length?-1:ee,ee=I+1;ee<q.length&&n(T.FullPaths[ee])!=n(ge);++ee);he.R=ee>=q.length?-1:ee,he.type=1}else n(T.FullPaths[I+1]||"")==n(ge)&&(he.R=I+1),he.type=2}}}function O(T,R){var b=R||{};if(b.fileType=="mad")return cv(T,b);switch(k(T),b.fileType){case"zip":return rv(T,b)}var N=function(ke){for(var me=0,_e=0,Oe=0;Oe<ke.FileIndex.length;++Oe){var at=ke.FileIndex[Oe];if(at.content){var st=at.content.length;st>0&&(st<4096?me+=st+63>>6:_e+=st+511>>9)}}for(var jt=ke.FullPaths.length+3>>2,$s=me+7>>3,Hs=me+127>>7,zs=$s+_e+jt+Hs,ca=zs+127>>7,vc=ca<=109?0:Math.ceil((ca-109)/127);zs+ca+vc+127>>7>ca;)vc=++ca<=109?0:Math.ceil((ca-109)/127);var on=[1,vc,ca,Hs,jt,_e,me,0];return ke.FileIndex[0].size=me<<6,on[7]=(ke.FileIndex[0].start=on[0]+on[1]+on[2]+on[3]+on[4]+on[5])+(on[6]+7>>3),on}(T),I=yt(N[7]<<9),D=0,G=0;{for(D=0;D<8;++D)I.write_shift(1,re[D]);for(D=0;D<8;++D)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),D=0;D<3;++D)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,N[2]),I.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:Q),I.write_shift(4,N[3]),I.write_shift(-4,N[1]?N[0]-1:Q),I.write_shift(4,N[1]),D=0;D<109;++D)I.write_shift(-4,D<N[2]?N[1]+D:-1)}if(N[1])for(G=0;G<N[1];++G){for(;D<236+G*127;++D)I.write_shift(-4,D<N[2]?N[1]+D:-1);I.write_shift(-4,G===N[1]-1?Q:G+1)}var ee=function(ke){for(G+=ke;D<G-1;++D)I.write_shift(-4,D+1);ke&&(++D,I.write_shift(-4,Q))};for(G=D=0,G+=N[1];D<G;++D)I.write_shift(-4,te.DIFSECT);for(G+=N[2];D<G;++D)I.write_shift(-4,te.FATSECT);ee(N[3]),ee(N[4]);for(var W=0,q=0,J=T.FileIndex[0];W<T.FileIndex.length;++W)J=T.FileIndex[W],J.content&&(q=J.content.length,!(q<4096)&&(J.start=G,ee(q+511>>9)));for(ee(N[6]+7>>3);I.l&511;)I.write_shift(-4,te.ENDOFCHAIN);for(G=D=0,W=0;W<T.FileIndex.length;++W)J=T.FileIndex[W],J.content&&(q=J.content.length,!(!q||q>=4096)&&(J.start=G,ee(q+63>>6)));for(;I.l&511;)I.write_shift(-4,te.ENDOFCHAIN);for(D=0;D<N[4]<<2;++D){var he=T.FullPaths[D];if(!he||he.length===0){for(W=0;W<17;++W)I.write_shift(4,0);for(W=0;W<3;++W)I.write_shift(4,-1);for(W=0;W<12;++W)I.write_shift(4,0);continue}J=T.FileIndex[D],D===0&&(J.start=J.size?J.start-1:Q);var ge=D===0&&b.root||J.name;if(q=2*(ge.length+1),I.write_shift(64,ge,"utf16le"),I.write_shift(2,q),I.write_shift(1,J.type),I.write_shift(1,J.color),I.write_shift(-4,J.L),I.write_shift(-4,J.R),I.write_shift(-4,J.C),J.clsid)I.write_shift(16,J.clsid,"hex");else for(W=0;W<4;++W)I.write_shift(4,0);I.write_shift(4,J.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,J.start),I.write_shift(4,J.size),I.write_shift(4,0)}for(D=1;D<T.FileIndex.length;++D)if(J=T.FileIndex[D],J.size>=4096)if(I.l=J.start+1<<9,Be&&Buffer.isBuffer(J.content))J.content.copy(I,I.l,0,J.size),I.l+=J.size+511&-512;else{for(W=0;W<J.size;++W)I.write_shift(1,J.content[W]);for(;W&511;++W)I.write_shift(1,0)}for(D=1;D<T.FileIndex.length;++D)if(J=T.FileIndex[D],J.size>0&&J.size<4096)if(Be&&Buffer.isBuffer(J.content))J.content.copy(I,I.l,0,J.size),I.l+=J.size+63&-64;else{for(W=0;W<J.size;++W)I.write_shift(1,J.content[W]);for(;W&63;++W)I.write_shift(1,0)}if(Be)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function j(T,R){var b=T.FullPaths.map(function(W){return W.toUpperCase()}),N=b.map(function(W){var q=W.split("/");return q[q.length-(W.slice(-1)=="/"?2:1)]}),I=!1;R.charCodeAt(0)===47?(I=!0,R=b[0].slice(0,-1)+R):I=R.indexOf("/")!==-1;var D=R.toUpperCase(),G=I===!0?b.indexOf(D):N.indexOf(D);if(G!==-1)return T.FileIndex[G];var ee=!D.match(si);for(D=D.replace(tr,""),ee&&(D=D.replace(si,"!")),G=0;G<b.length;++G)if((ee?b[G].replace(si,"!"):b[G]).replace(tr,"")==D||(ee?N[G].replace(si,"!"):N[G]).replace(tr,"")==D)return T.FileIndex[G];return null}var L=64,Q=-2,K="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(T,R,b){c();var N=O(T,b);l.writeFileSync(R,N)}function M(T){for(var R=new Array(T.length),b=0;b<T.length;++b)R[b]=String.fromCharCode(T[b]);return R.join("")}function oe(T,R){var b=O(T,R);switch(R&&R.type||"buffer"){case"file":return c(),l.writeFileSync(R.filename,b),b;case"binary":return typeof b=="string"?b:M(b);case"base64":return Ph(typeof b=="string"?b:M(b));case"buffer":if(Be)return Buffer.isBuffer(b)?b:La(b);case"array":return typeof b=="string"?Hr(b):b}return b}var se;function F(T){try{var R=T.InflateRaw,b=new R;if(b._processChunk(new Uint8Array([3,0]),b._finishFlushFlag),b.bytesRead)se=T;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function U(T,R){if(!se)return An(T,R);var b=se.InflateRaw,N=new b,I=N._processChunk(T.slice(T.l),N._finishFlushFlag);return T.l+=N.bytesRead,I}function H(T){return se?se.deflateRawSync(T):Fe(T)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(T){var R=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(R>>16|R>>8|R)&255}for(var ie=typeof Uint8Array<"u",ae=ie?new Uint8Array(256):[],z=0;z<256;++z)ae[z]=le(z);function A(T,R){var b=ae[T&255];return R<=8?b>>>8-R:(b=b<<8|ae[T>>8&255],R<=16?b>>>16-R:(b=b<<8|ae[T>>16&255],b>>>24-R))}function ve(T,R){var b=R&7,N=R>>>3;return(T[N]|(b<=6?0:T[N+1]<<8))>>>b&3}function ye(T,R){var b=R&7,N=R>>>3;return(T[N]|(b<=5?0:T[N+1]<<8))>>>b&7}function Y(T,R){var b=R&7,N=R>>>3;return(T[N]|(b<=4?0:T[N+1]<<8))>>>b&15}function V(T,R){var b=R&7,N=R>>>3;return(T[N]|(b<=3?0:T[N+1]<<8))>>>b&31}function X(T,R){var b=R&7,N=R>>>3;return(T[N]|(b<=1?0:T[N+1]<<8))>>>b&127}function ue(T,R,b){var N=R&7,I=R>>>3,D=(1<<b)-1,G=T[I]>>>N;return b<8-N||(G|=T[I+1]<<8-N,b<16-N)||(G|=T[I+2]<<16-N,b<24-N)||(G|=T[I+3]<<24-N),G&D}function ce(T,R,b){var N=R&7,I=R>>>3;return N<=5?T[I]|=(b&7)<<N:(T[I]|=b<<N&255,T[I+1]=(b&7)>>8-N),R+3}function Te(T,R,b){var N=R&7,I=R>>>3;return b=(b&1)<<N,T[I]|=b,R+1}function be(T,R,b){var N=R&7,I=R>>>3;return b<<=N,T[I]|=b&255,b>>>=8,T[I+1]=b,R+8}function Ve(T,R,b){var N=R&7,I=R>>>3;return b<<=N,T[I]|=b&255,b>>>=8,T[I+1]=b&255,T[I+2]=b>>>8,R+16}function Ce(T,R){var b=T.length,N=2*b>R?2*b:R+5,I=0;if(b>=R)return T;if(Be){var D=Rh(N);if(T.copy)T.copy(D);else for(;I<T.length;++I)D[I]=T[I];return D}else if(ie){var G=new Uint8Array(N);if(G.set)G.set(T);else for(;I<b;++I)G[I]=T[I];return G}return T.length=N,T}function De(T){for(var R=new Array(T),b=0;b<T;++b)R[b]=0;return R}function qe(T,R,b){var N=1,I=0,D=0,G=0,ee=0,W=T.length,q=ie?new Uint16Array(32):De(32);for(D=0;D<32;++D)q[D]=0;for(D=W;D<b;++D)T[D]=0;W=T.length;var J=ie?new Uint16Array(W):De(W);for(D=0;D<W;++D)q[I=T[D]]++,N<I&&(N=I),J[D]=0;for(q[0]=0,D=1;D<=N;++D)q[D+16]=ee=ee+q[D-1]<<1;for(D=0;D<W;++D)ee=T[D],ee!=0&&(J[D]=q[ee+16]++);var he=0;for(D=0;D<W;++D)if(he=T[D],he!=0)for(ee=A(J[D],N)>>N-he,G=(1<<N+4-he)-1;G>=0;--G)R[ee|G<<he]=he&15|D<<4;return N}var We=ie?new Uint16Array(512):De(512),Ye=ie?new Uint16Array(32):De(32);if(!ie){for(var Ge=0;Ge<512;++Ge)We[Ge]=0;for(Ge=0;Ge<32;++Ge)Ye[Ge]=0}(function(){for(var T=[],R=0;R<32;R++)T.push(5);qe(T,Ye,32);var b=[];for(R=0;R<=143;R++)b.push(8);for(;R<=255;R++)b.push(9);for(;R<=279;R++)b.push(7);for(;R<=287;R++)b.push(8);qe(b,We,288)})();var Nt=function(){for(var R=ie?new Uint8Array(32768):[],b=0,N=0;b<de.length-1;++b)for(;N<de[b+1];++N)R[N]=b;for(;N<32768;++N)R[N]=29;var I=ie?new Uint8Array(259):[];for(b=0,N=0;b<Z.length-1;++b)for(;N<Z[b+1];++N)I[N]=b;function D(ee,W){for(var q=0;q<ee.length;){var J=Math.min(65535,ee.length-q),he=q+J==ee.length;for(W.write_shift(1,+he),W.write_shift(2,J),W.write_shift(2,~J&65535);J-- >0;)W[W.l++]=ee[q++]}return W.l}function G(ee,W){for(var q=0,J=0,he=ie?new Uint16Array(32768):[];J<ee.length;){var ge=Math.min(65535,ee.length-J);if(ge<10){for(q=ce(W,q,+(J+ge==ee.length)),q&7&&(q+=8-(q&7)),W.l=q/8|0,W.write_shift(2,ge),W.write_shift(2,~ge&65535);ge-- >0;)W[W.l++]=ee[J++];q=W.l*8;continue}q=ce(W,q,+(J+ge==ee.length)+2);for(var ke=0;ge-- >0;){var me=ee[J];ke=(ke<<5^me)&32767;var _e=-1,Oe=0;if((_e=he[ke])&&(_e|=J&-32768,_e>J&&(_e-=32768),_e<J))for(;ee[_e+Oe]==ee[J+Oe]&&Oe<250;)++Oe;if(Oe>2){me=I[Oe],me<=22?q=be(W,q,ae[me+1]>>1)-1:(be(W,q,3),q+=5,be(W,q,ae[me-23]>>5),q+=3);var at=me<8?0:me-4>>2;at>0&&(Ve(W,q,Oe-Z[me]),q+=at),me=R[J-_e],q=be(W,q,ae[me]>>3),q-=3;var st=me<4?0:me-2>>1;st>0&&(Ve(W,q,J-_e-de[me]),q+=st);for(var jt=0;jt<Oe;++jt)he[ke]=J&32767,ke=(ke<<5^ee[J])&32767,++J;ge-=Oe-1}else me<=143?me=me+48:q=Te(W,q,1),q=be(W,q,ae[me]),he[ke]=J&32767,++J}q=be(W,q,0)-1}return W.l=(q+7)/8|0,W.l}return function(W,q){return W.length<8?D(W,q):G(W,q)}}();function Fe(T){var R=yt(50+Math.floor(T.length*1.1)),b=Nt(T,R);return R.slice(0,b)}var we=ie?new Uint16Array(32768):De(32768),Ke=ie?new Uint16Array(32768):De(32768),Ie=ie?new Uint16Array(128):De(128),St=1,Rr=1;function Sn(T,R){var b=V(T,R)+257;R+=5;var N=V(T,R)+1;R+=5;var I=Y(T,R)+4;R+=4;for(var D=0,G=ie?new Uint8Array(19):De(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=1,q=ie?new Uint8Array(8):De(8),J=ie?new Uint8Array(8):De(8),he=G.length,ge=0;ge<I;++ge)G[B[ge]]=D=ye(T,R),W<D&&(W=D),q[D]++,R+=3;var ke=0;for(q[0]=0,ge=1;ge<=W;++ge)J[ge]=ke=ke+q[ge-1]<<1;for(ge=0;ge<he;++ge)(ke=G[ge])!=0&&(ee[ge]=J[ke]++);var me=0;for(ge=0;ge<he;++ge)if(me=G[ge],me!=0){ke=ae[ee[ge]]>>8-me;for(var _e=(1<<7-me)-1;_e>=0;--_e)Ie[ke|_e<<me]=me&7|ge<<3}var Oe=[];for(W=1;Oe.length<b+N;)switch(ke=Ie[X(T,R)],R+=ke&7,ke>>>=3){case 16:for(D=3+ve(T,R),R+=2,ke=Oe[Oe.length-1];D-- >0;)Oe.push(ke);break;case 17:for(D=3+ye(T,R),R+=3;D-- >0;)Oe.push(0);break;case 18:for(D=11+X(T,R),R+=7;D-- >0;)Oe.push(0);break;default:Oe.push(ke),W<ke&&(W=ke);break}var at=Oe.slice(0,b),st=Oe.slice(b);for(ge=b;ge<286;++ge)at[ge]=0;for(ge=N;ge<30;++ge)st[ge]=0;return St=qe(at,we,286),Rr=qe(st,Ke,30),R}function Cn(T,R){if(T[0]==3&&!(T[1]&3))return[ea(R),2];for(var b=0,N=0,I=Rh(R||1<<18),D=0,G=I.length>>>0,ee=0,W=0;!(N&1);){if(N=ye(T,b),b+=3,N>>>1)N>>1==1?(ee=9,W=5):(b=Sn(T,b),ee=St,W=Rr);else{b&7&&(b+=8-(b&7));var q=T[b>>>3]|T[(b>>>3)+1]<<8;if(b+=32,q>0)for(!R&&G<D+q&&(I=Ce(I,D+q),G=I.length);q-- >0;)I[D++]=T[b>>>3],b+=8;continue}for(;;){!R&&G<D+32767&&(I=Ce(I,D+32767),G=I.length);var J=ue(T,b,ee),he=N>>>1==1?We[J]:we[J];if(b+=he&15,he>>>=4,!(he>>>8&255))I[D++]=he;else{if(he==256)break;he-=257;var ge=he<8?0:he-4>>2;ge>5&&(ge=0);var ke=D+Z[he];ge>0&&(ke+=ue(T,b,ge),b+=ge),J=ue(T,b,W),he=N>>>1==1?Ye[J]:Ke[J],b+=he&15,he>>>=4;var me=he<4?0:he-2>>1,_e=de[he];for(me>0&&(_e+=ue(T,b,me),b+=me),!R&&G<ke&&(I=Ce(I,ke+100),G=I.length);D<ke;)I[D]=I[D-_e],++D}}}return R?[I,b+7>>>3]:[I.slice(0,D),b+7>>>3]}function An(T,R){var b=T.slice(T.l||0),N=Cn(b,R);return T.l+=N[1],N[0]}function Ha(T,R){if(T)typeof console<"u"&&console.error(R);else throw new Error(R)}function la(T,R){var b=T;Pt(b,0);var N=[],I=[],D={FileIndex:N,FullPaths:I};E(D,{root:R.root});for(var G=b.length-4;(b[G]!=80||b[G+1]!=75||b[G+2]!=5||b[G+3]!=6)&&G>=0;)--G;b.l=G+4,b.l+=4;var ee=b.read_shift(2);b.l+=6;var W=b.read_shift(4);for(b.l=W,G=0;G<ee;++G){b.l+=20;var q=b.read_shift(4),J=b.read_shift(4),he=b.read_shift(2),ge=b.read_shift(2),ke=b.read_shift(2);b.l+=8;var me=b.read_shift(4),_e=o(b.slice(b.l+he,b.l+he+ge));b.l+=he+ge+ke;var Oe=b.l;b.l=me+4,mc(b,q,J,D,_e),b.l=Oe}return D}function mc(T,R,b,N,I){T.l+=2;var D=T.read_shift(2),G=T.read_shift(2),ee=i(T);if(D&8257)throw new Error("Unsupported ZIP encryption");for(var W=T.read_shift(4),q=T.read_shift(4),J=T.read_shift(4),he=T.read_shift(2),ge=T.read_shift(2),ke="",me=0;me<he;++me)ke+=String.fromCharCode(T[T.l++]);if(ge){var _e=o(T.slice(T.l,T.l+ge));(_e[21589]||{}).mt&&(ee=_e[21589].mt),((I||{})[21589]||{}).mt&&(ee=I[21589].mt)}T.l+=ge;var Oe=T.slice(T.l,T.l+q);switch(G){case 8:Oe=U(T,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var at=!1;D&8&&(W=T.read_shift(4),W==134695760&&(W=T.read_shift(4),at=!0),q=T.read_shift(4),J=T.read_shift(4)),q!=R&&Ha(at,"Bad compressed size: "+R+" != "+q),J!=b&&Ha(at,"Bad uncompressed size: "+b+" != "+J),gc(N,ke,Oe,{unsafe:!0,mt:ee})}function rv(T,R){var b=R||{},N=[],I=[],D=yt(1),G=b.compression?8:0,ee=0,W=0,q=0,J=0,he=0,ge=T.FullPaths[0],ke=ge,me=T.FileIndex[0],_e=[],Oe=0;for(W=1;W<T.FullPaths.length;++W)if(ke=T.FullPaths[W].slice(ge.length),me=T.FileIndex[W],!(!me.size||!me.content||ke=="Sh33tJ5")){var at=J,st=yt(ke.length);for(q=0;q<ke.length;++q)st.write_shift(1,ke.charCodeAt(q)&127);st=st.slice(0,st.l),_e[he]=xE.buf(me.content,0);var jt=me.content;G==8&&(jt=H(jt)),D=yt(30),D.write_shift(4,67324752),D.write_shift(2,20),D.write_shift(2,ee),D.write_shift(2,G),me.mt?s(D,me.mt):D.write_shift(4,0),D.write_shift(-4,_e[he]),D.write_shift(4,jt.length),D.write_shift(4,me.content.length),D.write_shift(2,st.length),D.write_shift(2,0),J+=D.length,N.push(D),J+=st.length,N.push(st),J+=jt.length,N.push(jt),D=yt(46),D.write_shift(4,33639248),D.write_shift(2,0),D.write_shift(2,20),D.write_shift(2,ee),D.write_shift(2,G),D.write_shift(4,0),D.write_shift(-4,_e[he]),D.write_shift(4,jt.length),D.write_shift(4,me.content.length),D.write_shift(2,st.length),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(4,0),D.write_shift(4,at),Oe+=D.l,I.push(D),Oe+=st.length,I.push(st),++he}return D=yt(22),D.write_shift(4,101010256),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,he),D.write_shift(2,he),D.write_shift(4,Oe),D.write_shift(4,J),D.write_shift(2,0),Mn([Mn(N),Mn(I),D])}var go={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nv(T,R){if(T.ctype)return T.ctype;var b=T.name||"",N=b.match(/\.([^\.]+)$/);return N&&go[N[1]]||R&&(N=(b=R).match(/[\.\\]([^\.\\])+$/),N&&go[N[1]])?go[N[1]]:"application/octet-stream"}function av(T){for(var R=Ph(T),b=[],N=0;N<R.length;N+=76)b.push(R.slice(N,N+76));return b.join(`\r
`)+`\r
`}function sv(T){var R=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var J=q.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var b=[],N=R.split(`\r
`),I=0;I<N.length;++I){var D=N[I];if(D.length==0){b.push("");continue}for(var G=0;G<D.length;){var ee=76,W=D.slice(G,G+ee);W.charAt(ee-1)=="="?ee--:W.charAt(ee-2)=="="?ee-=2:W.charAt(ee-3)=="="&&(ee-=3),W=D.slice(G,G+ee),G+=ee,G<D.length&&(W+="="),b.push(W)}}return b.join(`\r
`)}function iv(T){for(var R=[],b=0;b<T.length;++b){for(var N=T[b];b<=T.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+T[++b];R.push(N)}for(var I=0;I<R.length;++I)R[I]=R[I].replace(/[=][0-9A-Fa-f]{2}/g,function(D){return String.fromCharCode(parseInt(D.slice(1),16))});return Hr(R.join(`\r
`))}function ov(T,R,b){for(var N="",I="",D="",G,ee=0;ee<10;++ee){var W=R[ee];if(!W||W.match(/^\s*$/))break;var q=W.match(/^(.*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":N=q[2].trim();break;case"content-type":D=q[2].trim();break;case"content-transfer-encoding":I=q[2].trim();break}}switch(++ee,I.toLowerCase()){case"base64":G=Hr(_r(R.slice(ee).join("")));break;case"quoted-printable":G=iv(R.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var J=gc(T,N.slice(b.length),G,{unsafe:!0});D&&(J.ctype=D)}function lv(T,R){if(M(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var b=R&&R.root||"",N=(Be&&Buffer.isBuffer(T)?T.toString("binary"):M(T)).split(`\r
`),I=0,D="";for(I=0;I<N.length;++I)if(D=N[I],!!/^Content-Location:/i.test(D)&&(D=D.slice(D.indexOf("file")),b||(b=D.slice(0,D.lastIndexOf("/")+1)),D.slice(0,b.length)!=b))for(;b.length>0&&(b=b.slice(0,b.length-1),b=b.slice(0,b.lastIndexOf("/")+1),D.slice(0,b.length)!=b););var G=(N[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var ee="--"+(G[1]||""),W=[],q=[],J={FileIndex:W,FullPaths:q};E(J);var he,ge=0;for(I=0;I<N.length;++I){var ke=N[I];ke!==ee&&ke!==ee+"--"||(ge++&&ov(J,N.slice(he,I),b),he=I)}return J}function cv(T,R){var b=R||{},N=b.boundary||"SheetJS";N="------="+N;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],D=T.FullPaths[0],G=D,ee=T.FileIndex[0],W=1;W<T.FullPaths.length;++W)if(G=T.FullPaths[W].slice(D.length),ee=T.FileIndex[W],!(!ee.size||!ee.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var q=ee.content,J=Be&&Buffer.isBuffer(q)?q.toString("binary"):M(q),he=0,ge=Math.min(1024,J.length),ke=0,me=0;me<=ge;++me)(ke=J.charCodeAt(me))>=32&&ke<128&&++he;var _e=he>=ge*4/5;I.push(N),I.push("Content-Location: "+(b.root||"file:///C:/SheetJS/")+G),I.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),I.push("Content-Type: "+nv(ee,G)),I.push(""),I.push(_e?sv(J):av(J))}return I.push(N+`--\r
`),I.join(`\r
`)}function uv(T){var R={};return E(R,T),R}function gc(T,R,b,N){var I=N&&N.unsafe;I||E(T);var D=!I&&Ue.find(T,R);if(!D){var G=T.FullPaths[0];R.slice(0,G.length)==G?G=R:(G.slice(-1)!="/"&&(G+="/"),G=(G+R).replace("//","/")),D={name:a(R),type:2},T.FileIndex.push(D),T.FullPaths.push(G),I||Ue.utils.cfb_gc(T)}return D.content=b,D.size=b?b.length:0,N&&(N.CLSID&&(D.clsid=N.CLSID),N.mt&&(D.mt=N.mt),N.ct&&(D.ct=N.ct)),D}function fv(T,R){E(T);var b=Ue.find(T,R);if(b){for(var N=0;N<T.FileIndex.length;++N)if(T.FileIndex[N]==b)return T.FileIndex.splice(N,1),T.FullPaths.splice(N,1),!0}return!1}function dv(T,R,b){E(T);var N=Ue.find(T,R);if(N){for(var I=0;I<T.FileIndex.length;++I)if(T.FileIndex[I]==N)return T.FileIndex[I].name=a(b),T.FullPaths[I]=b,!0}return!1}function hv(T){k(T,!0)}return t.find=j,t.read=C,t.parse=u,t.write=oe,t.writeFile=ne,t.utils={cfb_new:uv,cfb_add:gc,cfb_del:fv,cfb_mov:dv,cfb_gc:hv,ReadShift:yi,CheckField:ag,prep_blob:Pt,bconcat:Mn,use_zlib:F,_deflateRaw:Fe,_inflateRaw:An,consts:te},t}();function mE(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function nn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Pf(e){for(var t=[],r=nn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Ll=new Date(1899,11,30,0,0,0);function rr(e,t){var r=e.getTime(),n=Ll.getTime()+(e.getTimezoneOffset()-Ll.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var jm=new Date,gE=Ll.getTime()+(jm.getTimezoneOffset()-Ll.getTimezoneOffset())*6e4,$h=jm.getTimezoneOffset();function dc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+gE),t.getTimezoneOffset()!==$h&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$h)*6e4),t}function vE(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Hh=new Date("2017-02-19T19:06:09.000Z"),Mm=isNaN(Hh.getFullYear())?new Date("2/19/17"):Hh,_E=Mm.getFullYear()==2017;function Ft(e,t){var r=new Date(e);if(_E)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Mm.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Oa(e,t){if(Be&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return oi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return oi(Tm(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return oi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return oi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function It(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=It(e[r]));return t}function ut(e,t){for(var r="";r.length<t;)r+=e;return r}function Kr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var yE=["january","february","march","april","may","june","july","august","september","october","november","december"];function Os(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&yE.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var wE=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function Bm(e){return e?e.content&&e.type?Oa(e.content,!0):e.data?ai(e.data):e.asNodeBuffer&&Be?ai(e.asNodeBuffer().toString("binary")):e.asBinary?ai(e.asBinary()):e._data&&e._data.getContent?ai(Oa(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Um(e){if(!e)return null;if(e.data)return Nh(e.data);if(e.asNodeBuffer&&Be)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Nh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function kE(e){return e&&e.name.slice(-4)===".bin"?Um(e):Bm(e)}function Tr(e,t){for(var r=e.FullPaths||nn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Rf(e,t){var r=Tr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function xt(e,t,r){if(!r)return kE(Rf(e,t));if(!t)return null;try{return xt(e,t)}catch{return null}}function pr(e,t,r){if(!r)return Bm(Rf(e,t));if(!t)return null;try{return pr(e,t)}catch{return null}}function EE(e,t,r){return Um(Rf(e,t))}function zh(e){for(var t=e.FullPaths||nn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function TE(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Be?n=La(r):n=zk(r),Ue.utils.cfb_add(e,t,n)}Ue.utils.cfb_add(e,t,r)}else e.file(t,r)}function $m(e,t){switch(t.type){case"base64":return Ue.read(e,{type:"base64"});case"binary":return Ue.read(e,{type:"binary"});case"buffer":case"array":return Ue.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ii(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Hm=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,SE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Vh=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,CE=/<[^>]*>/g,Xt=Hm.match(Vh)?Vh:CE,AE=/<\w*:/,bE=/<(\/?)\w+:/;function Ae(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(SE),o=0,l="",c=0,u="",f="",d=1;if(i)for(c=0;c!=i.length;++c){for(f=i[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(a=f.charCodeAt(s+1))==34||a==39?1:0,l=f.slice(s+1+d,f.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var x=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[x]&&u.slice(o-3,o)=="ext")continue;n[x]=l,n[x.toLowerCase()]=l}}return n}function an(e){return e.replace(bE,"<$1")}var zm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},FE=Pf(zm),ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return zm[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),NE=/[&<>'"]/g,OE=/[\u0000-\u001f]/g;function If(e){var t=e+"";return t.replace(NE,function(r){return FE[r]}).replace(/\n/g,"<br/>").replace(OE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Wh=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function rt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function t0(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Gh(e){var t=ea(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Kh(e){return La(e,"binary").toString("utf8")}var Uo="foo bar baz",Ze=Be&&(Kh(Uo)==t0(Uo)&&Kh||Gh(Uo)==t0(Uo)&&Gh)||t0,oi=Be?function(e){return La(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Xi=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Vm=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),PE=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),RE=/<\/?(?:vt:)?variant>/g,IE=/<(?:vt:)([^>]*)>([\s\S]*)</;function Xh(e,t){var r=Ae(e),n=e.match(PE(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(RE,"").match(IE);i&&a.push({v:Ze(i[2]),t:i[1]})}),a}var DE=/(^\s|\s$|\n)/;function LE(e){return nn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function jE(e,t,r){return"<"+e+(r!=null?LE(r):"")+(t!=null?(t.match(DE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Df(e){if(Be&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ze(ja(Ff(e)));throw new Error("Bad input format: expected Buffer or string")}var qi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ME={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},BE=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function UE(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function $E(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var qh=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Yh=Be?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:La(t)})):qh(e)}:qh,Jh=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(pn(e,a)));return n.join("").replace(tr,"")},Lf=Be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(tr,""):Jh(e,t,r)}:Jh,Qh=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Wm=Be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Qh(e,t,r)}:Qh,Zh=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Qa(e,a)));return n.join("")},uo=Be?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Zh(t,r,n)}:Zh,Gm=function(e,t){var r=hr(e,t);return r>0?uo(e,t+4,t+4+r-1):""},Km=Gm,Xm=function(e,t){var r=hr(e,t);return r>0?uo(e,t+4,t+4+r-1):""},qm=Xm,Ym=function(e,t){var r=2*hr(e,t);return r>0?uo(e,t+4,t+4+r-1):""},Jm=Ym,Qm=function(t,r){var n=hr(t,r);return n>0?Lf(t,r+4,r+4+n):""},Zm=Qm,eg=function(e,t){var r=hr(e,t);return r>0?uo(e,t+4,t+4+r):""},tg=eg,rg=function(e,t){return UE(e,t)},jl=rg,ng=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Be&&(Km=function(t,r){if(!Buffer.isBuffer(t))return Gm(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},qm=function(t,r){if(!Buffer.isBuffer(t))return Xm(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Jm=function(t,r){if(!Buffer.isBuffer(t))return Ym(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Zm=function(t,r){if(!Buffer.isBuffer(t))return Qm(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},tg=function(t,r){if(!Buffer.isBuffer(t))return eg(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},jl=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):rg(t,r)},ng=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Qa=function(e,t){return e[t]},pn=function(e,t){return e[t+1]*256+e[t]},HE=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},hr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ma=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},zE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function yi(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Be&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(pn(this,c)),c+=2;e*=2;break;case"utf8":r=uo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Lf(this,this.l,this.l+e);break;case"wstr":return yi.call(this,e,"dbcs");case"lpstr-ansi":r=Km(this,this.l),e=4+hr(this,this.l);break;case"lpstr-cp":r=qm(this,this.l),e=4+hr(this,this.l);break;case"lpwstr":r=Jm(this,this.l),e=4+2*hr(this,this.l);break;case"lpp4":e=4+hr(this,this.l),r=Zm(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+hr(this,this.l),r=tg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Qa(this,this.l+e++))!==0;)s.push(Bo(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=pn(this,this.l+e))!==0;)s.push(Bo(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Qa(this,c),this.l=c+1,o=yi.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bo(pn(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Qa(this,c),this.l=c+1,o=yi.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bo(Qa(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Qa(this,this.l),this.l++,n;case 2:return n=(t==="i"?HE:pn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ma:zE)(this,this.l),this.l+=4,n):(a=hr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=jl(this,this.l):a=jl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=Wm(this,this.l,e);break}}return this.l+=e,r}var VE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},WE=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},GE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function KE(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)GE(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,VE(this,t,this.l);break;case 8:if(n=8,r==="f"){$E(this,t,this.l);break}case 16:break;case-4:n=4,WE(this,t,this.l);break}return this.l+=n,this}function ag(e,t){var r=Wm(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Pt(e,t){e.l=t,e.read_shift=yi,e.chk=ag,e.write_shift=KE}function Kt(e,t){e.l+=t}function yt(e){var t=ea(e);return Pt(t,0),t}function Tn(e,t,r){if(e){var n,a,s;Pt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=zl[o]||zl[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function hu(){var e=[],t=Be?256:2048,r=function(c){var u=yt(c);return Pt(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),Mn(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function wi(e,t,r){var n=It(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ep(e,t,r){var n=It(e);return n.s=wi(n.s,t.s,r),n.e=wi(n.e,t.s,r),n}function ki(e,t){if(e.cRel&&e.c<0)for(e=It(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=It(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ne(e);return!e.cRel&&e.cRel!=null&&(r=YE(r)),!e.rRel&&e.rRel!=null&&(r=XE(r)),r}function r0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Et(e.s.c)+":"+(e.e.cRel?"":"$")+Et(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dt(e.s.r)+":"+(e.e.rRel?"":"$")+Dt(e.e.r):ki(e.s,t.biff)+":"+ki(e.e,t.biff)}function jf(e){return parseInt(qE(e),10)-1}function Dt(e){return""+(e+1)}function XE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function qE(e){return e.replace(/\$(\d+)$/,"$1")}function Mf(e){for(var t=JE(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Et(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function YE(e){return e.replace(/^([A-Z])/,"$$$1")}function JE(e){return e.replace(/^\$([A-Z])/,"$1")}function QE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Zt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ne(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Bs(e){var t=e.indexOf(":");return t==-1?{s:Zt(e),e:Zt(e)}:{s:Zt(e.slice(0,t)),e:Zt(e.slice(t+1))}}function $e(e,t){return typeof t>"u"||typeof t=="number"?$e(e.s,e.e):(typeof e!="string"&&(e=Ne(e)),typeof t!="string"&&(t=Ne(t)),e==t?e:e+":"+t)}function ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function tp(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Or(e.z,r?rr(t):t)}catch{}try{return e.w=Or((e.XF||{}).numFmtId||(r?14:0),r?rr(t):t)}catch{return""+t}}function kn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ua[e.v]||e.v:t==null?tp(e,e.v):tp(e,t))}function oa(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function sg(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Zt(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=ft(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[f].length;++d)if(!(typeof t[f][d]>"u")){var x={v:t[f][d]},m=i+f,g=o+d;if(c.s.r>m&&(c.s.r=m),c.s.c>g&&(c.s.c=g),c.e.r<m&&(c.e.r=m),c.e.c<g&&(c.e.c=g),t[f][d]&&typeof t[f][d]=="object"&&!Array.isArray(t[f][d])&&!(t[f][d]instanceof Date))x=t[f][d];else if(Array.isArray(x.v)&&(x.f=t[f][d][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||Re[14],n.cellDates?(x.t="d",x.w=Or(x.z,rr(x.v))):(x.t="n",x.v=rr(x.v),x.w=Or(x.z,x.v))):x.t="s";if(a)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(x.z=s[m][g].z),s[m][g]=x;else{var y=Ne({c:g,r:m});s[y]&&s[y].z&&(x.z=s[y].z),s[y]=x}}}return c.s.c<1e7&&(s["!ref"]=$e(c)),s}function Us(e,t){return sg(null,e,t)}function ZE(e){return e.read_shift(4,"i")}function Wt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function eT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Bf(e,t){var r=e.l,n=e.read_shift(1),a=Wt(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(eT(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var tT=Bf;function Pr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ma(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var rT=Wt;function Uf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var nT=Wt,pu=Uf;function $f(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?jl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ma(t,0)>>2;return r?a/100:a}function ig(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ba=ig;function zt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function aT(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Ta[a];c&&(t.rgb=Ji(c));break;case 2:t.rgb=Ji([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function sT(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function og(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function iT(e){return og(e,1)}function oT(e){return og(e,2)}var Hf=2,sr=3,$o=11,rp=12,Ml=19,Ho=64,lT=65,cT=71,uT=4108,fT=4126,Ct=80,lg=81,dT=[Ct,lg],hT={1:{n:"CodePage",t:Hf},2:{n:"Category",t:Ct},3:{n:"PresentationFormat",t:Ct},4:{n:"ByteCount",t:sr},5:{n:"LineCount",t:sr},6:{n:"ParagraphCount",t:sr},7:{n:"SlideCount",t:sr},8:{n:"NoteCount",t:sr},9:{n:"HiddenCount",t:sr},10:{n:"MultimediaClipCount",t:sr},11:{n:"ScaleCrop",t:$o},12:{n:"HeadingPairs",t:uT},13:{n:"TitlesOfParts",t:fT},14:{n:"Manager",t:Ct},15:{n:"Company",t:Ct},16:{n:"LinksUpToDate",t:$o},17:{n:"CharacterCount",t:sr},19:{n:"SharedDoc",t:$o},22:{n:"HyperlinksChanged",t:$o},23:{n:"AppVersion",t:sr,p:"version"},24:{n:"DigSig",t:lT},26:{n:"ContentType",t:Ct},27:{n:"ContentStatus",t:Ct},28:{n:"Language",t:Ct},29:{n:"Version",t:Ct},255:{},2147483648:{n:"Locale",t:Ml},2147483651:{n:"Behavior",t:Ml},1919054434:{}},pT={1:{n:"CodePage",t:Hf},2:{n:"Title",t:Ct},3:{n:"Subject",t:Ct},4:{n:"Author",t:Ct},5:{n:"Keywords",t:Ct},6:{n:"Comments",t:Ct},7:{n:"Template",t:Ct},8:{n:"LastAuthor",t:Ct},9:{n:"RevNumber",t:Ct},10:{n:"EditTime",t:Ho},11:{n:"LastPrinted",t:Ho},12:{n:"CreatedDate",t:Ho},13:{n:"ModifiedDate",t:Ho},14:{n:"PageCount",t:sr},15:{n:"WordCount",t:sr},16:{n:"CharCount",t:sr},17:{n:"Thumbnail",t:cT},18:{n:"Application",t:Ct},19:{n:"DocSecurity",t:sr},255:{},2147483648:{n:"Locale",t:Ml},2147483651:{n:"Behavior",t:Ml},1919054434:{}},np={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xT=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mT(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var gT=mT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ta=It(gT),Ua={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cg={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ap={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function vT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _T(e){var t=vT();if(!e||!e.match)return t;var r={};if((e.match(Xt)||[]).forEach(function(n){var a=Ae(n);switch(a[0].replace(AE,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[ap[a.ContentType]]!==void 0&&t[ap[a.ContentType]].push(a.PartName);break}}),t.xmlns!==ME.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var ds={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xu(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ei(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Xt)||[]).forEach(function(a){var s=Ae(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:ii(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var yT="application/vnd.oasis.opendocument.spreadsheet";function wT(e,t){for(var r=Df(e),n,a;n=qi.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ae(n[0],!1),a.path=="/"&&a.type!==yT)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Ti=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],kT=function(){for(var e=new Array(Ti.length),t=0;t<Ti.length;++t){var r=Ti[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function ug(e){var t={};e=Ze(e);for(var r=0;r<Ti.length;++r){var n=Ti[r],a=e.match(kT[r]);a!=null&&a.length>0&&(t[n[1]]=ze(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ft(t[n[1]]))}return t}var ET=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function fg(e,t,r,n){var a=[];if(typeof e=="string")a=Xh(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var i=typeof t=="string"?Xh(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function TT(e,t,r){var n={};return t||(t={}),e=Ze(e),ET.forEach(function(a){var s=(e.match(Xi(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=ze(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&fg(n.HeadingPairs,n.TitlesOfParts,t,r),t}var ST=/<[^>]+>[^<]*/g;function CT(e,t){var r={},n="",a=e.match(ST);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Ae(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ze(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ze(u);break;case"bool":r[n]=rt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Ft(u);break;case"cy":case"error":r[n]=ze(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var AT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},n0;function bT(e,t,r){n0||(n0=Pf(AT)),t=n0[t]||t,e[t]=r}function zf(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function dg(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function hg(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function pg(e,t,r){return t===31?hg(e):dg(e,t,r)}function mu(e,t,r){return pg(e,t,r===!1?0:4)}function FT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return pg(e,t,0)}function NT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(tr,""),e.l-a&2&&(e.l+=2)}return r}function OT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(tr,"");return r}function PT(e){var t=e.l,r=Bl(e,lg);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Bl(e,sr);return[r,n]}function RT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(PT(e));return r}function sp(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(tr,"").replace(si,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function xg(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function IT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Bl(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==rp&&n!==t&&dT.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===rp?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return dg(e,n,4).replace(tr,"");case 31:return hg(e);case 64:return zf(e);case 65:return xg(e);case 71:return IT(e);case 80:return mu(e,n,!s.raw).replace(tr,"");case 81:return FT(e,n).replace(tr,"");case 4108:return RT(e);case 4126:case 4127:return n==4127?NT(e):OT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ip(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),f=e.read_shift(4);s[i]=[u,f+r]}s.sort(function(_,p){return _[1]-p[1]});var d={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var x=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,x=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(x=!1,e.l=s[i][1]),x)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(d[m.n]=Bl(e,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:zr(o=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(s[i][0]===1){if(o=d.CodePage=Bl(e,Hf),zr(o),l!==-1){var g=e.l;e.l=s[l][1],c=sp(e,o),e.l=g}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=sp(e,o)}else{var y=c[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=xg(e);break;case 30:e.l+=4,v=mu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=mu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=dt(e,4);break;case 64:e.l+=4,v=Ft(zf(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[y]=v}}return e.l=r+n,d}function op(e,t,r){var n=e.content;if(!n)return{};Pt(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Ue.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var f=ip(n,t),d={SystemIdentifier:c};for(var x in f)d[x]=f[x];if(d.FMTID=s,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=ip(n,null)}catch{}for(x in m)d[x]=m[x];return d.FMTID=[s,i],d}function Nn(e,t){return e.read_shift(t),null}function DT(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function dt(e,t){return e.read_shift(t)===1}function mt(e){return e.read_shift(2,"u")}function mg(e,t){return DT(e,t,mt)}function LT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function fo(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function jT(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Pa(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ho(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Pa(e,n,r)}function $a(e,t,r){if(r.biff>5)return ho(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function MT(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function BT(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(tr,"");return n&&(e.l+=24),a}function UT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(tr,"");return r+i}function $T(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return BT(e);case"0303000000000000c000000000000046":return UT(e);default:throw new Error("Unsupported Moniker "+r)}}function zo(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(tr,""):"";return r}function HT(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",u,f;a&16&&(s=zo(e,r-e.l)),a&128&&(i=zo(e,r-e.l)),(a&257)===257&&(o=zo(e,r-e.l)),(a&257)===1&&(l=$T(e,r-e.l)),a&8&&(c=zo(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=zf(e)),e.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var x={Target:d};return u&&(x.guid=u),f&&(x.time=f),s&&(x.Tooltip=s),x}function gg(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function vg(e,t){var r=gg(e);return r[3]=0,r}function sn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function zT(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function VT(e,t,r){return t===0?"":$a(e,t,r)}function WT(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function _g(e){var t=e.read_shift(2),r=$f(e);return[t,r]}function GT(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=fo(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function hc(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function yg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var KT=yg;function wg(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function XT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function qT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ut(e){e.l+=2,e.l+=e.read_shift(2)}var YT={0:Ut,4:Ut,5:Ut,6:Ut,7:qT,8:Ut,9:Ut,10:Ut,11:Ut,12:Ut,13:XT,14:Ut,15:Ut,16:Ut,17:Ut,18:Ut,19:Ut,20:Ut,21:wg};function JT(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(YT[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Vo(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function QT(e,t){return t===0||e.read_shift(2),1200}function ZT(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=$a(e,0,r);return e.read_shift(t+n-e.l),a}function eS(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function tS(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=fo(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function rS(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(jT(e));return s.Count=n,s.Unique=a,s}function nS(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function aS(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function sS(e){var t=zT(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function iS(e){return e.read_shift(2),e.read_shift(4)}function lp(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function oS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function lS(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function cS(){}function uS(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=fo(e,0,r),n}function fS(e){var t=sn(e);return t.isst=e.read_shift(4),t}function dS(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=sn(e);r.biff==2&&e.l++;var s=ho(e,n-e.l,r);return a.val=s,a}function hS(e,t,r){var n=e.read_shift(2),a=$a(e,0,r);return[n,a]}var pS=$a;function cp(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function xS(e){var t=e.read_shift(2),r=e.read_shift(2),n=_g(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function mS(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(_g(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function gS(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function vS(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=xT[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function _S(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=vS(e,t,n.fStyle,r),n}function yS(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function up(e,t,r){var n=sn(e);(r.biff==2||t==9)&&++e.l;var a=LT(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function wS(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=sn(e),a=zt(e);return n.val=a,n}var fp=VT;function kS(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Pa(e,s),o=[];n>e.l;)o.push(ho(e));return[s,a,i,o]}function dp(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=GT(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var ES=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hp(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Pa(e,i,r);a&32&&(c=ES[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:aA(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function kg(e,t,r){if(r.biff<8)return TS(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(WT(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function TS(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=fo(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function SS(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Pa(e,n,r),i=Pa(e,a,r);return[s,i]}function CS(e,t,r){var n=yg(e);e.l++;var a=e.read_shift(1);return t-=8,[sA(e,t,r),a,n]}function pp(e,t,r){var n=KT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,rA(e,t,r)]}function AS(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function bS(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=$a(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function FS(e,t,r){return bS(e,t,r)}function NS(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(hc(e));return r}function OS(e,t,r){if(r&&r.biff<8)return RS(e,t,r);var n=wg(e),a=JT(e,t-22,n[1]);return{cmo:n,ft:a}}var PS={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function RS(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((PS[n]||Kt)(e,t,r)),{cmo:[a,n,s],ft:i}}function IS(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=MT(e,6,r);var o=e.read_shift(2);e.read_shift(2),mt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=Pa(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function DS(e,t){var r=hc(e);e.l+=16;var n=HT(e,t-24);return[r,n]}function LS(e,t){e.read_shift(2);var r=hc(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(tr,""),[r,n]}function jS(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=np[r]||r,r=e.read_shift(2),t[1]=np[r]||r,t}function MS(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(vg(e));return r}function BS(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(vg(e));return r}function US(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Eg(e,t,r){if(!r.cellStyles)return Kt(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function $S(e,t){var r={};return t<32||(e.l+=16,r.header=zt(e),r.footer=zt(e),e.l+=2),r}function HS(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var zS=sn,VS=mg,WS=ho;function GS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function KS(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=sn(e);++e.l;var a=$a(e,t-7,r);return n.t="str",n.val=a,n}function XS(e){var t=sn(e);++e.l;var r=zt(e);return t.t="n",t.val=r,t}function qS(e){var t=sn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function YS(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function JS(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function QS(e,t,r){var n=e.l+t,a=sn(e),s=e.read_shift(2),i=Pa(e,s,r);return e.l=n,a.t="str",a.val=i,a}var ZS=[2,3,48,49,131,139,140,245],xp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Pf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ea(1);switch(l.type){case"base64":u=Hr(_r(o));break;case"binary":u=Hr(o);break;case"buffer":case"array":u=o;break}Pt(u,0);var f=u.read_shift(1),d=!!(f&136),x=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:x=!0,d=!0;break;case 49:x=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=u.read_shift(2)),u.l+=3,f!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=u.read_shift(2));var v=u.read_shift(2),_=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(_=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var p=[],S={},P=Math.min(u.length,f==2?521:y-10-(x?264:0)),C=m?32:11;u.l<P&&u[u.l]!=13;)switch(S={},S.name=jn.utils.decode(_,u.slice(u.l,u.l+C)).replace(/[\u0000\r\n].*$/g,""),u.l+=C,S.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(S.offset=u.read_shift(4)),S.len=u.read_shift(1),f==2&&(S.offset=u.read_shift(2)),S.dec=u.read_shift(1),S.name.length&&p.push(S),f!=2&&(u.l+=m?13:14),S.type){case"B":(!x||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var E=0,w=0;for(c[0]=[],w=0;w!=p.length;++w)c[0][w]=p[w].name;for(;g-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++E]=[],w=0,w=0;w!=p.length;++w){var k=u.slice(u.l,u.l+p[w].len);u.l+=p[w].len,Pt(k,0);var O=jn.utils.decode(_,k);switch(p[w].type){case"C":O.trim().length&&(c[E][w]=O.replace(/\s+$/,""));break;case"D":O.length===8?c[E][w]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):c[E][w]=O;break;case"F":c[E][w]=parseFloat(O.trim());break;case"+":case"I":c[E][w]=m?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":c[E][w]=!0;break;case"N":case"F":c[E][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[E][w]="##MEMO##"+(m?parseInt(O.trim(),10):k.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(c[E][w]=+O||0);break;case"@":c[E][w]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[E][w]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[E][w]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][w]=-k.read_shift(-8,"f");break;case"B":if(x&&p[w].len==8){c[E][w]=k.read_shift(8,"f");break}case"G":case"P":k.l+=p[w].len;break;case"0":if(p[w].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+p[w].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=p,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Us(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return oa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&zr(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=hu(),f=Eu(o,{header:1,raw:!0,cellDates:!0}),d=f[0],x=f.slice(1),m=o["!cols"]||[],g=0,y=0,v=0,_=1;for(g=0;g<d.length;++g){if(((m[g]||{}).DBF||{}).name){d[g]=m[g].DBF.name,++v;continue}if(d[g]!=null){if(++v,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(y=0;y<1024;++y)if(d.indexOf(d[g]+"_"+y)==-1){d[g]+="_"+y;break}}}}var p=ft(o["!ref"]),S=[],P=[],C=[];for(g=0;g<=p.e.c-p.s.c;++g){var E="",w="",k=0,O=[];for(y=0;y<x.length;++y)x[y][g]!=null&&O.push(x[y][g]);if(O.length==0||d[g]==null){S[g]="?";continue}for(y=0;y<O.length;++y){switch(typeof O[y]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=O[y]instanceof Date?"D":"C";break;default:w="C"}k=Math.max(k,String(O[y]).length),E=E&&E!=w?"C":w}k>250&&(k=250),w=((m[g]||{}).DBF||{}).type,w=="C"&&m[g].DBF.len>k&&(k=m[g].DBF.len),E=="B"&&w=="N"&&(E="N",C[g]=m[g].DBF.dec,k=m[g].DBF.len),P[g]=E=="C"||w=="N"?k:s[E]||0,_+=P[g],S[g]=E}var j=u.next(32);for(j.write_shift(4,318902576),j.write_shift(4,x.length),j.write_shift(2,296+32*v),j.write_shift(2,_),g=0;g<4;++g)j.write_shift(4,0);for(j.write_shift(4,0|(+t[km]||3)<<8),g=0,y=0;g<d.length;++g)if(d[g]!=null){var L=u.next(32),Q=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,Q,"sbcs"),L.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),L.write_shift(4,y),L.write_shift(1,P[g]||s[S[g]]||0),L.write_shift(1,C[g]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),y+=P[g]||s[S[g]]||0}var K=u.next(264);for(K.write_shift(4,13),g=0;g<65;++g)K.write_shift(4,0);for(g=0;g<x.length;++g){var re=u.next(_);for(re.write_shift(1,0),y=0;y<d.length;++y)if(d[y]!=null)switch(S[y]){case"L":re.write_shift(1,x[g][y]==null?63:x[g][y]?84:70);break;case"B":re.write_shift(8,x[g][y]||0,"f");break;case"N":var fe="0";for(typeof x[g][y]=="number"&&(fe=x[g][y].toFixed(C[y]||0)),v=0;v<P[y]-fe.length;++v)re.write_shift(1,32);re.write_shift(1,fe,"sbcs");break;case"D":x[g][y]?(re.write_shift(4,("0000"+x[g][y].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(x[g][y].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+x[g][y].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var te=String(x[g][y]!=null?x[g][y]:"").slice(0,P[y]);for(re.write_shift(1,te,"sbcs"),v=0;v<P[y]-te.length;++v)re.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),e4=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+nn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,x){var m=e[x];return typeof m=="number"?Oh(m):m},n=function(d,x,m){var g=x.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?d:Oh(g)};e["|"]=254;function a(d,x){switch(x.type){case"base64":return s(_r(d),x);case"binary":return s(d,x);case"buffer":return s(Be&&Buffer.isBuffer(d)?d.toString("binary"):ja(d),x);case"array":return s(Oa(d),x)}throw new Error("Unrecognized type "+x.type)}function s(d,x){var m=d.split(/[\n\r]+/),g=-1,y=-1,v=0,_=0,p=[],S=[],P=null,C={},E=[],w=[],k=[],O=0,j;for(+x.codepage>=0&&zr(+x.codepage);v!==m.length;++v){O=0;var L=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Q=L.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),K=Q[0],re;if(L.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&S.push(L.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,te=!1,ne=!1,M=!1,oe=-1,se=-1;for(_=1;_<Q.length;++_)switch(Q[_].charAt(0)){case"A":break;case"X":y=parseInt(Q[_].slice(1))-1,te=!0;break;case"Y":for(g=parseInt(Q[_].slice(1))-1,te||(y=0),j=p.length;j<=g;++j)p[j]=[];break;case"K":re=Q[_].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Kr(re))?isNaN(Os(re).getDate())||(re=Ft(re)):(re=Kr(re),P!==null&&Ms(P)&&(re=dc(re))),fe=!0;break;case"E":M=!0;var F=ys(Q[_].slice(1),{r:g,c:y});p[g][y]=[p[g][y],F];break;case"S":ne=!0,p[g][y]=[p[g][y],"S5S"];break;case"G":break;case"R":oe=parseInt(Q[_].slice(1))-1;break;case"C":se=parseInt(Q[_].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}if(fe&&(p[g][y]&&p[g][y].length==2?p[g][y][0]=re:p[g][y]=re,P=null),ne){if(M)throw new Error("SYLK shared formula cannot have own formula");var U=oe>-1&&p[oe][se];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");p[g][y][1]=Rg(U[1],{r:g-oe,c:y-se})}break;case"F":var H=0;for(_=1;_<Q.length;++_)switch(Q[_].charAt(0)){case"X":y=parseInt(Q[_].slice(1))-1,++H;break;case"Y":for(g=parseInt(Q[_].slice(1))-1,j=p.length;j<=g;++j)p[j]=[];break;case"M":O=parseInt(Q[_].slice(1))/20;break;case"F":break;case"G":break;case"P":P=S[parseInt(Q[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=Q[_].slice(1).split(" "),j=parseInt(k[0],10);j<=parseInt(k[1],10);++j)O=parseInt(k[2],10),w[j-1]=O===0?{hidden:!0}:{wch:O},Ps(w[j-1]);break;case"C":y=parseInt(Q[_].slice(1))-1,w[y]||(w[y]={});break;case"R":g=parseInt(Q[_].slice(1))-1,E[g]||(E[g]={}),O>0?(E[g].hpt=O,E[g].hpx=Qi(O)):O===0&&(E[g].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}H<1&&(P=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}}return E.length>0&&(C["!rows"]=E),w.length>0&&(C["!cols"]=w),x&&x.sheetRows&&(p=p.slice(0,x.sheetRows)),[p,C]}function i(d,x){var m=a(d,x),g=m[0],y=m[1],v=Us(g,x);return nn(y).forEach(function(_){v[_]=y[_]}),v}function o(d,x){return oa(i(d,x),x)}function l(d,x,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(d.t){case"n":y+=d.v||0,d.f&&!d.F&&(y+=";E"+U3(d.f,{r:m,c:g}));break;case"b":y+=d.v?"TRUE":"FALSE";break;case"e":y+=d.w||d.v;break;case"d":y+='"'+(d.w||d.v)+'"';break;case"s":y+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(d,x){x.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=$l(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Hl(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&d.push(y)})}function u(d,x){x.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*Ng(m.hpx)+";"),y.length>2&&d.push(y+"R"+(g+1))})}function f(d,x){var m=["ID;PWXL;N;E"],g=[],y=ft(d["!ref"]),v,_=Array.isArray(d),p=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&c(m,d["!cols"]),d["!rows"]&&u(m,d["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var P=y.s.c;P<=y.e.c;++P){var C=Ne({r:S,c:P});v=_?(d[S]||[])[P]:d[C],!(!v||v.v==null&&(!v.f||v.F))&&g.push(l(v,d,S,P))}return m.join(p)+p+g.join(p)+p+"E"+p}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),t4=function(){function e(s,i){switch(i.type){case"base64":return t(_r(s),i);case"binary":return t(s,i);case"buffer":return t(Be&&Buffer.isBuffer(s)?s.toString("binary"):ja(s),i);case"array":return t(Oa(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),x=d[0],m=d[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+x){case-1:if(g==="BOT"){f[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[l][c]=!0:g==="FALSE"?f[l][c]=!1:isNaN(Kr(m))?isNaN(Os(m).getDate())?f[l][c]=m:f[l][c]=Ft(m):f[l][c]=Kr(m),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(s,i){return Us(e(s,i),i)}function n(s,i){return oa(r(s,i),i)}var a=function(){var s=function(l,c,u,f,d){l.push(c),l.push(u+","+f),l.push('"'+d.replace(/"/g,'""')+'"')},i=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=ft(l["!ref"]),f,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var x=u.s.r;x<=u.e.r;++x){i(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var g=Ne({r:x,c:m});if(f=d?(l[x]||[])[m]:l[g],!f){i(c,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?i(c,1,0,"="+f.f):i(c,1,0,""):i(c,0,y,"V");break;case"b":i(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Or(f.z||Re[14],rr(Ft(f.v)))),i(c,0,f.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var v=`\r
`,_=c.join(v);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),r4=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var x=f.split(`
`),m=-1,g=-1,y=0,v=[];y!==x.length;++y){var _=x[y].trim().split(":");if(_[0]==="cell"){var p=Zt(_[1]);if(v.length<=p.r)for(m=v.length;m<=p.r;++m)v[m]||(v[m]=[]);switch(m=p.r,g=p.c,_[2]){case"t":v[m][g]=e(_[3]);break;case"v":v[m][g]=+_[3];break;case"vtf":var S=_[_.length-1];case"vtc":switch(_[3]){case"nl":v[m][g]=!!+_[4];break;default:v[m][g]=+_[4];break}_[2]=="vtf"&&(v[m][g]=[v[m][g],S])}}}return d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),v}function n(f,d){return Us(r(f,d),d)}function a(f,d){return oa(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var d=[],x=[],m,g="",y=Bs(f["!ref"]),v=Array.isArray(f),_=y.s.r;_<=y.e.r;++_)for(var p=y.s.c;p<=y.e.c;++p)if(g=Ne({r:_,c:p}),m=v?(f[_]||[])[p]:f[g],!(!m||m.v==null||m.t==="z")){switch(x=["cell",g,"t"],m.t){case"s":case"str":x.push(t(m.v));break;case"n":m.f?(x[2]="vtf",x[3]="n",x[4]=m.v,x[5]=t(m.f)):(x[2]="v",x[3]=m.v);break;case"b":x[2]="vt"+(m.f?"f":"c"),x[3]="nl",x[4]=m.v?"1":"0",x[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=rr(Ft(m.v));x[2]="vtc",x[3]="nd",x[4]=""+S,x[5]=m.w||Or(m.z||Re[14],S);break;case"e":continue}d.push(x.join(":"))}return d.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[s,i,o,i,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Yi=function(){function e(u,f,d,x,m){m.raw?f[d][x]=u:u===""||(u==="TRUE"?f[d][x]=!0:u==="FALSE"?f[d][x]=!1:isNaN(Kr(u))?isNaN(Os(u).getDate())?f[d][x]=u:f[d][x]=Ft(u):f[d][x]=Kr(u))}function t(u,f){var d=f||{},x=[];if(!u||u.length===0)return x;for(var m=u.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,v=0,_=0;_<=g;++_)v=m[_].indexOf(" "),v==-1?v=m[_].length:v++,y=Math.max(y,v);for(_=0;_<=g;++_){x[_]=[];var p=0;for(e(m[_].slice(0,y).trim(),x,_,p,d),p=1;p<=(m[_].length-y)/10+1;++p)e(m[_].slice(y+(p-1)*10,y+p*10).trim(),x,_,p,d)}return d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},d=!1,x=0,m=0;x<u.length;++x)(m=u.charCodeAt(x))==34?d=!d:!d&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&m.push([f[x],x]);if(!m.length){f=n;for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&m.push([f[x],x])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function s(u,f){var d=f||{},x="",m=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(x=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(x=u.charAt(4),u=u.slice(6)):x=a(u.slice(0,1024)):d&&d.FS?x=d.FS:x=a(u.slice(0,1024));var y=0,v=0,_=0,p=0,S=0,P=x.charCodeAt(0),C=!1,E=0,w=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var k=d.dateNF!=null?hE(d.dateNF):null;function O(){var j=u.slice(p,S),L={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)L.t="z";else if(d.raw)L.t="s",L.v=j;else if(j.trim().length===0)L.t="s",L.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(L.t="s",L.v=j.slice(2,-1).replace(/""/g,'"')):H3(j)?(L.t="n",L.f=j.slice(1)):(L.t="s",L.v=j);else if(j=="TRUE")L.t="b",L.v=!0;else if(j=="FALSE")L.t="b",L.v=!1;else if(!isNaN(_=Kr(j)))L.t="n",d.cellText!==!1&&(L.w=j),L.v=_;else if(!isNaN(Os(j).getDate())||k&&j.match(k)){L.z=d.dateNF||Re[14];var Q=0;k&&j.match(k)&&(j=pE(j,d.dateNF,j.match(k)||[]),Q=1),d.cellDates?(L.t="d",L.v=Ft(j,Q)):(L.t="n",L.v=rr(Ft(j,Q))),d.cellText!==!1&&(L.w=Or(L.z,L.v instanceof Date?rr(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=j;if(L.t=="z"||(d.dense?(m[y]||(m[y]=[]),m[y][v]=L):m[Ne({c:v,r:y})]=L),p=S+1,w=u.charCodeAt(p),g.e.c<v&&(g.e.c=v),g.e.r<y&&(g.e.r=y),E==P)++v;else if(v=0,++y,d.sheetRows&&d.sheetRows<=y)return!0}e:for(;S<u.length;++S)switch(E=u.charCodeAt(S)){case 34:w===34&&(C=!C);break;case P:case 10:case 13:if(!C&&O())break e;break}return S-p>0&&O(),m["!ref"]=$e(g),m}function i(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Us(t(u,f),f)}function o(u,f){var d="",x=f.type=="string"?[0,0,0,0]:Jf(u,f);switch(f.type){case"base64":d=_r(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof jn<"u"?d=jn.utils.decode(f.codepage,u):d=Be&&Buffer.isBuffer(u)?u.toString("binary"):ja(u);break;case"array":d=Oa(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return x[0]==239&&x[1]==187&&x[2]==191?d=Ze(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=Ze(d):f.type=="binary"&&typeof jn<"u"&&f.codepage&&(d=jn.utils.decode(f.codepage,jn.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?r4.to_sheet(f.type=="string"?d:Ze(d),f):i(d,f)}function l(u,f){return oa(o(u,f),f)}function c(u){for(var f=[],d=ft(u["!ref"]),x,m=Array.isArray(u),g=d.s.r;g<=d.e.r;++g){for(var y=[],v=d.s.c;v<=d.e.c;++v){var _=Ne({r:g,c:v});if(x=m?(u[g]||[])[v]:u[_],!x||x.v==null){y.push("          ");continue}for(var p=(x.w||(kn(x),x.w)||"").slice(0,10);p.length<10;)p+=" ";y.push(p+(v===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function n4(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=e4.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Yi.to_workbook(e,t)}}var Si=function(){function e(F,U,H){if(F){Pt(F,F.l||0);for(var B=H.Enum||oe;F.l<F.length;){var Z=F.read_shift(2),de=B[Z]||B[65535],le=F.read_shift(2),ie=F.l+le,ae=de.f&&de.f(F,le,H);if(F.l=ie,U(ae,de,Z))return}}}function t(F,U){switch(U.type){case"base64":return r(Hr(_r(F)),U);case"binary":return r(Hr(F),U);case"buffer":case"array":return r(F,U)}throw"Unsupported type "+U.type}function r(F,U){if(!F)return F;var H=U||{},B=H.dense?[]:{},Z="Sheet1",de="",le=0,ie={},ae=[],z=[],A={s:{r:0,c:0},e:{r:0,c:0}},ve=H.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)H.Enum=oe,e(F,function(X,ue,ce){switch(ce){case 0:H.vers=X,X>=4096&&(H.qpro=!0);break;case 6:A=X;break;case 204:X&&(de=X);break;case 222:de=X;break;case 15:case 51:H.qpro||(X[1].v=X[1].v.slice(1));case 13:case 14:case 16:ce==14&&(X[2]&112)==112&&(X[2]&15)>1&&(X[2]&15)<15&&(X[1].z=H.dateNF||Re[14],H.cellDates&&(X[1].t="d",X[1].v=dc(X[1].v))),H.qpro&&X[3]>le&&(B["!ref"]=$e(A),ie[Z]=B,ae.push(Z),B=H.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},le=X[3],Z=de||"Sheet"+(le+1),de="");var Te=H.dense?(B[X[0].r]||[])[X[0].c]:B[Ne(X[0])];if(Te){Te.t=X[1].t,Te.v=X[1].v,X[1].z!=null&&(Te.z=X[1].z),X[1].f!=null&&(Te.f=X[1].f);break}H.dense?(B[X[0].r]||(B[X[0].r]=[]),B[X[0].r][X[0].c]=X[1]):B[Ne(X[0])]=X[1];break}},H);else if(F[2]==26||F[2]==14)H.Enum=se,F[2]==14&&(H.qpro=!0,F.l=0),e(F,function(X,ue,ce){switch(ce){case 204:Z=X;break;case 22:X[1].v=X[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(X[3]>le&&(B["!ref"]=$e(A),ie[Z]=B,ae.push(Z),B=H.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},le=X[3],Z="Sheet"+(le+1)),ve>0&&X[0].r>=ve)break;H.dense?(B[X[0].r]||(B[X[0].r]=[]),B[X[0].r][X[0].c]=X[1]):B[Ne(X[0])]=X[1],A.e.c<X[0].c&&(A.e.c=X[0].c),A.e.r<X[0].r&&(A.e.r=X[0].r);break;case 27:X[14e3]&&(z[X[14e3][0]]=X[14e3][1]);break;case 1537:z[X[0]]=X[1],X[0]==le&&(Z=X[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(B["!ref"]=$e(A),ie[de||Z]=B,ae.push(de||Z),!z.length)return{SheetNames:ae,Sheets:ie};for(var ye={},Y=[],V=0;V<z.length;++V)ie[ae[V]]?(Y.push(z[V]||ae[V]),ye[z[V]]=ie[z[V]]||ie[ae[V]]):(Y.push(z[V]),ye[z[V]]={"!ref":"A1"});return{SheetNames:Y,Sheets:ye}}function n(F,U){var H=U||{};if(+H.codepage>=0&&zr(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var B=hu(),Z=ft(F["!ref"]),de=Array.isArray(F),le=[];Lr(B,0,s(1030)),Lr(B,6,l(Z));for(var ie=Math.min(Z.e.r,8191),ae=Z.s.r;ae<=ie;++ae)for(var z=Dt(ae),A=Z.s.c;A<=Z.e.c;++A){ae===Z.s.r&&(le[A]=Et(A));var ve=le[A]+z,ye=de?(F[ae]||[])[A]:F[ve];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?Lr(B,13,x(ae,A,ye.v)):Lr(B,14,g(ae,A,ye.v));else{var Y=kn(ye);Lr(B,15,f(ae,A,Y.slice(0,239)))}}return Lr(B,1),B.end()}function a(F,U){var H=U||{};if(+H.codepage>=0&&zr(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var B=hu();Lr(B,0,i(F));for(var Z=0,de=0;Z<F.SheetNames.length;++Z)(F.Sheets[F.SheetNames[Z]]||{})["!ref"]&&Lr(B,27,M(F.SheetNames[Z],de++));var le=0;for(Z=0;Z<F.SheetNames.length;++Z){var ie=F.Sheets[F.SheetNames[Z]];if(!(!ie||!ie["!ref"])){for(var ae=ft(ie["!ref"]),z=Array.isArray(ie),A=[],ve=Math.min(ae.e.r,8191),ye=ae.s.r;ye<=ve;++ye)for(var Y=Dt(ye),V=ae.s.c;V<=ae.e.c;++V){ye===ae.s.r&&(A[V]=Et(V));var X=A[V]+Y,ue=z?(ie[ye]||[])[V]:ie[X];if(!(!ue||ue.t=="z"))if(ue.t=="n")Lr(B,23,O(ye,V,le,ue.v));else{var ce=kn(ue);Lr(B,22,E(ye,V,le,ce.slice(0,239)))}}++le}}return Lr(B,1),B.end()}function s(F){var U=yt(2);return U.write_shift(2,F),U}function i(F){var U=yt(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var H=0,B=0,Z=0,de=0;de<F.SheetNames.length;++de){var le=F.SheetNames[de],ie=F.Sheets[le];if(!(!ie||!ie["!ref"])){++Z;var ae=Bs(ie["!ref"]);H<ae.e.r&&(H=ae.e.r),B<ae.e.c&&(B=ae.e.c)}}return H>8191&&(H=8191),U.write_shift(2,H),U.write_shift(1,Z),U.write_shift(1,B),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(F,U,H){var B={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&H.qpro?(B.s.c=F.read_shift(1),F.l++,B.s.r=F.read_shift(2),B.e.c=F.read_shift(1),F.l++,B.e.r=F.read_shift(2),B):(B.s.c=F.read_shift(2),B.s.r=F.read_shift(2),U==12&&H.qpro&&(F.l+=2),B.e.c=F.read_shift(2),B.e.r=F.read_shift(2),U==12&&H.qpro&&(F.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(F){var U=yt(8);return U.write_shift(2,F.s.c),U.write_shift(2,F.s.r),U.write_shift(2,F.e.c),U.write_shift(2,F.e.r),U}function c(F,U,H){var B=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(B[0].c=F.read_shift(1),B[3]=F.read_shift(1),B[0].r=F.read_shift(2),F.l+=2):(B[2]=F.read_shift(1),B[0].c=F.read_shift(2),B[0].r=F.read_shift(2)),B}function u(F,U,H){var B=F.l+U,Z=c(F,U,H);if(Z[1].t="s",H.vers==20768){F.l++;var de=F.read_shift(1);return Z[1].v=F.read_shift(de,"utf8"),Z}return H.qpro&&F.l++,Z[1].v=F.read_shift(B-F.l,"cstr"),Z}function f(F,U,H){var B=yt(7+H.length);B.write_shift(1,255),B.write_shift(2,U),B.write_shift(2,F),B.write_shift(1,39);for(var Z=0;Z<B.length;++Z){var de=H.charCodeAt(Z);B.write_shift(1,de>=128?95:de)}return B.write_shift(1,0),B}function d(F,U,H){var B=c(F,U,H);return B[1].v=F.read_shift(2,"i"),B}function x(F,U,H){var B=yt(7);return B.write_shift(1,255),B.write_shift(2,U),B.write_shift(2,F),B.write_shift(2,H,"i"),B}function m(F,U,H){var B=c(F,U,H);return B[1].v=F.read_shift(8,"f"),B}function g(F,U,H){var B=yt(13);return B.write_shift(1,255),B.write_shift(2,U),B.write_shift(2,F),B.write_shift(8,H,"f"),B}function y(F,U,H){var B=F.l+U,Z=c(F,U,H);if(Z[1].v=F.read_shift(8,"f"),H.qpro)F.l=B;else{var de=F.read_shift(2);S(F.slice(F.l,F.l+de),Z),F.l+=de}return Z}function v(F,U,H){var B=U&32768;return U&=-32769,U=(B?F:0)+(U>=8192?U-16384:U),(B?"":"$")+(H?Et(U):Dt(U))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},p=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(F,U){Pt(F,0);for(var H=[],B=0,Z="",de="",le="",ie="";F.l<F.length;){var ae=F[F.l++];switch(ae){case 0:H.push(F.read_shift(8,"f"));break;case 1:de=v(U[0].c,F.read_shift(2),!0),Z=v(U[0].r,F.read_shift(2),!1),H.push(de+Z);break;case 2:{var z=v(U[0].c,F.read_shift(2),!0),A=v(U[0].r,F.read_shift(2),!1);de=v(U[0].c,F.read_shift(2),!0),Z=v(U[0].r,F.read_shift(2),!1),H.push(z+A+":"+de+Z)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(F.read_shift(2));break;case 6:{for(var ve="";ae=F[F.l++];)ve+=String.fromCharCode(ae);H.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ie=H.pop(),le=H.pop(),H.push(["AND","OR"][ae-20]+"("+le+","+ie+")");break;default:if(ae<32&&p[ae])ie=H.pop(),le=H.pop(),H.push(le+p[ae]+ie);else if(_[ae]){if(B=_[ae][1],B==69&&(B=F[F.l++]),B>H.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+H.join("|")+"|");return}var ye=H.slice(-B);H.length-=B,H.push(_[ae][0]+"("+ye.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}H.length==1?U[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function P(F){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=F.read_shift(2),U[3]=F[F.l++],U[0].c=F[F.l++],U}function C(F,U){var H=P(F);return H[1].t="s",H[1].v=F.read_shift(U-4,"cstr"),H}function E(F,U,H,B){var Z=yt(6+B.length);Z.write_shift(2,F),Z.write_shift(1,H),Z.write_shift(1,U),Z.write_shift(1,39);for(var de=0;de<B.length;++de){var le=B.charCodeAt(de);Z.write_shift(1,le>=128?95:le)}return Z.write_shift(1,0),Z}function w(F,U){var H=P(F);H[1].v=F.read_shift(2);var B=H[1].v>>1;if(H[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return H[1].v=B,H}function k(F,U){var H=P(F),B=F.read_shift(4),Z=F.read_shift(4),de=F.read_shift(2);if(de==65535)return B===0&&Z===3221225472?(H[1].t="e",H[1].v=15):B===0&&Z===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var le=de&32768;return de=(de&32767)-16446,H[1].v=(1-le*2)*(Z*Math.pow(2,de+32)+B*Math.pow(2,de)),H}function O(F,U,H,B){var Z=yt(14);if(Z.write_shift(2,F),Z.write_shift(1,H),Z.write_shift(1,U),B==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var de=0,le=0,ie=0,ae=0;return B<0&&(de=1,B=-B),le=Math.log2(B)|0,B/=Math.pow(2,le-31),ae=B>>>0,ae&2147483648||(B/=2,++le,ae=B>>>0),B-=ae,ae|=2147483648,ae>>>=0,B*=Math.pow(2,32),ie=B>>>0,Z.write_shift(4,ie),Z.write_shift(4,ae),le+=16383+(de?32768:0),Z.write_shift(2,le),Z}function j(F,U){var H=k(F);return F.l+=U-14,H}function L(F,U){var H=P(F),B=F.read_shift(4);return H[1].v=B>>6,H}function Q(F,U){var H=P(F),B=F.read_shift(8,"f");return H[1].v=B,H}function K(F,U){var H=Q(F);return F.l+=U-10,H}function re(F,U){return F[F.l+U-1]==0?F.read_shift(U,"cstr"):""}function fe(F,U){var H=F[F.l++];H>U-1&&(H=U-1);for(var B="";B.length<H;)B+=String.fromCharCode(F[F.l++]);return B}function te(F,U,H){if(!(!H.qpro||U<21)){var B=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var Z=F.read_shift(U-21,"cstr");return[B,Z]}}function ne(F,U){for(var H={},B=F.l+U;F.l<B;){var Z=F.read_shift(2);if(Z==14e3){for(H[Z]=[0,""],H[Z][0]=F.read_shift(2);F[F.l];)H[Z][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return H}function M(F,U){var H=yt(5+F.length);H.write_shift(2,14e3),H.write_shift(2,U);for(var B=0;B<F.length;++B){var Z=F.charCodeAt(B);H[H.l++]=Z>127?95:Z}return H[H.l++]=0,H}var oe={0:{n:"BOF",f:mt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function a4(e){var t={},r=e.match(Xt),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ae(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Af[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var s4=function(){var e=Xi("t"),t=Xi("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:ze(i[1])},l=s.match(t);return l&&(o.s=a4(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),i4=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),o4=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,l4=/<(?:\w+:)?r>/,c4=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Vf(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ze(Ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ze(e),r&&(n.h=If(n.t))):e.match(l4)&&(n.r=Ze(e),n.t=ze(Ze((e.replace(c4,"").match(o4)||[]).join("").replace(Xt,""))),r&&(n.h=i4(s4(n.r)))),n):{t:""}}var u4=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,f4=/<(?:\w+:)?(?:si|sstItem)>/g,d4=/<\/(?:\w+:)?(?:si|sstItem)>/;function h4(e,t){var r=[],n="";if(!e)return r;var a=e.match(u4);if(a){n=a[2].replace(f4,"").split(d4);for(var s=0;s!=n.length;++s){var i=Vf(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ae(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function p4(e){return[e.read_shift(4),e.read_shift(4)]}function x4(e,t){var r=[],n=!1;return Tn(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Tg(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function gn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function m4(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=gn(e,4),t.U=gn(e,4),t.W=gn(e,4),t}function g4(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function v4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(g4(e));return t}function _4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function y4(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=gn(e,4),t.U=gn(e,4),t.W=gn(e,4),t}function w4(e){var t=y4(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Sg(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Cg(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function k4(e){var t=gn(e);switch(t.Minor){case 2:return[t.Minor,E4(e)];case 3:return[t.Minor,T4()];case 4:return[t.Minor,S4(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function E4(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Sg(e,r),a=Cg(e,e.length-e.l);return{t:"Std",h:n,v:a}}function T4(){throw new Error("File is password-protected: ECMA-376 Extensible")}function S4(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Xt,function(s){var i=Ae(s);switch(an(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function C4(e,t){var r={},n=r.EncryptionVersionInfo=gn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Sg(e,a),t-=a,r.EncryptionVerifier=Cg(e,t),r}function A4(e){var t={},r=t.EncryptionVersionInfo=gn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function b4(e){var t=0,r,n=Tg(e),a=n.length+1,s,i,o,l,c;for(r=ea(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var Ag=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=Tg(i),l=s(o),c=o.length,u=ea(16),f=0;f!=16;++f)u[f]=0;var d,x,m;for((c&1)===1&&(d=l>>8,u[c]=a(e[0],d),--c,d=l&255,x=o[o.length-1],u[c]=a(x,d));c>0;)--c,d=l>>8,u[c]=a(o[c],d),--c,d=l&255,u[c]=a(o[c],d);for(c=15,m=15-o.length;m>0;)d=l>>8,u[c]=a(e[m],d),--c,--m,d=l&255,u[c]=a(o[c],d),--c,--m;return u}}(),F4=function(e,t,r,n,a){a||(a=t),n||(n=Ag(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},N4=function(e){var t=0,r=Ag(e);return function(n){var a=F4("",n,t,r);return t=a[1],a[0]}};function O4(e,t,r,n){var a={key:mt(e),verificationBytes:mt(e)};return r.password&&(a.verifier=b4(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=N4(r.password)),a}function P4(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=A4(e):n.Data=C4(e,t),n}function R4(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?P4(e,t-2,n):O4(e,r.biff>=8?t:t-2,r,n),n}var I4=function(){function e(a,s){switch(s.type){case"base64":return t(_r(a),s);case"binary":return t(a,s);case"buffer":return t(Be&&Buffer.isBuffer(a)?a.toString("binary"):ja(a),s);case"array":return t(Oa(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,x=0,m,g=-1;m=d.exec(u);){switch(m[0]){case"\\cell":var y=u.slice(x,d.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[f][g]=v:o[Ne({r:f,c:g})]=v}break}x=d.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=$e(c),o}function r(a,s){return oa(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=ft(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var f=Ne({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(kn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function D4(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ji(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function L4(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function j4(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Ul(e,t){if(t===0)return e;var r=L4(D4(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Ji(j4(r))}var bg=6,M4=15,B4=1,Qt=bg;function $l(e){return Math.floor((e+Math.round(128/Qt)/256)*Qt)}function Hl(e){return Math.floor((e-5)/Qt*100+.5)/100}function gu(e){return Math.round((e*Qt+5)/Qt*256)/256}function a0(e){return gu(Hl($l(e)))}function Wf(e){var t=Math.abs(e-a0(e)),r=Qt;if(t>.005)for(Qt=B4;Qt<M4;++Qt)Math.abs(e-a0(e))<=t&&(t=Math.abs(e-a0(e)),r=Qt);Qt=r}function Ps(e){e.width?(e.wpx=$l(e.width),e.wch=Hl(e.wpx),e.MDW=Qt):e.wpx?(e.wch=Hl(e.wpx),e.width=gu(e.wch),e.MDW=Qt):typeof e.wch=="number"&&(e.width=gu(e.wch),e.wpx=$l(e.width),e.MDW=Qt),e.customWidth&&delete e.customWidth}var U4=96,Fg=U4;function Ng(e){return e*96/Fg}function Qi(e){return e*Fg/96}var $4={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function H4(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Xt)||[]).forEach(function(i){var o=Ae(i);switch(an(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=rt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=rt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function z4(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Xt)||[]).forEach(function(i){var o=Ae(i);switch(an(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function V4(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Xt)||[]).forEach(function(i){var o=Ae(i);switch(an(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Ze(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?rt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?rt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?rt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?rt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?rt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?rt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?rt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Af[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=rt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Ta[a.color.index];a.color.index==81&&(l=Ta[1]),l||(l=Ta[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Ul(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function W4(e,t,r){t.NumberFmt=[];for(var n=nn(Re),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Re[n[a]];var s=e[0].match(Xt);if(s)for(a=0;a<s.length;++a){var i=Ae(s[a]);switch(an(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ze(Ze(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Ea(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Wo=["numFmtId","fillId","fontId","borderId","xfId"],Go=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function G4(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Xt)||[]).forEach(function(s){var i=Ae(s),o=0;switch(an(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Wo.length;++o)n[Wo[o]]&&(n[Wo[o]]=parseInt(n[Wo[o]],10));for(o=0;o<Go.length;++o)n[Go[o]]&&(n[Go[o]]=rt(n[Go[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=rt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var K4=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&W4(f,u,c),(f=o.match(a))&&V4(f,u,l,c),(f=o.match(n))&&z4(f,u,l,c),(f=o.match(s))&&H4(f,u,l,c),(f=o.match(r))&&G4(f,u,c),u}}();function X4(e,t){var r=e.read_shift(2),n=Wt(e);return[r,n]}function q4(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=sT(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=aT(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wt(e),n}var Y4=Kt;function J4(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var Q4=Kt;function Z4(e,t,r){var n={};n.NumberFmt=[];for(var a in Re)n.NumberFmt[a]=Re[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Tn(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Ea(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ul(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var e3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function t3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Xt)||[]).forEach(function(a){var s=Ae(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[e3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function r3(){}function n3(){}var a3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,s3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,i3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function o3(e,t,r){t.themeElements={};var n;[["clrScheme",a3,t3],["fontScheme",s3,r3],["fmtScheme",i3,n3]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var l3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Og(e,t){(!e||e.length===0)&&(e=c3());var r,n={};if(!(r=e.match(l3)))throw new Error("themeElements not found in theme");return o3(r[0],n,t),n.raw=e,n}function c3(e,t){var r=[Hm];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function u3(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=$m(s,{type:"array"})}catch{return}var o=pr(i,"theme/theme/theme1.xml",!0);if(o)return Og(o,r)}}function f3(e){return e.read_shift(4)}function d3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=h3(e,4);break;case 2:t.xclrValue=gg(e);break;case 3:t.xclrValue=f3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function h3(e,t){return Kt(e,t)}function p3(e,t){return Kt(e,t)}function x3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=d3(e);break;case 6:n[1]=p3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function m3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(x3(e,r-e.l));return{ixfe:n,ext:s}}function g3(e,t){t.forEach(function(r){switch(r[0]){}})}function v3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wt(e)}}function _3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function y3(e){return e.l+=4,e.read_shift(4)!=0}function w3(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return Tn(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function k3(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Xt,function(o){var l=Ae(o);switch(an(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function E3(e){var t=[];if(!e)return t;var r=1;return(e.match(Xt)||[]).forEach(function(n){var a=Ae(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function T3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ne(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function S3(e,t,r){var n=[];return Tn(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function C3(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Tn(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function A3(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function mp(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Zt(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=ft(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=$e(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function b3(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ae(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Zt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&Vf(f[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function F3(e,t){var r=[],n=!1,a={},s=0;return e.replace(Xt,function(o,l){var c=Ae(o);switch(an(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function N3(e,t){var r=[],n=!1;return e.replace(Xt,function(s){var i=Ae(s);switch(an(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function O3(e){var t={};t.iauthor=e.read_shift(4);var r=Ba(e);return t.rfx=r.s,t.ref=Ne(r.s),e.l+=16,t}var P3=Wt;function R3(e,t){var r=[],n=[],a={},s=!1;return Tn(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var I3="application/vnd.ms-office.vbaProject";function D3(e){var t=Ue.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ue.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ue.write(t)}function L3(){return{"!type":"dialog"}}function j3(){return{"!type":"dialog"}}function M3(){return{"!type":"macro"}}function B3(){return{"!type":"macro"}}var ys=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+Et(u)+(l?"":"$")+Dt(c)}return function(a,s){return t=s,a.replace(e,r)}}(),Pg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,U3=function(){return function(t,r){return t.replace(Pg,function(n,a,s,i,o,l){var c=Mf(i)-(s?0:r.c),u=jf(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return a+"R"+f+"C"+d})}}();function Rg(e,t){return e.replace(Pg,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Et(Mf(s)+t.c))+(i=="$"?i+o:Dt(jf(o)+t.r))})}function $3(e,t,r){var n=Bs(t),a=n.s,s=Zt(r),i={r:s.r-a.r,c:s.c-a.c};return Rg(e,i)}function H3(e){return e.length!=1}function gp(e){return e.replace(/_xlfn\./g,"")}function pt(e){e.l+=1}function ta(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Ig(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Dg(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=ta(e),o=ta(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Dg(e){var t=ta(e),r=ta(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function z3(e,t,r){if(r.biff<8)return Dg(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=ta(e),i=ta(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function Lg(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return V3(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ta(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function V3(e){var t=ta(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function W3(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function G3(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return K3(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function K3(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function X3(e,t,r){var n=(e[e.l++]&96)>>5,a=Ig(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function q3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Ig(e,s,r);return[n,a,i]}function Y3(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function J3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function Q3(e,t,r){var n=(e[e.l++]&96)>>5,a=z3(e,t-1,r);return[n,a]}function Z3(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function vp(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function eC(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function tC(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function rC(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function nC(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function aC(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function jg(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function sC(e){return e.read_shift(2),jg(e)}function iC(e){return e.read_shift(2),jg(e)}function oC(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Lg(e,0,r);return[n,a]}function lC(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=G3(e,0,r);return[n,a]}function cC(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Lg(e,0,r);return[n,a,s]}function uC(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[fA[a],Ug[a],n]}function fC(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:dC(e);return[a,(s[0]===0?Ug:uA)[s[1]]]}function dC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function hC(e,t,r){e.l+=r&&r.biff==2?3:4}function pC(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function xC(e){return e.l++,Ua[e.read_shift(1)]}function mC(e){return e.l++,e.read_shift(2)}function gC(e){return e.l++,e.read_shift(1)!==0}function vC(e){return e.l++,zt(e)}function _C(e,t,r){return e.l++,fo(e,t-1,r)}function yC(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=dt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ua[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=zt(e);break;case 2:r[1]=$a(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function wC(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Ba:hc)(e));return a}function kC(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=yC(e,r.biff);return i}function EC(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function TC(e,t,r){if(r.biff==5)return SC(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function SC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function CC(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function AC(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function bC(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function FC(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var NC=Kt,OC=Kt,PC=Kt;function po(e,t,r){return e.l+=2,[W3(e)]}function Gf(e){return e.l+=6,[]}var RC=po,IC=Gf,DC=Gf,LC=po;function Mg(e){return e.l+=2,[mt(e),e.read_shift(2)&1]}var jC=po,MC=Mg,BC=Gf,UC=po,$C=po,HC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zC(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=HC[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function VC(e){return e.l+=2,[e.read_shift(4)]}function WC(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function GC(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function KC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function XC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function qC(e){return e.l+=4,[0,0]}var _p={1:{n:"PtgExp",f:pC},2:{n:"PtgTbl",f:PC},3:{n:"PtgAdd",f:pt},4:{n:"PtgSub",f:pt},5:{n:"PtgMul",f:pt},6:{n:"PtgDiv",f:pt},7:{n:"PtgPower",f:pt},8:{n:"PtgConcat",f:pt},9:{n:"PtgLt",f:pt},10:{n:"PtgLe",f:pt},11:{n:"PtgEq",f:pt},12:{n:"PtgGe",f:pt},13:{n:"PtgGt",f:pt},14:{n:"PtgNe",f:pt},15:{n:"PtgIsect",f:pt},16:{n:"PtgUnion",f:pt},17:{n:"PtgRange",f:pt},18:{n:"PtgUplus",f:pt},19:{n:"PtgUminus",f:pt},20:{n:"PtgPercent",f:pt},21:{n:"PtgParen",f:pt},22:{n:"PtgMissArg",f:pt},23:{n:"PtgStr",f:_C},26:{n:"PtgSheet",f:WC},27:{n:"PtgEndSheet",f:GC},28:{n:"PtgErr",f:xC},29:{n:"PtgBool",f:gC},30:{n:"PtgInt",f:mC},31:{n:"PtgNum",f:vC},32:{n:"PtgArray",f:Z3},33:{n:"PtgFunc",f:uC},34:{n:"PtgFuncVar",f:fC},35:{n:"PtgName",f:EC},36:{n:"PtgRef",f:oC},37:{n:"PtgArea",f:X3},38:{n:"PtgMemArea",f:CC},39:{n:"PtgMemErr",f:NC},40:{n:"PtgMemNoMem",f:OC},41:{n:"PtgMemFunc",f:AC},42:{n:"PtgRefErr",f:bC},43:{n:"PtgAreaErr",f:Y3},44:{n:"PtgRefN",f:lC},45:{n:"PtgAreaN",f:Q3},46:{n:"PtgMemAreaN",f:KC},47:{n:"PtgMemNoMemN",f:XC},57:{n:"PtgNameX",f:TC},58:{n:"PtgRef3d",f:cC},59:{n:"PtgArea3d",f:q3},60:{n:"PtgRefErr3d",f:FC},61:{n:"PtgAreaErr3d",f:J3},255:{}},YC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JC={1:{n:"PtgElfLel",f:Mg},2:{n:"PtgElfRw",f:UC},3:{n:"PtgElfCol",f:RC},6:{n:"PtgElfRwV",f:$C},7:{n:"PtgElfColV",f:LC},10:{n:"PtgElfRadical",f:jC},11:{n:"PtgElfRadicalS",f:BC},13:{n:"PtgElfColS",f:IC},15:{n:"PtgElfColSV",f:DC},16:{n:"PtgElfRadicalLel",f:MC},25:{n:"PtgList",f:zC},29:{n:"PtgSxName",f:VC},255:{}},QC={0:{n:"PtgAttrNoop",f:qC},1:{n:"PtgAttrSemi",f:aC},2:{n:"PtgAttrIf",f:rC},4:{n:"PtgAttrChoose",f:eC},8:{n:"PtgAttrGoto",f:tC},16:{n:"PtgAttrSum",f:hC},32:{n:"PtgAttrBaxcel",f:vp},33:{n:"PtgAttrBaxcel",f:vp},64:{n:"PtgAttrSpace",f:sC},65:{n:"PtgAttrSpaceSemi",f:iC},128:{n:"PtgAttrIfError",f:nC},255:{}};function xo(e,t,r,n){if(n.biff<8)return Kt(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=kC(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=wC(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Kt(e,t)),s}function mo(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=_p[s]||_p[YC[s]],(s===24||s===25)&&(a=(s===24?JC:QC)[e[e.l+1]]),!a||!a.f?Kt(e,t):i.push([a.n,a.f(e,t,r)]);return i}function ZC(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var eA={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tA(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Bg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function yp(e,t,r){var n=Bg(e,t,r);return n=="#REF"?n:tA(n,r)}function $t(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,d=0,x,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",v=0,_=e[0].length;v<_;++v){var p=e[0][v];switch(p[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=ut(" ",e[0][g][1][1]);break;case 1:y=ut("\r",e[0][g][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+y,g=-1}o.push(c+eA[p[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=wi(p[1][1],i,a),o.push(ki(u,s));break;case"PtgRefN":u=r?wi(p[1][1],r,a):p[1][1],o.push(ki(u,s));break;case"PtgRef3d":f=p[1][1],u=wi(p[1][2],i,a),m=yp(n,f,a),o.push(m+"!"+ki(u,s));break;case"PtgFunc":case"PtgFuncVar":var S=p[1][0],P=p[1][1];S||(S=0),S&=127;var C=S==0?[]:o.slice(-S);o.length-=S,P==="User"&&(P=C.shift()),o.push(P+"("+C.join(",")+")");break;case"PtgBool":o.push(p[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(p[1]);break;case"PtgNum":o.push(String(p[1]));break;case"PtgStr":o.push('"'+p[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(p[1]);break;case"PtgAreaN":x=ep(p[1][1],r?{s:r}:i,a),o.push(r0(x,a));break;case"PtgArea":x=ep(p[1][1],i,a),o.push(r0(x,a));break;case"PtgArea3d":f=p[1][1],x=p[1][2],m=yp(n,f,a),o.push(m+"!"+r0(x,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=p[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],w=E?E.Name:"SH33TJSNAME"+String(d);w&&w.slice(0,6)=="_xlfn."&&!a.xlfn&&(w=w.slice(6)),o.push(w);break;case"PtgNameX":var k=p[1][1];d=p[1][2];var O;if(a.biff<=5)k<0&&(k=-k),n[k]&&(O=n[k][d]);else{var j="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][d]&&n[k][d].itab>0&&(j=n.SheetNames[n[k][d].itab-1]+"!"):j=n.SheetNames[d-1]+"!"),n[k]&&n[k][d])j+=n[k][d].Name;else if(n[0]&&n[0][d])j+=n[0][d].Name;else{var L=(Bg(n,k,a)||"").split(";;");L[d-1]?j=L[d-1]:j+="SH33TJSERRX"}o.push(j);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var Q="(",K=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:Q=ut(" ",e[0][g][1][1])+Q;break;case 3:Q=ut("\r",e[0][g][1][1])+Q;break;case 4:K=ut(" ",e[0][g][1][1])+K;break;case 5:K=ut("\r",e[0][g][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(Q+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:p[1][1],r:p[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[Ne(u)]){var fe=n.sharedf[Ne(u)];o.push($t(fe,i,re,n,a))}else{var te=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push($t(c[1],i,re,n,a)),te=!0;break}te||o.push(p[1])}break;case"PtgArray":o.push("{"+ZC(p[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+p[1].idx+"[#"+p[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(p));default:throw new Error("Unrecognized Formula Token: "+String(p))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&ne.indexOf(e[0][v][0])==-1){p=e[0][g];var M=!0;switch(p[1][0]){case 4:M=!1;case 0:y=ut(" ",p[1][1]);break;case 5:M=!1;case 1:y=ut("\r",p[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+p[1][0])}o.push((M?y:"")+o.pop()+(M?"":y)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function rA(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Kt(e,t-2)];var o=mo(e,i,r);return t!==i+a&&(s=xo(e,t-i-a,o,r)),e.l=n,[o,s]}function nA(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Kt(e,t-2)];var o=mo(e,i,r);return t!==i+a&&(s=xo(e,t-i-a,o,r)),e.l=n,[o,s]}function aA(e,t,r,n){var a=e.l+t,s=mo(e,n,r),i;return a!==e.l&&(i=xo(e,a-e.l,s,r)),[s,i]}function sA(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=mo(e,s,r);return s==65535?[[],Kt(e,t-2)]:(t!==s+2&&(a=xo(e,n-s-2,i,r)),[i,a])}function iA(e){var t;if(pn(e,e.l+6)!==65535)return[zt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function s0(e,t,r){var n=e.l+t,a=sn(e);r.biff==2&&++e.l;var s=iA(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=nA(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function pc(e,t,r){var n=e.read_shift(4),a=mo(e,n,r),s=e.read_shift(4),i=s>0?xo(e,s,a,r):null;return[a,i]}var oA=pc,xc=pc,lA=pc,cA=pc,uA={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ug={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},fA={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wp(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function i0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Ci={},ws={};function Ai(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $g(e,t,r,n,a,s){try{n.cellNF&&(e.z=Re[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ft(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Re[t]==null&&Ea(dE[t]||"General",t),e.t==="e")e.w=e.w||Ua[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ki(e.v);else if(e.t==="d"){var i=rr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Ki(i)}else{if(e.v===void 0)return"";e.w=Na(e.v,ws)}else e.t==="d"?e.w=Or(t,rr(e.v),ws):e.w=Or(t,e.v,ws)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ul(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ul(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function dA(e,t){var r=ft(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=$e(r))}var hA=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pA=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xA=/<(?:\w:)?hyperlink [^>]*>/mg,mA=/"(\w*:\w*)"/,gA=/<(?:\w:)?col\b[^>]*[\/]?>/g,vA=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_A=/<(?:\w:)?pageMargins[^>]*\/>/g,Hg=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yA=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,wA=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kA(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(pA);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var d=c.match(Hg);d?Kf(d[0],o,a,r):(d=c.match(yA))&&EA(d[0],d[1]||"",o,a,r);var x=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var m=c.slice(x,x+50).match(mA);m&&dA(o,m[1])}var g=c.match(wA);g&&g[1]&&FA(g[1],a);var y=[];if(t.cellStyles){var v=c.match(gA);v&&CA(y,v)}f&&NA(f[1],o,t,l,s,i);var _=u.match(vA);_&&(o["!autofilter"]=AA(_[0]));var p=[],S=u.match(hA);if(S)for(x=0;x!=S.length;++x)p[x]=ft(S[x].slice(S[x].indexOf('"')+1));var P=u.match(xA);P&&TA(o,P,n);var C=u.match(_A);if(C&&(o["!margins"]=SA(Ae(C[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=$e(l)),t.sheetRows>0&&o["!ref"]){var E=ft(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=$e(E))}return y.length>0&&(o["!cols"]=y),p.length>0&&(o["!merges"]=p),o}function Kf(e,t,r,n){var a=Ae(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ze(Ze(a.codeName)))}function EA(e,t,r,n,a){Kf(e.slice(0,e.indexOf(">")),r,n,a)}function TA(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ae(Ze(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+ze(s.location))):(s.Target="#"+ze(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ft(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ne({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function SA(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function CA(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ae(t[n],!0);a.hidden&&(a.hidden=rt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Wf(a.width)),Ps(a);s<=i;)e[s++]=It(a)}}function AA(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var bA=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FA(e,t){t.Views||(t.Views=[{}]),(e.match(bA)||[]).forEach(function(r,n){var a=Ae(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),rt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var NA=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Xi("v"),i=Xi("f");return function(l,c,u,f,d,x){for(var m=0,g="",y=[],v=[],_=0,p=0,S=0,P="",C,E,w=0,k=0,O,j,L=0,Q=0,K=Array.isArray(x.CellXf),re,fe=[],te=[],ne=Array.isArray(c),M=[],oe={},se=!1,F=!!u.sheetStubs,U=l.split(t),H=0,B=U.length;H!=B;++H){g=U[H].trim();var Z=g.length;if(Z!==0){var de=0;e:for(m=0;m<Z;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(E=Ae(g.slice(de,m),!0),w=E.r!=null?parseInt(E.r,10):w+1,k=-1,u.sheetRows&&u.sheetRows<w)continue;oe={},se=!1,E.ht&&(se=!0,oe.hpt=parseFloat(E.ht),oe.hpx=Qi(oe.hpt)),E.hidden=="1"&&(se=!0,oe.hidden=!0),E.outlineLevel!=null&&(se=!0,oe.level=+E.outlineLevel),se&&(M[w-1]=oe)}break;case"<":de=m;break}if(de>=m)break;if(E=Ae(g.slice(de,m),!0),w=E.r!=null?parseInt(E.r,10):w+1,k=-1,!(u.sheetRows&&u.sheetRows<w)){f.s.r>w-1&&(f.s.r=w-1),f.e.r<w-1&&(f.e.r=w-1),u&&u.cellStyles&&(oe={},se=!1,E.ht&&(se=!0,oe.hpt=parseFloat(E.ht),oe.hpx=Qi(oe.hpt)),E.hidden=="1"&&(se=!0,oe.hidden=!0),E.outlineLevel!=null&&(se=!0,oe.level=+E.outlineLevel),se&&(M[w-1]=oe)),y=g.slice(m).split(e);for(var le=0;le!=y.length&&y[le].trim().charAt(0)=="<";++le);for(y=y.slice(le),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(v=g.match(r),_=m,p=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(_=0,P=v[1],p=0;p!=P.length&&!((S=P.charCodeAt(p)-64)<1||S>26);++p)_=26*_+S;--_,k=_}else++k;for(p=0;p!=g.length&&g.charCodeAt(p)!==62;++p);if(++p,E=Ae(g.slice(0,p),!0),E.r||(E.r=Ne({r:w-1,c:k})),P=g.slice(p),C={t:""},(v=P.match(s))!=null&&v[1]!==""&&(C.v=ze(v[1])),u.cellFormula){if((v=P.match(i))!=null&&v[1]!==""){if(C.f=ze(Ze(v[1])).replace(/\r\n/g,`
`),u.xlfn||(C.f=gp(C.f)),v[0].indexOf('t="array"')>-1)C.F=(P.match(a)||[])[1],C.F.indexOf(":")>-1&&fe.push([ft(C.F),C.F]);else if(v[0].indexOf('t="shared"')>-1){j=Ae(v[0]);var ie=ze(Ze(v[1]));u.xlfn||(ie=gp(ie)),te[parseInt(j.si,10)]=[j,ie,E.r]}}else(v=P.match(/<f[^>]*\/>/))&&(j=Ae(v[0]),te[j.si]&&(C.f=$3(te[j.si][1],te[j.si][2],E.r)));var ae=Zt(E.r);for(p=0;p<fe.length;++p)ae.r>=fe[p][0].s.r&&ae.r<=fe[p][0].e.r&&ae.c>=fe[p][0].s.c&&ae.c<=fe[p][0].e.c&&(C.F=fe[p][1])}if(E.t==null&&C.v===void 0)if(C.f||C.F)C.v=0,C.t="n";else if(F)C.t="z";else continue;else C.t=E.t||"n";switch(f.s.c>k&&(f.s.c=k),f.e.c<k&&(f.e.c=k),C.t){case"n":if(C.v==""||C.v==null){if(!F)continue;C.t="z"}else C.v=parseFloat(C.v);break;case"s":if(typeof C.v>"u"){if(!F)continue;C.t="z"}else O=Ci[parseInt(C.v,10)],C.v=O.t,C.r=O.r,u.cellHTML&&(C.h=O.h);break;case"str":C.t="s",C.v=C.v!=null?Ze(C.v):"",u.cellHTML&&(C.h=If(C.v));break;case"inlineStr":v=P.match(n),C.t="s",v!=null&&(O=Vf(v[1]))?(C.v=O.t,u.cellHTML&&(C.h=O.h)):C.v="";break;case"b":C.v=rt(C.v);break;case"d":u.cellDates?C.v=Ft(C.v,1):(C.v=rr(Ft(C.v,1)),C.t="n");break;case"e":(!u||u.cellText!==!1)&&(C.w=C.v),C.v=cg[C.v];break}if(L=Q=0,re=null,K&&E.s!==void 0&&(re=x.CellXf[E.s],re!=null&&(re.numFmtId!=null&&(L=re.numFmtId),u.cellStyles&&re.fillId!=null&&(Q=re.fillId))),$g(C,L,Q,u,d,x),u.cellDates&&K&&C.t=="n"&&Ms(Re[L])&&(C.t="d",C.v=dc(C.v)),E.cm&&u.xlmeta){var z=(u.xlmeta.Cell||[])[+E.cm-1];z&&z.type=="XLDAPR"&&(C.D=!0)}if(ne){var A=Zt(E.r);c[A.r]||(c[A.r]=[]),c[A.r][A.c]=C}else c[E.r]=C}}}}M.length>0&&(c["!rows"]=M)}}();function OA(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var PA=Ba;function RA(){}function IA(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=rT(e),r}function DA(e){var t=Pr(e);return[t]}function LA(e){var t=Ma(e);return[t]}function jA(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"b"]}function MA(e){var t=Ma(e),r=e.read_shift(1);return[t,r,"b"]}function BA(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"e"]}function UA(e){var t=Ma(e),r=e.read_shift(1);return[t,r,"e"]}function $A(e){var t=Pr(e),r=e.read_shift(4);return[t,r,"s"]}function HA(e){var t=Ma(e),r=e.read_shift(4);return[t,r,"s"]}function zA(e){var t=Pr(e),r=zt(e);return[t,r,"n"]}function zg(e){var t=Ma(e),r=zt(e);return[t,r,"n"]}function VA(e){var t=Pr(e),r=$f(e);return[t,r,"n"]}function WA(e){var t=Ma(e),r=$f(e);return[t,r,"n"]}function GA(e){var t=Pr(e),r=Bf(e);return[t,r,"is"]}function KA(e){var t=Pr(e),r=Wt(e);return[t,r,"str"]}function XA(e){var t=Ma(e),r=Wt(e);return[t,r,"str"]}function qA(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=xc(e,n-e.l,r);i[3]=$t(o,null,a,r.supbooks,r)}else e.l=n;return i}function YA(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=xc(e,n-e.l,r);i[3]=$t(o,null,a,r.supbooks,r)}else e.l=n;return i}function JA(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=zt(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=xc(e,n-e.l,r);i[3]=$t(o,null,a,r.supbooks,r)}else e.l=n;return i}function QA(e,t,r){var n=e.l+t,a=Pr(e);a.r=r["!row"];var s=Wt(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=xc(e,n-e.l,r);i[3]=$t(o,null,a,r.supbooks,r)}else e.l=n;return i}var ZA=Ba;function eb(e,t){var r=e.l+t,n=Ba(e),a=Uf(e),s=Wt(e),i=Wt(e),o=Wt(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function tb(){}function rb(e,t,r){var n=e.l+t,a=ig(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=oA(e,n-e.l,r);i[1]=o}else e.l=n;return i}function nb(e,t,r){var n=e.l+t,a=Ba(e),s=[a];if(r.cellFormula){var i=cA(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var ab=["left","right","top","bottom","header","footer"];function sb(e){var t={};return ab.forEach(function(r){t[r]=zt(e)}),t}function ib(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ob(){}function lb(){}function cb(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,d=!1,x,m,g,y,v,_,p,S,P,C=[];o.biff=12,o["!row"]=0;var E=0,w=!1,k=[],O={},j=o.supbooks||a.supbooks||[[]];if(j.sharedf=O,j.arrayf=k,j.SheetNames=a.SheetNames||a.Sheets.map(function(ne){return ne.name}),!o.supbooks&&(o.supbooks=j,a.Names))for(var L=0;L<a.Names.length;++L)j[0][L+1]=a.Names[L];var Q=[],K=[],re=!1;zl[16]={n:"BrtShortReal",f:zg};var fe;if(Tn(e,function(M,oe,se){if(!d)switch(se){case 148:c=M;break;case 0:x=M,o.sheetRows&&o.sheetRows<=x.r&&(d=!0),S=Dt(y=x.r),o["!row"]=x.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Qi(M.hpt)),K[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:M[2]},M[2]){case"n":m.v=M[1];break;case"s":p=Ci[M[1]],m.v=p.t,m.r=p.r;break;case"b":m.v=!!M[1];break;case"e":m.v=M[1],o.cellText!==!1&&(m.w=Ua[m.v]);break;case"str":m.t="s",m.v=M[1];break;case"is":m.t="s",m.v=M[1].t;break}if((g=i.CellXf[M[0].iStyleRef])&&$g(m,g.numFmtId,null,o,s,i),v=M[0].c==-1?v+1:M[0].c,o.dense?(l[y]||(l[y]=[]),l[y][v]=m):l[Et(v)+S]=m,o.cellFormula){for(w=!1,E=0;E<k.length;++E){var F=k[E];x.r>=F[0].s.r&&x.r<=F[0].e.r&&v>=F[0].s.c&&v<=F[0].e.c&&(m.F=$e(F[0]),w=!0)}!w&&M.length>3&&(m.f=M[3])}if(u.s.r>x.r&&(u.s.r=x.r),u.s.c>v&&(u.s.c=v),u.e.r<x.r&&(u.e.r=x.r),u.e.c<v&&(u.e.c=v),o.cellDates&&g&&m.t=="n"&&Ms(Re[g.numFmtId])){var U=ya(m.v);U&&(m.t="d",m.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}fe&&(fe.type=="XLDAPR"&&(m.D=!0),fe=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},v=M[0].c==-1?v+1:M[0].c,o.dense?(l[y]||(l[y]=[]),l[y][v]=m):l[Et(v)+S]=m,u.s.r>x.r&&(u.s.r=x.r),u.s.c>v&&(u.s.c=v),u.e.r<x.r&&(u.e.r=x.r),u.e.c<v&&(u.e.c=v),fe&&(fe.type=="XLDAPR"&&(m.D=!0),fe=void 0);break;case 176:C.push(M);break;case 49:fe=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var H=n["!id"][M.relId];for(H?(M.Target=H.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=H):M.relId==""&&(M.Target="#"+M.loc),y=M.rfx.s.r;y<=M.rfx.e.r;++y)for(v=M.rfx.s.c;v<=M.rfx.e.c;++v)o.dense?(l[y]||(l[y]=[]),l[y][v]||(l[y][v]={t:"z",v:void 0}),l[y][v].l=M):(_=Ne({c:v,r:y}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=M);break;case 426:if(!o.cellFormula)break;k.push(M),P=o.dense?l[y][v]:l[Et(v)+S],P.f=$t(M[1],u,{r:x.r,c:v},j,o),P.F=$e(M[0]);break;case 427:if(!o.cellFormula)break;O[Ne(M[0].s)]=M[1],P=o.dense?l[y][v]:l[Et(v)+S],P.f=$t(M[1],u,{r:x.r,c:v},j,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)Q[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},re||(re=!0,Wf(M.w/256)),Ps(Q[M.e+1]);break;case 161:l["!autofilter"]={ref:$e(M)};break;case 476:l["!margins"]=M;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),M.name&&(a.Sheets[r].CodeName=M.name),(M.above||M.left)&&(l["!outline"]={above:M.above,left:M.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),M.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!oe.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=$e(c||u)),o.sheetRows&&l["!ref"]){var te=ft(l["!ref"]);o.sheetRows<=+te.e.r&&(te.e.r=o.sheetRows-1,te.e.r>u.e.r&&(te.e.r=u.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>u.e.c&&(te.e.c=u.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),l["!fullref"]=l["!ref"],l["!ref"]=$e(te))}return C.length>0&&(l["!merges"]=C),Q.length>0&&(l["!cols"]=Q),K.length>0&&(l["!rows"]=K),l}function ub(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function fb(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=ub(f);u.s.r=u.s.c=0,u.e.c=o,c=Et(o),d[0].forEach(function(x,m){i[c+Dt(m)]={t:"n",v:x,z:d[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=$e(u)),i}function db(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(Hg);return o&&Kf(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function hb(e,t){e.l+=10;var r=Wt(e);return{name:r}}function pb(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Tn(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Vg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xb=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],mb=[],gb=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kp(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=rt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Ep(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=rt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Wg(e){Ep(e.WBProps,Vg),Ep(e.CalcPr,gb),kp(e.WBView,xb),kp(e.Sheets,mb),ws.date1904=rt(e.WBProps.date1904)}var vb="][*?/\\".split("");function _b(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return vb.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var yb=/<\w+:workbook/;function wb(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Xt,function(l,c){var u=Ae(l);switch(an(u[0])){case"<?xml":break;case"<workbook":l.match(yb)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vg.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=rt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Ze(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ze(Ze(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ze(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),rt(u.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=ze(Ze(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),BE.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Wg(r),r}function kb(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pu(e),r.name=Wt(e),r}function Eb(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Wt(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Tb(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Sb(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=nT(e),i=lA(e,0,r),o=Uf(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function Cb(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],zl[16]={n:"BrtFRTArchID$",f:Tb},Tn(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=$t(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),Wg(r),r.Names=s,r.supbooks=i,r}function Ab(e,t,r){return t.slice(-4)===".bin"?Cb(e,r):wb(e,r)}function bb(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?cb(e,n,r,a,s,i,o):kA(e,n,r,a,s,i,o)}function Fb(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?pb(e,n,r,a,s):db(e,n,r,a,s)}function Nb(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?M3():B3()}function Ob(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?L3():j3()}function Pb(e,t,r,n){return t.slice(-4)===".bin"?Z4(e,r,n):K4(e,r,n)}function Rb(e,t,r){return Og(e,r)}function Ib(e,t,r){return t.slice(-4)===".bin"?x4(e,r):h4(e,r)}function Db(e,t,r){return t.slice(-4)===".bin"?R3(e,r):b3(e,r)}function Lb(e,t,r){return t.slice(-4)===".bin"?S3(e):E3(e)}function jb(e,t,r,n){return r.slice(-4)===".bin"?C3(e,t,r,n):void 0}function Mb(e,t,r){return t.slice(-4)===".bin"?w3(e,t,r):k3(e,t,r)}var Gg=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Kg=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Dr(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Gg),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(Kg),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function Bb(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Gg),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(Kg),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var bi;function Ub(e,t){var r=bi[e]||ze(e);return r==="General"?Na(t):Or(r,t)}function $b(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=rt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ft(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ze(t)]=a}function Hb(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ua[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ki(e.v):e.w=Na(e.v):e.w=Ub(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=bi[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ms(n)){var a=ya(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function zb(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=$4[n.Pattern]||n.Pattern)}e[t.ID]=t}function Vb(e,t,r,n,a,s,i,o,l,c){var u="General",f=n.StyleID,d={};c=c||{};var x=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&x.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=rt(e);break;case"String":n.t="s",n.r=Wh(ze(e)),n.v=e.indexOf("<")>-1?ze(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ft(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ze(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=cg[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Wh(t||e));break}if(Hb(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=ze(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=ys(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ys("RC:RC",a):n.ArrayRange&&(n.F=ys(n.ArrayRange,a),l.push([ft(n.F),n.F]))}else for(m=0;m<l.length;++m)a.r>=l[m][0].s.r&&a.r<=l[m][0].e.r&&a.c>=l[m][0].s.c&&a.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(x.forEach(function(y){!d.patternType&&y.patternType&&(d.patternType=y.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Wb(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function o0(e,t){var r=t||{};Dm();var n=ai(Df(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ze(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=It(r);return i.type="string",Yi.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ue){a.indexOf("<"+ue)>=0&&(s=!0)}),s)return eF(n,r);bi={"General Number":"General","General Date":Re[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Re[15],"Short Date":Re[14],"Long Time":Re[19],"Medium Time":Re[18],"Short Time":Re[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Re[2],Standard:Re[4],Percent:Re[10],Scientific:Re[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],d=r.dense?[]:{},x="",m={},g={},y=Dr('<Data ss:Type="String">'),v=0,_=0,p=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},C={},E="",w=0,k=[],O={},j={},L=0,Q=[],K=[],re={},fe=[],te,ne=!1,M=[],oe=[],se={},F=0,U=0,H={Sheets:[],WBProps:{date1904:!1}},B={};qi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";o=qi.exec(n);)switch(o[3]=(Z=o[3]).toLowerCase()){case"data":if(Z=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?Vb(n.slice(v,o.index),E,y,l[l.length-1][0]=="comment"?re:m,{c:_,r:p},P,fe[_],g,M,r):(E="",y=Dr(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(K.length>0&&(m.c=K),(!r.sheetRows||r.sheetRows>p)&&m.v!==void 0&&(r.dense?(d[p]||(d[p]=[]),d[p][_]=m):d[Et(_)+Dt(p)]=m),m.HRef&&(m.l={Target:ze(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(F=_+(parseInt(m.MergeAcross,10)|0),U=p+(parseInt(m.MergeDown,10)|0),k.push({s:{c:_,r:p},e:{c:F,r:U}})),!r.sheetStubs)m.MergeAcross?_=F+1:++_;else if(m.MergeAcross||m.MergeDown){for(var de=_;de<=F;++de)for(var le=p;le<=U;++le)(de>_||le>p)&&(r.dense?(d[le]||(d[le]=[]),d[le][de]={t:"z"}):d[Et(de)+Dt(le)]={t:"z"});_=F+1}else++_;else m=Bb(o[0]),m.Index&&(_=+m.Index-1),_<S.s.c&&(S.s.c=_),_>S.e.c&&(S.e.c=_),o[0].slice(-2)==="/>"&&++_,K=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(p<S.s.r&&(S.s.r=p),p>S.e.r&&(S.e.r=p),o[0].slice(-2)==="/>"&&(g=Dr(o[0]),g.Index&&(p=+g.Index-1)),_=0,++p):(g=Dr(o[0]),g.Index&&(p=+g.Index-1),se={},(g.AutoFitHeight=="0"||g.Height)&&(se.hpx=parseInt(g.Height,10),se.hpt=Ng(se.hpx),oe[p]=se),g.Hidden=="1"&&(se.hidden=!0,oe[p]=se));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(x),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(d["!ref"]=$e(S),r.sheetRows&&r.sheetRows<=S.e.r&&(d["!fullref"]=d["!ref"],S.e.r=r.sheetRows-1,d["!ref"]=$e(S))),k.length&&(d["!merges"]=k),fe.length>0&&(d["!cols"]=fe),oe.length>0&&(d["!rows"]=oe),u[x]=d}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=_=0,l.push([o[3],!1]),c=Dr(o[0]),x=ze(c.Name),d=r.dense?[]:{},k=[],M=[],oe=[],B={name:x,Hidden:0},H.Sheets.push(B);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),fe=[],ne=!1}break;case"style":o[1]==="/"?zb(P,C,r):C=Dr(o[0]);break;case"numberformat":C.nf=ze(Dr(o[0]).Format||"General"),bi[C.nf]&&(C.nf=bi[C.nf]);for(var ie=0;ie!=392&&Re[ie]!=C.nf;++ie);if(ie==392){for(ie=57;ie!=392;++ie)if(Re[ie]==null){Ea(C.nf,ie);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(te=Dr(o[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!ne&&te.wpx>10){ne=!0,Qt=bg;for(var ae=0;ae<fe.length;++ae)fe[ae]&&Ps(fe[ae])}ne&&Ps(te),fe[te.Index-1||fe.length]=te;for(var z=0;z<+te.Span;++z)fe[fe.length]=It(te);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var A=Ae(o[0]),ve={Name:A.Name,Ref:ys(A.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(ve.Sheet=H.Sheets.length-1),H.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(w,o.index):w=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;C.Interior=Dr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?bT(O,Z,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));Wb(re),K.push(re)}else l.push([o[3],!1]),c=Dr(o[0]),re={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ye=Dr(o[0]);d["!autofilter"]={ref:ys(ye.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Fp(n,r);var Y=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Y=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Y=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Y=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Y=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else L=o.index+o[0].length;break;case"header":d["!margins"]||Ai(d["!margins"]={},"xlml"),isNaN(+Ae(o[0]).Margin)||(d["!margins"].header=+Ae(o[0]).Margin);break;case"footer":d["!margins"]||Ai(d["!margins"]={},"xlml"),isNaN(+Ae(o[0]).Margin)||(d["!margins"].footer=+Ae(o[0]).Margin);break;case"pagemargins":var V=Ae(o[0]);d["!margins"]||Ai(d["!margins"]={},"xlml"),isNaN(+V.Top)||(d["!margins"].top=+V.Top),isNaN(+V.Left)||(d["!margins"].left=+V.Left),isNaN(+V.Right)||(d["!margins"].right=+V.Right),isNaN(+V.Bottom)||(d["!margins"].bottom=+V.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Y=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Y=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Y=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Y=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Y=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Y=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Y=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Y=!1}break;case"smarttags":break;default:Y=!1;break}if(Y||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$b(j,Z,Q,n.slice(L,o.index)):(Q=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var X={};return!r.bookSheets&&!r.bookProps&&(X.Sheets=u),X.SheetNames=f,X.Workbook=H,X.SSF=It(Re),X.Props=O,X.Custprops=j,X}function vu(e,t){switch(Yf(t=t||{}),t.type||"base64"){case"base64":return o0(_r(e),t);case"binary":case"buffer":case"file":return o0(e,t);case"array":return o0(ja(e),t)}}function Gb(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=iT(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=oT(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Kb=[60,1084,2066,2165,2175];function Xb(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=pn(r,r.l),c=_u[l],u=0;c!=null&&Kb.indexOf(l)>-1;)s=pn(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),i.push(o),r.l+=4+s,c=_u[l=pn(r,r.l)];var f=Mn(i);Pt(f,0);var d=0;f.lens=[];for(var x=0;x<i.length;++x)f.lens.push(d),d+=i[x].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Yr(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Re[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ua[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ki(e.v):e.w=Na(e.v):e.w=Or(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Ms(Re[n]||String(n))){var a=ya(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Ko(e,t,r){return{v:e,ixfe:t,t:r}}function qb(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",u={},f,d="",x,m,g,y,v={},_=[],p,S,P=[],C=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},w={},k=function(Fe){return Fe<8?Ta[Fe]:Fe<64&&C[Fe-8]||Ta[Fe]},O=function(Fe,we,Ke){var Ie=we.XF.data;if(!(!Ie||!Ie.patternType||!Ke||!Ke.cellStyles)){we.s={},we.s.patternType=Ie.patternType;var St;(St=Ji(k(Ie.icvFore)))&&(we.s.fgColor={rgb:St}),(St=Ji(k(Ie.icvBack)))&&(we.s.bgColor={rgb:St})}},j=function(Fe,we,Ke){if(!(se>1)&&!(Ke.sheetRows&&Fe.r>=Ke.sheetRows)){if(Ke.cellStyles&&we.XF&&we.XF.data&&O(Fe,we,Ke),delete we.ixfe,delete we.XF,f=Fe,d=Ne(Fe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<i.s.r&&(i.s.r=Fe.r),Fe.c<i.s.c&&(i.s.c=Fe.c),Fe.r+1>i.e.r&&(i.e.r=Fe.r+1),Fe.c+1>i.e.c&&(i.e.c=Fe.c+1),Ke.cellFormula&&we.f){for(var Ie=0;Ie<_.length;++Ie)if(!(_[Ie][0].s.c>Fe.c||_[Ie][0].s.r>Fe.r)&&!(_[Ie][0].e.c<Fe.c||_[Ie][0].e.r<Fe.r)){we.F=$e(_[Ie][0]),(_[Ie][0].s.c!=Fe.c||_[Ie][0].s.r!=Fe.r)&&delete we.f,we.f&&(we.f=""+$t(_[Ie][1],i,Fe,M,L));break}}Ke.dense?(a[Fe.r]||(a[Fe.r]=[]),a[Fe.r][Fe.c]=we):a[d]=we}},L={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var Q,K=[],re=[],fe=[],te=[],ne=!1,M=[];M.SheetNames=L.snames,M.sharedf=L.sharedf,M.arrayf=L.arrayf,M.names=[],M.XTI=[];var oe=0,se=0,F=0,U=[],H=[],B;L.codepage=1200,zr(1200);for(var Z=!1;e.l<e.length-1;){var de=e.l,le=e.read_shift(2);if(le===0&&oe===10)break;var ie=e.l===e.length?0:e.read_shift(2),ae=_u[le];if(ae&&ae.f){if(t.bookSheets&&oe===133&&le!==133)break;if(oe=le,ae.r===2||ae.r==12){var z=e.read_shift(2);if(ie-=2,!L.enc&&z!==le&&((z&255)<<8|z>>8)!==le)throw new Error("rt mismatch: "+z+"!="+le);ae.r==12&&(e.l+=10,ie-=10)}var A={};if(le===10?A=ae.f(e,ie,L):A=Xb(le,ae,e,ie,L),se==0&&[9,521,1033,2057].indexOf(oe)===-1)continue;switch(le){case 34:r.opts.Date1904=E.WBProps.date1904=A;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=A,!t.password)throw new Error("File is password-protected");if(A.valid==null)throw new Error("Encryption scheme unsupported");if(!A.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=A;break;case 66:var ve=Number(A);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}zr(L.codepage=ve),Z=!0;break;case 317:L.rrtabid=A;break;case 25:L.winlocked=A;break;case 439:r.opts.RefreshAll=A;break;case 12:r.opts.CalcCount=A;break;case 16:r.opts.CalcDelta=A;break;case 17:r.opts.CalcIter=A;break;case 13:r.opts.CalcMode=A;break;case 14:r.opts.CalcPrecision=A;break;case 95:r.opts.CalcSaveRecalc=A;break;case 15:L.CalcRefMode=A;break;case 2211:r.opts.FullCalc=A;break;case 129:A.fDialog&&(a["!type"]="dialog"),A.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),A.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:P.push(A);break;case 430:M.push([A]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(A);break;case 24:case 536:B={Name:A.Name,Ref:$t(A.rgce,i,null,M,L)},A.itab>0&&(B.Sheet=A.itab-1),M.names.push(B),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(A),A.Name=="_xlnm._FilterDatabase"&&A.itab>0&&A.rgce&&A.rgce[0]&&A.rgce[0][0]&&A.rgce[0][0][0]=="PtgArea3d"&&(H[A.itab-1]={ref:$e(A.rgce[0][0][1][2])});break;case 22:L.ExternCount=A;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(A),M.XTI=M.XTI.concat(A);break;case 2196:if(L.biff<8)break;B!=null&&(B.Comment=A[1]);break;case 18:a["!protect"]=A;break;case 19:A!==0&&L.WTF&&console.error("Password verifier: "+A);break;case 133:s[A.pos]=A,L.snames.push(A.name);break;case 10:{if(--se)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=$e(i),t.sheetRows&&t.sheetRows<=i.e.r){var ye=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=$e(i),i.e.r=ye}i.e.r++,i.e.c++}K.length>0&&(a["!merges"]=K),re.length>0&&(a["!objects"]=re),fe.length>0&&(a["!cols"]=fe),te.length>0&&(a["!rows"]=te),E.Sheets.push(w)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[A.BIFFVer]||8),L.biffguess=A.BIFFVer==0,A.BIFFVer==0&&A.dt==4096&&(L.biff=5,Z=!0,zr(L.codepage=28591)),L.biff==8&&A.BIFFVer==0&&A.dt==16&&(L.biff=2),se++)break;if(a=t.dense?[]:{},L.biff<8&&!Z&&(Z=!0,zr(L.codepage=t.codepage||1252)),L.biff<5||A.BIFFVer==0&&A.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Y={pos:e.l-ie,name:c};s[Y.pos]=Y,L.snames.push(c)}else c=(s[de]||{name:""}).name;A.dt==32&&(a["!type"]="chart"),A.dt==64&&(a["!type"]="macro"),K=[],re=[],L.arrayf=_=[],fe=[],te=[],ne=!1,w={Hidden:(s[de]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[A.r]||[])[A.c]:a[Ne({c:A.c,r:A.r})])&&++A.c,p={ixfe:A.ixfe,XF:P[A.ixfe]||{},v:A.val,t:"n"},F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:A.c,r:A.r},p,t);break;case 5:case 517:p={ixfe:A.ixfe,XF:P[A.ixfe],v:A.val,t:A.t},F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:A.c,r:A.r},p,t);break;case 638:p={ixfe:A.ixfe,XF:P[A.ixfe],v:A.rknum,t:"n"},F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:A.c,r:A.r},p,t);break;case 189:for(var V=A.c;V<=A.C;++V){var X=A.rkrec[V-A.c][0];p={ixfe:X,XF:P[X],v:A.rkrec[V-A.c][1],t:"n"},F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:V,r:A.r},p,t)}break;case 6:case 518:case 1030:{if(A.val=="String"){o=A;break}if(p=Ko(A.val,A.cell.ixfe,A.tt),p.XF=P[p.ixfe],t.cellFormula){var ue=A.formula;if(ue&&ue[0]&&ue[0][0]&&ue[0][0][0]=="PtgExp"){var ce=ue[0][0][1][0],Te=ue[0][0][1][1],be=Ne({r:ce,c:Te});v[be]?p.f=""+$t(A.formula,i,A.cell,M,L):p.F=((t.dense?(a[ce]||[])[Te]:a[be])||{}).F}else p.f=""+$t(A.formula,i,A.cell,M,L)}F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j(A.cell,p,t),o=A}break;case 7:case 519:if(o)o.val=A,p=Ko(A,o.cell.ixfe,"s"),p.XF=P[p.ixfe],t.cellFormula&&(p.f=""+$t(o.formula,i,o.cell,M,L)),F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j(o.cell,p,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(A);var Ve=Ne(A[0].s);if(x=t.dense?(a[A[0].s.r]||[])[A[0].s.c]:a[Ve],t.cellFormula&&x){if(!o||!Ve||!x)break;x.f=""+$t(A[1],i,A[0],M,L),x.F=$e(A[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;v[Ne(o.cell)]=A[0],x=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Ne(o.cell)],(x||{}).f=""+$t(A[0],i,f,M,L)}}break;case 253:p=Ko(l[A.isst].t,A.ixfe,"s"),l[A.isst].h&&(p.h=l[A.isst].h),p.XF=P[p.ixfe],F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:A.c,r:A.r},p,t);break;case 513:t.sheetStubs&&(p={ixfe:A.ixfe,XF:P[A.ixfe],t:"z"},F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:A.c,r:A.r},p,t));break;case 190:if(t.sheetStubs)for(var Ce=A.c;Ce<=A.C;++Ce){var De=A.ixfe[Ce-A.c];p={ixfe:De,XF:P[De],t:"z"},F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:Ce,r:A.r},p,t)}break;case 214:case 516:case 4:p=Ko(A.val,A.ixfe,"s"),p.XF=P[p.ixfe],F>0&&(p.z=U[p.ixfe>>8&63]),Yr(p,t,r.opts.Date1904),j({c:A.c,r:A.r},p,t);break;case 0:case 512:se===1&&(i=A);break;case 252:l=A;break;case 1054:if(L.biff==4){U[F++]=A[1];for(var qe=0;qe<F+163&&Re[qe]!=A[1];++qe);qe>=163&&Ea(A[1],F+163)}else Ea(A[1],A[0]);break;case 30:{U[F++]=A;for(var We=0;We<F+163&&Re[We]!=A;++We);We>=163&&Ea(A,F+163)}break;case 229:K=K.concat(A);break;case 93:re[A.cmo[0]]=L.lastobj=A;break;case 438:L.lastobj.TxO=A;break;case 127:L.lastobj.ImData=A;break;case 440:for(y=A[0].s.r;y<=A[0].e.r;++y)for(g=A[0].s.c;g<=A[0].e.c;++g)x=t.dense?(a[y]||[])[g]:a[Ne({c:g,r:y})],x&&(x.l=A[1]);break;case 2048:for(y=A[0].s.r;y<=A[0].e.r;++y)for(g=A[0].s.c;g<=A[0].e.c;++g)x=t.dense?(a[y]||[])[g]:a[Ne({c:g,r:y})],x&&x.l&&(x.l.Tooltip=A[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;x=t.dense?(a[A[0].r]||[])[A[0].c]:a[Ne(A[0])];var Ye=re[A[2]];x||(t.dense?(a[A[0].r]||(a[A[0].r]=[]),x=a[A[0].r][A[0].c]={t:"z"}):x=a[Ne(A[0])]={t:"z"},i.e.r=Math.max(i.e.r,A[0].r),i.s.r=Math.min(i.s.r,A[0].r),i.e.c=Math.max(i.e.c,A[0].c),i.s.c=Math.min(i.s.c,A[0].c)),x.c||(x.c=[]),m={a:A[1],t:Ye.TxO.t},x.c.push(m)}break;case 2173:g3(P[A.ixfe],A.ext);break;case 125:{if(!L.cellStyles)break;for(;A.e>=A.s;)fe[A.e--]={width:A.w/256,level:A.level||0,hidden:!!(A.flags&1)},ne||(ne=!0,Wf(A.w/256)),Ps(fe[A.e+1])}break;case 520:{var Ge={};A.level!=null&&(te[A.r]=Ge,Ge.level=A.level),A.hidden&&(te[A.r]=Ge,Ge.hidden=!0),A.hpt&&(te[A.r]=Ge,Ge.hpt=A.hpt,Ge.hpx=Qi(A.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Ai(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=A;break;case 161:a["!margins"]||Ai(a["!margins"]={}),a["!margins"].header=A.header,a["!margins"].footer=A.footer;break;case 574:A.RTL&&(E.Views[0].RTL=!0);break;case 146:C=A;break;case 2198:Q=A;break;case 140:S=A;break;case 442:c?w.CodeName=A||w.name:E.WBProps.CodeName=A||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=ie}return r.SheetNames=nn(s).sort(function(Nt,Fe){return Number(Nt)-Number(Fe)}).map(function(Nt){return s[Nt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&H.forEach(function(Nt,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=Nt}),r.Strings=l,r.SSF=It(Re),L.enc&&(r.Encryption=L.enc),Q&&(r.Themes=Q),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),M.names.length>0&&(E.Names=M.names),r.Workbook=E,r}var Tp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Yb(e,t,r){var n=Ue.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=op(n,hT,Tp.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Ue.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=op(i,pT,Tp.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(fg(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Xg(e,t){t||(t={}),Yf(t),Em(),t.codepage&&bf(t.codepage);var r,n;if(e.FullPaths){if(Ue.find(e,"/encryption"))throw new Error("File is password-protected");r=Ue.find(e,"!CompObj"),n=Ue.find(e,"/Workbook")||Ue.find(e,"/Book")}else{switch(t.type){case"base64":e=Hr(_r(e));break;case"binary":e=Hr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Pt(e,0),n={content:e}}var a,s;if(r&&Gb(r),t.bookProps&&!t.bookSheets)a={};else{var i=Be?"buffer":"array";if(n&&n.content)a=qb(n.content,t);else if((s=Ue.find(e,"PerfectOffice_MAIN"))&&s.content)a=Si.to_workbook(s.content,(t.type=i,t));else if((s=Ue.find(e,"NativeContent_MAIN"))&&s.content)a=Si.to_workbook(s.content,(t.type=i,t));else throw(s=Ue.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ue.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=D3(e))}var o={};return e.FullPaths&&Yb(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var zl={0:{f:OA},1:{f:DA},2:{f:VA},3:{f:BA},4:{f:jA},5:{f:zA},6:{f:KA},7:{f:$A},8:{f:QA},9:{f:JA},10:{f:qA},11:{f:YA},12:{f:LA},13:{f:WA},14:{f:UA},15:{f:MA},16:{f:zg},17:{f:XA},18:{f:HA},19:{f:Bf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Sb},40:{},42:{},43:{f:q4},44:{f:X4},45:{f:Y4},46:{f:Q4},47:{f:J4},48:{},49:{f:ZE},50:{},51:{f:_3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Eg},62:{f:GA},63:{f:T3},64:{f:ob},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ib},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:IA},148:{f:PA,p:16},151:{f:tb},152:{},153:{f:Eb},154:{},155:{},156:{f:kb},157:{},158:{},159:{T:1,f:p4},160:{T:-1},161:{T:1,f:Ba},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ZA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:v3},336:{T:-1},337:{f:y3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:kg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rb},427:{f:nb},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sb},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RA},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eb},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:P3},633:{T:1},634:{T:-1},635:{T:1,f:O3},636:{T:-1},637:{f:tT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hb},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lb},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_u={6:{f:s0},10:{f:Nn},12:{f:mt},13:{f:mt},14:{f:dt},15:{f:dt},16:{f:zt},17:{f:dt},18:{f:dt},19:{f:mt},20:{f:fp},21:{f:fp},23:{f:kg},24:{f:hp},25:{f:dt},26:{},27:{},28:{f:FS},29:{},34:{f:dt},35:{f:dp},38:{f:zt},39:{f:zt},40:{f:zt},41:{f:zt},42:{f:dt},43:{f:dt},47:{f:R4},49:{f:uS},51:{f:mt},60:{},61:{f:oS},64:{f:dt},65:{f:cS},66:{f:mt},77:{},80:{},81:{},82:{},85:{f:mt},89:{},90:{},91:{},92:{f:ZT},93:{f:OS},94:{},95:{f:dt},96:{},97:{},99:{f:dt},125:{f:Eg},128:{f:yS},129:{f:eS},130:{f:mt},131:{f:dt},132:{f:dt},133:{f:tS},134:{},140:{f:jS},141:{f:mt},144:{},146:{f:BS},151:{},152:{},153:{},154:{},155:{},156:{f:mt},157:{},158:{},160:{f:VS},161:{f:$S},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:mS},190:{f:gS},193:{f:Nn},197:{},198:{},199:{},200:{},201:{},202:{f:dt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mt},220:{},221:{f:dt},222:{},224:{f:_S},225:{f:QT},226:{f:Nn},227:{},229:{f:NS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:rS},253:{f:fS},255:{f:nS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:mg},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dt},353:{f:Nn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:kS},431:{f:dt},432:{},433:{},434:{},437:{},438:{f:IS},439:{f:dt},440:{f:DS},441:{},442:{f:ho},443:{},444:{f:mt},445:{},446:{},448:{f:Nn},449:{f:iS,r:2},450:{f:Nn},512:{f:cp},513:{f:zS},515:{f:wS},516:{f:dS},517:{f:up},519:{f:WS},520:{f:aS},523:{},545:{f:pp},549:{f:lp},566:{},574:{f:lS},638:{f:xS},659:{},1048:{},1054:{f:hS},1084:{},1212:{f:CS},2048:{f:LS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Vo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Nn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:US,r:12},2173:{f:m3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:SS,r:12},2197:{},2198:{f:u3,r:12},2199:{},2200:{},2201:{},2202:{f:AS,r:12},2203:{f:Nn},2204:{},2205:{},2206:{},2207:{},2211:{f:sS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:HS},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:MS},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cp},1:{},2:{f:qS},3:{f:XS},4:{f:KS},5:{f:up},7:{f:YS},8:{},9:{f:Vo},11:{},22:{f:mt},30:{f:pS},31:{},32:{},33:{f:pp},36:{},37:{f:lp},50:{f:JS},62:{},52:{},67:{},68:{f:mt},69:{},86:{},126:{},127:{f:GS},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:QS},223:{},234:{},354:{},421:{},518:{f:s0},521:{f:Vo},536:{f:hp},547:{f:dp},561:{},579:{},1030:{f:s0},1033:{f:Vo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Lr(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&ng(r)&&e.push(r)}}function Sp(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=wE(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,d=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var g=l[i].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var _=v[o].trim();if(_.match(/<t[dh]/i)){for(var p=_,S=0;p.charAt(0)=="<"&&(S=p.indexOf(">"))>-1;)p=p.slice(S+1);for(var P=0;P<m.length;++P){var C=m[P];C.s.c==u&&C.s.r<c&&c<=C.e.r&&(u=C.e.c+1,P=-1)}var E=Ae(_.slice(0,_.indexOf(">")));d=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||d>1)&&m.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+d-1}});var w=E.t||E["data-t"]||"";if(!p.length){u+=d;continue}if(p=Vm(p),x.s.r>c&&(x.s.r=c),x.e.r<c&&(x.e.r=c),x.s.c>u&&(x.s.c=u),x.e.c<u&&(x.e.c=u),!p.length){u+=d;continue}var k={t:"s",v:p};r.raw||!p.trim().length||w=="s"||(p==="TRUE"?k={t:"b",v:!0}:p==="FALSE"?k={t:"b",v:!1}:isNaN(Kr(p))?isNaN(Os(p).getDate())||(k={t:"d",v:Ft(p)},r.cellDates||(k={t:"n",v:rr(k.v)}),k.z=r.dateNF||Re[14]):k={t:"n",v:Kr(p)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=k):n[Ne({r:c,c:u})]=k,u+=d}}}}return n["!ref"]=$e(x),m.length&&(n["!merges"]=m),n}function Jb(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Ne({r,c:i}),f=n.dense?(e[r]||[])[i]:e[u],d=f&&f.v!=null&&(f.h||If(f.w||(kn(f),f.w)||""))||"",x={};o>1&&(x.rowspan=o),l>1&&(x.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(x["data-t"]=f&&f.t||"z",f.v!=null&&(x["data-v"]=f.v),f.z!=null&&(x["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),x.id=(n.id||"sjs")+"-"+u,s.push(jE("td",d,x))}}var m="<tr>";return m+s.join("")+"</tr>"}var Qb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Zb="</body></html>";function eF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return oa(Sp(r[0],t),t);var n=Qf();return r.forEach(function(a,s){Zf(n,Sp(a,t),"Sheet"+(s+1))}),n}function tF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function rF(e,t){var r=t||{},n=r.header!=null?r.header:Qb,a=r.footer!=null?r.footer:Zb,s=[n],i=Bs(e["!ref"]);r.dense=Array.isArray(e),s.push(tF(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(Jb(e,i,o,r));return s.push("</table>"+a),s.join("")}function qg(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Zt(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=Bs(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],d=0,x=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,v=0,_=0,p=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<l;++m){var S=o[m];if(Cp(S)){if(n.display)continue;x[g]={hidden:!0}}var P=S.children;for(y=v=0;y<P.length;++y){var C=P[y];if(!(n.display&&Cp(C))){var E=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):Vm(C.innerHTML),w=C.getAttribute("data-z")||C.getAttribute("z");for(d=0;d<f.length;++d){var k=f[d];k.s.c==v+s&&k.s.r<g+a&&g+a<=k.e.r&&(v=k.e.c+1-s,d=-1)}p=+C.getAttribute("colspan")||1,((_=+C.getAttribute("rowspan")||1)>1||p>1)&&f.push({s:{r:g+a,c:v+s},e:{r:g+a+(_||1)-1,c:v+s+(p||1)-1}});var O={t:"s",v:E},j=C.getAttribute("data-t")||C.getAttribute("t")||"";E!=null&&(E.length==0?O.t=j||"z":n.raw||E.trim().length==0||j=="s"||(E==="TRUE"?O={t:"b",v:!0}:E==="FALSE"?O={t:"b",v:!1}:isNaN(Kr(E))?isNaN(Os(E).getDate())||(O={t:"d",v:Ft(E)},n.cellDates||(O={t:"n",v:rr(O.v)}),O.z=n.dateNF||Re[14]):O={t:"n",v:Kr(E)})),O.z===void 0&&w!=null&&(O.z=w);var L="",Q=C.getElementsByTagName("A");if(Q&&Q.length)for(var K=0;K<Q.length&&!(Q[K].hasAttribute("href")&&(L=Q[K].getAttribute("href"),L.charAt(0)!="#"));++K);L&&L.charAt(0)!="#"&&(O.l={Target:L}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+s]=O):e[Ne({c:v+s,r:g+a})]=O,c.e.c<v+s&&(c.e.c=v+s),v+=p}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,g-1+a),e["!ref"]=$e(c),g>=l&&(e["!fullref"]=$e((c.e.r=o.length-m+g-1+a,c))),e}function Yg(e,t){var r=t||{},n=r.dense?[]:{};return qg(n,e,t)}function nF(e,t){return oa(Yg(e,t),t)}function Cp(e){var t="",r=aF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function aF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function sF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ze(t.replace(/<[^>]*>/g,""));return[r]}var Ap={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Jg(e,t){var r=t||{},n=Df(e),a=[],s,i,o={name:""},l="",c=0,u,f,d={},x=[],m=r.dense?[]:{},g,y,v={value:""},_="",p=0,S=[],P=-1,C=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},w=0,k={},O=[],j={},L=0,Q=0,K=[],re=1,fe=1,te=[],ne={Names:[]},M={},oe=["",""],se=[],F={},U="",H=0,B=!1,Z=!1,de=0;for(qi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=qi.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?m["!ref"]=$e(E):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=$e(E)),O.length&&(m["!merges"]=O),K.length&&(m["!rows"]=K),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),x.push(u.name),d[u.name]=m,Z=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Ae(g[0],!1),P=C=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,m=r.dense?[]:{},O=[],K=[],Z=!0);break;case"table-row-group":g[1]==="/"?--w:++w;break;case"table-row":case"":if(g[1]==="/"){P+=re,re=1;break}if(f=Ae(g[0],!1),f.?P=f.-1:P==-1&&(P=0),re=+f["number-rows-repeated"]||1,re<10)for(de=0;de<re;++de)w>0&&(K[P+de]={level:w});C=-1;break;case"covered-table-cell":g[1]!=="/"&&++C,r.sheetStubs&&(r.dense?(m[P]||(m[P]=[]),m[P][C]={t:"z"}):m[Ne({r:P,c:C})]={t:"z"}),_="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++C,v=Ae(g[0],!1),fe=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=wp(ze(v.formula))),(v.||v["value-type"])=="string"&&(y.t="s",y.v=ze(v["string-value"]||""),r.dense?(m[P]||(m[P]=[]),m[P][C]=y):m[Ne({r:P,c:C})]=y),C+=fe-1;else if(g[1]!=="/"){++C,_="",p=0,S=[],fe=1;var le=re?P+re-1:P;if(C>E.e.c&&(E.e.c=C),C<E.s.c&&(E.s.c=C),P<E.s.r&&(E.s.r=P),le>E.e.r&&(E.e.r=le),v=Ae(g[0],!1),se=[],F={},y={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=ze(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(L=parseInt(v["number-matrix-rows-spanned"],10)||0,Q=parseInt(v["number-matrix-columns-spanned"],10)||0,j={s:{r:P,c:C},e:{r:P+L-1,c:C+Q-1}},y.F=$e(j),te.push([j,y.F])),v.formula)y.f=wp(v.formula);else for(de=0;de<te.length;++de)P>=te[de][0].s.r&&P<=te[de][0].e.r&&C>=te[de][0].s.c&&C<=te[de][0].e.c&&(y.F=te[de][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(L=parseInt(v["number-rows-spanned"],10)||0,Q=parseInt(v["number-columns-spanned"],10)||0,j={s:{r:P,c:C},e:{r:P+L-1,c:C+Q-1}},O.push(j)),v["number-columns-repeated"]&&(fe=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=rt(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=Ft(v["date-value"]),r.cellDates||(y.t="n",y.v=rr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=vE(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=dc(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(_=ze(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(B=!1,y.t==="s"&&(y.v=_||"",S.length&&(y.R=S),B=p==0),M.Target&&(y.l=M),se.length>0&&(y.c=se,se=[]),_&&r.cellText!==!1&&(y.w=_),B&&(y.t="z",delete y.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var ie=0;ie<re;++ie){if(fe=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[P+ie]||(m[P+ie]=[]),m[P+ie][C]=ie==0?y:It(y);--fe>0;)m[P+ie][C+fe]=It(y);else for(m[Ne({r:P+ie,c:C})]=y;--fe>0;)m[Ne({r:P+ie,c:C+fe})]=It(y);E.e.c<=C&&(E.e.c=C)}fe=parseInt(v["number-columns-repeated"]||"1",10),C+=fe-1,fe=0,y={},_="",S=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s;F.t=_,S.length&&(F.R=S),F.a=U,se.push(F)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);U="",H=0,_="",p=0,S=[];break;case"creator":g[1]==="/"?U=n.slice(H,g.index):H=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);_="",p=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(k[o.name]=l,(s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Ae(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ae(g[0],!1),l+=Ap[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ae(g[0],!1),l+=Ap[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":i=Ae(g[0],!1),oe=i0(i["cell-range-address"]);var ae={Name:i.name,Ref:oe[0]+"!"+oe[1]};Z&&(ae.Sheet=x.length),ne.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var z=sF(n.slice(p,g.index));_=(_.length>0?_+`
`:"")+z[0]}else Ae(g[0],!1),p=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{oe=i0(Ae(g[0])["target-range-address"]),d[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(M=Ae(g[0],!1),!M.href)break;M.Target=ze(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(oe=i0(M.Target.slice(1)),M.Target="#"+oe[0]+"!"+oe[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var A={Sheets:d,SheetNames:x,Workbook:ne};return r.bookSheets&&delete A.Sheets,A}function bp(e,t){t=t||{},Tr(e,"META-INF/manifest.xml")&&wT(xt(e,"META-INF/manifest.xml"),t);var r=pr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Jg(Ze(r),t);return Tr(e,"meta.xml")&&(n.Props=ug(xt(e,"meta.xml"))),n}function Fp(e,t){return Jg(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yu(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ze(ja(e))}function wu(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Np(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function iF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Zi(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Tt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Vt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Zi(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Zi(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function qf(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function oF(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Zi(e,n),s=Vt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Tt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Vt(o.data),c=Tt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=Tt(s[3][0].data)>>>0>0),r.push(i)}return r}function lF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Zi(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[wu(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=wu(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function cF(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(lF(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return wu(t)}function uF(e,t,r,n){var a=Xf(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Np(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Np(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function fF(e,t,r){var n=Xf(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=iF(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function dF(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return uF(e,t,r,e[0]);case 5:return fF(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Jn(e){var t=Vt(e);return Zi(t[1][0].data)}function Op(e,t){var r=Vt(t.data),n=Tt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=Vt(i.data),l=Tt(o[1][0].data)>>>0;switch(n){case 1:s[l]=yu(o[3][0].data);break;case 8:{var c=e[Jn(o[9][0].data)][0],u=Vt(c.data),f=e[Jn(u[1][0].data)][0],d=Tt(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var x=Vt(f.data);s[l]=x[3].map(function(m){return yu(m.data)}).join("")}break}}),s}function hF(e,t){var r,n,a,s,i,o,l,c,u,f,d,x,m,g,y=Vt(e),v=Tt(y[1][0].data)>>>0,_=Tt(y[2][0].data)>>>0,p=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Tt(y[8][0].data)>0||!1,S,P;if((s=(a=y[7])==null?void 0:a[0])!=null&&s.data&&t!=0)S=(o=(i=y[7])==null?void 0:i[0])==null?void 0:o.data,P=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=y[4])==null?void 0:u[0])!=null&&f.data&&t!=1)S=(x=(d=y[4])==null?void 0:d[0])==null?void 0:x.data,P=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var C=p?4:1,E=Xf(S),w=[],k=0;k<S.length/2;++k){var O=E.getUint16(k*2,!0);O<65535&&w.push([k,O])}if(w.length!=_)throw"Expected ".concat(_," cells, found ").concat(w.length);var j=[];for(k=0;k<w.length-1;++k)j[w[k][0]]=P.subarray(w[k][1]*C,w[k+1][1]*C);return w.length>=1&&(j[w[w.length-1][0]]=P.subarray(w[w.length-1][1]*C)),{R:v,cells:j}}function pF(e,t){var r,n=Vt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Tt(n[7][0].data)>>>0>0?1:0:-1,s=qf(n[5],function(i){return hF(i,a)});return{nrows:Tt(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function xF(e,t,r){var n,a=Vt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Tt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Tt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=$e(s);var i=Vt(a[4][0].data),o=Op(e,e[Jn(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Op(e,e[Jn(i[17][0].data)][0]):[],c=Vt(i[3][0].data),u=0;c[1].forEach(function(f){var d=Vt(f.data),x=e[Jn(d[2][0].data)][0],m=Tt(x.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=pF(e,x);g.data.forEach(function(y,v){y.forEach(function(_,p){var S=Ne({r:u+v,c:p}),P=dF(_,o,l);P&&(r[S]=P)})}),u+=g.nrows})}function mF(e,t){var r=Vt(t.data),n={"!ref":"A1"},a=e[Jn(r[2][0].data)],s=Tt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return xF(e,a[0],n),n}function gF(e,t){var r,n=Vt(t.data),a={name:(r=n[1])!=null&&r[0]?yu(n[1][0].data):"",sheets:[]},s=qf(n[2],Jn);return s.forEach(function(i){e[i].forEach(function(o){var l=Tt(o.meta[1][0].data);l==6e3&&a.sheets.push(mF(e,o))})}),a}function vF(e,t){var r=Qf(),n=Vt(t.data),a=qf(n[1],Jn);if(a.forEach(function(s){e[s].forEach(function(i){var o=Tt(i.meta[1][0].data);if(o==2){var l=gF(e,i);l.sheets.forEach(function(c,u){Zf(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function l0(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=cF(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=oF(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Tt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var u=Tt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return vF(s,o)}function _F(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Yf(e){_F([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function yF(e){return ds.WS.indexOf(e)>-1?"sheet":e==ds.CS?"chart":e==ds.DS?"dialog":e==ds.MS?"macro":e&&e.length?e:"sheet"}function wF(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,yF(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function kF(e,t,r,n,a,s,i,o,l,c,u,f){try{s[n]=Ei(pr(e,r,!0),t);var d=xt(e,t),x;switch(o){case"sheet":x=bb(d,t,a,l,s[n],c,u,f);break;case"chart":if(x=Fb(d,t,a,l,s[n],c,u,f),!x||!x["!drawel"])break;var m=ii(x["!drawel"].Target,t),g=xu(m),y=A3(pr(e,m,!0),Ei(pr(e,g,!0),m)),v=ii(y,m),_=xu(v);x=fb(pr(e,v,!0),v,l,Ei(pr(e,_,!0),v),c,x);break;case"macro":x=Nb(d,t,a,l,s[n],c,u,f);break;case"dialog":x=Ob(d,t,a,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=x;var p=[];s&&s[n]&&nn(s[n]).forEach(function(S){var P="";if(s[n][S].Type==ds.CMNT){P=ii(s[n][S].Target,t);var C=Db(xt(e,P,!0),P,l);if(!C||!C.length)return;mp(x,C,!1)}s[n][S].Type==ds.TCMNT&&(P=ii(s[n][S].Target,t),p=p.concat(F3(xt(e,P,!0),l)))}),p&&p.length&&mp(x,p,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function kr(e){return e.charAt(0)=="/"?e.slice(1):e}function EF(e,t){if(Dm(),t=t||{},Yf(t),Tr(e,"META-INF/manifest.xml")||Tr(e,"objectdata.xml"))return bp(e,t);if(Tr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof l0<"u"){if(e.FileIndex)return l0(e);var r=Ue.utils.cfb_new();return zh(e).forEach(function(K){TE(r,K,EE(e,K))}),l0(r)}throw new Error("Unsupported NUMBERS file")}if(!Tr(e,"[Content_Types].xml"))throw Tr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Tr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zh(e),a=_T(pr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",xt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!xt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Ci=[],a.sst)try{Ci=Ib(xt(e,kr(a.sst)),a.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&a.themes.length&&(l=Rb(pr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=Pb(xt(e,kr(a.style)),a.style,l,t))}a.links.map(function(K){try{var re=Ei(pr(e,xu(kr(K))),K);return jb(xt(e,kr(K)),re,K,t)}catch{}});var u=Ab(xt(e,kr(a.workbooks[0])),a.workbooks[0],t),f={},d="";a.coreprops.length&&(d=xt(e,kr(a.coreprops[0]),!0),d&&(f=ug(d)),a.extprops.length!==0&&(d=xt(e,kr(a.extprops[0]),!0),d&&TT(d,f,t)));var x={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=pr(e,kr(a.custprops[0]),!0),d&&(x=CT(d,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(re){return re.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=x),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var g={};t.bookDeps&&a.calcchain&&(g=Lb(xt(e,kr(a.calcchain)),a.calcchain));var y=0,v={},_,p;{var S=u.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var P=0;P!=S.length;++P)f.SheetNames[P]=S[P].name}var C=s?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),w=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Tr(e,w)||(w="xl/_rels/workbook."+C+".rels");var k=Ei(pr(e,w,!0),w.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Mb(xt(e,kr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=N3(xt(e,kr(a.people[0])),t)),k&&(k=wF(k,u.Sheets));var O=xt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var j="sheet";if(k&&k[y]?(_="xl/"+k[y][1].replace(/[\/]?xl\//,""),Tr(e,_)||(_=k[y][1]),Tr(e,_)||(_=w.replace(/_rels\/.*$/,"")+k[y][1]),j=k[y][2]):(_="xl/worksheets/sheet"+(y+1-O)+"."+C,_=_.replace(/sheet0\./,"sheet.")),p=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,Q=0;Q!=t.sheets.length;++Q)typeof t.sheets[Q]=="number"&&t.sheets[Q]==y&&(L=1),typeof t.sheets[Q]=="string"&&t.sheets[Q].toLowerCase()==f.SheetNames[y].toLowerCase()&&(L=1);if(!L)continue e}}kF(e,_,p,f.SheetNames[y],y,v,i,j,t,u,l,c)}return m={Directory:a,Workbook:u,Props:f,Custprops:x,Deps:g,Sheets:i,SheetNames:f.SheetNames,Strings:Ci,Styles:c,Themes:l,SSF:It(Re)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(K,re){K=K.replace(/^Root Entry[\/]/,""),m.keys.push(K),m.files[K]=e.FileIndex[re]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=xt(e,kr(a.vba[0]),!0):a.defaults&&a.defaults.bin===I3&&(m.vbaraw=xt(e,"xl/vbaProject.bin",!0))),m}function TF(e,t){var r=t||{},n="Workbook",a=Ue.find(e,n);try{if(n="/!DataSpaces/Version",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(m4(a.content),n="/!DataSpaces/DataSpaceMap",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=v4(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=_4(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);w4(a.content)}catch{}if(n="/EncryptionInfo",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=k4(a.content);if(n="/EncryptedPackage",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Jf(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_r(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function SF(e,t){return Ue.find(e,"EncryptedPackage")?TF(e,t):Xg(e,t)}function CF(e,t){var r,n=e,a=t||{};return a.type||(a.type=Be&&Buffer.isBuffer(e)?"buffer":"base64"),r=$m(n,a),EF(r,a)}function Qg(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return vu(e.slice(r),t);default:break e}return Yi.to_workbook(e,t)}function AF(e,t){var r="",n=Jf(e,t);switch(t.type){case"base64":r=_r(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Oa(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ze(r)),t.type="binary",Qg(r,t)}function bF(e,t){var r=e;return t.type=="base64"&&(r=_r(r)),r=jn.utils.decode(1200,r.slice(2),"str"),t.type="binary",Qg(r,t)}function FF(e){return e.match(/[^\x00-\x7F]/)?oi(e):e}function c0(e,t,r,n){return n?(r.type="string",Yi.to_workbook(e,r)):Yi.to_workbook(t,r)}function ku(e,t){Em();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ku(new Uint8Array(e),(r=It(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ws={},r.dateNF&&(ws.dateNF=r.dateNF),r.type||(r.type=Be&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Be?"buffer":"binary",n=mE(e),typeof Uint8Array<"u"&&!Be&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=FF(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=It(r),r.type="array",ku(Ff(n),r)}switch((a=Jf(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return SF(Ue.read(n,r),r);break;case 9:if(a[1]<=8)return Xg(n,r);break;case 60:return vu(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return n4(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return t4.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?CF(n,r):c0(e,n,r,s);case 239:return a[3]===60?vu(n,r):c0(e,n,r,s);case 255:if(a[1]===254)return bF(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Si.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Si.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return xp.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return I4.to_workbook(n,r);break;case 10:case 13:case 32:return AF(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ZS.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?xp.to_workbook(n,r):c0(e,n,r,s)}function NF(e,t,r,n,a,s,i,o){var l=Dt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var x=t.s.c;x<=t.e.c;++x){var m=i?e[r][x]:e[n[x]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[x]!=null&&(d[s[x]]=c);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[x]!=null){if(g==null)if(m.t=="e"&&g===null)d[s[x]]=null;else if(c!==void 0)d[s[x]]=c;else if(u&&g===null)d[s[x]]=null;else continue;else d[s[x]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?g:kn(m,g,o);g!=null&&(f=!1)}}return{row:d,isempty:f}}function Eu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=ft(u);break;case"number":l=ft(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=Dt(l.s.r),d=[],x=[],m=0,g=0,y=Array.isArray(e),v=l.s.r,_=0,p={};y&&!e[v]&&(e[v]=[]);var S=c.skipHidden&&e["!cols"]||[],P=c.skipHidden&&e["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(S[_]||{}).hidden)switch(d[_]=Et(_),r=y?e[v][_]:e[d[_]+f],n){case 1:s[_]=_-l.s.c;break;case 2:s[_]=d[_];break;case 3:s[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=kn(r,null,c),g=p[i]||0,!g)p[i]=1;else{do o=i+"_"+g++;while(p[o]);p[i]=g,p[o]=1}s[_]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(P[v]||{}).hidden){var C=NF(e,l,v,d,n,s,y,c);(C.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(x[m++]=C.row)}return x.length=m,x}var Pp=/"/g;function OF(e,t,r,n,a,s,i,o){for(var l=!0,c=[],u="",f=Dt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var x=o.dense?(e[r]||[])[d]:e[n[d]+f];if(x==null)u="";else if(x.v!=null){l=!1,u=""+(o.rawNumbers&&x.t=="n"?x.v:kn(x,null,o));for(var m=0,g=0;m!==u.length;++m)if((g=u.charCodeAt(m))===a||g===s||g===34||o.forceQuotes){u='"'+u.replace(Pp,'""')+'"';break}u=="ID"&&(u='"ID"')}else x.f!=null&&!x.F?(l=!1,u="="+x.f,u.indexOf(",")>=0&&(u='"'+u.replace(Pp,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function Zg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ft(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(d[m]||{}).hidden||(f[m]=Et(m));for(var g=0,y=a.s.r;y<=a.e.r;++y)(x[y]||{}).hidden||(u=OF(e,a,y,f,i,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function PF(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Zg(e,t);return r}function RF(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ft(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Et(o);for(var u=a.s.r;u<=a.e.r;++u)for(s=Dt(u),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function ev(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Zt(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var f=ft(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(i=f.e.r+1,u.e.r=i+t.length-1+a)}else i==-1&&(i=0,u.e.r=t.length-1+a);var d=n.header||[],x=0;t.forEach(function(g,y){nn(g).forEach(function(v){(x=d.indexOf(v))==-1&&(d[x=d.length]=v);var _=g[v],p="z",S="",P=Ne({c:o+x,r:i+y+a});c=eo(s,P),_&&typeof _=="object"&&!(_ instanceof Date)?s[P]=_:(typeof _=="number"?p="n":typeof _=="boolean"?p="b":typeof _=="string"?p="s":_ instanceof Date?(p="d",n.cellDates||(p="n",_=rr(_)),S=n.dateNF||Re[14]):_===null&&n.nullError&&(p="e",_=0),c?(c.t=p,c.v=_,delete c.w,delete c.R,S&&(c.z=S)):s[P]=c={t:p,v:_},S&&(c.z=S))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var m=Dt(i);if(a)for(x=0;x<d.length;++x)s[Et(x+o)+m]={t:"s",v:d[x]};return s["!ref"]=$e(u),s}function IF(e,t){return ev(null,e,t)}function eo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Zt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?eo(e,Ne(t)):eo(e,Ne({r:t,c:r||0}))}function DF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Qf(){return{SheetNames:[],Sheets:{}}}function Zf(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(_b(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function LF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=DF(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function jF(e,t){return e.z=t,e}function tv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function MF(e,t,r){return tv(e,"#"+t,r)}function BF(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function UF(e,t,r,n){for(var a=typeof t!="string"?t:ft(t),s=typeof t=="string"?t:$e(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=eo(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var $F={encode_col:Et,encode_row:Dt,encode_cell:Ne,encode_range:$e,decode_col:Mf,decode_row:jf,split_cell:QE,decode_cell:Zt,decode_range:Bs,format_cell:kn,sheet_add_aoa:sg,sheet_add_json:ev,sheet_add_dom:qg,aoa_to_sheet:Us,json_to_sheet:IF,table_to_sheet:Yg,table_to_book:nF,sheet_to_csv:Zg,sheet_to_txt:PF,sheet_to_json:Eu,sheet_to_html:rF,sheet_to_formulae:RF,sheet_to_row_object_array:Eu,sheet_get_cell:eo,book_new:Qf,book_append_sheet:Zf,book_set_sheet_visibility:LF,cell_set_number_format:jF,cell_set_hyperlink:tv,cell_set_internal_link:MF,cell_add_comment:BF,sheet_set_array_formula:UF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function HF(){const{user:e}=ia(),t=fc(),[r,n]=xe.useState("file"),[a,s]=xe.useState(null),[i,o]=xe.useState(!1),[l,c]=xe.useState([{industry:"",path:""}]),u=["industry_name","level-1","level-2","level-3","level-4","level-5","level-6","breadcrumbs","end_category"],f=()=>c([...l,{industry:"",path:""}]),d=p=>{l.length>1&&c(l.filter((S,P)=>P!==p))},x=(p,S,P)=>{const C=[...l];C[p][S]=P,c(C)},m=async()=>{const p=l.filter(S=>S.industry.trim()&&S.path.trim());if(p.length===0){t.error("Please fill in at least one row with Industry and Breadcrumbs.");return}o(!0);try{const S=p.map(C=>{const E=C.path.split(">").map(w=>w.trim());return{client_id:(e==null?void 0:e.client_id)||(e==null?void 0:e.id),category_path:C.path.trim(),level:E.length,name:E[E.length-1],metadata:{industry:C.industry.trim(),source:"manual_entry"}}}),{error:P}=await Se.from("categories").insert(S);if(P)throw P;t.success(`Successfully saved ${S.length} categories!`),c([{industry:"",path:""}])}catch(S){t.error(S.message)}finally{o(!1)}},g=p=>{if(p.target.files&&p.target.files[0]){const S=p.target.files[0],P=S.name.toLowerCase();if(!P.endsWith(".csv")&&!P.endsWith(".xlsx")&&!P.endsWith(".txt")){t.error("Invalid file type. Please upload .csv, .xlsx, or .txt");return}s(S)}},y=async p=>{if(p.length===0)throw new Error("The file is empty.");const S=Object.keys(p[0]).map(w=>w.trim().toLowerCase()),P=u.filter(w=>!S.includes(w));if(P.length>0)throw new Error(`Invalid Format. Missing columns: ${P.join(", ")}`);const C=p.map((w,k)=>{const O=Object.keys(w).find(re=>re.trim().toLowerCase()==="breadcrumbs")||"breadcrumbs",j=Object.keys(w).find(re=>re.trim().toLowerCase()==="industry_name")||"industry_name",L=String(w[O]||"").trim(),Q=String(w[j]||"").trim();if(!L||!Q)return null;const K=L.split(">").map(re=>re.trim());return{client_id:(e==null?void 0:e.client_id)||(e==null?void 0:e.id),category_path:L,level:K.length,name:K[K.length-1],metadata:{industry:Q,source:a==null?void 0:a.name,row_index:k+2}}}).filter(Boolean);if(C.length===0)throw new Error("No valid data found in the required columns.");const{error:E}=await Se.from("categories").insert(C);if(E)throw E;return C.length},v=async()=>{if(!(!a||!e)){o(!0);try{let p=[];if(a.name.endsWith(".xlsx")){const P=await a.arrayBuffer(),C=ku(P);p=$F.sheet_to_json(C.Sheets[C.SheetNames[0]])}else await new Promise((P,C)=>{Bk.parse(a,{header:!0,skipEmptyLines:!0,complete:E=>{p=E.data,P(null)},error:C})});const S=await y(p);t.success(`Imported ${S} categories successfully!`),s(null)}catch(p){t.error(p.message)}finally{o(!1)}}},_=()=>{const p=u.join(","),S="Marine,Boat Care,Anodes,Anodes - Hull,,,,Boat Care > Anodes > Anodes - Hull,Anodes - Hull",P=new Blob([`${p}
${S}`],{type:"text/csv;charset=utf-8;"}),C=URL.createObjectURL(P),E=document.createElement("a");E.href=C,E.download="required_template.csv",E.click()};return h.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Category Management"}),h.jsx("p",{className:"text-slate-500 text-sm",children:"Upload bulk files or enter data manually"})]}),h.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[h.jsxs("button",{onClick:()=>n("file"),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${r==="file"?"bg-white shadow-sm text-blue-600":"text-slate-600 hover:text-slate-900"}`,children:[h.jsx(pk,{className:"w-4 h-4"})," File Upload"]}),h.jsxs("button",{onClick:()=>n("manual"),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${r==="manual"?"bg-white shadow-sm text-blue-600":"text-slate-600 hover:text-slate-900"}`,children:[h.jsx(yk,{className:"w-4 h-4"})," Manual Entry"]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsx("div",{className:"lg:col-span-2",children:r==="file"?h.jsxs("div",{className:"bg-white p-8 rounded-xl border border-slate-200 shadow-sm animate-in fade-in duration-300",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800",children:"Import File"}),h.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-56 border-2 border-dashed border-slate-300 rounded-xl cursor-pointer hover:bg-blue-50 hover:border-blue-400 transition-all mb-6",children:[h.jsx(vm,{className:"w-10 h-10 text-slate-400 mb-2"}),h.jsx("span",{className:"text-sm text-slate-600 font-medium",children:a?a.name:"Click to select CSV, XLSX, or TXT"}),h.jsx("input",{type:"file",className:"hidden",accept:".csv,.xlsx,.txt",onChange:g})]}),h.jsxs("button",{onClick:v,disabled:!a||i,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[i&&h.jsx(co,{className:"w-4 h-4 animate-spin"}),i?"Processing...":"Start Import"]})]}):h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-in fade-in duration-300",children:[h.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[h.jsx("h3",{className:"font-semibold text-slate-800",children:"Manual Record Entry"}),h.jsxs("button",{onClick:f,className:"text-blue-600 hover:text-blue-700 text-sm font-bold flex items-center gap-1",children:[h.jsx(Pl,{className:"w-4 h-4"})," Add Row"]})]}),h.jsx("div",{className:"p-6 space-y-4 max-h-[450px] overflow-y-auto",children:l.map((p,S)=>{const P=p.path.split(">").map(w=>w.trim()).filter(Boolean),C=P.length>0?P[P.length-1]:"",E=P.length;return h.jsxs("div",{className:"p-4 bg-white border border-slate-200 rounded-xl space-y-4 shadow-sm",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("span",{className:"text-[10px] font-bold bg-slate-100 px-2 py-1 rounded text-slate-500 uppercase",children:["Record #",S+1]}),h.jsx("button",{onClick:()=>d(S),className:"text-slate-300 hover:text-red-500 transition-colors",children:h.jsx(Cf,{className:"w-4 h-4"})})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Industry Name"}),h.jsx("input",{placeholder:"e.g. Marine",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-500",value:p.industry,onChange:w=>x(S,"industry",w.target.value)})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-xs font-semibold text-slate-700",children:"Breadcrumb Path"}),h.jsx("input",{placeholder:"L1 > L2 > L3",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-500",value:p.path,onChange:w=>x(S,"path",w.target.value)})]})]}),p.path.includes(">")&&h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 pt-2 border-t border-slate-50",children:[h.jsxs("div",{className:"bg-slate-50 p-2 rounded",children:[h.jsx("p",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"End Category"}),h.jsx("p",{className:"text-xs font-medium text-blue-600 truncate",children:C||"---"})]}),h.jsxs("div",{className:"bg-slate-50 p-2 rounded",children:[h.jsx("p",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Total Levels"}),h.jsx("p",{className:"text-xs font-medium text-slate-700",children:E})]}),h.jsxs("div",{className:"col-span-2 bg-slate-50 p-2 rounded",children:[h.jsx("p",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Level Breakdown"}),h.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:P.map((w,k)=>h.jsxs("span",{className:"text-[10px] bg-white border border-slate-200 px-1 rounded text-slate-500",children:["L",k+1,": ",w]},k))})]})]})]},S)})}),h.jsx("div",{className:"p-6 bg-slate-50 border-t border-slate-100 text-right",children:h.jsx("button",{onClick:m,disabled:i,className:"w-full md:w-auto px-10 bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50",children:i?"Saving...":"Save Categories"})})]})}),h.jsx("div",{className:"space-y-6",children:h.jsxs("div",{className:"bg-slate-900 text-white p-6 rounded-xl shadow-lg",children:[h.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[h.jsx(Tf,{className:"w-5 h-5 text-blue-400"})," Validation Rules"]}),h.jsxs("div",{className:"space-y-4 text-sm text-slate-300",children:[h.jsxs("p",{children:["1. ",h.jsx("strong",{children:"Path Format:"})," Use the ",h.jsxs("code",{children:[" ",">"," "]})," symbol to separate levels (e.g., Electronics ",">"," Phones)."]}),h.jsxs("p",{children:["2. ",h.jsx("strong",{children:"Headers:"})," Files must include all 9 required columns, even if some levels are empty."]}),h.jsxs("p",{children:["3. ",h.jsx("strong",{children:"Industry:"})," Every row must have an industry name for identification."]}),h.jsxs("button",{onClick:_,className:"w-full mt-4 flex items-center justify-center gap-2 bg-white/10 hover:bg-white/20 py-2 rounded-lg transition-colors text-white font-medium border border-white/10",children:[h.jsx(Sf,{className:"w-4 h-4"})," Download Template"]})]})]})})]})]})}function zF(){const{user:e,signOut:t}=ia(),[r,n]=xe.useState("dashboard"),[a,s]=xe.useState({facets_recommended:0,jobs_in_progress:0,jobs_yet_to_start:0,pending_categories:0,downloads:0,total_projects:0});xe.useEffect(()=>{i()},[e]);const i=async()=>{var _,p,S;if(!e)return;const c=e.role==="super_admin"?{}:{client_id:e.client_id},[u,f,d,x]=await Promise.all([Se.from("facet_generation_jobs").select("status").match(c),Se.from("categories").select("id").match(c),Se.from("export_history").select("id").match(c),Se.from("facet_generation_jobs").select("id").match(c)]),m=u.data||[],g=m.filter(P=>P.status==="completed").length,y=m.filter(P=>P.status==="processing").length,v=m.filter(P=>P.status==="pending").length;s({facets_recommended:g,jobs_in_progress:y,jobs_yet_to_start:v,pending_categories:((_=f.data)==null?void 0:_.length)||0,downloads:((p=d.data)==null?void 0:p.length)||0,total_projects:((S=x.data)==null?void 0:S.length)||0})},o=[{id:"dashboard",label:"Dashboard",icon:wk},{id:"projects",label:"Projects",icon:Ah},{id:"upload",label:"Upload Categories",icon:vm},{id:"prompts",label:"Prompt Templates",icon:hk},{id:"generate",label:"Generate Facets",icon:gm}];((e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="client_admin")&&o.push({id:"clients",label:e.role==="super_admin"?"Manage Clients":"Manage Team",icon:_m});const l=()=>{switch(r){case"dashboard":return h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:(e==null?void 0:e.role)==="super_admin"?"Admin Dashboard":"Dashboard"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[h.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:h.jsx(Tf,{className:"w-6 h-6 text-green-600"})}),h.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.facets_recommended})]}),h.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Facets Recommended"}),h.jsx("p",{className:"text-sm text-slate-600",children:"Successfully generated"})]}),h.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:h.jsx(Nk,{className:"w-6 h-6 text-blue-600"})}),h.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.jobs_in_progress})]}),h.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"In Progress"}),h.jsx("p",{className:"text-sm text-slate-600",children:"Currently processing"})]}),h.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:h.jsx(fk,{className:"w-6 h-6 text-yellow-600"})}),h.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.jobs_yet_to_start})]}),h.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Yet to Start"}),h.jsx("p",{className:"text-sm text-slate-600",children:"Pending jobs"})]}),h.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("div",{className:"p-3 bg-slate-100 rounded-lg",children:h.jsx(mm,{className:"w-6 h-6 text-slate-600"})}),h.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.pending_categories})]}),h.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Categories"}),h.jsx("p",{className:"text-sm text-slate-600",children:"Total uploaded"})]}),h.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:h.jsx(Sf,{className:"w-6 h-6 text-indigo-600"})}),h.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.downloads})]}),h.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Downloaded Outputs"}),h.jsx("p",{className:"text-sm text-slate-600",children:"Export history"})]}),h.jsxs("div",{className:"bg-white p-6 rounded-lg border border-slate-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:h.jsx(Ah,{className:"w-6 h-6 text-purple-600"})}),h.jsx("span",{className:"text-3xl font-bold text-slate-900",children:a.total_projects})]}),h.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Total Projects"}),h.jsx("p",{className:"text-sm text-slate-600",children:"All time"})]})]}),h.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[h.jsx("h3",{className:"font-semibold text-slate-900 mb-2",children:"Quick Actions"}),h.jsxs("div",{className:"flex flex-wrap gap-3",children:[h.jsx("button",{onClick:()=>n("projects"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create New Project"}),h.jsx("button",{onClick:()=>n("upload"),className:"px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Upload Categories"}),h.jsx("button",{onClick:()=>n("generate"),className:"px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Generate Facets"})]})]})]});case"projects":return h.jsx(Pk,{});case"upload":return h.jsx(HF,{});case"prompts":return h.jsx(Dk,{});case"generate":return h.jsx(Lk,{onComplete:()=>n("dashboard")});case"clients":return(e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="client_admin"?h.jsx(jk,{}):null;default:return null}};return h.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[h.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200",children:[h.jsxs("div",{className:"p-6 border-b border-slate-200",children:[h.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Facet Builder Pro"}),h.jsx("p",{className:"text-sm text-slate-600 mt-1",children:e==null?void 0:e.email}),(e==null?void 0:e.role)==="super_admin"&&h.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded",children:"Super Admin"}),(e==null?void 0:e.role)==="client_admin"&&h.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:"Client Admin"})]}),h.jsx("nav",{className:"p-4",children:o.map(c=>{const u=c.icon;return h.jsxs("button",{onClick:()=>n(c.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg mb-1 transition-colors ${r===c.id?"bg-blue-50 text-blue-700 font-medium":"text-slate-700 hover:bg-slate-50"}`,children:[h.jsx(u,{className:"w-5 h-5"}),c.label]},c.id)})}),h.jsx("div",{className:"absolute bottom-0 left-0 right-0 w-64 p-4 border-t border-slate-200",children:h.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[h.jsx(kk,{className:"w-5 h-5"}),"Sign Out"]})})]}),h.jsx("main",{className:"flex-1 p-8 overflow-auto",children:l()})]})}function VF({onComplete:e}){const[t,r]=xe.useState(""),[n,a]=xe.useState(!1),[s,i]=xe.useState(null),o=async l=>{l.preventDefault(),a(!0),i(null);try{const{error:c}=await Se.auth.updateUser({password:t});if(c)throw c;alert("Account activated successfully!"),e()}catch(c){i(c.message)}finally{a(!1)}};return h.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 border border-slate-200",children:[h.jsx("div",{className:"flex justify-center mb-6",children:h.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:h.jsx(_k,{className:"w-8 h-8 text-blue-600"})})}),h.jsx("h2",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Set Your Password"}),h.jsx("p",{className:"text-center text-slate-500 mb-8",children:"Welcome! Please choose a password to complete your account setup."}),h.jsxs("form",{onSubmit:o,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"New Password"}),h.jsx("input",{type:"password",required:!0,minLength:6,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:t,onChange:l=>r(l.target.value),placeholder:""})]}),s&&h.jsx("p",{className:"text-red-500 text-sm",children:s}),h.jsx("button",{type:"submit",disabled:n||t.length<6,className:"w-full bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition disabled:opacity-50 flex items-center justify-center gap-2",children:n?h.jsx(co,{className:"w-5 h-5 animate-spin"}):"Finish Setup"})]})]})})}function WF(){const{user:e,loading:t}=ia(),[r,n]=xe.useState(!1);return xe.useEffect(()=>{const a=window.location.hash;a&&(a.includes("access_token")||a.includes("type=invite"))&&n(!0)},[]),t?h.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx(co,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-slate-600",children:"Loading..."})]})}):r?h.jsx(VF,{onComplete:()=>n(!1)}):e?h.jsx(zF,{}):h.jsx(Ok,{})}Wx(document.getElementById("root")).render(h.jsx(xe.StrictMode,{children:h.jsx(sk,{children:h.jsx(Rk,{children:h.jsx(WF,{})})})}));
