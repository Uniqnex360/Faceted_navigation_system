(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Py=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wx={exports:{}},cu={},Hx={exports:{}},nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ml=Symbol.for("react.element"),jy=Symbol.for("react.portal"),Ly=Symbol.for("react.fragment"),My=Symbol.for("react.strict_mode"),By=Symbol.for("react.profiler"),Uy=Symbol.for("react.provider"),$y=Symbol.for("react.context"),Wy=Symbol.for("react.forward_ref"),Hy=Symbol.for("react.suspense"),zy=Symbol.for("react.memo"),Vy=Symbol.for("react.lazy"),Hd=Symbol.iterator;function Gy(e){return e===null||typeof e!="object"?null:(e=Hd&&e[Hd]||e["@@iterator"],typeof e=="function"?e:null)}var zx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vx=Object.assign,Gx={};function Li(e,t,r){this.props=e,this.context=t,this.refs=Gx,this.updater=r||zx}Li.prototype.isReactComponent={};Li.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Li.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qx(){}qx.prototype=Li.prototype;function th(e,t,r){this.props=e,this.context=t,this.refs=Gx,this.updater=r||zx}var rh=th.prototype=new qx;rh.constructor=th;Vx(rh,Li.prototype);rh.isPureReactComponent=!0;var zd=Array.isArray,Kx=Object.prototype.hasOwnProperty,nh={current:null},Xx={key:!0,ref:!0,__self:!0,__source:!0};function Yx(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Kx.call(t,n)&&!Xx.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:ml,type:e,key:s,ref:i,props:a,_owner:nh.current}}function qy(e,t){return{$$typeof:ml,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ah(e){return typeof e=="object"&&e!==null&&e.$$typeof===ml}function Ky(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Vd=/\/+/g;function Bu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ky(""+e.key):t.toString(36)}function uc(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case ml:case jy:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Bu(i,0):n,zd(a)?(r="",e!=null&&(r=e.replace(Vd,"$&/")+"/"),uc(a,t,r,"",function(c){return c})):a!=null&&(ah(a)&&(a=qy(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(Vd,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",zd(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Bu(s,o);i+=uc(s,t,r,l,a)}else if(l=Gy(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Bu(s,o++),i+=uc(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Ol(e,t,r){if(e==null)return e;var n=[],a=0;return uc(e,n,"","",function(s){return t.call(r,s,a++)}),n}function Xy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var jr={current:null},fc={transition:null},Yy={ReactCurrentDispatcher:jr,ReactCurrentBatchConfig:fc,ReactCurrentOwner:nh};function Jx(){throw Error("act(...) is not supported in production builds of React.")}nt.Children={map:Ol,forEach:function(e,t,r){Ol(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ol(e,function(){t++}),t},toArray:function(e){return Ol(e,function(t){return t})||[]},only:function(e){if(!ah(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};nt.Component=Li;nt.Fragment=Ly;nt.Profiler=By;nt.PureComponent=th;nt.StrictMode=My;nt.Suspense=Hy;nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yy;nt.act=Jx;nt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Vx({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=nh.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Kx.call(t,l)&&!Xx.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ml,type:e.type,key:a,ref:s,props:n,_owner:i}};nt.createContext=function(e){return e={$$typeof:$y,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Uy,_context:e},e.Consumer=e};nt.createElement=Yx;nt.createFactory=function(e){var t=Yx.bind(null,e);return t.type=e,t};nt.createRef=function(){return{current:null}};nt.forwardRef=function(e){return{$$typeof:Wy,render:e}};nt.isValidElement=ah;nt.lazy=function(e){return{$$typeof:Vy,_payload:{_status:-1,_result:e},_init:Xy}};nt.memo=function(e,t){return{$$typeof:zy,type:e,compare:t===void 0?null:t}};nt.startTransition=function(e){var t=fc.transition;fc.transition={};try{e()}finally{fc.transition=t}};nt.unstable_act=Jx;nt.useCallback=function(e,t){return jr.current.useCallback(e,t)};nt.useContext=function(e){return jr.current.useContext(e)};nt.useDebugValue=function(){};nt.useDeferredValue=function(e){return jr.current.useDeferredValue(e)};nt.useEffect=function(e,t){return jr.current.useEffect(e,t)};nt.useId=function(){return jr.current.useId()};nt.useImperativeHandle=function(e,t,r){return jr.current.useImperativeHandle(e,t,r)};nt.useInsertionEffect=function(e,t){return jr.current.useInsertionEffect(e,t)};nt.useLayoutEffect=function(e,t){return jr.current.useLayoutEffect(e,t)};nt.useMemo=function(e,t){return jr.current.useMemo(e,t)};nt.useReducer=function(e,t,r){return jr.current.useReducer(e,t,r)};nt.useRef=function(e){return jr.current.useRef(e)};nt.useState=function(e){return jr.current.useState(e)};nt.useSyncExternalStore=function(e,t,r){return jr.current.useSyncExternalStore(e,t,r)};nt.useTransition=function(){return jr.current.useTransition()};nt.version="18.3.1";Hx.exports=nt;var ne=Hx.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy=ne,Qy=Symbol.for("react.element"),Zy=Symbol.for("react.fragment"),e_=Object.prototype.hasOwnProperty,t_=Jy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r_={key:!0,ref:!0,__self:!0,__source:!0};function Qx(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)e_.call(t,n)&&!r_.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Qy,type:e,key:s,ref:i,props:a,_owner:t_.current}}cu.Fragment=Zy;cu.jsx=Qx;cu.jsxs=Qx;Wx.exports=cu;var f=Wx.exports,Zx={exports:{}},an={},e1={exports:{}},t1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,T){var q=ee.length;ee.push(T);e:for(;0<q;){var te=q-1>>>1,C=ee[te];if(0<a(C,T))ee[te]=T,ee[q]=C,q=te;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var T=ee[0],q=ee.pop();if(q!==T){ee[0]=q;e:for(var te=0,C=ee.length,M=C>>>1;te<M;){var W=2*(te+1)-1,P=ee[W],z=W+1,he=ee[z];if(0>a(P,q))z<C&&0>a(he,P)?(ee[te]=he,ee[z]=q,te=z):(ee[te]=P,ee[W]=q,te=W);else if(z<C&&0>a(he,q))ee[te]=he,ee[z]=q,te=z;else break e}}return T}function a(ee,T){var q=ee.sortIndex-T.sortIndex;return q!==0?q:ee.id-T.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,x=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(ee){for(var T=r(c);T!==null;){if(T.callback===null)n(c);else if(T.startTime<=ee)n(c),T.sortIndex=T.expirationTime,t(l,T);else break;T=r(c)}}function b(ee){if(m=!1,g(ee),!x)if(r(l)!==null)x=!0,me(I);else{var T=r(c);T!==null&&ie(b,T.startTime-ee)}}function I(ee,T){x=!1,m&&(m=!1,w(_),_=-1),p=!0;var q=d;try{for(g(T),h=r(l);h!==null&&(!(h.expirationTime>T)||ee&&!H());){var te=h.callback;if(typeof te=="function"){h.callback=null,d=h.priorityLevel;var C=te(h.expirationTime<=T);T=e.unstable_now(),typeof C=="function"?h.callback=C:h===r(l)&&n(l),g(T)}else n(l);h=r(l)}if(h!==null)var M=!0;else{var W=r(c);W!==null&&ie(b,W.startTime-T),M=!1}return M}finally{h=null,d=q,p=!1}}var A=!1,E=null,_=-1,k=5,O=-1;function H(){return!(e.unstable_now()-O<k)}function L(){if(E!==null){var ee=e.unstable_now();O=ee;var T=!0;try{T=E(!0,ee)}finally{T?V():(A=!1,E=null)}}else A=!1}var V;if(typeof y=="function")V=function(){y(L)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,de=Y.port2;Y.port1.onmessage=L,V=function(){de.postMessage(null)}}else V=function(){v(L,0)};function me(ee){E=ee,A||(A=!0,V())}function ie(ee,T){_=v(function(){ee(e.unstable_now())},T)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,me(I))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ee){switch(d){case 1:case 2:case 3:var T=3;break;default:T=d}var q=d;d=T;try{return ee()}finally{d=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,T){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var q=d;d=ee;try{return T()}finally{d=q}},e.unstable_scheduleCallback=function(ee,T,q){var te=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?te+q:te):q=te,ee){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=q+C,ee={id:u++,callback:T,priorityLevel:ee,startTime:q,expirationTime:C,sortIndex:-1},q>te?(ee.sortIndex=q,t(c,ee),r(l)===null&&ee===r(c)&&(m?(w(_),_=-1):m=!0,ie(b,q-te))):(ee.sortIndex=C,t(l,ee),x||p||(x=!0,me(I))),ee},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(ee){var T=d;return function(){var q=d;d=T;try{return ee.apply(this,arguments)}finally{d=q}}}})(t1);e1.exports=t1;var n_=e1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a_=ne,rn=n_;function we(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r1=new Set,Ro={};function Os(e,t){Ci(e,t),Ci(e+"Capture",t)}function Ci(e,t){for(Ro[e]=t,e=0;e<t.length;e++)r1.add(t[e])}var oa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),j0=Object.prototype.hasOwnProperty,s_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gd={},qd={};function i_(e){return j0.call(qd,e)?!0:j0.call(Gd,e)?!1:s_.test(e)?qd[e]=!0:(Gd[e]=!0,!1)}function o_(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function l_(e,t,r,n){if(t===null||typeof t>"u"||o_(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Lr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var mr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){mr[e]=new Lr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];mr[t]=new Lr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){mr[e]=new Lr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){mr[e]=new Lr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){mr[e]=new Lr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){mr[e]=new Lr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){mr[e]=new Lr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){mr[e]=new Lr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){mr[e]=new Lr(e,5,!1,e.toLowerCase(),null,!1,!1)});var sh=/[\-:]([a-z])/g;function ih(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(sh,ih);mr[t]=new Lr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(sh,ih);mr[t]=new Lr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(sh,ih);mr[t]=new Lr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){mr[e]=new Lr(e,1,!1,e.toLowerCase(),null,!1,!1)});mr.xlinkHref=new Lr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){mr[e]=new Lr(e,1,!1,e.toLowerCase(),null,!0,!0)});function oh(e,t,r,n){var a=mr.hasOwnProperty(t)?mr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(l_(t,r,a,n)&&(r=null),n||a===null?i_(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ha=a_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rl=Symbol.for("react.element"),ti=Symbol.for("react.portal"),ri=Symbol.for("react.fragment"),lh=Symbol.for("react.strict_mode"),L0=Symbol.for("react.profiler"),n1=Symbol.for("react.provider"),a1=Symbol.for("react.context"),ch=Symbol.for("react.forward_ref"),M0=Symbol.for("react.suspense"),B0=Symbol.for("react.suspense_list"),uh=Symbol.for("react.memo"),ya=Symbol.for("react.lazy"),s1=Symbol.for("react.offscreen"),Kd=Symbol.iterator;function Xi(e){return e===null||typeof e!="object"?null:(e=Kd&&e[Kd]||e["@@iterator"],typeof e=="function"?e:null)}var Dt=Object.assign,Uu;function ao(e){if(Uu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Uu=t&&t[1]||""}return`
`+Uu+e}var $u=!1;function Wu(e,t){if(!e||$u)return"";$u=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{$u=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ao(e):""}function c_(e){switch(e.tag){case 5:return ao(e.type);case 16:return ao("Lazy");case 13:return ao("Suspense");case 19:return ao("SuspenseList");case 0:case 2:case 15:return e=Wu(e.type,!1),e;case 11:return e=Wu(e.type.render,!1),e;case 1:return e=Wu(e.type,!0),e;default:return""}}function U0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ri:return"Fragment";case ti:return"Portal";case L0:return"Profiler";case lh:return"StrictMode";case M0:return"Suspense";case B0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case a1:return(e.displayName||"Context")+".Consumer";case n1:return(e._context.displayName||"Context")+".Provider";case ch:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case uh:return t=e.displayName||null,t!==null?t:U0(e.type)||"Memo";case ya:t=e._payload,e=e._init;try{return U0(e(t))}catch{}}return null}function u_(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U0(t);case 8:return t===lh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ma(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function i1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function f_(e){var t=i1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Il(e){e._valueTracker||(e._valueTracker=f_(e))}function o1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=i1(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function kc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $0(e,t){var r=t.checked;return Dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Xd(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ma(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function l1(e,t){t=t.checked,t!=null&&oh(e,"checked",t,!1)}function W0(e,t){l1(e,t);var r=Ma(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?H0(e,t.type,r):t.hasOwnProperty("defaultValue")&&H0(e,t.type,Ma(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Yd(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function H0(e,t,r){(t!=="number"||kc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var so=Array.isArray;function xi(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ma(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function z0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(we(91));return Dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Jd(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(we(92));if(so(r)){if(1<r.length)throw Error(we(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ma(r)}}function c1(e,t){var r=Ma(t.value),n=Ma(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Qd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function u1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function V0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?u1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Pl,f1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Pl=Pl||document.createElement("div"),Pl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Pl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Io(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ho={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},h_=["Webkit","ms","Moz","O"];Object.keys(ho).forEach(function(e){h_.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ho[t]=ho[e]})});function h1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ho.hasOwnProperty(e)&&ho[e]?(""+t).trim():t+"px"}function d1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=h1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var d_=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function G0(e,t){if(t){if(d_[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(we(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(we(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(we(61))}if(t.style!=null&&typeof t.style!="object")throw Error(we(62))}}function q0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var K0=null;function fh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var X0=null,gi=null,vi=null;function Zd(e){if(e=vl(e)){if(typeof X0!="function")throw Error(we(280));var t=e.stateNode;t&&(t=pu(t),X0(e.stateNode,e.type,t))}}function p1(e){gi?vi?vi.push(e):vi=[e]:gi=e}function m1(){if(gi){var e=gi,t=vi;if(vi=gi=null,Zd(e),t)for(e=0;e<t.length;e++)Zd(t[e])}}function x1(e,t){return e(t)}function g1(){}var Hu=!1;function v1(e,t,r){if(Hu)return e(t,r);Hu=!0;try{return x1(e,t,r)}finally{Hu=!1,(gi!==null||vi!==null)&&(g1(),m1())}}function Po(e,t){var r=e.stateNode;if(r===null)return null;var n=pu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(we(231,t,typeof r));return r}var Y0=!1;if(oa)try{var Yi={};Object.defineProperty(Yi,"passive",{get:function(){Y0=!0}}),window.addEventListener("test",Yi,Yi),window.removeEventListener("test",Yi,Yi)}catch{Y0=!1}function p_(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var po=!1,Ec=null,Sc=!1,J0=null,m_={onError:function(e){po=!0,Ec=e}};function x_(e,t,r,n,a,s,i,o,l){po=!1,Ec=null,p_.apply(m_,arguments)}function g_(e,t,r,n,a,s,i,o,l){if(x_.apply(this,arguments),po){if(po){var c=Ec;po=!1,Ec=null}else throw Error(we(198));Sc||(Sc=!0,J0=c)}}function Rs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function w1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ep(e){if(Rs(e)!==e)throw Error(we(188))}function v_(e){var t=e.alternate;if(!t){if(t=Rs(e),t===null)throw Error(we(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return ep(a),e;if(s===n)return ep(a),t;s=s.sibling}throw Error(we(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(we(189))}}if(r.alternate!==n)throw Error(we(190))}if(r.tag!==3)throw Error(we(188));return r.stateNode.current===r?e:t}function y1(e){return e=v_(e),e!==null?_1(e):null}function _1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_1(e);if(t!==null)return t;e=e.sibling}return null}var k1=rn.unstable_scheduleCallback,tp=rn.unstable_cancelCallback,w_=rn.unstable_shouldYield,y_=rn.unstable_requestPaint,Ht=rn.unstable_now,__=rn.unstable_getCurrentPriorityLevel,hh=rn.unstable_ImmediatePriority,E1=rn.unstable_UserBlockingPriority,bc=rn.unstable_NormalPriority,k_=rn.unstable_LowPriority,S1=rn.unstable_IdlePriority,uu=null,Vn=null;function E_(e){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(uu,e,void 0,(e.current.flags&128)===128)}catch{}}var In=Math.clz32?Math.clz32:T_,S_=Math.log,b_=Math.LN2;function T_(e){return e>>>=0,e===0?32:31-(S_(e)/b_|0)|0}var Dl=64,jl=4194304;function io(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=io(o):(s&=i,s!==0&&(n=io(s)))}else i=r&~a,i!==0?n=io(i):s!==0&&(n=io(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-In(t),a=1<<r,n|=e[r],t&=~a;return n}function C_(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function A_(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-In(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=C_(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function Q0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function b1(){var e=Dl;return Dl<<=1,!(Dl&4194240)&&(Dl=64),e}function zu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-In(t),e[t]=r}function N_(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-In(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function dh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-In(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var xt=0;function T1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var C1,ph,A1,N1,F1,Z0=!1,Ll=[],Fa=null,Oa=null,Ra=null,Do=new Map,jo=new Map,Ea=[],F_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rp(e,t){switch(e){case"focusin":case"focusout":Fa=null;break;case"dragenter":case"dragleave":Oa=null;break;case"mouseover":case"mouseout":Ra=null;break;case"pointerover":case"pointerout":Do.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jo.delete(t.pointerId)}}function Ji(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=vl(t),t!==null&&ph(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function O_(e,t,r,n,a){switch(t){case"focusin":return Fa=Ji(Fa,e,t,r,n,a),!0;case"dragenter":return Oa=Ji(Oa,e,t,r,n,a),!0;case"mouseover":return Ra=Ji(Ra,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Do.set(s,Ji(Do.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,jo.set(s,Ji(jo.get(s)||null,e,t,r,n,a)),!0}return!1}function O1(e){var t=cs(e.target);if(t!==null){var r=Rs(t);if(r!==null){if(t=r.tag,t===13){if(t=w1(r),t!==null){e.blockedOn=t,F1(e.priority,function(){A1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ef(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);K0=n,r.target.dispatchEvent(n),K0=null}else return t=vl(r),t!==null&&ph(t),e.blockedOn=r,!1;t.shift()}return!0}function np(e,t,r){hc(e)&&r.delete(t)}function R_(){Z0=!1,Fa!==null&&hc(Fa)&&(Fa=null),Oa!==null&&hc(Oa)&&(Oa=null),Ra!==null&&hc(Ra)&&(Ra=null),Do.forEach(np),jo.forEach(np)}function Qi(e,t){e.blockedOn===t&&(e.blockedOn=null,Z0||(Z0=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,R_)))}function Lo(e){function t(a){return Qi(a,e)}if(0<Ll.length){Qi(Ll[0],e);for(var r=1;r<Ll.length;r++){var n=Ll[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Fa!==null&&Qi(Fa,e),Oa!==null&&Qi(Oa,e),Ra!==null&&Qi(Ra,e),Do.forEach(t),jo.forEach(t),r=0;r<Ea.length;r++)n=Ea[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ea.length&&(r=Ea[0],r.blockedOn===null);)O1(r),r.blockedOn===null&&Ea.shift()}var wi=ha.ReactCurrentBatchConfig,Cc=!0;function I_(e,t,r,n){var a=xt,s=wi.transition;wi.transition=null;try{xt=1,mh(e,t,r,n)}finally{xt=a,wi.transition=s}}function P_(e,t,r,n){var a=xt,s=wi.transition;wi.transition=null;try{xt=4,mh(e,t,r,n)}finally{xt=a,wi.transition=s}}function mh(e,t,r,n){if(Cc){var a=ef(e,t,r,n);if(a===null)e0(e,t,n,Ac,r),rp(e,n);else if(O_(a,e,t,r,n))n.stopPropagation();else if(rp(e,n),t&4&&-1<F_.indexOf(e)){for(;a!==null;){var s=vl(a);if(s!==null&&C1(s),s=ef(e,t,r,n),s===null&&e0(e,t,n,Ac,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else e0(e,t,n,null,r)}}var Ac=null;function ef(e,t,r,n){if(Ac=null,e=fh(n),e=cs(e),e!==null)if(t=Rs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=w1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ac=e,null}function R1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(__()){case hh:return 1;case E1:return 4;case bc:case k_:return 16;case S1:return 536870912;default:return 16}default:return 16}}var Ta=null,xh=null,dc=null;function I1(){if(dc)return dc;var e,t=xh,r=t.length,n,a="value"in Ta?Ta.value:Ta.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return dc=a.slice(e,1<n?1-n:void 0)}function pc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ml(){return!0}function ap(){return!1}function sn(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ml:ap,this.isPropagationStopped=ap,this}return Dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ml)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ml)},persist:function(){},isPersistent:Ml}),t}var Mi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gh=sn(Mi),gl=Dt({},Mi,{view:0,detail:0}),D_=sn(gl),Vu,Gu,Zi,fu=Dt({},gl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zi&&(Zi&&e.type==="mousemove"?(Vu=e.screenX-Zi.screenX,Gu=e.screenY-Zi.screenY):Gu=Vu=0,Zi=e),Vu)},movementY:function(e){return"movementY"in e?e.movementY:Gu}}),sp=sn(fu),j_=Dt({},fu,{dataTransfer:0}),L_=sn(j_),M_=Dt({},gl,{relatedTarget:0}),qu=sn(M_),B_=Dt({},Mi,{animationName:0,elapsedTime:0,pseudoElement:0}),U_=sn(B_),$_=Dt({},Mi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),W_=sn($_),H_=Dt({},Mi,{data:0}),ip=sn(H_),z_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=G_[e])?!!t[e]:!1}function vh(){return q_}var K_=Dt({},gl,{key:function(e){if(e.key){var t=z_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?V_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vh,charCode:function(e){return e.type==="keypress"?pc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),X_=sn(K_),Y_=Dt({},fu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),op=sn(Y_),J_=Dt({},gl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vh}),Q_=sn(J_),Z_=Dt({},Mi,{propertyName:0,elapsedTime:0,pseudoElement:0}),e2=sn(Z_),t2=Dt({},fu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),r2=sn(t2),n2=[9,13,27,32],wh=oa&&"CompositionEvent"in window,mo=null;oa&&"documentMode"in document&&(mo=document.documentMode);var a2=oa&&"TextEvent"in window&&!mo,P1=oa&&(!wh||mo&&8<mo&&11>=mo),lp=" ",cp=!1;function D1(e,t){switch(e){case"keyup":return n2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ni=!1;function s2(e,t){switch(e){case"compositionend":return j1(t);case"keypress":return t.which!==32?null:(cp=!0,lp);case"textInput":return e=t.data,e===lp&&cp?null:e;default:return null}}function i2(e,t){if(ni)return e==="compositionend"||!wh&&D1(e,t)?(e=I1(),dc=xh=Ta=null,ni=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return P1&&t.locale!=="ko"?null:t.data;default:return null}}var o2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function up(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!o2[e.type]:t==="textarea"}function L1(e,t,r,n){p1(n),t=Nc(t,"onChange"),0<t.length&&(r=new gh("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var xo=null,Mo=null;function l2(e){K1(e,0)}function hu(e){var t=ii(e);if(o1(t))return e}function c2(e,t){if(e==="change")return t}var M1=!1;if(oa){var Ku;if(oa){var Xu="oninput"in document;if(!Xu){var fp=document.createElement("div");fp.setAttribute("oninput","return;"),Xu=typeof fp.oninput=="function"}Ku=Xu}else Ku=!1;M1=Ku&&(!document.documentMode||9<document.documentMode)}function hp(){xo&&(xo.detachEvent("onpropertychange",B1),Mo=xo=null)}function B1(e){if(e.propertyName==="value"&&hu(Mo)){var t=[];L1(t,Mo,e,fh(e)),v1(l2,t)}}function u2(e,t,r){e==="focusin"?(hp(),xo=t,Mo=r,xo.attachEvent("onpropertychange",B1)):e==="focusout"&&hp()}function f2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hu(Mo)}function h2(e,t){if(e==="click")return hu(t)}function d2(e,t){if(e==="input"||e==="change")return hu(t)}function p2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ln=typeof Object.is=="function"?Object.is:p2;function Bo(e,t){if(Ln(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!j0.call(t,a)||!Ln(e[a],t[a]))return!1}return!0}function dp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pp(e,t){var r=dp(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dp(r)}}function U1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?U1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $1(){for(var e=window,t=kc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=kc(e.document)}return t}function yh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function m2(e){var t=$1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&U1(r.ownerDocument.documentElement,r)){if(n!==null&&yh(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=pp(r,s);var i=pp(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var x2=oa&&"documentMode"in document&&11>=document.documentMode,ai=null,tf=null,go=null,rf=!1;function mp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;rf||ai==null||ai!==kc(n)||(n=ai,"selectionStart"in n&&yh(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),go&&Bo(go,n)||(go=n,n=Nc(tf,"onSelect"),0<n.length&&(t=new gh("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ai)))}function Bl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var si={animationend:Bl("Animation","AnimationEnd"),animationiteration:Bl("Animation","AnimationIteration"),animationstart:Bl("Animation","AnimationStart"),transitionend:Bl("Transition","TransitionEnd")},Yu={},W1={};oa&&(W1=document.createElement("div").style,"AnimationEvent"in window||(delete si.animationend.animation,delete si.animationiteration.animation,delete si.animationstart.animation),"TransitionEvent"in window||delete si.transitionend.transition);function du(e){if(Yu[e])return Yu[e];if(!si[e])return e;var t=si[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in W1)return Yu[e]=t[r];return e}var H1=du("animationend"),z1=du("animationiteration"),V1=du("animationstart"),G1=du("transitionend"),q1=new Map,xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Va(e,t){q1.set(e,t),Os(t,[e])}for(var Ju=0;Ju<xp.length;Ju++){var Qu=xp[Ju],g2=Qu.toLowerCase(),v2=Qu[0].toUpperCase()+Qu.slice(1);Va(g2,"on"+v2)}Va(H1,"onAnimationEnd");Va(z1,"onAnimationIteration");Va(V1,"onAnimationStart");Va("dblclick","onDoubleClick");Va("focusin","onFocus");Va("focusout","onBlur");Va(G1,"onTransitionEnd");Ci("onMouseEnter",["mouseout","mouseover"]);Ci("onMouseLeave",["mouseout","mouseover"]);Ci("onPointerEnter",["pointerout","pointerover"]);Ci("onPointerLeave",["pointerout","pointerover"]);Os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Os("onBeforeInput",["compositionend","keypress","textInput","paste"]);Os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w2=new Set("cancel close invalid load scroll toggle".split(" ").concat(oo));function gp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,g_(n,t,void 0,e),e.currentTarget=null}function K1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;gp(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;gp(a,o,c),s=l}}}if(Sc)throw e=J0,Sc=!1,J0=null,e}function kt(e,t){var r=t[lf];r===void 0&&(r=t[lf]=new Set);var n=e+"__bubble";r.has(n)||(X1(t,e,2,!1),r.add(n))}function Zu(e,t,r){var n=0;t&&(n|=4),X1(r,e,n,t)}var Ul="_reactListening"+Math.random().toString(36).slice(2);function Uo(e){if(!e[Ul]){e[Ul]=!0,r1.forEach(function(r){r!=="selectionchange"&&(w2.has(r)||Zu(r,!1,e),Zu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ul]||(t[Ul]=!0,Zu("selectionchange",!1,t))}}function X1(e,t,r,n){switch(R1(t)){case 1:var a=I_;break;case 4:a=P_;break;default:a=mh}r=a.bind(null,t,r,e),a=void 0,!Y0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function e0(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=cs(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}v1(function(){var c=s,u=fh(r),h=[];e:{var d=q1.get(e);if(d!==void 0){var p=gh,x=e;switch(e){case"keypress":if(pc(r)===0)break e;case"keydown":case"keyup":p=X_;break;case"focusin":x="focus",p=qu;break;case"focusout":x="blur",p=qu;break;case"beforeblur":case"afterblur":p=qu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=sp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=L_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Q_;break;case H1:case z1:case V1:p=U_;break;case G1:p=e2;break;case"scroll":p=D_;break;case"wheel":p=r2;break;case"copy":case"cut":case"paste":p=W_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=op}var m=(t&4)!==0,v=!m&&e==="scroll",w=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,g;y!==null;){g=y;var b=g.stateNode;if(g.tag===5&&b!==null&&(g=b,w!==null&&(b=Po(y,w),b!=null&&m.push($o(y,b,g)))),v)break;y=y.return}0<m.length&&(d=new p(d,x,null,r,u),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==K0&&(x=r.relatedTarget||r.fromElement)&&(cs(x)||x[la]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?cs(x):null,x!==null&&(v=Rs(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(m=sp,b="onMouseLeave",w="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=op,b="onPointerLeave",w="onPointerEnter",y="pointer"),v=p==null?d:ii(p),g=x==null?d:ii(x),d=new m(b,y+"leave",p,r,u),d.target=v,d.relatedTarget=g,b=null,cs(u)===c&&(m=new m(w,y+"enter",x,r,u),m.target=g,m.relatedTarget=v,b=m),v=b,p&&x)t:{for(m=p,w=x,y=0,g=m;g;g=$s(g))y++;for(g=0,b=w;b;b=$s(b))g++;for(;0<y-g;)m=$s(m),y--;for(;0<g-y;)w=$s(w),g--;for(;y--;){if(m===w||w!==null&&m===w.alternate)break t;m=$s(m),w=$s(w)}m=null}else m=null;p!==null&&vp(h,d,p,m,!1),x!==null&&v!==null&&vp(h,v,x,m,!0)}}e:{if(d=c?ii(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var I=c2;else if(up(d))if(M1)I=d2;else{I=f2;var A=u2}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(I=h2);if(I&&(I=I(e,c))){L1(h,I,r,u);break e}A&&A(e,d,c),e==="focusout"&&(A=d._wrapperState)&&A.controlled&&d.type==="number"&&H0(d,"number",d.value)}switch(A=c?ii(c):window,e){case"focusin":(up(A)||A.contentEditable==="true")&&(ai=A,tf=c,go=null);break;case"focusout":go=tf=ai=null;break;case"mousedown":rf=!0;break;case"contextmenu":case"mouseup":case"dragend":rf=!1,mp(h,r,u);break;case"selectionchange":if(x2)break;case"keydown":case"keyup":mp(h,r,u)}var E;if(wh)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else ni?D1(e,r)&&(_="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(_="onCompositionStart");_&&(P1&&r.locale!=="ko"&&(ni||_!=="onCompositionStart"?_==="onCompositionEnd"&&ni&&(E=I1()):(Ta=u,xh="value"in Ta?Ta.value:Ta.textContent,ni=!0)),A=Nc(c,_),0<A.length&&(_=new ip(_,e,null,r,u),h.push({event:_,listeners:A}),E?_.data=E:(E=j1(r),E!==null&&(_.data=E)))),(E=a2?s2(e,r):i2(e,r))&&(c=Nc(c,"onBeforeInput"),0<c.length&&(u=new ip("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=E))}K1(h,t)})}function $o(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Nc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Po(e,r),s!=null&&n.unshift($o(e,s,a)),s=Po(e,t),s!=null&&n.push($o(e,s,a))),e=e.return}return n}function $s(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vp(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Po(r,s),l!=null&&i.unshift($o(r,l,o))):a||(l=Po(r,s),l!=null&&i.push($o(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var y2=/\r\n?/g,_2=/\u0000|\uFFFD/g;function wp(e){return(typeof e=="string"?e:""+e).replace(y2,`
`).replace(_2,"")}function $l(e,t,r){if(t=wp(t),wp(e)!==t&&r)throw Error(we(425))}function Fc(){}var nf=null,af=null;function sf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var of=typeof setTimeout=="function"?setTimeout:void 0,k2=typeof clearTimeout=="function"?clearTimeout:void 0,yp=typeof Promise=="function"?Promise:void 0,E2=typeof queueMicrotask=="function"?queueMicrotask:typeof yp<"u"?function(e){return yp.resolve(null).then(e).catch(S2)}:of;function S2(e){setTimeout(function(){throw e})}function t0(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Lo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Lo(t)}function Ia(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function _p(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Bi=Math.random().toString(36).slice(2),Hn="__reactFiber$"+Bi,Wo="__reactProps$"+Bi,la="__reactContainer$"+Bi,lf="__reactEvents$"+Bi,b2="__reactListeners$"+Bi,T2="__reactHandles$"+Bi;function cs(e){var t=e[Hn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[la]||r[Hn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=_p(e);e!==null;){if(r=e[Hn])return r;e=_p(e)}return t}e=r,r=e.parentNode}return null}function vl(e){return e=e[Hn]||e[la],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ii(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(we(33))}function pu(e){return e[Wo]||null}var cf=[],oi=-1;function Ga(e){return{current:e}}function St(e){0>oi||(e.current=cf[oi],cf[oi]=null,oi--)}function yt(e,t){oi++,cf[oi]=e.current,e.current=t}var Ba={},Cr=Ga(Ba),$r=Ga(!1),ys=Ba;function Ai(e,t){var r=e.type.contextTypes;if(!r)return Ba;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Wr(e){return e=e.childContextTypes,e!=null}function Oc(){St($r),St(Cr)}function kp(e,t,r){if(Cr.current!==Ba)throw Error(we(168));yt(Cr,t),yt($r,r)}function Y1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(we(108,u_(e)||"Unknown",a));return Dt({},r,n)}function Rc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ba,ys=Cr.current,yt(Cr,e),yt($r,$r.current),!0}function Ep(e,t,r){var n=e.stateNode;if(!n)throw Error(we(169));r?(e=Y1(e,t,ys),n.__reactInternalMemoizedMergedChildContext=e,St($r),St(Cr),yt(Cr,e)):St($r),yt($r,r)}var Zn=null,mu=!1,r0=!1;function J1(e){Zn===null?Zn=[e]:Zn.push(e)}function C2(e){mu=!0,J1(e)}function qa(){if(!r0&&Zn!==null){r0=!0;var e=0,t=xt;try{var r=Zn;for(xt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Zn=null,mu=!1}catch(a){throw Zn!==null&&(Zn=Zn.slice(e+1)),k1(hh,qa),a}finally{xt=t,r0=!1}}return null}var li=[],ci=0,Ic=null,Pc=0,pn=[],mn=0,_s=null,ea=1,ta="";function ns(e,t){li[ci++]=Pc,li[ci++]=Ic,Ic=e,Pc=t}function Q1(e,t,r){pn[mn++]=ea,pn[mn++]=ta,pn[mn++]=_s,_s=e;var n=ea;e=ta;var a=32-In(n)-1;n&=~(1<<a),r+=1;var s=32-In(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ea=1<<32-In(t)+a|r<<a|n,ta=s+e}else ea=1<<s|r<<a|n,ta=e}function _h(e){e.return!==null&&(ns(e,1),Q1(e,1,0))}function kh(e){for(;e===Ic;)Ic=li[--ci],li[ci]=null,Pc=li[--ci],li[ci]=null;for(;e===_s;)_s=pn[--mn],pn[mn]=null,ta=pn[--mn],pn[mn]=null,ea=pn[--mn],pn[mn]=null}var tn=null,en=null,Ct=!1,Fn=null;function Z1(e,t){var r=xn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Sp(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,tn=e,en=Ia(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,tn=e,en=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_s!==null?{id:ea,overflow:ta}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=xn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,tn=e,en=null,!0):!1;default:return!1}}function uf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ff(e){if(Ct){var t=en;if(t){var r=t;if(!Sp(e,t)){if(uf(e))throw Error(we(418));t=Ia(r.nextSibling);var n=tn;t&&Sp(e,t)?Z1(n,r):(e.flags=e.flags&-4097|2,Ct=!1,tn=e)}}else{if(uf(e))throw Error(we(418));e.flags=e.flags&-4097|2,Ct=!1,tn=e}}}function bp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;tn=e}function Wl(e){if(e!==tn)return!1;if(!Ct)return bp(e),Ct=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!sf(e.type,e.memoizedProps)),t&&(t=en)){if(uf(e))throw eg(),Error(we(418));for(;t;)Z1(e,t),t=Ia(t.nextSibling)}if(bp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(we(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){en=Ia(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}en=null}}else en=tn?Ia(e.stateNode.nextSibling):null;return!0}function eg(){for(var e=en;e;)e=Ia(e.nextSibling)}function Ni(){en=tn=null,Ct=!1}function Eh(e){Fn===null?Fn=[e]:Fn.push(e)}var A2=ha.ReactCurrentBatchConfig;function eo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(we(309));var n=r.stateNode}if(!n)throw Error(we(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(we(284));if(!r._owner)throw Error(we(290,e))}return e}function Hl(e,t){throw e=Object.prototype.toString.call(t),Error(we(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Tp(e){var t=e._init;return t(e._payload)}function tg(e){function t(w,y){if(e){var g=w.deletions;g===null?(w.deletions=[y],w.flags|=16):g.push(y)}}function r(w,y){if(!e)return null;for(;y!==null;)t(w,y),y=y.sibling;return null}function n(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function a(w,y){return w=La(w,y),w.index=0,w.sibling=null,w}function s(w,y,g){return w.index=g,e?(g=w.alternate,g!==null?(g=g.index,g<y?(w.flags|=2,y):g):(w.flags|=2,y)):(w.flags|=1048576,y)}function i(w){return e&&w.alternate===null&&(w.flags|=2),w}function o(w,y,g,b){return y===null||y.tag!==6?(y=c0(g,w.mode,b),y.return=w,y):(y=a(y,g),y.return=w,y)}function l(w,y,g,b){var I=g.type;return I===ri?u(w,y,g.props.children,b,g.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ya&&Tp(I)===y.type)?(b=a(y,g.props),b.ref=eo(w,y,g),b.return=w,b):(b=_c(g.type,g.key,g.props,null,w.mode,b),b.ref=eo(w,y,g),b.return=w,b)}function c(w,y,g,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=u0(g,w.mode,b),y.return=w,y):(y=a(y,g.children||[]),y.return=w,y)}function u(w,y,g,b,I){return y===null||y.tag!==7?(y=ms(g,w.mode,b,I),y.return=w,y):(y=a(y,g),y.return=w,y)}function h(w,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=c0(""+y,w.mode,g),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Rl:return g=_c(y.type,y.key,y.props,null,w.mode,g),g.ref=eo(w,null,y),g.return=w,g;case ti:return y=u0(y,w.mode,g),y.return=w,y;case ya:var b=y._init;return h(w,b(y._payload),g)}if(so(y)||Xi(y))return y=ms(y,w.mode,g,null),y.return=w,y;Hl(w,y)}return null}function d(w,y,g,b){var I=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return I!==null?null:o(w,y,""+g,b);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Rl:return g.key===I?l(w,y,g,b):null;case ti:return g.key===I?c(w,y,g,b):null;case ya:return I=g._init,d(w,y,I(g._payload),b)}if(so(g)||Xi(g))return I!==null?null:u(w,y,g,b,null);Hl(w,g)}return null}function p(w,y,g,b,I){if(typeof b=="string"&&b!==""||typeof b=="number")return w=w.get(g)||null,o(y,w,""+b,I);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Rl:return w=w.get(b.key===null?g:b.key)||null,l(y,w,b,I);case ti:return w=w.get(b.key===null?g:b.key)||null,c(y,w,b,I);case ya:var A=b._init;return p(w,y,g,A(b._payload),I)}if(so(b)||Xi(b))return w=w.get(g)||null,u(y,w,b,I,null);Hl(y,b)}return null}function x(w,y,g,b){for(var I=null,A=null,E=y,_=y=0,k=null;E!==null&&_<g.length;_++){E.index>_?(k=E,E=null):k=E.sibling;var O=d(w,E,g[_],b);if(O===null){E===null&&(E=k);break}e&&E&&O.alternate===null&&t(w,E),y=s(O,y,_),A===null?I=O:A.sibling=O,A=O,E=k}if(_===g.length)return r(w,E),Ct&&ns(w,_),I;if(E===null){for(;_<g.length;_++)E=h(w,g[_],b),E!==null&&(y=s(E,y,_),A===null?I=E:A.sibling=E,A=E);return Ct&&ns(w,_),I}for(E=n(w,E);_<g.length;_++)k=p(E,w,_,g[_],b),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?_:k.key),y=s(k,y,_),A===null?I=k:A.sibling=k,A=k);return e&&E.forEach(function(H){return t(w,H)}),Ct&&ns(w,_),I}function m(w,y,g,b){var I=Xi(g);if(typeof I!="function")throw Error(we(150));if(g=I.call(g),g==null)throw Error(we(151));for(var A=I=null,E=y,_=y=0,k=null,O=g.next();E!==null&&!O.done;_++,O=g.next()){E.index>_?(k=E,E=null):k=E.sibling;var H=d(w,E,O.value,b);if(H===null){E===null&&(E=k);break}e&&E&&H.alternate===null&&t(w,E),y=s(H,y,_),A===null?I=H:A.sibling=H,A=H,E=k}if(O.done)return r(w,E),Ct&&ns(w,_),I;if(E===null){for(;!O.done;_++,O=g.next())O=h(w,O.value,b),O!==null&&(y=s(O,y,_),A===null?I=O:A.sibling=O,A=O);return Ct&&ns(w,_),I}for(E=n(w,E);!O.done;_++,O=g.next())O=p(E,w,_,O.value,b),O!==null&&(e&&O.alternate!==null&&E.delete(O.key===null?_:O.key),y=s(O,y,_),A===null?I=O:A.sibling=O,A=O);return e&&E.forEach(function(L){return t(w,L)}),Ct&&ns(w,_),I}function v(w,y,g,b){if(typeof g=="object"&&g!==null&&g.type===ri&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Rl:e:{for(var I=g.key,A=y;A!==null;){if(A.key===I){if(I=g.type,I===ri){if(A.tag===7){r(w,A.sibling),y=a(A,g.props.children),y.return=w,w=y;break e}}else if(A.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ya&&Tp(I)===A.type){r(w,A.sibling),y=a(A,g.props),y.ref=eo(w,A,g),y.return=w,w=y;break e}r(w,A);break}else t(w,A);A=A.sibling}g.type===ri?(y=ms(g.props.children,w.mode,b,g.key),y.return=w,w=y):(b=_c(g.type,g.key,g.props,null,w.mode,b),b.ref=eo(w,y,g),b.return=w,w=b)}return i(w);case ti:e:{for(A=g.key;y!==null;){if(y.key===A)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(w,y.sibling),y=a(y,g.children||[]),y.return=w,w=y;break e}else{r(w,y);break}else t(w,y);y=y.sibling}y=u0(g,w.mode,b),y.return=w,w=y}return i(w);case ya:return A=g._init,v(w,y,A(g._payload),b)}if(so(g))return x(w,y,g,b);if(Xi(g))return m(w,y,g,b);Hl(w,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(w,y.sibling),y=a(y,g),y.return=w,w=y):(r(w,y),y=c0(g,w.mode,b),y.return=w,w=y),i(w)):r(w,y)}return v}var Fi=tg(!0),rg=tg(!1),Dc=Ga(null),jc=null,ui=null,Sh=null;function bh(){Sh=ui=jc=null}function Th(e){var t=Dc.current;St(Dc),e._currentValue=t}function hf(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function yi(e,t){jc=e,Sh=ui=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ur=!0),e.firstContext=null)}function wn(e){var t=e._currentValue;if(Sh!==e)if(e={context:e,memoizedValue:t,next:null},ui===null){if(jc===null)throw Error(we(308));ui=e,jc.dependencies={lanes:0,firstContext:e}}else ui=ui.next=e;return t}var us=null;function Ch(e){us===null?us=[e]:us.push(e)}function ng(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Ch(t)):(r.next=a.next,a.next=r),t.interleaved=r,ca(e,n)}function ca(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var _a=!1;function Ah(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ag(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function na(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Pa(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ot&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ca(e,r)}return a=n.interleaved,a===null?(t.next=t,Ch(n)):(t.next=a.next,a.next=t),n.interleaved=t,ca(e,r)}function mc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dh(e,r)}}function Cp(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Lc(e,t,r,n){var a=e.updateQueue;_a=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=a.baseState;i=0,u=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,m=o;switch(d=t,p=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){h=x.call(p,h,d);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,d=typeof x=="function"?x.call(p,h,d):x,d==null)break e;h=Dt({},h,d);break e;case 2:_a=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,i|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(u===null&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Es|=i,e.lanes=i,e.memoizedState=h}}function Ap(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(we(191,a));a.call(n)}}}var wl={},Gn=Ga(wl),Ho=Ga(wl),zo=Ga(wl);function fs(e){if(e===wl)throw Error(we(174));return e}function Nh(e,t){switch(yt(zo,t),yt(Ho,e),yt(Gn,wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:V0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=V0(t,e)}St(Gn),yt(Gn,t)}function Oi(){St(Gn),St(Ho),St(zo)}function sg(e){fs(zo.current);var t=fs(Gn.current),r=V0(t,e.type);t!==r&&(yt(Ho,e),yt(Gn,r))}function Fh(e){Ho.current===e&&(St(Gn),St(Ho))}var Ot=Ga(0);function Mc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var n0=[];function Oh(){for(var e=0;e<n0.length;e++)n0[e]._workInProgressVersionPrimary=null;n0.length=0}var xc=ha.ReactCurrentDispatcher,a0=ha.ReactCurrentBatchConfig,ks=0,Pt=null,Qt=null,ar=null,Bc=!1,vo=!1,Vo=0,N2=0;function vr(){throw Error(we(321))}function Rh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ln(e[r],t[r]))return!1;return!0}function Ih(e,t,r,n,a,s){if(ks=s,Pt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,xc.current=e===null||e.memoizedState===null?I2:P2,e=r(n,a),vo){s=0;do{if(vo=!1,Vo=0,25<=s)throw Error(we(301));s+=1,ar=Qt=null,t.updateQueue=null,xc.current=D2,e=r(n,a)}while(vo)}if(xc.current=Uc,t=Qt!==null&&Qt.next!==null,ks=0,ar=Qt=Pt=null,Bc=!1,t)throw Error(we(300));return e}function Ph(){var e=Vo!==0;return Vo=0,e}function Wn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ar===null?Pt.memoizedState=ar=e:ar=ar.next=e,ar}function yn(){if(Qt===null){var e=Pt.alternate;e=e!==null?e.memoizedState:null}else e=Qt.next;var t=ar===null?Pt.memoizedState:ar.next;if(t!==null)ar=t,Qt=e;else{if(e===null)throw Error(we(310));Qt=e,e={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},ar===null?Pt.memoizedState=ar=e:ar=ar.next=e}return ar}function Go(e,t){return typeof t=="function"?t(e):t}function s0(e){var t=yn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=Qt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var u=c.lane;if((ks&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,Pt.lanes|=u,Es|=u}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,Ln(n,t.memoizedState)||(Ur=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Pt.lanes|=s,Es|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function i0(e){var t=yn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Ln(s,t.memoizedState)||(Ur=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function ig(){}function og(e,t){var r=Pt,n=yn(),a=t(),s=!Ln(n.memoizedState,a);if(s&&(n.memoizedState=a,Ur=!0),n=n.queue,Dh(ug.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||ar!==null&&ar.memoizedState.tag&1){if(r.flags|=2048,qo(9,cg.bind(null,r,n,a,t),void 0,null),or===null)throw Error(we(349));ks&30||lg(r,t,a)}return a}function lg(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Pt.updateQueue,t===null?(t={lastEffect:null,stores:null},Pt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function cg(e,t,r,n){t.value=r,t.getSnapshot=n,fg(t)&&hg(e)}function ug(e,t,r){return r(function(){fg(t)&&hg(e)})}function fg(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ln(e,r)}catch{return!0}}function hg(e){var t=ca(e,1);t!==null&&Pn(t,e,1,-1)}function Np(e){var t=Wn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:e},t.queue=e,e=e.dispatch=R2.bind(null,Pt,e),[t.memoizedState,e]}function qo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Pt.updateQueue,t===null?(t={lastEffect:null,stores:null},Pt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function dg(){return yn().memoizedState}function gc(e,t,r,n){var a=Wn();Pt.flags|=e,a.memoizedState=qo(1|t,r,void 0,n===void 0?null:n)}function xu(e,t,r,n){var a=yn();n=n===void 0?null:n;var s=void 0;if(Qt!==null){var i=Qt.memoizedState;if(s=i.destroy,n!==null&&Rh(n,i.deps)){a.memoizedState=qo(t,r,s,n);return}}Pt.flags|=e,a.memoizedState=qo(1|t,r,s,n)}function Fp(e,t){return gc(8390656,8,e,t)}function Dh(e,t){return xu(2048,8,e,t)}function pg(e,t){return xu(4,2,e,t)}function mg(e,t){return xu(4,4,e,t)}function xg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gg(e,t,r){return r=r!=null?r.concat([e]):null,xu(4,4,xg.bind(null,t,e),r)}function jh(){}function vg(e,t){var r=yn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Rh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function wg(e,t){var r=yn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Rh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function yg(e,t,r){return ks&21?(Ln(r,t)||(r=b1(),Pt.lanes|=r,Es|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ur=!0),e.memoizedState=r)}function F2(e,t){var r=xt;xt=r!==0&&4>r?r:4,e(!0);var n=a0.transition;a0.transition={};try{e(!1),t()}finally{xt=r,a0.transition=n}}function _g(){return yn().memoizedState}function O2(e,t,r){var n=ja(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},kg(e))Eg(t,r);else if(r=ng(e,t,r,n),r!==null){var a=Pr();Pn(r,e,n,a),Sg(r,t,n)}}function R2(e,t,r){var n=ja(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(kg(e))Eg(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Ln(o,i)){var l=t.interleaved;l===null?(a.next=a,Ch(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=ng(e,t,a,n),r!==null&&(a=Pr(),Pn(r,e,n,a),Sg(r,t,n))}}function kg(e){var t=e.alternate;return e===Pt||t!==null&&t===Pt}function Eg(e,t){vo=Bc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Sg(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dh(e,r)}}var Uc={readContext:wn,useCallback:vr,useContext:vr,useEffect:vr,useImperativeHandle:vr,useInsertionEffect:vr,useLayoutEffect:vr,useMemo:vr,useReducer:vr,useRef:vr,useState:vr,useDebugValue:vr,useDeferredValue:vr,useTransition:vr,useMutableSource:vr,useSyncExternalStore:vr,useId:vr,unstable_isNewReconciler:!1},I2={readContext:wn,useCallback:function(e,t){return Wn().memoizedState=[e,t===void 0?null:t],e},useContext:wn,useEffect:Fp,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,gc(4194308,4,xg.bind(null,t,e),r)},useLayoutEffect:function(e,t){return gc(4194308,4,e,t)},useInsertionEffect:function(e,t){return gc(4,2,e,t)},useMemo:function(e,t){var r=Wn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Wn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=O2.bind(null,Pt,e),[n.memoizedState,e]},useRef:function(e){var t=Wn();return e={current:e},t.memoizedState=e},useState:Np,useDebugValue:jh,useDeferredValue:function(e){return Wn().memoizedState=e},useTransition:function(){var e=Np(!1),t=e[0];return e=F2.bind(null,e[1]),Wn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Pt,a=Wn();if(Ct){if(r===void 0)throw Error(we(407));r=r()}else{if(r=t(),or===null)throw Error(we(349));ks&30||lg(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Fp(ug.bind(null,n,s,e),[e]),n.flags|=2048,qo(9,cg.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Wn(),t=or.identifierPrefix;if(Ct){var r=ta,n=ea;r=(n&~(1<<32-In(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Vo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=N2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},P2={readContext:wn,useCallback:vg,useContext:wn,useEffect:Dh,useImperativeHandle:gg,useInsertionEffect:pg,useLayoutEffect:mg,useMemo:wg,useReducer:s0,useRef:dg,useState:function(){return s0(Go)},useDebugValue:jh,useDeferredValue:function(e){var t=yn();return yg(t,Qt.memoizedState,e)},useTransition:function(){var e=s0(Go)[0],t=yn().memoizedState;return[e,t]},useMutableSource:ig,useSyncExternalStore:og,useId:_g,unstable_isNewReconciler:!1},D2={readContext:wn,useCallback:vg,useContext:wn,useEffect:Dh,useImperativeHandle:gg,useInsertionEffect:pg,useLayoutEffect:mg,useMemo:wg,useReducer:i0,useRef:dg,useState:function(){return i0(Go)},useDebugValue:jh,useDeferredValue:function(e){var t=yn();return Qt===null?t.memoizedState=e:yg(t,Qt.memoizedState,e)},useTransition:function(){var e=i0(Go)[0],t=yn().memoizedState;return[e,t]},useMutableSource:ig,useSyncExternalStore:og,useId:_g,unstable_isNewReconciler:!1};function Tn(e,t){if(e&&e.defaultProps){t=Dt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function df(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Dt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var gu={isMounted:function(e){return(e=e._reactInternals)?Rs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Pr(),a=ja(e),s=na(n,a);s.payload=t,r!=null&&(s.callback=r),t=Pa(e,s,a),t!==null&&(Pn(t,e,a,n),mc(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Pr(),a=ja(e),s=na(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Pa(e,s,a),t!==null&&(Pn(t,e,a,n),mc(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Pr(),n=ja(e),a=na(r,n);a.tag=2,t!=null&&(a.callback=t),t=Pa(e,a,n),t!==null&&(Pn(t,e,n,r),mc(t,e,n))}};function Op(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Bo(r,n)||!Bo(a,s):!0}function bg(e,t,r){var n=!1,a=Ba,s=t.contextType;return typeof s=="object"&&s!==null?s=wn(s):(a=Wr(t)?ys:Cr.current,n=t.contextTypes,s=(n=n!=null)?Ai(e,a):Ba),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=gu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function Rp(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&gu.enqueueReplaceState(t,t.state,null)}function pf(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Ah(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=wn(s):(s=Wr(t)?ys:Cr.current,a.context=Ai(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(df(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&gu.enqueueReplaceState(a,a.state,null),Lc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ri(e,t){try{var r="",n=t;do r+=c_(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function o0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function mf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var j2=typeof WeakMap=="function"?WeakMap:Map;function Tg(e,t,r){r=na(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Wc||(Wc=!0,bf=n),mf(e,t)},r}function Cg(e,t,r){r=na(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){mf(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){mf(e,t),typeof n!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Ip(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new j2;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Y2.bind(null,e,t,r),t.then(e,e))}function Pp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Dp(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=na(-1,1),t.tag=2,Pa(r,t,1))),r.lanes|=1),e)}var L2=ha.ReactCurrentOwner,Ur=!1;function Or(e,t,r,n){t.child=e===null?rg(t,null,r,n):Fi(t,e.child,r,n)}function jp(e,t,r,n,a){r=r.render;var s=t.ref;return yi(t,a),n=Ih(e,t,r,n,s,a),r=Ph(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ua(e,t,a)):(Ct&&r&&_h(t),t.flags|=1,Or(e,t,n,a),t.child)}function Lp(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!zh(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Ag(e,t,s,n,a)):(e=_c(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Bo,r(i,n)&&e.ref===t.ref)return ua(e,t,a)}return t.flags|=1,e=La(s,n),e.ref=t.ref,e.return=t,t.child=e}function Ag(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Bo(s,n)&&e.ref===t.ref)if(Ur=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Ur=!0);else return t.lanes=e.lanes,ua(e,t,a)}return xf(e,t,r,n,a)}function Ng(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(hi,qr),qr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,yt(hi,qr),qr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,yt(hi,qr),qr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,yt(hi,qr),qr|=n;return Or(e,t,a,r),t.child}function Fg(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function xf(e,t,r,n,a){var s=Wr(r)?ys:Cr.current;return s=Ai(t,s),yi(t,a),r=Ih(e,t,r,n,s,a),n=Ph(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ua(e,t,a)):(Ct&&n&&_h(t),t.flags|=1,Or(e,t,r,a),t.child)}function Mp(e,t,r,n,a){if(Wr(r)){var s=!0;Rc(t)}else s=!1;if(yi(t,a),t.stateNode===null)vc(e,t),bg(t,r,n),pf(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=wn(c):(c=Wr(r)?ys:Cr.current,c=Ai(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Rp(t,i,n,c),_a=!1;var d=t.memoizedState;i.state=d,Lc(t,n,i,a),l=t.memoizedState,o!==n||d!==l||$r.current||_a?(typeof u=="function"&&(df(t,r,u,n),l=t.memoizedState),(o=_a||Op(t,r,o,n,d,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,ag(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Tn(t.type,o),i.props=c,h=t.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=wn(l):(l=Wr(r)?ys:Cr.current,l=Ai(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||d!==l)&&Rp(t,i,n,l),_a=!1,d=t.memoizedState,i.state=d,Lc(t,n,i,a);var x=t.memoizedState;o!==h||d!==x||$r.current||_a?(typeof p=="function"&&(df(t,r,p,n),x=t.memoizedState),(c=_a||Op(t,r,c,n,d,x,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return gf(e,t,r,n,s,a)}function gf(e,t,r,n,a,s){Fg(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Ep(t,r,!1),ua(e,t,s);n=t.stateNode,L2.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Fi(t,e.child,null,s),t.child=Fi(t,null,o,s)):Or(e,t,o,s),t.memoizedState=n.state,a&&Ep(t,r,!0),t.child}function Og(e){var t=e.stateNode;t.pendingContext?kp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&kp(e,t.context,!1),Nh(e,t.containerInfo)}function Bp(e,t,r,n,a){return Ni(),Eh(a),t.flags|=256,Or(e,t,r,n),t.child}var vf={dehydrated:null,treeContext:null,retryLane:0};function wf(e){return{baseLanes:e,cachePool:null,transitions:null}}function Rg(e,t,r){var n=t.pendingProps,a=Ot.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),yt(Ot,a&1),e===null)return ff(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=yu(i,n,0,null),e=ms(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=wf(r),t.memoizedState=vf,e):Lh(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return M2(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=La(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=La(o,s):(s=ms(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?wf(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=vf,n}return s=e.child,e=s.sibling,n=La(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Lh(e,t){return t=yu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function zl(e,t,r,n){return n!==null&&Eh(n),Fi(t,e.child,null,r),e=Lh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function M2(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=o0(Error(we(422))),zl(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=yu({mode:"visible",children:n.children},a,0,null),s=ms(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Fi(t,e.child,null,i),t.child.memoizedState=wf(i),t.memoizedState=vf,s);if(!(t.mode&1))return zl(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(we(419)),n=o0(s,n,void 0),zl(e,t,i,n)}if(o=(i&e.childLanes)!==0,Ur||o){if(n=or,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ca(e,a),Pn(n,e,a,-1))}return Hh(),n=o0(Error(we(421))),zl(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=J2.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,en=Ia(a.nextSibling),tn=t,Ct=!0,Fn=null,e!==null&&(pn[mn++]=ea,pn[mn++]=ta,pn[mn++]=_s,ea=e.id,ta=e.overflow,_s=t),t=Lh(t,n.children),t.flags|=4096,t)}function Up(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),hf(e.return,t,r)}function l0(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Ig(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Or(e,t,n.children,r),n=Ot.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Up(e,r,t);else if(e.tag===19)Up(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(yt(Ot,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Mc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),l0(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Mc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}l0(t,!0,r,null,s);break;case"together":l0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ua(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Es|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(we(153));if(t.child!==null){for(e=t.child,r=La(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=La(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function B2(e,t,r){switch(t.tag){case 3:Og(t),Ni();break;case 5:sg(t);break;case 1:Wr(t.type)&&Rc(t);break;case 4:Nh(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;yt(Dc,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(yt(Ot,Ot.current&1),t.flags|=128,null):r&t.child.childLanes?Rg(e,t,r):(yt(Ot,Ot.current&1),e=ua(e,t,r),e!==null?e.sibling:null);yt(Ot,Ot.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Ig(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),yt(Ot,Ot.current),n)break;return null;case 22:case 23:return t.lanes=0,Ng(e,t,r)}return ua(e,t,r)}var Pg,yf,Dg,jg;Pg=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};yf=function(){};Dg=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,fs(Gn.current);var s=null;switch(r){case"input":a=$0(e,a),n=$0(e,n),s=[];break;case"select":a=Dt({},a,{value:void 0}),n=Dt({},n,{value:void 0}),s=[];break;case"textarea":a=z0(e,a),n=z0(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Fc)}G0(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ro.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ro.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&kt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};jg=function(e,t,r,n){r!==n&&(t.flags|=4)};function to(e,t){if(!Ct)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function wr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function U2(e,t,r){var n=t.pendingProps;switch(kh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(t),null;case 1:return Wr(t.type)&&Oc(),wr(t),null;case 3:return n=t.stateNode,Oi(),St($r),St(Cr),Oh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Wl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Fn!==null&&(Af(Fn),Fn=null))),yf(e,t),wr(t),null;case 5:Fh(t);var a=fs(zo.current);if(r=t.type,e!==null&&t.stateNode!=null)Dg(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(we(166));return wr(t),null}if(e=fs(Gn.current),Wl(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Hn]=t,n[Wo]=s,e=(t.mode&1)!==0,r){case"dialog":kt("cancel",n),kt("close",n);break;case"iframe":case"object":case"embed":kt("load",n);break;case"video":case"audio":for(a=0;a<oo.length;a++)kt(oo[a],n);break;case"source":kt("error",n);break;case"img":case"image":case"link":kt("error",n),kt("load",n);break;case"details":kt("toggle",n);break;case"input":Xd(n,s),kt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},kt("invalid",n);break;case"textarea":Jd(n,s),kt("invalid",n)}G0(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&$l(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&$l(n.textContent,o,e),a=["children",""+o]):Ro.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&kt("scroll",n)}switch(r){case"input":Il(n),Yd(n,s,!0);break;case"textarea":Il(n),Qd(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Fc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=u1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Hn]=t,e[Wo]=n,Pg(e,t,!1,!1),t.stateNode=e;e:{switch(i=q0(r,n),r){case"dialog":kt("cancel",e),kt("close",e),a=n;break;case"iframe":case"object":case"embed":kt("load",e),a=n;break;case"video":case"audio":for(a=0;a<oo.length;a++)kt(oo[a],e);a=n;break;case"source":kt("error",e),a=n;break;case"img":case"image":case"link":kt("error",e),kt("load",e),a=n;break;case"details":kt("toggle",e),a=n;break;case"input":Xd(e,n),a=$0(e,n),kt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Dt({},n,{value:void 0}),kt("invalid",e);break;case"textarea":Jd(e,n),a=z0(e,n),kt("invalid",e);break;default:a=n}G0(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?d1(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&f1(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Io(e,l):typeof l=="number"&&Io(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ro.hasOwnProperty(s)?l!=null&&s==="onScroll"&&kt("scroll",e):l!=null&&oh(e,s,l,i))}switch(r){case"input":Il(e),Yd(e,n,!1);break;case"textarea":Il(e),Qd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ma(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?xi(e,!!n.multiple,s,!1):n.defaultValue!=null&&xi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Fc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wr(t),null;case 6:if(e&&t.stateNode!=null)jg(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(we(166));if(r=fs(zo.current),fs(Gn.current),Wl(t)){if(n=t.stateNode,r=t.memoizedProps,n[Hn]=t,(s=n.nodeValue!==r)&&(e=tn,e!==null))switch(e.tag){case 3:$l(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$l(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Hn]=t,t.stateNode=n}return wr(t),null;case 13:if(St(Ot),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ct&&en!==null&&t.mode&1&&!(t.flags&128))eg(),Ni(),t.flags|=98560,s=!1;else if(s=Wl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(we(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(we(317));s[Hn]=t}else Ni(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wr(t),s=!1}else Fn!==null&&(Af(Fn),Fn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ot.current&1?er===0&&(er=3):Hh())),t.updateQueue!==null&&(t.flags|=4),wr(t),null);case 4:return Oi(),yf(e,t),e===null&&Uo(t.stateNode.containerInfo),wr(t),null;case 10:return Th(t.type._context),wr(t),null;case 17:return Wr(t.type)&&Oc(),wr(t),null;case 19:if(St(Ot),s=t.memoizedState,s===null)return wr(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)to(s,!1);else{if(er!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Mc(e),i!==null){for(t.flags|=128,to(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return yt(Ot,Ot.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ht()>Ii&&(t.flags|=128,n=!0,to(s,!1),t.lanes=4194304)}else{if(!n)if(e=Mc(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),to(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Ct)return wr(t),null}else 2*Ht()-s.renderingStartTime>Ii&&r!==1073741824&&(t.flags|=128,n=!0,to(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ht(),t.sibling=null,r=Ot.current,yt(Ot,n?r&1|2:r&1),t):(wr(t),null);case 22:case 23:return Wh(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?qr&1073741824&&(wr(t),t.subtreeFlags&6&&(t.flags|=8192)):wr(t),null;case 24:return null;case 25:return null}throw Error(we(156,t.tag))}function $2(e,t){switch(kh(t),t.tag){case 1:return Wr(t.type)&&Oc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Oi(),St($r),St(Cr),Oh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Fh(t),null;case 13:if(St(Ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(we(340));Ni()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return St(Ot),null;case 4:return Oi(),null;case 10:return Th(t.type._context),null;case 22:case 23:return Wh(),null;case 24:return null;default:return null}}var Vl=!1,Er=!1,W2=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function fi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Mt(e,t,n)}else r.current=null}function _f(e,t,r){try{r()}catch(n){Mt(e,t,n)}}var $p=!1;function H2(e,t){if(nf=Cc,e=$1(),yh(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var p;h!==r||a!==0&&h.nodeType!==3||(o=i+a),h!==s||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===e)break t;if(d===r&&++c===a&&(o=i),d===s&&++u===n&&(l=i),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(af={focusedElem:e,selectionRange:r},Cc=!1,Oe=t;Oe!==null;)if(t=Oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Oe=e;else for(;Oe!==null;){t=Oe;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,v=x.memoizedState,w=t.stateNode,y=w.getSnapshotBeforeUpdate(t.elementType===t.type?m:Tn(t.type,m),v);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(b){Mt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Oe=e;break}Oe=t.return}return x=$p,$p=!1,x}function wo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&_f(t,r,s)}a=a.next}while(a!==n)}}function vu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function kf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Lg(e){var t=e.alternate;t!==null&&(e.alternate=null,Lg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Hn],delete t[Wo],delete t[lf],delete t[b2],delete t[T2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Mg(e){return e.tag===5||e.tag===3||e.tag===4}function Wp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Mg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ef(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Fc));else if(n!==4&&(e=e.child,e!==null))for(Ef(e,t,r),e=e.sibling;e!==null;)Ef(e,t,r),e=e.sibling}function Sf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Sf(e,t,r),e=e.sibling;e!==null;)Sf(e,t,r),e=e.sibling}var fr=null,An=!1;function va(e,t,r){for(r=r.child;r!==null;)Bg(e,t,r),r=r.sibling}function Bg(e,t,r){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(uu,r)}catch{}switch(r.tag){case 5:Er||fi(r,t);case 6:var n=fr,a=An;fr=null,va(e,t,r),fr=n,An=a,fr!==null&&(An?(e=fr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):fr.removeChild(r.stateNode));break;case 18:fr!==null&&(An?(e=fr,r=r.stateNode,e.nodeType===8?t0(e.parentNode,r):e.nodeType===1&&t0(e,r),Lo(e)):t0(fr,r.stateNode));break;case 4:n=fr,a=An,fr=r.stateNode.containerInfo,An=!0,va(e,t,r),fr=n,An=a;break;case 0:case 11:case 14:case 15:if(!Er&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&_f(r,t,i),a=a.next}while(a!==n)}va(e,t,r);break;case 1:if(!Er&&(fi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Mt(r,t,o)}va(e,t,r);break;case 21:va(e,t,r);break;case 22:r.mode&1?(Er=(n=Er)||r.memoizedState!==null,va(e,t,r),Er=n):va(e,t,r);break;default:va(e,t,r)}}function Hp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new W2),t.forEach(function(n){var a=Q2.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function En(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:fr=o.stateNode,An=!1;break e;case 3:fr=o.stateNode.containerInfo,An=!0;break e;case 4:fr=o.stateNode.containerInfo,An=!0;break e}o=o.return}if(fr===null)throw Error(we(160));Bg(s,i,a),fr=null,An=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Mt(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ug(t,e),t=t.sibling}function Ug(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(En(t,e),Mn(e),n&4){try{wo(3,e,e.return),vu(3,e)}catch(m){Mt(e,e.return,m)}try{wo(5,e,e.return)}catch(m){Mt(e,e.return,m)}}break;case 1:En(t,e),Mn(e),n&512&&r!==null&&fi(r,r.return);break;case 5:if(En(t,e),Mn(e),n&512&&r!==null&&fi(r,r.return),e.flags&32){var a=e.stateNode;try{Io(a,"")}catch(m){Mt(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&l1(a,s),q0(o,i);var c=q0(o,s);for(i=0;i<l.length;i+=2){var u=l[i],h=l[i+1];u==="style"?d1(a,h):u==="dangerouslySetInnerHTML"?f1(a,h):u==="children"?Io(a,h):oh(a,u,h,c)}switch(o){case"input":W0(a,s);break;case"textarea":c1(a,s);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?xi(a,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?xi(a,!!s.multiple,s.defaultValue,!0):xi(a,!!s.multiple,s.multiple?[]:"",!1))}a[Wo]=s}catch(m){Mt(e,e.return,m)}}break;case 6:if(En(t,e),Mn(e),n&4){if(e.stateNode===null)throw Error(we(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){Mt(e,e.return,m)}}break;case 3:if(En(t,e),Mn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Lo(t.containerInfo)}catch(m){Mt(e,e.return,m)}break;case 4:En(t,e),Mn(e);break;case 13:En(t,e),Mn(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Uh=Ht())),n&4&&Hp(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Er=(c=Er)||u,En(t,e),Er=c):En(t,e),Mn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Oe=e,u=e.child;u!==null;){for(h=Oe=u;Oe!==null;){switch(d=Oe,p=d.child,d.tag){case 0:case 11:case 14:case 15:wo(4,d,d.return);break;case 1:fi(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(m){Mt(n,r,m)}}break;case 5:fi(d,d.return);break;case 22:if(d.memoizedState!==null){Vp(h);continue}}p!==null?(p.return=d,Oe=p):Vp(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=h1("display",i))}catch(m){Mt(e,e.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Mt(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:En(t,e),Mn(e),n&4&&Hp(e);break;case 21:break;default:En(t,e),Mn(e)}}function Mn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Mg(r)){var n=r;break e}r=r.return}throw Error(we(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Io(a,""),n.flags&=-33);var s=Wp(e);Sf(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Wp(e);Ef(e,o,i);break;default:throw Error(we(161))}}catch(l){Mt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function z2(e,t,r){Oe=e,$g(e)}function $g(e,t,r){for(var n=(e.mode&1)!==0;Oe!==null;){var a=Oe,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Vl;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Er;o=Vl;var c=Er;if(Vl=i,(Er=l)&&!c)for(Oe=a;Oe!==null;)i=Oe,l=i.child,i.tag===22&&i.memoizedState!==null?Gp(a):l!==null?(l.return=i,Oe=l):Gp(a);for(;s!==null;)Oe=s,$g(s),s=s.sibling;Oe=a,Vl=o,Er=c}zp(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Oe=s):zp(e)}}function zp(e){for(;Oe!==null;){var t=Oe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Er||vu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Er)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Tn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Ap(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Ap(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Lo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}Er||t.flags&512&&kf(t)}catch(d){Mt(t,t.return,d)}}if(t===e){Oe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function Vp(e){for(;Oe!==null;){var t=Oe;if(t===e){Oe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function Gp(e){for(;Oe!==null;){var t=Oe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{vu(4,t)}catch(l){Mt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Mt(t,a,l)}}var s=t.return;try{kf(t)}catch(l){Mt(t,s,l)}break;case 5:var i=t.return;try{kf(t)}catch(l){Mt(t,i,l)}}}catch(l){Mt(t,t.return,l)}if(t===e){Oe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Oe=o;break}Oe=t.return}}var V2=Math.ceil,$c=ha.ReactCurrentDispatcher,Mh=ha.ReactCurrentOwner,gn=ha.ReactCurrentBatchConfig,ot=0,or=null,Yt=null,pr=0,qr=0,hi=Ga(0),er=0,Ko=null,Es=0,wu=0,Bh=0,yo=null,Br=null,Uh=0,Ii=1/0,Jn=null,Wc=!1,bf=null,Da=null,Gl=!1,Ca=null,Hc=0,_o=0,Tf=null,wc=-1,yc=0;function Pr(){return ot&6?Ht():wc!==-1?wc:wc=Ht()}function ja(e){return e.mode&1?ot&2&&pr!==0?pr&-pr:A2.transition!==null?(yc===0&&(yc=b1()),yc):(e=xt,e!==0||(e=window.event,e=e===void 0?16:R1(e.type)),e):1}function Pn(e,t,r,n){if(50<_o)throw _o=0,Tf=null,Error(we(185));xl(e,r,n),(!(ot&2)||e!==or)&&(e===or&&(!(ot&2)&&(wu|=r),er===4&&Sa(e,pr)),Hr(e,n),r===1&&ot===0&&!(t.mode&1)&&(Ii=Ht()+500,mu&&qa()))}function Hr(e,t){var r=e.callbackNode;A_(e,t);var n=Tc(e,e===or?pr:0);if(n===0)r!==null&&tp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&tp(r),t===1)e.tag===0?C2(qp.bind(null,e)):J1(qp.bind(null,e)),E2(function(){!(ot&6)&&qa()}),r=null;else{switch(T1(n)){case 1:r=hh;break;case 4:r=E1;break;case 16:r=bc;break;case 536870912:r=S1;break;default:r=bc}r=Xg(r,Wg.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Wg(e,t){if(wc=-1,yc=0,ot&6)throw Error(we(327));var r=e.callbackNode;if(_i()&&e.callbackNode!==r)return null;var n=Tc(e,e===or?pr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=zc(e,n);else{t=n;var a=ot;ot|=2;var s=zg();(or!==e||pr!==t)&&(Jn=null,Ii=Ht()+500,ps(e,t));do try{K2();break}catch(o){Hg(e,o)}while(!0);bh(),$c.current=s,ot=a,Yt!==null?t=0:(or=null,pr=0,t=er)}if(t!==0){if(t===2&&(a=Q0(e),a!==0&&(n=a,t=Cf(e,a))),t===1)throw r=Ko,ps(e,0),Sa(e,n),Hr(e,Ht()),r;if(t===6)Sa(e,n);else{if(a=e.current.alternate,!(n&30)&&!G2(a)&&(t=zc(e,n),t===2&&(s=Q0(e),s!==0&&(n=s,t=Cf(e,s))),t===1))throw r=Ko,ps(e,0),Sa(e,n),Hr(e,Ht()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(we(345));case 2:as(e,Br,Jn);break;case 3:if(Sa(e,n),(n&130023424)===n&&(t=Uh+500-Ht(),10<t)){if(Tc(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Pr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=of(as.bind(null,e,Br,Jn),t);break}as(e,Br,Jn);break;case 4:if(Sa(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-In(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=Ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*V2(n/1960))-n,10<n){e.timeoutHandle=of(as.bind(null,e,Br,Jn),n);break}as(e,Br,Jn);break;case 5:as(e,Br,Jn);break;default:throw Error(we(329))}}}return Hr(e,Ht()),e.callbackNode===r?Wg.bind(null,e):null}function Cf(e,t){var r=yo;return e.current.memoizedState.isDehydrated&&(ps(e,t).flags|=256),e=zc(e,t),e!==2&&(t=Br,Br=r,t!==null&&Af(t)),e}function Af(e){Br===null?Br=e:Br.push.apply(Br,e)}function G2(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Ln(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Sa(e,t){for(t&=~Bh,t&=~wu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-In(t),n=1<<r;e[r]=-1,t&=~n}}function qp(e){if(ot&6)throw Error(we(327));_i();var t=Tc(e,0);if(!(t&1))return Hr(e,Ht()),null;var r=zc(e,t);if(e.tag!==0&&r===2){var n=Q0(e);n!==0&&(t=n,r=Cf(e,n))}if(r===1)throw r=Ko,ps(e,0),Sa(e,t),Hr(e,Ht()),r;if(r===6)throw Error(we(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,as(e,Br,Jn),Hr(e,Ht()),null}function $h(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(Ii=Ht()+500,mu&&qa())}}function Ss(e){Ca!==null&&Ca.tag===0&&!(ot&6)&&_i();var t=ot;ot|=1;var r=gn.transition,n=xt;try{if(gn.transition=null,xt=1,e)return e()}finally{xt=n,gn.transition=r,ot=t,!(ot&6)&&qa()}}function Wh(){qr=hi.current,St(hi)}function ps(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,k2(r)),Yt!==null)for(r=Yt.return;r!==null;){var n=r;switch(kh(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Oc();break;case 3:Oi(),St($r),St(Cr),Oh();break;case 5:Fh(n);break;case 4:Oi();break;case 13:St(Ot);break;case 19:St(Ot);break;case 10:Th(n.type._context);break;case 22:case 23:Wh()}r=r.return}if(or=e,Yt=e=La(e.current,null),pr=qr=t,er=0,Ko=null,Bh=wu=Es=0,Br=yo=null,us!==null){for(t=0;t<us.length;t++)if(r=us[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}us=null}return e}function Hg(e,t){do{var r=Yt;try{if(bh(),xc.current=Uc,Bc){for(var n=Pt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Bc=!1}if(ks=0,ar=Qt=Pt=null,vo=!1,Vo=0,Mh.current=null,r===null||r.return===null){er=1,Ko=t,Yt=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=pr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Pp(i);if(p!==null){p.flags&=-257,Dp(p,i,o,s,t),p.mode&1&&Ip(s,c,t),t=p,l=c;var x=t.updateQueue;if(x===null){var m=new Set;m.add(l),t.updateQueue=m}else x.add(l);break e}else{if(!(t&1)){Ip(s,c,t),Hh();break e}l=Error(we(426))}}else if(Ct&&o.mode&1){var v=Pp(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Dp(v,i,o,s,t),Eh(Ri(l,o));break e}}s=l=Ri(l,o),er!==4&&(er=2),yo===null?yo=[s]:yo.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var w=Tg(s,l,t);Cp(s,w);break e;case 1:o=l;var y=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Da===null||!Da.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=Cg(s,o,t);Cp(s,b);break e}}s=s.return}while(s!==null)}Gg(r)}catch(I){t=I,Yt===r&&r!==null&&(Yt=r=r.return);continue}break}while(!0)}function zg(){var e=$c.current;return $c.current=Uc,e===null?Uc:e}function Hh(){(er===0||er===3||er===2)&&(er=4),or===null||!(Es&268435455)&&!(wu&268435455)||Sa(or,pr)}function zc(e,t){var r=ot;ot|=2;var n=zg();(or!==e||pr!==t)&&(Jn=null,ps(e,t));do try{q2();break}catch(a){Hg(e,a)}while(!0);if(bh(),ot=r,$c.current=n,Yt!==null)throw Error(we(261));return or=null,pr=0,er}function q2(){for(;Yt!==null;)Vg(Yt)}function K2(){for(;Yt!==null&&!w_();)Vg(Yt)}function Vg(e){var t=Kg(e.alternate,e,qr);e.memoizedProps=e.pendingProps,t===null?Gg(e):Yt=t,Mh.current=null}function Gg(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=$2(r,t),r!==null){r.flags&=32767,Yt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{er=6,Yt=null;return}}else if(r=U2(r,t,qr),r!==null){Yt=r;return}if(t=t.sibling,t!==null){Yt=t;return}Yt=t=e}while(t!==null);er===0&&(er=5)}function as(e,t,r){var n=xt,a=gn.transition;try{gn.transition=null,xt=1,X2(e,t,r,n)}finally{gn.transition=a,xt=n}return null}function X2(e,t,r,n){do _i();while(Ca!==null);if(ot&6)throw Error(we(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(we(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(N_(e,s),e===or&&(Yt=or=null,pr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Gl||(Gl=!0,Xg(bc,function(){return _i(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=gn.transition,gn.transition=null;var i=xt;xt=1;var o=ot;ot|=4,Mh.current=null,H2(e,r),Ug(r,e),m2(af),Cc=!!nf,af=nf=null,e.current=r,z2(r),y_(),ot=o,xt=i,gn.transition=s}else e.current=r;if(Gl&&(Gl=!1,Ca=e,Hc=a),s=e.pendingLanes,s===0&&(Da=null),E_(r.stateNode),Hr(e,Ht()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Wc)throw Wc=!1,e=bf,bf=null,e;return Hc&1&&e.tag!==0&&_i(),s=e.pendingLanes,s&1?e===Tf?_o++:(_o=0,Tf=e):_o=0,qa(),null}function _i(){if(Ca!==null){var e=T1(Hc),t=gn.transition,r=xt;try{if(gn.transition=null,xt=16>e?16:e,Ca===null)var n=!1;else{if(e=Ca,Ca=null,Hc=0,ot&6)throw Error(we(331));var a=ot;for(ot|=4,Oe=e.current;Oe!==null;){var s=Oe,i=s.child;if(Oe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Oe=c;Oe!==null;){var u=Oe;switch(u.tag){case 0:case 11:case 15:wo(8,u,s)}var h=u.child;if(h!==null)h.return=u,Oe=h;else for(;Oe!==null;){u=Oe;var d=u.sibling,p=u.return;if(Lg(u),u===c){Oe=null;break}if(d!==null){d.return=p,Oe=d;break}Oe=p}}}var x=s.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}Oe=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Oe=i;else e:for(;Oe!==null;){if(s=Oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:wo(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Oe=w;break e}Oe=s.return}}var y=e.current;for(Oe=y;Oe!==null;){i=Oe;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,Oe=g;else e:for(i=y;Oe!==null;){if(o=Oe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vu(9,o)}}catch(I){Mt(o,o.return,I)}if(o===i){Oe=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,Oe=b;break e}Oe=o.return}}if(ot=a,qa(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(uu,e)}catch{}n=!0}return n}finally{xt=r,gn.transition=t}}return!1}function Kp(e,t,r){t=Ri(r,t),t=Tg(e,t,1),e=Pa(e,t,1),t=Pr(),e!==null&&(xl(e,1,t),Hr(e,t))}function Mt(e,t,r){if(e.tag===3)Kp(e,e,r);else for(;t!==null;){if(t.tag===3){Kp(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Da===null||!Da.has(n))){e=Ri(r,e),e=Cg(t,e,1),t=Pa(t,e,1),e=Pr(),t!==null&&(xl(t,1,e),Hr(t,e));break}}t=t.return}}function Y2(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Pr(),e.pingedLanes|=e.suspendedLanes&r,or===e&&(pr&r)===r&&(er===4||er===3&&(pr&130023424)===pr&&500>Ht()-Uh?ps(e,0):Bh|=r),Hr(e,t)}function qg(e,t){t===0&&(e.mode&1?(t=jl,jl<<=1,!(jl&130023424)&&(jl=4194304)):t=1);var r=Pr();e=ca(e,t),e!==null&&(xl(e,t,r),Hr(e,r))}function J2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),qg(e,r)}function Q2(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(we(314))}n!==null&&n.delete(t),qg(e,r)}var Kg;Kg=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||$r.current)Ur=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ur=!1,B2(e,t,r);Ur=!!(e.flags&131072)}else Ur=!1,Ct&&t.flags&1048576&&Q1(t,Pc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;vc(e,t),e=t.pendingProps;var a=Ai(t,Cr.current);yi(t,r),a=Ih(null,t,n,e,a,r);var s=Ph();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Wr(n)?(s=!0,Rc(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Ah(t),a.updater=gu,t.stateNode=a,a._reactInternals=t,pf(t,n,e,r),t=gf(null,t,n,!0,s,r)):(t.tag=0,Ct&&s&&_h(t),Or(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(vc(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=ek(n),e=Tn(n,e),a){case 0:t=xf(null,t,n,e,r);break e;case 1:t=Mp(null,t,n,e,r);break e;case 11:t=jp(null,t,n,e,r);break e;case 14:t=Lp(null,t,n,Tn(n.type,e),r);break e}throw Error(we(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),xf(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),Mp(e,t,n,a,r);case 3:e:{if(Og(t),e===null)throw Error(we(387));n=t.pendingProps,s=t.memoizedState,a=s.element,ag(e,t),Lc(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Ri(Error(we(423)),t),t=Bp(e,t,n,r,a);break e}else if(n!==a){a=Ri(Error(we(424)),t),t=Bp(e,t,n,r,a);break e}else for(en=Ia(t.stateNode.containerInfo.firstChild),tn=t,Ct=!0,Fn=null,r=rg(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ni(),n===a){t=ua(e,t,r);break e}Or(e,t,n,r)}t=t.child}return t;case 5:return sg(t),e===null&&ff(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,sf(n,a)?i=null:s!==null&&sf(n,s)&&(t.flags|=32),Fg(e,t),Or(e,t,i,r),t.child;case 6:return e===null&&ff(t),null;case 13:return Rg(e,t,r);case 4:return Nh(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Fi(t,null,n,r):Or(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),jp(e,t,n,a,r);case 7:return Or(e,t,t.pendingProps,r),t.child;case 8:return Or(e,t,t.pendingProps.children,r),t.child;case 12:return Or(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,yt(Dc,n._currentValue),n._currentValue=i,s!==null)if(Ln(s.value,i)){if(s.children===a.children&&!$r.current){t=ua(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=na(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),hf(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(we(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),hf(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Or(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,yi(t,r),a=wn(a),n=n(a),t.flags|=1,Or(e,t,n,r),t.child;case 14:return n=t.type,a=Tn(n,t.pendingProps),a=Tn(n.type,a),Lp(e,t,n,a,r);case 15:return Ag(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),vc(e,t),t.tag=1,Wr(n)?(e=!0,Rc(t)):e=!1,yi(t,r),bg(t,n,a),pf(t,n,a,r),gf(null,t,n,!0,e,r);case 19:return Ig(e,t,r);case 22:return Ng(e,t,r)}throw Error(we(156,t.tag))};function Xg(e,t){return k1(e,t)}function Z2(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(e,t,r,n){return new Z2(e,t,r,n)}function zh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ek(e){if(typeof e=="function")return zh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ch)return 11;if(e===uh)return 14}return 2}function La(e,t){var r=e.alternate;return r===null?(r=xn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function _c(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")zh(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case ri:return ms(r.children,a,s,t);case lh:i=8,a|=8;break;case L0:return e=xn(12,r,t,a|2),e.elementType=L0,e.lanes=s,e;case M0:return e=xn(13,r,t,a),e.elementType=M0,e.lanes=s,e;case B0:return e=xn(19,r,t,a),e.elementType=B0,e.lanes=s,e;case s1:return yu(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case n1:i=10;break e;case a1:i=9;break e;case ch:i=11;break e;case uh:i=14;break e;case ya:i=16,n=null;break e}throw Error(we(130,e==null?e:typeof e,""))}return t=xn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function ms(e,t,r,n){return e=xn(7,e,n,t),e.lanes=r,e}function yu(e,t,r,n){return e=xn(22,e,n,t),e.elementType=s1,e.lanes=r,e.stateNode={isHidden:!1},e}function c0(e,t,r){return e=xn(6,e,null,t),e.lanes=r,e}function u0(e,t,r){return t=xn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function tk(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zu(0),this.expirationTimes=zu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zu(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Vh(e,t,r,n,a,s,i,o,l){return e=new tk(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=xn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ah(s),e}function rk(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ti,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Yg(e){if(!e)return Ba;e=e._reactInternals;e:{if(Rs(e)!==e||e.tag!==1)throw Error(we(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Wr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(we(171))}if(e.tag===1){var r=e.type;if(Wr(r))return Y1(e,r,t)}return t}function Jg(e,t,r,n,a,s,i,o,l){return e=Vh(r,n,!0,e,a,s,i,o,l),e.context=Yg(null),r=e.current,n=Pr(),a=ja(r),s=na(n,a),s.callback=t??null,Pa(r,s,a),e.current.lanes=a,xl(e,a,n),Hr(e,n),e}function _u(e,t,r,n){var a=t.current,s=Pr(),i=ja(a);return r=Yg(r),t.context===null?t.context=r:t.pendingContext=r,t=na(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Pa(a,t,i),e!==null&&(Pn(e,a,i,s),mc(e,a,i)),i}function Vc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Xp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Gh(e,t){Xp(e,t),(e=e.alternate)&&Xp(e,t)}function nk(){return null}var Qg=typeof reportError=="function"?reportError:function(e){console.error(e)};function qh(e){this._internalRoot=e}ku.prototype.render=qh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(we(409));_u(e,t,null,null)};ku.prototype.unmount=qh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ss(function(){_u(null,e,null,null)}),t[la]=null}};function ku(e){this._internalRoot=e}ku.prototype.unstable_scheduleHydration=function(e){if(e){var t=N1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ea.length&&t!==0&&t<Ea[r].priority;r++);Ea.splice(r,0,e),r===0&&O1(e)}};function Kh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Eu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Yp(){}function ak(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Vc(i);s.call(c)}}var i=Jg(t,n,e,0,null,!1,!1,"",Yp);return e._reactRootContainer=i,e[la]=i.current,Uo(e.nodeType===8?e.parentNode:e),Ss(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Vc(l);o.call(c)}}var l=Vh(e,0,!1,null,null,!1,!1,"",Yp);return e._reactRootContainer=l,e[la]=l.current,Uo(e.nodeType===8?e.parentNode:e),Ss(function(){_u(t,l,r,n)}),l}function Su(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Vc(i);o.call(l)}}_u(t,i,e,a)}else i=ak(r,t,e,a,n);return Vc(i)}C1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=io(t.pendingLanes);r!==0&&(dh(t,r|1),Hr(t,Ht()),!(ot&6)&&(Ii=Ht()+500,qa()))}break;case 13:Ss(function(){var n=ca(e,1);if(n!==null){var a=Pr();Pn(n,e,1,a)}}),Gh(e,1)}};ph=function(e){if(e.tag===13){var t=ca(e,134217728);if(t!==null){var r=Pr();Pn(t,e,134217728,r)}Gh(e,134217728)}};A1=function(e){if(e.tag===13){var t=ja(e),r=ca(e,t);if(r!==null){var n=Pr();Pn(r,e,t,n)}Gh(e,t)}};N1=function(){return xt};F1=function(e,t){var r=xt;try{return xt=e,t()}finally{xt=r}};X0=function(e,t,r){switch(t){case"input":if(W0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=pu(n);if(!a)throw Error(we(90));o1(n),W0(n,a)}}}break;case"textarea":c1(e,r);break;case"select":t=r.value,t!=null&&xi(e,!!r.multiple,t,!1)}};x1=$h;g1=Ss;var sk={usingClientEntryPoint:!1,Events:[vl,ii,pu,p1,m1,$h]},ro={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ik={bundleType:ro.bundleType,version:ro.version,rendererPackageName:ro.rendererPackageName,rendererConfig:ro.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ha.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=y1(e),e===null?null:e.stateNode},findFiberByHostInstance:ro.findFiberByHostInstance||nk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ql=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ql.isDisabled&&ql.supportsFiber)try{uu=ql.inject(ik),Vn=ql}catch{}}an.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sk;an.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kh(t))throw Error(we(200));return rk(e,t,null,r)};an.createRoot=function(e,t){if(!Kh(e))throw Error(we(299));var r=!1,n="",a=Qg;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Vh(e,1,!1,null,null,r,!1,n,a),e[la]=t.current,Uo(e.nodeType===8?e.parentNode:e),new qh(t)};an.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(we(188)):(e=Object.keys(e).join(","),Error(we(268,e)));return e=y1(t),e=e===null?null:e.stateNode,e};an.flushSync=function(e){return Ss(e)};an.hydrate=function(e,t,r){if(!Eu(t))throw Error(we(200));return Su(null,e,t,!0,r)};an.hydrateRoot=function(e,t,r){if(!Kh(e))throw Error(we(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=Qg;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Jg(t,null,e,1,r??null,a,!1,s,i),e[la]=t.current,Uo(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new ku(t)};an.render=function(e,t,r){if(!Eu(t))throw Error(we(200));return Su(null,e,t,!1,r)};an.unmountComponentAtNode=function(e){if(!Eu(e))throw Error(we(40));return e._reactRootContainer?(Ss(function(){Su(null,null,e,!1,function(){e._reactRootContainer=null,e[la]=null})}),!0):!1};an.unstable_batchedUpdates=$h;an.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Eu(r))throw Error(we(200));if(e==null||e._reactInternals===void 0)throw Error(we(38));return Su(e,t,r,!1,n)};an.version="18.3.1-next-f1338f8080-20240426";function Zg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zg)}catch(e){console.error(e)}}Zg(),Zx.exports=an;var ok=Zx.exports,ev,Jp=ok;ev=Jp.createRoot,Jp.hydrateRoot;function bu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function lk(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})}const ck=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Xh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class uk extends Xh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Qp extends Xh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Zp extends Xh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Nf;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Nf||(Nf={}));class fk{constructor(t,{headers:r={},customFetch:n,region:a=Nf.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=ck(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return lk(this,arguments,void 0,function*(r,n={}){var a;let s,i;try{const{headers:o,method:l,body:c,signal:u,timeout:h}=n;let d={},{region:p}=n;p||(p=this.region);const x=new URL(`${this.url}/${r}`);p&&p!=="any"&&(d["x-region"]=p,x.searchParams.set("forceFunctionRegion",p));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(d["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(d["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let v=u;h&&(i=new AbortController,s=setTimeout(()=>i.abort(),h),u?(v=i.signal,u.addEventListener("abort",()=>i.abort())):v=i.signal);const w=yield this.fetch(x.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:m,signal:v}).catch(I=>{throw new uk(I)}),y=w.headers.get("x-relay-error");if(y&&y==="true")throw new Qp(w);if(!w.ok)throw new Zp(w);let g=((a=w.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),b;return g==="application/json"?b=yield w.json():g==="application/octet-stream"||g==="application/pdf"?b=yield w.blob():g==="text/event-stream"?b=w:g==="multipart/form-data"?b=yield w.formData():b=yield w.text(),{data:b,error:null,response:w}}catch(o){return{data:null,error:o,response:o instanceof Zp||o instanceof Qp?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var hk=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},dk=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let i=null,o=null,l=null,c=s.status,u=s.statusText;if(s.ok){var h,d;if(r.method!=="HEAD"){var p;const w=await s.text();w===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((p=r.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?o=w:o=JSON.parse(w))}const m=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),v=(d=s.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");m&&v&&v.length>1&&(l=parseInt(v[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,u="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var x;const m=await s.text();try{i=JSON.parse(m),Array.isArray(i)&&s.status===404&&(o=[],i=null,c=200,u="OK")}catch{s.status===404&&m===""?(c=204,u="No Content"):i={message:m}}if(i&&r.isMaybeSingle&&(!(i==null||(x=i.details)===null||x===void 0)&&x.includes("0 rows"))&&(i=null,c=200,u="OK"),i&&r.shouldThrowOnError)throw new hk(i)}return{error:i,data:o,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(a=a.catch(s=>{var i;let o="";const l=s==null?void 0:s.cause;if(l){var c,u,h,d;const x=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",m=(u=l==null?void 0:l.code)!==null&&u!==void 0?u:"";o=`${(h=s==null?void 0:s.name)!==null&&h!==void 0?h:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(d=l==null?void 0:l.name)!==null&&d!==void 0?d:"Error"}: ${x}`,m&&(o+=` (${m})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var p;o=(p=s==null?void 0:s.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},pk=class extends dk{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const s=a?`${a}.order`:"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:s="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const em=new RegExp("[,()]");var Js=class extends pk{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&em.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&em.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},mk=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},a=r?"HEAD":"GET";let s=!1;const i=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",i),n&&l.append("Prefer",`count=${n}`),new Js({method:a,url:o,headers:l,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const a="POST",{url:s,headers:i}=this.cloneRequestState();if(t&&i.append("Prefer",`count=${t}`),r||i.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);s.searchParams.set("columns",l.join(","))}}return new Js({method:a,url:s,headers:i,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var s;const i="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),a||l.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);o.searchParams.set("columns",u.join(","))}}return new Js({method:i,url:o,headers:l,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:a,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Js({method:n,url:a,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new Js({method:r,url:n,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},xk=class tv{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new mk(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new tv(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;const u=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(u)),h=n&&Object.values(r).some(u);h?(o="POST",c=r):n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([p,x])=>x!==void 0).map(([p,x])=>[p,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([p,x])=>{l.searchParams.append(p,x)})):(o="POST",c=r);const d=new Headers(this.headers);return h?d.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&d.set("Prefer",`count=${s}`),new Js({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class gk{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const a=n.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const vk="2.90.1",wk=`realtime-js/${vk}`,rv="1.0.0",yk="2.0.0",tm=rv,Ff=1e4,_k=1e3,kk=100;var ka;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ka||(ka={}));var Jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Jt||(Jt={}));var Nn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Nn||(Nn={}));var Of;(function(e){e.websocket="websocket"})(Of||(Of={}));var is;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(is||(is={}));class Ek{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},i=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(t,r,n){var a,s;const i=t.topic,o=(a=t.ref)!==null&&a!==void 0?a:"",l=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+i.length+c.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+d);let x=new DataView(p),m=0;x.setUint8(m++,this.KINDS.userBroadcastPush),x.setUint8(m++,l.length),x.setUint8(m++,o.length),x.setUint8(m++,i.length),x.setUint8(m++,c.length),x.setUint8(m++,h.length),x.setUint8(m++,r),Array.from(l,w=>x.setUint8(m++,w.charCodeAt(0))),Array.from(o,w=>x.setUint8(m++,w.charCodeAt(0))),Array.from(i,w=>x.setUint8(m++,w.charCodeAt(0))),Array.from(c,w=>x.setUint8(m++,w.charCodeAt(0))),Array.from(h,w=>x.setUint8(m++,w.charCodeAt(0)));var v=new Uint8Array(p.byteLength+n.byteLength);return v.set(new Uint8Array(p),0),v.set(new Uint8Array(n),p.byteLength),v.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,s,i,o,l]=n;return r({join_ref:a,ref:s,topic:i,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2),i=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+a));l=l+a;const u=n.decode(t.slice(l,l+s));l=l+s;const h=n.decode(t.slice(l,l+i));l=l+i;const d=t.slice(l,t.byteLength),p=o===this.JSON_ENCODING?JSON.parse(n.decode(d)):d,x={type:this.BROADCAST_EVENT,event:u,payload:p};return i>0&&(x.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class nv{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var wt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(wt||(wt={}));const rm=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,i)=>(s[i]=Sk(i,e,t,a),s),{}):{}},Sk=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?av(s,i):Rf(i)},av=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Ak(t,r)}switch(e){case wt.bool:return bk(t);case wt.float4:case wt.float8:case wt.int2:case wt.int4:case wt.int8:case wt.numeric:case wt.oid:return Tk(t);case wt.json:case wt.jsonb:return Ck(t);case wt.timestamp:return Nk(t);case wt.abstime:case wt.date:case wt.daterange:case wt.int4range:case wt.int8range:case wt.money:case wt.reltime:case wt.text:case wt.time:case wt.timestamptz:case wt.timetz:case wt.tsrange:case wt.tstzrange:return Rf(t);default:return Rf(t)}},Rf=e=>e,bk=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Tk=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ck=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},Ak=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>av(t,o))}return e},Nk=e=>typeof e=="string"?e.replace(" ","T"):e,sv=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class f0{constructor(t,r,n={},a=Ff){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var nm;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(nm||(nm={}));class ko{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ko.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=ko.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=ko.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const h=s[c];if(h){const d=u.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),x=u.filter(v=>p.indexOf(v.presence_ref)<0),m=h.filter(v=>d.indexOf(v.presence_ref)<0);x.length>0&&(o[c]=x),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const h=t[o].map(p=>p.presence_ref),d=u.filter(p=>h.indexOf(p.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var am;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(am||(am={}));var Eo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Eo||(Eo={}));var Qn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Qn||(Qn={}));class di{constructor(t,r={config:{}},n){var a,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new f0(this,Nn.join,this.params,this.timeout),this.rejoinTimer=new nv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Jt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Nn.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new ko(this),this.broadcastEndpointURL=sv(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Jt.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Eo.PRESENCE]&&this.bindings[Eo.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},d={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Qn.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Qn.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){t==null||t(Qn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(x=m==null?void 0:m.length)!==null&&x!==void 0?x:0,w=[];for(let y=0;y<v;y++){const g=m[y],{filter:{event:b,schema:I,table:A,filter:E}}=g,_=p&&p[y];if(_&&_.event===b&&di.isFilterValueEqual(_.schema,I)&&di.isFilterValueEqual(_.table,A)&&di.isFilterValueEqual(_.filter,E))w.push(Object.assign(Object.assign({},g),{id:_.id}));else{this.unsubscribe(),this.state=Jt.errored,t==null||t(Qn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Qn.SUBSCRIBED);return}}).receive("error",p=>{this.state=Jt.errored,t==null||t(Qn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Qn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Jt.joined&&t===Eo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Nn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new f0(this,Nn.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new f0(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>kk){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Nn;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let d=this._onMessage(i,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var x,m,v;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(m=p.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(p=>p.callback(d,n)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var x,m,v,w,y,g,b,I;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const A=p.id,E=(x=p.filter)===null||x===void 0?void 0:x.event;return A&&((m=r.ids)===null||m===void 0?void 0:m.includes(A))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))&&(!(!((w=p.filter)===null||w===void 0)&&w.table)||p.filter.table===((y=r.data)===null||y===void 0?void 0:y.table))}else{const A=(b=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return A==="*"||A===((I=r==null?void 0:r.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof d=="object"&&"ids"in d){const x=d.data,{schema:m,table:v,commit_timestamp:w,type:y,errors:g}=x;d=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:w,eventType:y,new:{},old:{},errors:g}),this._getPayloadRecords(x))}p.callback(d,n)})}_isClosed(){return this.state===Jt.closed}_isJoined(){return this.state===Jt.joined}_isJoining(){return this.state===Jt.joining}_isLeaving(){return this.state===Jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&di.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Nn.close,{},t)}_onError(t){this._on(Nn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=rm(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=rm(t.columns,t.old_record)),r}}const h0=()=>{},Kl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Fk=[1e3,2e3,5e3,1e4],Ok=1e4,Rk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ik{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ff,this.transport=null,this.heartbeatIntervalMs=Kl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=h0,this.ref=0,this.reconnectTimer=null,this.vsn=tm,this.logger=h0,this.conn=null,this.sendBuffer=[],this.serializer=new Ek,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...s)=>a(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Of.websocket}`,this.httpEndpoint=sv(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=gk.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ka.connecting:return is.Connecting;case ka.open:return is.Open;case ka.closing:return is.Closing;default:return is.Closed}}isConnected(){return this.connectionState()===is.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new di(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(_k,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Kl.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===ka.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ka.open||this.conn.readyState===ka.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Nn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Rk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const s={access_token:r,version:wk};r&&a.updateJoinPayload(s),a.joinedOnce&&a._isJoined()&&a._push(Nn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new nv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Kl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,c,u,h,d,p;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Ff,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Kl.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:h0,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:tm,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:x=>Fk[x-1]||Ok,this.vsn){case rv:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(x,m)=>m(JSON.stringify(x)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(x,m)=>m(JSON.parse(x));break;case yk:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:this.serializer.encode.bind(this.serializer),this.decode=(p=t==null?void 0:t.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Xo=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Pk(e,t,r){const n=new URL(t,e);if(r)for(const[a,s]of Object.entries(r))s!==void 0&&n.searchParams.set(a,s);return n.toString()}async function Dk(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function jk(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:s,headers:i}){const o=Pk(e.baseUrl,n,a),l=await Dk(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...i},body:s?JSON.stringify(s):void 0}),u=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),d=h&&u?JSON.parse(u):u;if(!c.ok){const p=h?d:void 0,x=p==null?void 0:p.error;throw new Xo((x==null?void 0:x.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:p})}return{status:c.status,headers:c.headers,data:d}}}}function Xl(e){return e.join("")}var Lk=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Xl(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Xl(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Xl(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Xl(e.namespace)}`}),!0}catch(t){if(t instanceof Xo&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Xo&&r.status===409)return;throw r}}};function Ws(e){return e.join("")}var Mk=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ws(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Xo&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Xo&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},Bk=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=jk({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new Lk(this.client,t),this.tableOps=new Mk(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Tu=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Ft(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Uk=class extends Tu{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},If=class extends Tu{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Yh=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$k=()=>Response,Pf=e=>{if(Array.isArray(e))return e.map(r=>Pf(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Pf(n)}),t},Wk=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Hk=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Yo(e){"@babel/helpers - typeof";return Yo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yo(e)}function zk(e,t){if(Yo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vk(e){var t=zk(e,"string");return Yo(t)=="symbol"?t:t+""}function Gk(e,t,r){return(t=Vk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ge(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sm(Object(r),!0).forEach(function(n){Gk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sm(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const d0=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},qk=async(e,t,r)=>{e instanceof await $k()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,s=(n==null?void 0:n.statusCode)||a+"";t(new Uk(d0(n),a,s))}).catch(n=>{t(new If(d0(n),n))}):t(new If(d0(e),e))},Kk=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Wk(n)?(a.headers=Ge({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Ge(Ge({},a),r))};async function yl(e,t,r,n,a,s){return new Promise((i,o)=>{e(r,Kk(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>qk(l,o,n))})}async function Jo(e,t,r,n){return yl(e,"GET",t,r,n)}async function Cn(e,t,r,n,a){return yl(e,"POST",t,n,a,r)}async function Df(e,t,r,n,a){return yl(e,"PUT",t,n,a,r)}async function Xk(e,t,r,n){return yl(e,"HEAD",t,Ge(Ge({},r),{},{noResolveJson:!0}),n)}async function Jh(e,t,r,n,a){return yl(e,"DELETE",t,n,a,r)}var Yk=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ft(t))return{data:null,error:t};throw t}}};let iv;iv=Symbol.toStringTag;var Jk=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[iv]="BlobDownloadBuilder",this.promise=null}asStream(){return new Yk(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ft(t))return{data:null,error:t};throw t}}};const Qk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},im={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Zk=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Yh(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var a=this;try{let s;const i=Ge(Ge({},im),n);let o=Ge(Ge({},a.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",a.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",i.cacheControl),l&&!s.has("metadata")&&s.append("metadata",a.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(o=Ge(Ge({},o),n.headers));const c=a._removeEmptyFolders(t),u=a._getFinalPath(c),h=await(e=="PUT"?Df:Cn)(a.fetch,`${a.url}/object/${u}`,s,Ge({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(Ft(s))return{data:null,error:s};throw s}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var a=this;const s=a._removeEmptyFolders(e),i=a._getFinalPath(s),o=new URL(a.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const c=Ge({upsert:im.upsert},n),u=Ge(Ge({},a.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{data:{path:s,fullPath:(await Df(a.fetch,o.toString(),l,{headers:u})).Key},error:null}}catch(l){if(a.shouldThrowOnError)throw l;if(Ft(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const a=Ge({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const s=await Cn(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(r.url+s.url),o=i.searchParams.get("token");if(!o)throw new Tu("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await Cn(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ft(a))return{data:null,error:a};throw a}}async copy(e,t,r){var n=this;try{return{data:{path:(await Cn(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ft(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var n=this;try{let a=n._getFinalPath(e),s=await Cn(n.fetch,`${n.url}/object/sign/${a}`,Ge({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${n.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ft(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var n=this;try{const a=await Cn(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(i=>Ge(Ge({},i),{},{signedUrl:i.signedURL?encodeURI(`${n.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ft(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"",s=this._getFinalPath(e),i=()=>Jo(this.fetch,`${this.url}/${r}/${s}${a}`,{headers:this.headers,noResolveJson:!0});return new Jk(i,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Pf(await Jo(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Xk(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ft(n)&&n instanceof If){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});i!==""&&n.push(i);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;try{return{data:await Jh(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const a=Ge(Ge(Ge({},Qk),t),{},{prefix:e||""});return{data:await Cn(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ft(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const n=Ge({},e);return{data:await Cn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const ov="2.90.1",lv={"X-Client-Info":`storage-js/${ov}`};var eE=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Ge(Ge({},lv),t),this.fetch=Yh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Jo(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Jo(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Cn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await Df(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await Cn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Jh(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},tE=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ge(Ge({},lv),t),this.fetch=Yh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Cn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await Jo(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Jh(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!Hk(e))throw new Tu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Bk({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,s){const i=a[s];return typeof i!="function"?i:async(...o)=>{try{return{data:await i.apply(a,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}};const Qh={"X-Client-Info":`storage-js/${ov}`,"Content-Type":"application/json"};var cv=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Yr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var p0=class extends cv{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},rE=class extends cv{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Zh=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),nE=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},om=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),aE=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(s=>{const i=(s==null?void 0:s.statusCode)||(s==null?void 0:s.code)||n+"";t(new p0(om(s),n,i))}).catch(()=>{const s=n+"";t(new p0(a.statusText||`HTTP ${n} error`,n,s))});else{const s=n+"";t(new p0(a.statusText||`HTTP ${n} error`,n,s))}}else t(new rE(om(e),e))},sE=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(nE(n)?(a.headers=Ge({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Ge(Ge({},a),r)):a};async function iE(e,t,r,n,a,s){return new Promise((i,o)=>{e(r,sE(t,n,a,s)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>i(l)).catch(l=>aE(l,o,n))})}async function Jr(e,t,r,n,a){return iE(e,"POST",t,n,a,r)}var oE=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ge(Ge({},Qh),t),this.fetch=Zh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Jr(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Yr(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Jr(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Yr(n))return{data:null,error:n};throw n}}},lE=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ge(Ge({},Qh),t),this.fetch=Zh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Jr(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Jr(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Jr(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}},cE=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ge(Ge({},Qh),t),this.fetch=Zh(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yr(r))return{data:null,error:r};throw r}}},uE=class extends cE{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new fE(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},fE=class extends oE{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ge(Ge({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ge(Ge({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new hE(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},hE=class extends lE{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ge(Ge({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ge(Ge({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ge(Ge({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ge(Ge({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ge(Ge({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},dE=class extends eE{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new Zk(this.url,this.headers,e,this.fetch)}get vectors(){return new uE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new tE(this.url+"/iceberg",this.headers,this.fetch)}};const uv="2.90.1",Qs=30*1e3,jf=3,m0=jf*Qs,pE="http://localhost:9999",mE="supabase.auth.token",xE={"X-Client-Info":`gotrue-js/${uv}`},Lf="X-Supabase-Api-Version",fv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,vE=10*60*1e3;class Qo extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class wE extends Qo{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function yE(e){return Le(e)&&e.name==="AuthApiError"}class os extends Qo{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class da extends Qo{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Gr extends da{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _E(e){return Le(e)&&e.name==="AuthSessionMissingError"}class Hs extends da{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Yl extends da{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Jl extends da{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function kE(e){return Le(e)&&e.name==="AuthImplicitGrantRedirectError"}class lm extends da{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class EE extends da{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Mf extends da{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function x0(e){return Le(e)&&e.name==="AuthRetryableFetchError"}class cm extends da{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Bf extends da{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Gc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),um=` 	
\r=`.split(""),SE=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<um.length;t+=1)e[um[t].charCodeAt(0)]=-2;for(let t=0;t<Gc.length;t+=1)e[Gc[t].charCodeAt(0)]=t;return e})();function fm(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Gc[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Gc[n]),t.queuedBits-=6}}function hv(e,t,r){const n=SE[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function hm(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{CE(i,n,r)};for(let i=0;i<e.length;i+=1)hv(e.charCodeAt(i),a,s);return t.join("")}function bE(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function TE(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}bE(n,t)}}function CE(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ki(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)hv(e.charCodeAt(a),r,n);return new Uint8Array(t)}function AE(e){const t=[];return TE(e,r=>t.push(r)),new Uint8Array(t)}function hs(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>fm(a,r,n)),fm(null,r,n),t.join("")}function NE(e){return Math.round(Date.now()/1e3)+e}function FE(){return Symbol("auth-callback")}const cr=()=>typeof window<"u"&&typeof document<"u",ts={tested:!1,writable:!1},dv=()=>{if(!cr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ts.tested)return ts.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ts.tested=!0,ts.writable=!0}catch{ts.tested=!0,ts.writable=!1}return ts.writable};function OE(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const pv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),RE=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Zs=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},rs=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},lr=async(e,t)=>{await e.removeItem(t)};class Cu{constructor(){this.promise=new Cu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Cu.promiseConstructor=Promise;function g0(e){const t=e.split(".");if(t.length!==3)throw new Bf("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!gE.test(t[n]))throw new Bf("JWT not in base64url format");return{header:JSON.parse(hm(t[0])),payload:JSON.parse(hm(t[1])),signature:ki(t[2]),raw:{header:t[0],payload:t[1]}}}async function IE(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function PE(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function DE(e){return("0"+e.toString(16)).substr(-2)}function jE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,DE).join("")}async function LE(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function ME(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await LE(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function zs(e,t,r=!1){const n=jE();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Zs(e,`${t}-code-verifier`,a);const s=await ME(n);return[s,n===s?"plain":"s256"]}const BE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function UE(e){const t=e.headers.get(Lf);if(!t||!t.match(BE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function $E(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function WE(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const HE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vs(e){if(!HE.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function v0(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zE(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function dm(e){return JSON.parse(JSON.stringify(e))}const ss=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),VE=[502,503,504];async function pm(e){var t;if(!RE(e))throw new Mf(ss(e),0);if(VE.includes(e.status))throw new Mf(ss(e),e.status);let r;try{r=await e.json()}catch(s){throw new os(ss(s),s)}let n;const a=UE(e);if(a&&a.getTime()>=fv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new cm(ss(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Gr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new cm(ss(r),e.status,r.weak_password.reasons);throw new wE(ss(r),e.status||500,n)}const GE=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ve(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[Lf]||(s[Lf]=fv["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await qE(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function qE(e,t,r,n,a,s){const i=GE(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new Mf(ss(l),0)}if(o.ok||await pm(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await pm(l)}}function bn(e){var t;let r=null;YE(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=NE(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function mm(e){const t=bn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ba(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function KE(e){return{data:e,error:null}}function XE(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=bu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function xm(e){return e}function YE(e){return e.access_token&&e.refresh_token&&e.expires_in}const w0=["global","local","others"];class JE{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=pv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=w0[0]){if(w0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${w0.join(", ")}`);try{return await Ve(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Le(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ve(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ba})}catch(n){if(Le(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=bu(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ve(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:XE,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Le(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ve(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ba})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ve(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:xm});if(u.error)throw u.error;const h=await u.json(),d=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(x=>{const m=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Le(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Vs(t);try{return await Ve(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ba})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Vs(t);try{return await Ve(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ba})}catch(n){if(Le(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Vs(t);try{return await Ve(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ba})}catch(n){if(Le(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Vs(t.userId);try{const{data:r,error:n}=await Ve(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Vs(t.userId),Vs(t.id);try{return{data:await Ve(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ve(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:xm});if(u.error)throw u.error;const h=await u.json(),d=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(x=>{const m=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Le(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Ve(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ve(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ve(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Le(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ve(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ve(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}}function gm(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Gs={debug:!!(globalThis&&dv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class mv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class QE extends mv{}async function ZE(e,t,r){Gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Gs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Gs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new QE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Gs.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function eS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function xv(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function tS(e){return parseInt(e,16)}function rS(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function nS(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:s=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:u,uri:h,version:d}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=xv(e.address),x=u?`${u}://${n}`:n,m=e.statement?`${e.statement}
`:"",v=`${x} wants you to sign in with your Ethereum account:
${p}

${m}`;let w=`URI: ${h}
Version: ${d}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${s.toISOString()}`;if(a&&(w+=`
Expiration Time: ${a.toISOString()}`),o&&(w+=`
Not Before: ${o.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let y=`
Resources:`;for(const g of c){if(!g||typeof g!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${g}`);y+=`
- ${g}`}w+=y}return`${v}
${w}`}class Xt extends Error{constructor({message:t,code:r,cause:n,name:a}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=a??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class qc extends Xt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function aS({error:e,options:t}){var r,n,a;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Xt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Xt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Xt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Xt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Xt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Xt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Xt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(gv(i)){if(s.rp.id!==i)return new Xt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Xt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Xt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function sS({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Xt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(gv(n)){if(r.rpId!==n)return new Xt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Xt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class iS{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const oS=new iS;function lS(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=bu(e,["challenge","user","excludeCredentials"]),s=ki(t).buffer,i=Object.assign(Object.assign({},r),{id:ki(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:s,user:i});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:ki(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function cS(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=bu(e,["challenge","allowCredentials"]),a=ki(t).buffer,s=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const o=r[i];s.allowCredentials[i]=Object.assign(Object.assign({},o),{id:ki(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function uS(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:hs(new Uint8Array(e.response.attestationObject)),clientDataJSON:hs(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function fS(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:hs(new Uint8Array(a.authenticatorData)),clientDataJSON:hs(new Uint8Array(a.clientDataJSON)),signature:hs(new Uint8Array(a.signature)),userHandle:a.userHandle?hs(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function gv(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function vm(){var e,t;return!!(cr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function hS(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new qc("Browser returned unexpected credential type",t)}:{data:null,error:new qc("Empty credential response",t)}}catch(t){return{data:null,error:aS({error:t,options:e})}}}async function dS(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new qc("Browser returned unexpected credential type",t)}:{data:null,error:new qc("Empty credential response",t)}}catch(t){return{data:null,error:sS({error:t,options:e})}}}const pS={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},mS={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Kc(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const s in a){const i=a[s];if(i!==void 0)if(Array.isArray(i))n[s]=i;else if(r(i))n[s]=i;else if(t(i)){const o=n[s];t(o)?n[s]=Kc(o,i):n[s]=Kc(i)}else n[s]=i}return n}function xS(e,t){return Kc(pS,e,t||{})}function gS(e,t){return Kc(mS,e,t||{})}class vS{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},s){try{const{data:i,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:o};const l=a??oS.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:c}=i.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(i.webauthn.type){case"create":{const c=xS(i.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:u,error:h}=await hS({publicKey:c,signal:l});return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const c=gS(i.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:u,error:h}=await dS(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new os("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new Qo("rpId is required for WebAuthn authentication")};try{if(!vm())return{data:null,error:new os("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:s});if(!i)return{data:null,error:o};const{webauthn:l}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new os("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new Qo("rpId is required for WebAuthn registration")};try{if(!vm())return{data:null,error:new os("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(d=>d.factor_type==="webauthn"&&d.friendly_name===t&&d.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:s});return l?this._verify({factorId:i.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(i){return Le(i)?{data:null,error:i}:{data:null,error:new os("Unexpected error in register",i)}}}}eS();const wS={url:pE,storageKey:mE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:xE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function wm(e,t,r){return await r()}const qs={};class Zo{get jwks(){var t,r;return(r=(t=qs[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){qs[this.storageKey]=Object.assign(Object.assign({},qs[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=qs[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){qs[this.storageKey]=Object.assign(Object.assign({},qs[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},wS),t);if(this.storageKey=s.storageKey,this.instanceID=(r=Zo.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Zo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&cr()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new JE({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=pv(s.fetch),this.lock=s.lock||wm,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&cr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=ZE:this.lock=wm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new vS(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:dv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=gm(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=gm(this.memoryStorage)),cr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${uv}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(cr()&&(r=OE(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),cr()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),kE(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Le(r)?this._returnResult({error:r}):this._returnResult({error:new os("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:bn}),{data:i,error:o}=s;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(Le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:u,password:h,options:d}=t;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await zs(this.storage,this.storageKey)),s=await Ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:p,code_challenge_method:x},xform:bn})}else if("phone"in t){const{phone:u,password:h,options:d}=t;s=await Ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:bn})}else throw new Yl("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return await lr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(await lr(this.storage,`${this.storageKey}-code-verifier`),Le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mm})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mm})}else throw new Yl("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const s=new Hs;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,s,i,o,l,c,u,h,d;let p,x;if("message"in t)p=t.message,x=t.signature;else{const{chain:m,wallet:v,statement:w,options:y}=t;let g;if(cr())if(typeof v=="object")g=v;else{const k=window;if("ethereum"in k&&typeof k.ethereum=="object"&&"request"in k.ethereum&&typeof k.ethereum.request=="function")g=k.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=v}const b=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),I=await g.request({method:"eth_requestAccounts"}).then(k=>k).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!I||I.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=xv(I[0]);let E=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!E){const k=await g.request({method:"eth_chainId"});E=tS(k)}const _={domain:b.host,address:A,statement:w,uri:b.href,version:"1",chainId:E,nonce:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(i=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=nS(_),x=await g.request({method:"personal_sign",params:[rS(p),A]})}try{const{data:m,error:v}=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:x},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:bn});if(v)throw v;if(!m||!m.session||!m.user){const w=new Hs;return this._returnResult({data:{user:null,session:null},error:w})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:v})}catch(m){if(Le(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,a,s,i,o,l,c,u,h,d,p;let x,m;if("message"in t)x=t.message,m=t.signature;else{const{chain:v,wallet:w,statement:y,options:g}=t;let b;if(cr())if(typeof w=="object")b=w;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))b=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=w}const I=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const A=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),y?{statement:y}:null));let E;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")E=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)E=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)x=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),m=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${I.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(a=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((h=(u=g==null?void 0:g.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...g.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const A=await b.signMessage(new TextEncoder().encode(x),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=A}}try{const{data:v,error:w}=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:hs(m)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:bn});if(w)throw w;if(!v||!v.session||!v.user){const y=new Hs;return this._returnResult({data:{user:null,session:null},error:y})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:w})}catch(v){if(Le(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(t){const r=await rs(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new EE;const{data:s,error:i}=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:bn});if(await lr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!s||!s.session||!s.user){const o=new Hs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(await lr(this.storage,`${this.storageKey}-code-verifier`),Le(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:bn}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Hs;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await zs(this.storage,this.storageKey));const{error:h}=await Ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new Yl("You must provide either an email or phone number.")}catch(o){if(await lr(this.storage,`${this.storageKey}-code-verifier`),Le(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Ve(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:bn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,s,i;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await zs(this.storage,this.storageKey));const c=await Ve(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:KE});return!((s=c.data)===null||s===void 0)&&s.url&&cr()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await lr(this.storage,`${this.storageKey}-code-verifier`),Le(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Gr;const{error:a}=await Ve(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(Le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Ve(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await Ve(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o})}throw new Yl("You must provide either an email or phone number and a type")}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await rs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<m0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await rs(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=v0()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=zE(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ba}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Gr}:await Ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:ba})})}catch(r){if(Le(r))return _E(r)&&(await this._removeSession(),await lr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Gr;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await zs(this.storage,this.storageKey));const{data:c,error:u}=await Ve(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:ba});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(n){if(await lr(this.storage,`${this.storageKey}-code-verifier`),Le(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Gr;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=g0(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Le(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Gr;const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!cr())throw new Jl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Jl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new lm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Jl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new lm("No code detected.");const{data:y,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new Jl("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let d=u+h;l&&(d=parseInt(l));const p=d-u;p*1e3<=Qs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const x=d-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,d,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,d,u);const{data:m,error:v}=await this._getUser(s);if(v)throw v;const w={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:h,expires_at:d,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(n){if(Le(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await rs(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({error:s});const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(yE(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await lr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=FE(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await zs(this.storage,this.storageKey,!0));try{return await Ve(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await lr(this.storage,`${this.storageKey}-code-verifier`),Le(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,u;const{data:h,error:d}=s;if(d)throw d;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ve(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return cr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Le(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:s}}=r;if(a)throw a;const{options:i,provider:o,token:l,access_token:c,nonce:u}=t,h=await Ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:bn}),{data:d,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!d||!d.session||!d.user?this._returnResult({data:{user:null,session:null},error:new Hs}):(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:p}))}catch(a){if(await lr(this.storage,`${this.storageKey}-code-verifier`),Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Ve(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await PE(async a=>(a>0&&await IE(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ve(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:bn})),(a,s)=>{const i=200*Math.pow(2,a);return s&&x0(s)&&Date.now()+i-n<Qs})}catch(n){if(this._debug(r,"error",n),Le(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),cr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await rs(this.storage,this.storageKey);if(a&&this.userStorage){let i=await rs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await Zs(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:v0()}else if(a&&!a.user&&!a.user){const i=await rs(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await lr(this.storage,this.storageKey+"-user"),await Zs(this.storage,this.storageKey,a)):a.user=v0()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<m0;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${m0}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),x0(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Gr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Cu;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Gr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Le(s)){const i={data:null,error:s};return x0(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await lr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Zs(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=dm(a);await Zs(this.storage,this.storageKey,s)}else{const a=dm(r);await Zs(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await lr(this.storage,this.storageKey),await lr(this.storage,this.storageKey+"-code-verifier"),await lr(this.storage,this.storageKey+"-user"),this.userStorage&&await lr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&cr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Qs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Qs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Qs}ms, refresh threshold is ${jf} ticks`),a<=jf&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof mv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!cr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await zs(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?this._returnResult({data:null,error:s}):await Ve(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await Ve(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?uS(t.webauthn.credential_response):fS(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await Ve(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const i=await Ve(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:lS(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:cS(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(s),s.status==="verified"&&a[s.factor_type].push(s);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=g0(n.access_token);let i=null;s.aal&&(i=s.aal);let o=i;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=s.amr||[];return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await Ve(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Gr})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Gr});const i=await Ve(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&cr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(Le(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Gr});const i=await Ve(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&cr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(Le(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ve(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Gr})})}catch(t){if(Le(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await Ve(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Gr})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+vE>a)return n;const{data:s,error:i}=await Ve(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:x}=await this.getSession();if(x||!p.session)return this._returnResult({data:null,error:x});n=p.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=g0(n);r!=null&&r.allowExpired||$E(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:a,signature:i},error:null}}const u=WE(a.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,AE(`${o}.${l}`)))throw new Bf("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Le(n))return this._returnResult({data:null,error:n});throw n}}}Zo.nextInstanceID={};const yS=Zo,_S="2.90.1";let lo="";typeof Deno<"u"?lo="deno":typeof document<"u"?lo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?lo="react-native":lo="node";const kS={"X-Client-Info":`supabase-js-${lo}/${_S}`},ES={headers:kS},SS={schema:"public"},bS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},TS={};function el(e){"@babel/helpers - typeof";return el=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},el(e)}function CS(e,t){if(el(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(el(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AS(e){var t=CS(e,"string");return el(t)=="symbol"?t:t+""}function NS(e,t,r){return(t=AS(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ym(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ym(Object(r),!0).forEach(function(n){NS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ym(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const FS=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),OS=()=>Headers,RS=(e,t,r)=>{const n=FS(r),a=OS();return async(s,i)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Lt(Lt({},i),{},{headers:c}))}};function IS(e){return e.endsWith("/")?e:e+"/"}function PS(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:h}=t,d={db:Lt(Lt({},l),a),auth:Lt(Lt({},c),s),realtime:Lt(Lt({},u),i),storage:{},global:Lt(Lt(Lt({},h),o),{},{headers:Lt(Lt({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function DS(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(IS(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var jS=class extends yS{constructor(e){super(e)}},LS=class{constructor(e,t,r){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const s=DS(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const i=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:SS,realtime:TS,auth:Lt(Lt({},bS),{},{storageKey:i}),global:ES},l=PS(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=l.global.headers)!==null&&a!==void 0?a:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=RS(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Lt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new xk(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new dE(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new fk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:s,flowType:i,lock:o,debug:l,throwOnError:c},u,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jS({url:this.authUrl.href,headers:Lt(Lt({},d),u),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,flowType:i,lock:o,debug:l,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ik(this.realtimeUrl.href,Lt(Lt({},e),{},{params:Lt(Lt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const MS=(e,t,r)=>new LS(e,t,r);function BS(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}BS()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const US="https://rqairbvsiwohklvsxyre.supabase.co",$S="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYWlyYnZzaXdvaGtsdnN4eXJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5Nzk2NTcsImV4cCI6MjA4MjU1NTY1N30.6Uyi42A_4Pqe1G40qnx4M8ST38XRgh9x8o7mCtiVr18",Ne=MS(US,$S),vv=ne.createContext(void 0);function WS({children:e}){const[t,r]=ne.useState(null),[n,a]=ne.useState(!0);ne.useEffect(()=>{s();const{data:c}=Ne.auth.onAuthStateChange(()=>{(async()=>await s())()});return()=>{var u;(u=c==null?void 0:c.subscription)==null||u.unsubscribe()}},[]);const s=async()=>{try{const{data:{user:c}}=await Ne.auth.getUser();if(c){const{data:u}=await Ne.from("user_profiles").select("*").eq("id",c.id).maybeSingle();r(u)}else r(null)}catch(c){console.error("Error checking user:",c),r(null)}finally{a(!1)}},i=async(c,u)=>{const{error:h}=await Ne.auth.signInWithPassword({email:c,password:u});if(h)throw h;await s()},o=async(c,u,h,d,p)=>{const{data:x,error:m}=await Ne.auth.signUp({email:c,password:u});if(m)throw m;if(!x.user)throw new Error("User creation failed");const{error:v}=await Ne.from("user_profiles").insert({id:x.user.id,email:c,full_name:h,role:d,client_id:p||null,is_active:!0});if(v)throw v;await s()},l=async()=>{const{error:c}=await Ne.auth.signOut();if(c)throw c;r(null)};return f.jsx(vv.Provider,{value:{user:t,loading:n,signIn:i,signUp:o,signOut:l},children:e})}function Ka(){const e=ne.useContext(vv);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),We=(e,t)=>{const r=ne.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},u)=>ne.createElement("svg",{ref:u,...HS,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${zS(e)}`,o].join(" "),...c},[...t.map(([h,d])=>ne.createElement(h,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=We("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=We("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=We("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=We("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=We("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Em=We("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=We("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=We("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=We("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=We("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=We("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=We("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=We("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=We("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=We("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=We("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=We("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=We("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=We("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=We("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=We("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=We("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=We("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=We("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=We("GitFork",[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=We("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=We("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=We("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=We("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=We("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=We("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=We("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=We("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=We("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=We("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=We("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=We("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=We("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=We("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=We("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=We("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=We("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=We("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=We("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=We("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=We("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=We("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=We("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=We("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $f=We("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=We("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=We("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wf=We("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=We("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function wb(){const{signIn:e,signOut:t}=Ka(),[r,n]=ne.useState(""),[a,s]=ne.useState(""),[i,o]=ne.useState(!1),[l,c]=ne.useState(""),u=async h=>{h.preventDefault(),c(""),o(!0);try{await e(r,a);const{data:{user:d}}=await Ne.auth.getUser();if(d){const{data:p,error:x}=await Ne.from("user_profiles").select("is_active").eq("id",d.id).maybeSingle();if(x)throw new Error("Error verifying account status");if(p&&p.is_active===!1)throw await t(),new Error("Your account has been deactivated. Please contact your administrator.")}}catch(d){c(d instanceof Error?d.message:"Failed to sign in")}finally{o(!1)}};return f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center p-6",children:f.jsx("div",{className:"w-full max-w-md",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:f.jsx(Cm,{className:"w-8 h-8 text-white"})}),f.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Facet Builder Pro"}),f.jsx("p",{className:"text-slate-600",children:"Sign in to your account"})]}),f.jsxs("form",{onSubmit:u,className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-2",children:"Email Address"}),f.jsx("input",{type:"email",id:"email",value:r,onChange:h=>n(h.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:"you@company.com",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),f.jsx("input",{type:"password",id:"password",value:a,onChange:h=>s(h.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:"",required:!0})]}),l&&f.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex items-start gap-3 animate-in fade-in slide-in-from-top-1",children:[f.jsx(ed,{className:"w-5 h-5 shrink-0 mt-0.5"}),f.jsx("span",{children:l})]}),f.jsx("button",{type:"submit",disabled:i,className:"w-full py-3 px-6 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 shadow-md hover:shadow-lg active:scale-[0.98]",children:i?f.jsxs(f.Fragment,{children:[f.jsx(_l,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Cm,{className:"w-5 h-5"}),"Sign In"]})})]})]})})})}const Ev=ne.createContext(void 0);function yb({children:e}){const[t,r]=ne.useState([]),n=ne.useCallback(i=>{r(o=>o.filter(l=>l.id!==i))},[]),a=ne.useCallback((i,o,l)=>{const c=Math.random().toString(36).substring(7);if(r([{id:c,message:i,type:o,options:l}]),o!=="confirm"){const h=(l==null?void 0:l.duration)||4e3;setTimeout(()=>{n(c)},h)}},[n]),s={success:(i,o)=>a(i,"success",o),error:(i,o)=>a(i,"error",o),info:(i,o)=>a(i,"info",o),warning:(i,o)=>a(i,"warning",o),confirm:(i,o,l)=>a(i,"confirm",{...l,onConfirm:o}),dismiss:n};return f.jsxs(Ev.Provider,{value:{toast:s},children:[e,f.jsx(_b,{toasts:t,dismiss:n})]})}function _b({toasts:e,dismiss:t}){var i,o;if(ne.useEffect(()=>{const l=c=>{var u;if(c.key==="Escape"&&e.length>0){const h=e[0];h.type==="confirm"&&((u=h.options)!=null&&u.onCancel)&&h.options.onCancel(),t(h.id)}};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[e,t]),e.length===0)return null;const r=e[0],a={success:{icon:td,border:"border-green-200",bg:"bg-white",text:"text-green-600",glow:"shadow-green-500/10"},error:{icon:ed,border:"border-red-200",bg:"bg-white",text:"text-red-600",glow:"shadow-red-500/10"},warning:{icon:_m,border:"border-yellow-200",bg:"bg-white",text:"text-red-600",glow:"shadow-red-500/10"},info:{icon:ab,border:"border-blue-200",bg:"bg-white",text:"text-blue-600",glow:"shadow-blue-500/10"},confirm:{icon:_m,border:"border-purple-500/50",bg:"bg-white",text:"text-purple-400",glow:"shadow-purple-500/10"}}[r.type],s=a.icon;return f.jsxs("div",{className:"fixed top-8 left-1/2 -translate-x-1/2 z-[100] flex flex-col items-center justify-center pointer-events-none",children:[f.jsxs("div",{className:`
          pointer-events-auto
          flex items-center gap-4 px-5 py-4 
          rounded-2xl border ${a.border} ${a.bg} backdrop-blur-md
          shadow-xl ${a.glow}
          animate-in slide-in-from-top-5 fade-in duration-300
          min-w-[320px] max-w-[90vw]
        `,children:[f.jsx("div",{className:`p-2 rounded-full bg-white/5 ${a.text}`,children:f.jsx(s,{className:"w-5 h-5"})}),f.jsx("div",{className:"flex-1",children:f.jsx("p",{className:"text-sm font-semibold text-slate-900",children:r.message})}),r.type==="confirm"?f.jsxs("div",{className:"flex gap-2 ml-2",children:[f.jsx("button",{onClick:()=>{var l;(l=r.options)!=null&&l.onCancel&&r.options.onCancel(),t(r.id)},className:"px-3 py-1.5 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/10 rounded-md transition-colors",children:((i=r.options)==null?void 0:i.cancelText)||"Cancel"}),f.jsx("button",{onClick:()=>{var l,c;(c=(l=r.options)==null?void 0:l.onConfirm)==null||c.call(l),t(r.id)},className:"px-3 py-1.5 text-xs font-bold text-slate-900 bg-white hover:bg-slate-200 rounded-md transition-colors shadow-lg shadow-white/10",children:((o=r.options)==null?void 0:o.confirmText)||"Confirm"})]}):f.jsx("button",{onClick:()=>t(r.id),className:"text-slate-500 hover:text-white transition-colors",children:f.jsx(Ua,{className:"w-4 h-4"})})]}),r.type!=="confirm"&&f.jsx("div",{className:"w-full h-1 mt-2 overflow-hidden rounded-full max-w-[300px]",children:f.jsx("div",{className:"h-full bg-slate-300 animate-shrink-width",style:{animationDuration:"4s"}})})]})}function Ui(){const e=ne.useContext(Ev);if(e===void 0)throw new Error("useToast must be used within a ToastProvider");return e.toast}function kb(){const{user:e}=Ka(),t=Ui(),[r,n]=ne.useState([]),[a,s]=ne.useState(""),[i,o]=ne.useState([]),[l,c]=ne.useState({}),[u,h]=ne.useState(""),[d,p]=ne.useState(new Set),[x,m]=ne.useState(null),[v,w]=ne.useState(!1),[y,g]=ne.useState(!1),[b,I]=ne.useState([]),[A,E]=ne.useState(!1),[_,k]=ne.useState(["Input Taxonomy","End Category (C3)","Filter Attributes","Possible Values","Filling Percentage (Approx.)","Priority (High / Medium / Low)","Confidence Score (110)","# of available sources","Source URLs"]);ne.useEffect(()=>{Y()},[e]);const O=ne.useMemo(()=>a?b.filter(T=>{var q,te;return(te=(q=T.categories)==null?void 0:q.category_path)==null?void 0:te.startsWith(a)}):[],[b,a]),H=async T=>{var q,te;if(T){m(T),w(!0),E(!0),I([]),p(new Set),(te=(q=T.metadata)==null?void 0:q.output_format)!=null&&te.columns&&Array.isArray(T.metadata.output_format.columns)?k(T.metadata.output_format.columns):k(["Input Taxonomy","End Category (C3)","Filter Attributes","Possible Values","Filling Percentage (Approx.)","Priority (High / Medium / Low)","Confidence Score (110)","# of available sources","Source URLs"]);try{const{data:C,error:M}=await Ne.from("recommended_facets").select("*, categories (name, category_path)").eq("job_id",T.id).order("sort_order");if(M)throw M;const W=C||[];I(W);const P=Array.from(new Set(W.map(z=>{var he,ae;return(ae=(he=z.categories)==null?void 0:he.category_path)==null?void 0:ae.split(" > ")[0]}).filter(Boolean))).sort();o(P),P.length>0&&s(P[0])}catch(C){console.error("Error loading project details:",C),t.error("Failed to load project details")}finally{E(!1)}}},L=T=>{const q=new Set(d);q.has(T)?q.delete(T):q.add(T),p(q)},V=()=>{const T=O.length>0&&O.every(te=>d.has(te.id)),q=new Set(d);T?O.forEach(te=>q.delete(te.id)):O.forEach(te=>q.add(te.id)),p(q)},Y=async()=>{if(!e)return;const T=Ne.from("facet_generation_jobs").select("*").order("created_at",{ascending:!1});e.role!=="super_admin"&&T.eq("client_id",e.client_id);const{data:q,error:te}=await T;if(te)return;const C=Array.from(new Set((q||[]).flatMap(M=>M.category_ids||[])));if(C.length>0){const{data:M}=await Ne.from("categories").select("id,name").in("id",C),W={};M==null||M.forEach(P=>W[P.id]=P.name),c(W)}n(q||[])},de=async()=>{if(!(!u.trim()||!e)){g(!0);try{const{error:T}=await Ne.from("facet_generation_jobs").insert({client_id:e.client_id||e.id,project_name:u,category_ids:[],status:"pending",created_by:e.id});if(T)throw T;h(""),await Y()}catch(T){console.error("Error creating project:",T)}finally{g(!1)}}},me=async T=>{t.confirm("Are you sure? This action cannot be undone.",async()=>{const{error:q}=await Ne.from("facet_generation_jobs").delete().eq("id",T.id);q?(console.error("Error deleting project",q),t.error("Failed to delete project")):(t.success("Project deleted successfully!"),await Y())})},ie=()=>{const T=d.size>0?b.filter(P=>d.has(P.id)):b;if(T.length===0)return;const te=[_.join(","),...T.map(P=>{var be,He;const z=((be=P.categories)==null?void 0:be.category_path)||"N/A",he=((He=P.categories)==null?void 0:He.name)||"Unknown",ae=P["Input Taxonomy"]||P["A. Input Taxonomy"]||z,se=P["End Category (C3)"]||P["B. End Category (C3)"]||he,oe=P.facet_name||P["Filter Attributes"]||P["C. Filter Attributes"]||"",ye=P.possible_values||P["Possible Values"]||P["D. Possible Values"]||"",R=P.filling_percentage||P["Filling Percentage (Approx.)"]||P["E. Filling Percentage (Approx.)"]||0,Me=P.priority||P["Priority (High / Medium / Low)"]||P["F. Priority (High / Medium / Low)"]||"Medium",U=P.confidence_score||P["Confidence Score (110)"]||P["G. Confidence Score (110)"]||5,re=P.num_sources||P["# of available sources"]||P["H. # of available sources"]||0,J=P.source_urls||P["Source URLs"]||P["I. Source URLs"]||"N/A",ue=Xe=>`"${String(Xe||"").replace(/"/g,'""')}"`;return[ue(ae),ue(se),ue(oe),ue(ye),R,Me,U,re,ue(J)].join(",")})].join(`
`),C=new Blob([te],{type:"text/csv"}),M=URL.createObjectURL(C),W=document.createElement("a");W.href=M,W.download=`${(x==null?void 0:x.project_name)||"project"}_facets_export.csv`,W.click(),URL.revokeObjectURL(M),t.success(d.size>0?"Exported selected facets":"Exported all facets")},ee=T=>{switch(T){case"completed":return"bg-green-100 text-green-700";case"processing":return"bg-blue-100 text-blue-700";case"failed":return"bg-red-100 text-red-700";default:return"bg-yellow-100 text-yellow-700"}};return f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Project Management"}),f.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[f.jsx("h3",{className:"font-semibold text-slate-900 mb-4",children:"Create New Project"}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("input",{type:"text",value:u,onChange:T=>h(T.target.value),placeholder:"Enter project name",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),f.jsxs("button",{onClick:de,disabled:y||!u.trim(),className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[f.jsx(tb,{className:"w-5 h-5"}),"Create Project"]})]})]}),f.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Breadcrumbs"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Status"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Categories"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Progress"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Created"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Actions"})]})}),f.jsxs("tbody",{className:"divide-y divide-slate-200",children:[r.map(T=>f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"px-6 py-4",children:f.jsx("div",{className:"flex flex-wrap items-center gap-1 px-6 py-4",children:T.category_ids&&T.category_ids.length>0?T.category_ids.map((q,te)=>f.jsxs("span",{className:"flex items-center text-[11px] text-slate-500",children:[f.jsx("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded border border-slate-200",children:l[q]||"Loading..."}),te<T.category_ids.length-1&&f.jsx("span",{className:"mx-1 text-slate-300",children:"/"})]},q)):f.jsx("span",{className:"text-xs text-slate-400 italic",children:"No categories linked!"})})}),f.jsx("td",{className:"px-6 py-4",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(T.status)}`,children:T.status})}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:T.total_categories}),f.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[T.progress,"%"]}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:new Date(T.created_at).toLocaleDateString()}),f.jsx("td",{className:"px-6 py-4",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>H(T),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:f.jsx(wv,{className:"w-4 h-4"})}),(e==null?void 0:e.role)==="super_admin"&&f.jsx("button",{onClick:()=>me(T),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:f.jsx($f,{className:"w-4 h-4"})})]})})]},T.id)),r.length===0&&f.jsx("tr",{children:f.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-slate-500",children:"No projects yet. Create your first project to get started."})})]})]})}),v&&x&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg max-w-[95vw] w-full max-h-[90vh] flex flex-col",children:[f.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between z-10",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:a||(x.category_ids&&x.category_ids.length>0?x.category_ids.map(T=>l[T]).filter(Boolean).slice(0,3).join(", ")+(x.category_ids.length>3?` + ${x.category_ids.length-3} more`:""):x.project_name||"Untitled Project")}),f.jsx("p",{className:"text-sm text-slate-500",children:d.size>0?`${d.size} selected`:`Showing ${O.length} facets`})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("button",{onClick:ie,disabled:b.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[f.jsx(Au,{className:"w-4 h-4"}),d.size>0?`Export Selected (${d.size})`:"Download CSV"]}),f.jsx("button",{onClick:()=>w(!1),className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:f.jsx(Ua,{className:"w-6 h-6"})})]})]}),f.jsx("div",{className:"p-0 overflow-hidden flex-1 flex flex-col",children:A?f.jsxs("div",{className:"text-center py-20",children:[f.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),f.jsx("p",{className:"text-slate-500",children:"Loading..."})]}):f.jsxs("div",{className:"flex-1 overflow-auto flex flex-col",children:[i.length>0&&f.jsx("div",{className:"px-6 pt-4 border-b border-slate-200 bg-white sticky top-0 z-20",children:f.jsx("div",{className:"flex gap-6 overflow-x-auto",children:i.map(T=>f.jsx("button",{onClick:()=>s(T),className:`pb-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${a===T?"border-blue-600 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:T},T))})}),O.length>0?f.jsxs("table",{className:"w-full text-left border-collapse",children:[f.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10 shadow-sm",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 w-10 border-b border-slate-200 bg-slate-50",children:f.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:O.length>0&&O.every(T=>d.has(T.id)),onChange:V})}),_.map((T,q)=>f.jsx("th",{className:"px-6 py-3 text-xs font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200 whitespace-nowrap bg-slate-50",children:T},q))]})}),f.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:O.map(T=>{var C,M;const q=((C=T.categories)==null?void 0:C.category_path)||"N/A",te=((M=T.categories)==null?void 0:M.name)||"Unknown";return f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"px-4 py-4",children:f.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:d.has(T.id),onChange:()=>L(T.id)})}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-xs truncate",title:q,children:T["Input Taxonomy"]||T["A. Input Taxonomy"]||q}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:T["End Category (C3)"]||T["B. End Category (C3)"]||te}),f.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:T.facet_name||T["Filter Attributes"]||T["C. Filter Attributes"]||"N/A"}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-md truncate",title:T.possible_values,children:T.possible_values||T["Possible Values"]||T["D. Possible Values"]||"N/A"}),f.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[T.filling_percentage||T["Filling Percentage (Approx.)"]||T["E. Filling Percentage (Approx.)"]||0,"%"]}),f.jsx("td",{className:"px-6 py-4",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(T.priority||T["Priority (High / Medium / Low)"]||T["F. Priority (High / Medium / Low)"])==="High"?"bg-red-100 text-red-700":(T.priority||T["Priority (High / Medium / Low)"]||T["F. Priority (High / Medium / Low)"])==="Medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:T.priority||T["Priority (High / Medium / Low)"]||T["F. Priority (High / Medium / Low)"]||"Medium"})}),f.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[T.confidence_score||T["Confidence Score (110)"]||T["G. Confidence Score (110)"]||5,"/10"]}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:T.num_sources||T["# of available sources"]||T["H. # of available sources"]||0}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-xs truncate",title:T.source_urls,children:T.source_urls||T["Source URLs"]||T["I. Source URLs"]||"N/A"})]},T.id)})})]}):f.jsx("div",{className:"text-center py-20",children:f.jsx("p",{className:"text-slate-500",children:"No facets found for this category."})})]})}),f.jsx("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end",children:f.jsx("button",{onClick:()=>w(!1),className:"px-6 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300",children:"Close"})})]})})]})}const pi=["Industry Analysis","Geography","Business Rules","Customer Intent","Competitive Analysis","Use Case Scenarios","Seasonal & Trends","Master Prompt"];function Eb(){const e=Ui(),{user:t}=Ka(),r=(t==null?void 0:t.role)==="super_admin",[n,a]=ne.useState([]),[s,i]=ne.useState(null),[o,l]=ne.useState(!1),[c,u]=ne.useState(""),[h,d]=ne.useState(""),[p,x]=ne.useState(!1),[m,v]=ne.useState(!1),[w,y]=ne.useState({}),[g,b]=ne.useState(!1),[I,A]=ne.useState([]),[E,_]=ne.useState(!1),[k,O]=ne.useState(null),[H,L]=ne.useState({}),[V,Y]=ne.useState(null),[de,me]=ne.useState(Array(5).fill("")),[ie,ee]=ne.useState(!1),[T,q]=ne.useState({name:"",template:"",level:1});ne.useEffect(()=>{C()},[t]);const te=async U=>{if(U){i(U),b(!0),_(!0);try{const{data:re,error:J}=await Ne.from("prompt_versions").select("*").eq("prompt_template_id",U.id).order("version",{ascending:!1});if(J)throw J;A(re||[])}catch(re){console.error("Error loading prompt history:",re),Y("Failed to load version history.")}finally{_(!1)}}},C=async()=>{if(!t)return;Y(null);const U=Ne.from("prompt_templates").select("*").eq("is_active",!0);t.role!=="super_admin"&&U.or(`client_id.eq.${t.client_id},client_id.is.null`);const{data:re,error:J}=await U;if(J)console.error("Error loading prompts:",J),Y(`Failed to load prompts: ${J.message}`),a([]);else{const ue=re||[],be=new Map;ue.sort((G,_e)=>G.client_id===null&&_e.client_id!==null?-1:G.client_id!==null&&_e.client_id==null?1:0),ue.forEach(G=>{be.set(G.name,G)});const Xe=Array.from(be.values()).sort((G,_e)=>{const Re=pi.indexOf(G.name),xe=pi.indexOf(_e.name);return(Re===-1?1/0:Re)-(xe===-1?1/0:xe)});a(Xe)}},M=U=>{!s||!t||e.confirm(`Restore v${U.version}? This creates a new version.`,async()=>{l(!0);try{const re=(s.current_version||0)+1,J=U.metadata||s.metadata||{},{error:ue}=await Ne.from("prompt_versions").insert({prompt_template_id:s.id,version:re,template_content:U.template_content,variables:U.variables,edited_by:t.id,metadata:J,change_notes:`Restored from Version ${U.version}`,is_active:!0});if(ue)throw ue;await Ne.from("prompt_versions").update({is_active:!1}).eq("prompt_template_id",s.id).neq("version",re);const{error:be}=await Ne.from("prompt_templates").update({template:U.template_content,current_version:re,metadata:J,updated_at:new Date().toISOString()}).eq("id",s.id);if(be)throw be;e.success(`Restored successfully as v${re}`),b(!1),await C()}catch(re){console.error("Error restoring version",re),e.error(`Failed to restore ${re.message}`)}finally{l(!1)}},{confirmText:"Yes,Restore",cancelText:"Cancel"})},W=async(U,re)=>{if(!U){alert("There is no content to copy.");return}try{await navigator.clipboard.writeText(U),O(re),setTimeout(()=>{O(null)},2e3)}catch(J){console.error("Failed to copy text:",J),alert("Failed to copy content to clipboard.")}},P=async()=>{if(!T.name.trim()||!T.template.trim()){Y("Prompt name and template content are required.");return}if(t){Y(null),v(!0);try{const{error:U}=await Ne.from("prompt_templates").insert({name:T.name,template:T.template,type:T.type,level:T.level,client_id:t.client_id,current_version:1});if(U)throw U;ee(!1),q({name:"",template:"",level:1}),await C()}catch(U){console.error("Error creating prompt:",U),e.error("Prompt created successfully!"),Y(`Failed to create prompt: ${U.message}`)}finally{v(!1)}}},z=s?(()=>{var U;if(c!==s.template)return!0;if(s.name==="Industry Analysis"){const re=((U=s.metadata)==null?void 0:U.industry_levels)||{};return JSON.stringify(w)!==JSON.stringify(re)}return!1})():!1,he=U=>{var re;if(Y(null),i(U),u(U.template),d(""),x(!0),y({}),U.name==="Industry Analysis"){const J=((re=U.metadata)==null?void 0:re.industry_levels)||{};y(J)}me(Array(5).fill(""))},ae=()=>{const U=Object.keys(w).map(Number),re=U.length>0?Math.max(...U)+1:2;y(J=>({...J,[re]:""}))},se=U=>{y(re=>{const J={...re};return delete J[U],J})},oe=(U,re)=>{y(J=>({...J,[U]:re}))},ye=async()=>{if(!s||!t)return;const U=s.client_id===null,re=t.role!=="super_admin"&&U;if(!(t.role==="super_admin"&&U&&!window.confirm(` WARNING: You are editing a Global Master Template.

These changes will affect ALL clients who have not customized this prompt.
Are you sure you want to proceed?`))){Y(null),v(!0);try{let J=s.id,ue=(s.current_version||1)+1,be={...s.metadata||{}};if(s.name==="Industry Analysis"){const Xe=Object.fromEntries(Object.entries(w).filter(([G,_e])=>_e.trim()!==""));be.industry_levels=Xe}if(re){const{data:Xe,error:G}=await Ne.from("prompt_templates").insert({name:s.name,template:c,type:s.type,level:s.level,client_id:t.client_id,current_version:1,is_active:!0,metadata:be}).select().single();if(G)throw G;J=Xe.id,ue=1,e.success("Created a custom version of this prompt for your organization.")}else{await Ne.from("prompt_versions").update({is_active:!1}).eq("prompt_template_id",J);const{error:Xe}=await Ne.from("prompt_templates").update({template:c,current_version:ue,updated_at:new Date().toISOString(),metadata:be}).eq("id",J);if(Xe)throw Xe}const{error:He}=await Ne.from("prompt_versions").insert({prompt_template_id:J,version:ue,template_content:c,variables:s.variables,metadata:be,edited_by:t.id,change_notes:re?"Initial customization from Global Default":h,is_active:!0});if(He)throw He;re||e.success("New version saved successfully"),x(!1),i(null),await C()}catch(J){console.error("Error saving prompt version:",J),Y(`Save failed: ${J.message}`),e.error(`Save failed: ${J.message}`)}finally{v(!1)}}},R=async(U,re)=>{t&&(re?await Ne.from("master_templates").delete().eq("prompt_template_id",U):await Ne.from("master_templates").insert({client_id:t.client_id||t.id,prompt_template_id:U,level_start:2,level_end:10,is_master:!0}),await C())},Me=async U=>{const{data:re}=await Ne.from("master_templates").select("id").eq("prompt_template_id",U).maybeSingle();return!!re};return f.jsxs("div",{children:["fv",f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Prompt Template Management"}),!p&&r&&f.jsxs("button",{onClick:()=>ee(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[f.jsx(Xc,{className:"w-5 h-5"}),"New Prompt"]})]}),p&&s?f.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[f.jsxs("h3",{className:"font-semibold text-slate-900 mb-4",children:["Edit: ",s.name]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:s.name==="Industry Analysis"?"Level 1 Keywords":"Template Content"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>W(c,"main-content"),className:"text-xs inline-flex items-center gap-1 text-slate-500 hover:text-slate-800",children:[f.jsx(y0,{className:"w-3 h-3"})," Copy"]}),k==="main-content"&&f.jsx("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 bg-slate-800 text-white text-xs rounded py-1 px-2",children:"Copied!"})]}),f.jsx("textarea",{value:c,onChange:U=>u(U.target.value),rows:8,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]}),s.name==="Industry Analysis"&&f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Sub-Level Templates"}),f.jsxs("button",{onClick:ae,className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-sm",children:[f.jsx(Xc,{className:"w-3 h-3"})," Add Level"]})]}),Object.keys(w).length===0&&f.jsx("p",{className:"text-sm text-slate-500 italic mb-4",children:'No sub-levels defined. Click "Add Level" to create additional processing levels.'}),f.jsx("div",{className:"space-y-6",children:Object.entries(w).map(([U,re])=>f.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 relative",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Level ",U]}),f.jsx("button",{onClick:()=>se(Number(U)),className:"text-red-500 hover:text-red-700",title:"Remove this level",children:f.jsx(Ua,{className:"w-4 h-4"})})]}),f.jsxs("div",{className:"relative mb-1",children:[f.jsxs("button",{onClick:()=>W(re,`level-${U}`),className:"text-xs inline-flex items-center gap-1 text-slate-500 hover:text-slate-800",children:[f.jsx(y0,{className:"w-3 h-3"})," Copy"]}),k===`level-${U}`&&f.jsx("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 bg-slate-800 text-white text-xs rounded py-1 px-2",children:"Copied!"})]}),f.jsx("textarea",{value:re,onChange:J=>oe(Number(U),J.target.value),rows:8,placeholder:`Enter template for level ${U}...`,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]},U))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Change Notes"}),f.jsx("input",{type:"text",value:h,onChange:U=>d(U.target.value),placeholder:"Describe what you changed...",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"flex gap-3",children:[z&&f.jsxs("button",{onClick:ye,disabled:m,className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[f.jsx(Nm,{className:"w-4 h-4"}),m?"Saving...":"Save New Version"]}),f.jsx("button",{onClick:()=>{x(!1),Y(null),i(null)},className:"px-6 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:z?"Cancel":"Close"})]})]}),V&&f.jsxs("div",{className:"bg-red-50 border border-red-200 text-sm text-red-700 px-4 py-3 rounded-lg mb-4",role:"alert",children:[f.jsx("strong",{className:"font-bold",children:"Error: "}),f.jsx("span",{children:V})]})]}):f.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Name"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Level"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Version"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Master Template"}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:n.map(U=>f.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[f.jsx("td",{className:"px-6 py-4",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-sm font-medium text-slate-900",children:U.name}),U.client_id?f.jsxs("span",{className:"text-[10px] inline-flex items-center gap-1 w-fit px-1.5 py-0.5 rounded bg-purple-50 text-purple-700 font-bold border border-purple-100 mt-1",children:[f.jsx(rb,{className:"w-3 h-3"})," Customized"]}):f.jsxs("span",{className:"text-[10px] inline-flex items-center gap-1 w-fit px-1.5 py-0.5 rounded bg-slate-100 text-slate-500 border border-slate-200 mt-1",children:[f.jsx(pb,{className:"w-3 h-3"})," Global Default"]})]})}),f.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:U.name}),f.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:["Level ",U.level]}),f.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:["v",U.current_version||1]}),f.jsx("td",{className:"px-6 py-4",children:f.jsx("button",{onClick:async()=>{const re=await Me(U.id);R(U.id,re)},disabled:!r,className:"text-yellow-500 hover:text-yellow-600 disabled:text-slate-300 disabled:cursor-not-allowed",title:"Toggle Master Template",children:f.jsx(gb,{className:"w-5 h-5"})})}),f.jsx("td",{className:"px-6 py-4",children:f.jsxs("div",{className:"flex items-center gap-2",children:[r&&f.jsx("button",{onClick:()=>he(U),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit Prompt",children:f.jsx(fb,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>te(U),className:"p-1 text-slate-600 hover:bg-slate-50 rounded",title:"View History",children:f.jsx(nb,{className:"w-4 h-4"})})]})})]},U.id))})]})}),f.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[f.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Version Control"}),f.jsx("p",{className:"text-sm text-slate-600",children:"All prompt edits are automatically versioned. The system uses the latest version for facet generation. Mark prompts with Level 2-10 as master templates for comprehensive facet building."})]}),ie&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full",children:[f.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:f.jsx("h3",{className:"text-xl font-semibold text-slate-900",children:"Create New Prompt Template"})}),f.jsxs("div",{className:"p-6 space-y-4",children:[V&&f.jsx("div",{className:"bg-red-50 border border-red-200 text-sm text-red-700 px-4 py-3 rounded-lg",role:"alert",children:V}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Prompt Name"}),f.jsx("input",{type:"text",placeholder:"e.g., 'Technical Specifications'",value:T.name,onChange:U=>q({...T,name:U.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Template Content (Level 1)"}),f.jsx("textarea",{rows:8,placeholder:"Enter the main prompt content here...",value:T.template,onChange:U=>q({...T,template:U.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500"})]}),f.jsx("div",{className:"grid grid-cols-1 gap-4",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Level"}),f.jsx("input",{type:"number",min:"1",value:T.level,onChange:U=>q({...T,level:parseInt(U.target.value,10)||1}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})})]}),f.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end gap-3",children:[f.jsx("button",{onClick:()=>{ee(!1),Y(null),q({name:"",template:"",level:1})},className:"px-6 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200",children:"Cancel"}),f.jsxs("button",{onClick:P,disabled:m,className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[f.jsx(Nm,{className:"w-4 h-4"}),m?"Creating...":"Create Prompt"]})]})]})}),g&&s&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[f.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between",children:[f.jsxs("h3",{className:"text-xl font-semibold text-slate-900",children:["Version History: ",s.name]}),f.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-slate-100 rounded-full",children:f.jsx(Ua,{className:"w-5 h-5"})})]}),f.jsx("div",{className:"p-6 overflow-y-auto",children:E?f.jsx("p",{className:"text-center text-slate-500",children:"Loading history..."}):f.jsxs("div",{className:"space-y-6",children:[I.map((U,re)=>{var ue,be;const J=re===0;return f.jsxs("div",{className:`border rounded-lg transition-all ${J?"border-blue-300 ring-1 ring-blue-100":"border-slate-200"}`,children:[f.jsxs("div",{className:"bg-slate-50 p-3 flex justify-between items-center text-sm border-b rounded-t-lg",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("span",{className:"font-semibold text-slate-900",children:["Version ",U.version]}),J?f.jsx("span",{className:"text-xs font-medium bg-green-100 text-green-700 px-2 py-0.5 rounded-full border border-green-200",children:"Current Active"}):f.jsx("span",{className:"text-xs text-slate-500",children:new Date(U.created_at).toLocaleDateString()})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"text-slate-500 hidden sm:block",children:[f.jsx("span",{className:"font-medium",children:"By:"})," ",((ue=U.users)==null?void 0:ue.email)||"Unknown"]}),!J&&r&&f.jsxs("button",{onClick:()=>M(U),disabled:o,className:"flex items-center gap-1 text-xs font-medium bg-white border border-slate-300 text-slate-700 px-3 py-1.5 rounded hover:bg-slate-100 hover:text-blue-600 transition-colors shadow-sm",title:"Restore this version",children:[f.jsx(db,{className:"w-3 h-3"}),o?"Restoring...":"Restore"]})]})]}),f.jsxs("div",{className:"p-4 space-y-3 bg-white rounded-b-lg",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800 text-xs uppercase tracking-wider mb-1",children:"Change Notes"}),f.jsx("p",{className:"text-sm text-slate-600 italic",children:U.change_notes||"No notes provided."})]}),f.jsxs("div",{children:[f.jsxs("h4",{className:"font-semibold text-slate-800 text-xs uppercase tracking-wider mb-1 flex justify-between",children:[f.jsx("span",{children:"Template Content"}),f.jsxs("button",{onClick:()=>W(U.template_content,`v-${U.version}`),className:"text-blue-600 hover:text-blue-800 normal-case font-normal flex items-center gap-1",children:[f.jsx(y0,{className:"w-3 h-3"})," Copy"]})]}),f.jsxs("div",{className:"relative",children:[f.jsx("pre",{className:"bg-slate-50 border border-slate-100 p-3 rounded-md text-xs font-mono whitespace-pre-wrap overflow-x-auto max-h-60",children:U.template_content}),((be=U.metadata)==null?void 0:be.industry_levels)&&Object.keys(U.metadata.industry_levels).length>0&&f.jsxs("div",{className:"mt-3 border-t border-slate-100 pt-3",children:[f.jsx("h4",{className:"font-semibold text-slate-800 text-xs uppercase tracking-wider mb-2",children:"Included Sub-Levels"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(U.metadata.industry_levels).map(He=>f.jsxs("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded border border-slate-200",children:["Level ",He]},He))})]}),k===`v-${U.version}`&&f.jsx("span",{className:"absolute top-2 right-2 bg-slate-800 text-white text-[10px] rounded py-0.5 px-1.5 opacity-90",children:"Copied"})]})]})]})]},U.id)}),I.length===0&&f.jsx("p",{className:"text-center text-slate-500",children:"No version history found."})]})}),f.jsx("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end",children:f.jsx("button",{onClick:()=>b(!1),className:"px-6 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300",children:"Close"})})]})})]})}function Sb({onComplete:e}){var Fl;const t=ne.useRef(null),r=Ui(),{user:n}=Ka(),[a,s]=ne.useState({input_taxonomy:"A. Input Taxonomy",end_category:"B. End Category (C3)",facet_name:"C. Filter Attributes",possible_values:"D. Possible Values",filling_percentage:"E. Filling Percentage (Approx.)",priority:"F. Priority (High / Medium / Low)",confidence_score:"G. Confidence Score (110)",num_sources:"H. # of available sources",source_urls:"I. Sources URLs"}),[i,o]=ne.useState(!1),[l,c]=ne.useState([]),[u,h]=ne.useState([]),[d,p]=ne.useState(""),[x,m]=ne.useState(!1),[v,w]=ne.useState(new Set),[y,g]=ne.useState(new Set),[b,I]=ne.useState(null),[A,E]=ne.useState({1:"",2:"",3:""}),[_,k]=ne.useState(""),[O,H]=ne.useState(""),[L,V]=ne.useState(!1),[Y,de]=ne.useState({1:"",2:"",3:"",4:"",5:"",6:""}),[me,ie]=ne.useState(!1),[ee,T]=ne.useState([]),[q,te]=ne.useState({}),[C,M]=ne.useState(null),[W,P]=ne.useState(null),[z,he]=ne.useState(""),[ae,se]=ne.useState({}),[oe,ye]=ne.useState(null),[R,Me]=ne.useState({});ne.useEffect(()=>()=>{t.current&&clearTimeout(t.current)},[]),ne.useEffect(()=>{je()},[n,e]);const U=(fe,ke)=>{Me(Ie=>{const Be={...Ie},Pe=new Set(Be[fe]||[]);return Pe.has(ke)?Pe.delete(ke):Pe.add(ke),Be[fe]=Pe,Be})},re=fe=>{let ke=[];const Ie=A[fe].toLowerCase(),Be=l.filter(Pe=>Pe.is_visible!==!1);if(fe===1)ke=Array.from(new Set(Be.map(ge=>ge.category_path.split(">")[0].trim()))).sort().map(ge=>({id:ge,name:ge}));else{const Pe=[];for(let $e=1;$e<fe;$e++)if(Y[$e])Pe.push(Y[$e]);else return[];const ge=Pe.join(" > "),Je=Be.filter($e=>$e.category_path.startsWith(ge+" >")||$e.category_path===ge);ke=Array.from(new Set(Je.map($e=>{var rr;return(rr=$e.category_path.split(">")[fe-1])==null?void 0:rr.trim()}))).filter(Boolean).sort().map($e=>({id:$e,name:$e}))}return ke.filter(Pe=>Pe.name.toLowerCase().includes(Ie))},J=ne.useMemo(()=>{const fe=d.toLowerCase().trim(),Ie=Object.values(Y).filter(Boolean).join(" > ");return l.filter(Be=>{if(Be.is_visible===!1)return!1;const Pe=Be.category_path.toLowerCase(),ge=fe===""||Pe.includes(fe),Je=Ie===""||Be.category_path.startsWith(Ie);return ge&&Je}).slice(0,50)},[l,d,Y]),ue=fe=>{m(!1);const ke=fe.category_path.split(" > ").map(Be=>Be.trim()),Ie={1:"",2:"",3:"",4:"",5:"",6:""};ke.forEach((Be,Pe)=>{Pe<6&&(Ie[Pe+1]=Be)}),de(Ie),p(""),m(!1),r.info(`Navigation synced to: ${fe.name}`)};ne.useEffect(()=>{const fe=()=>{I(null),m(!1)},ke=Ie=>{Ie.key==="Escape"&&(I(null),m(!1),p(""))};return(b!==null||x)&&(window.addEventListener("click",fe),window.addEventListener("keydown",ke)),()=>{window.removeEventListener("click",fe),window.removeEventListener("keydown",ke)}},[b,x]),ne.useEffect(()=>{if(!n)return;(async()=>{const{data:ke}=await Ne.from("user_queues").select("queue").eq("user_id",n.id).maybeSingle();ke!=null&&ke.queue&&Array.isArray(ke.queue)&&w(new Set(ke.queue)),o(!0)})()},[n]),ne.useEffect(()=>{if(!n||!i)return;const ke=setTimeout(async()=>{const Ie=Array.from(v),{error:Be}=await Ne.from("user_queues").upsert({user_id:n.id,queue:Ie,updated_at:new Date});Be&&console.error("Error saving queue:",Be)},500);return()=>clearTimeout(ke)},[v,n,i]),ne.useEffect(()=>{const fe=ke=>{v.size>0&&(ke.preventDefault(),ke.returnValue="You have items in your processing queue. Are you sure you want to leave?")};return window.addEventListener("beforeunload",fe),()=>window.removeEventListener("beforeunload",fe)},[v.size]);const be=()=>{Object.values(Y).some(Boolean)&&r.confirm("Reset all selected levels? Your current navigation path will be cleared.",()=>{de({1:"",2:"",3:"",4:"",5:"",6:""}),E({1:"",2:"",3:""}),r.success("Filters reset")},{confirmText:"Reset",cancelText:"Stay"})},He=()=>{r.confirm(`Remove all ${v.size} categories from the queue?`,()=>{w(new Set),r.success("Queue cleared")},{confirmText:"Clear All",cancelText:"Keep"})},Xe=(fe,ke)=>{r.confirm(`Remove "${ke}" from the processing queue?`,()=>{at(fe),r.success("Item removed")},{confirmText:"Remove",cancelText:"Cancel"})},G=fe=>{if(fe&&(fe.preventDefault(),fe.stopPropagation()),I(null),t.current&&(clearTimeout(t.current),t.current=null),!Y[1]||!Y[2]){r.error("Please select at least Level 1 and Level 2!");return}const Ie=Object.values(Y).filter(Boolean).join(" > "),Be=l.find(Pe=>Pe.category_path.trim()===Ie.trim());if(Be)at(Be.id),v.has(Be.id)?r.success(`Removed: ${Ie}`):(r.success(`Added: ${Ie}`),de({1:"",2:"",3:"",4:"",5:"",6:""}),E({1:"",2:"",3:""}));else{const Pe=l.filter(ge=>ge.category_path.trim().startsWith(Ie.trim()+" >"));Pe.length>0?r.confirm(`"${Ie}" is a group with ${Pe.length} items. Add all of them to the queue?`,()=>{w(ge=>{const Je=new Set(ge);return Pe.forEach(vt=>Je.add(vt.id)),Je}),r.success(`Added ${Pe.length} categories to queue`),de({1:"",2:"",3:"",4:"",5:"",6:""}),E({1:"",2:"",3:""})},{confirmText:"Add All",cancelText:"Cancel"}):r.error("No valid categories found for this selection.")}},_e=(fe,ke)=>{t.current&&(clearTimeout(t.current),t.current=null);const Ie={...Y,[fe]:ke};if(fe<3)for(let Be=fe+1;Be<=6;Be++)Ie[Be]="";de(Ie)},Re=fe=>{on(fe),t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{I(null),de({1:"",2:"",3:"",4:"",5:"",6:""}),E({1:"",2:"",3:""}),r.info("Filters auto-reset due to inactivity"),t.current=null},3e3)},xe=(fe,ke)=>{Me(Ie=>{const Be={...Ie},Pe=Be[fe]||new Set,ge=ke.map(Je=>Je.id);return Pe.size===ge.length?Be[fe]=new Set:Be[fe]=new Set(ge),Be})},De=Object.values(R).reduce((fe,ke)=>fe+ke.size,0),je=async()=>{if(!n)return;const fe=n.role==="super_admin"?{}:{client_id:n.client_id},[ke,Ie]=await Promise.all([Ne.from("categories").select("*").eq("is_visible",!0).match(fe).order("category_path"),Ne.from("prompt_templates").select("*").order("level").eq("is_active",!0).order("execution_order")]),Pe=(Ie.data||[]).sort((vt,$e)=>{const rr=pi.indexOf(vt.name),Qa=pi.indexOf($e.name);return(rr===-1?1/0:rr)-(Qa===-1?1/0:Qa)});c(ke.data||[]),h(Pe);const ge=["Industry Analysis","Master Prompt"],Je=Pe.filter(vt=>ge.includes(vt.name)).map(vt=>vt.id);g(new Set(Je))},at=fe=>{const ke=new Set(v);ke.has(fe)?ke.delete(fe):ke.add(fe),w(ke)},ut=fe=>{w(ke=>{const Ie=new Set(ke),Be=Ie.has(fe);Be?Ie.delete(fe):Ie.add(fe);const Pe=l.find(ge=>ge.id===fe);return Pe?r.success(Be?`Removed: ${Pe.name}`:`Added: ${Pe.name}`):r.error(`Category not found: ${fe}`),Ie})},_t=fe=>{const ke=new Set(y);ke.has(fe)?ke.delete(fe):ke.add(fe),g(ke)},ze=()=>{y.size===u.length?g(new Set):g(new Set(u.map(fe=>fe.id)))},st=async()=>{if(!n)return null;const fe=Array.from(v).sort().join(","),ke=Array.from(y).sort().join(","),{data:Ie}=await Ne.from("facet_generation_jobs").select("*").eq("client_id",n.client_id).eq("status","completed").order("created_at",{ascending:!1}).limit(20);return Ie?Ie.find(Be=>{const Pe=(Be.category_ids||[]).sort().join(","),ge=(Be.selected_prompts||[]).sort().join(",");return Pe===fe&&ge===ke}):null},ht=async fe=>{ie(!0);try{r.info("Loading existing results.....");const{data:ke}=await Ne.from("recommended_facets").select("*").eq("job_id",fe).order("sort_order"),Ie=ke||[];T(Ie),M(fe);const Be=Ie.reduce((ge,Je)=>{const vt=Je.category_id;return ge[vt]||(ge[vt]=[]),ge[vt].push(Je),ge},{});te(Be);const Pe=Object.keys(Be);he(Pe.length>0?Pe[0]:""),r.success("Loaded existing results successfully!")}catch(ke){console.error("Error loading existing:",ke),r.error("Failed to load existing results.")}finally{ie(!1)}},it=async()=>{const fe=new Set(Object.values(R).flatMap($e=>Array.from($e)));if(fe.size===0){console.log("No facets selected for export.");return}const ke=ee.filter($e=>fe.has($e.id)),Ie=new Map(l.map($e=>[$e.id,$e.name])),Pe=["Input Taxonomy,End Category (C3),Filter Attributes,Possible Values,Filling Percentage (Approx.),Priority (High / Medium / Low),Confidence Score (110),# of available sources,Source URLs",...ke.map($e=>{var K;const rr=((K=l.find(ce=>ce.id===$e.category_id))==null?void 0:K.category_path)||"N/A",Qa=Ie.get($e.category_id)||"Unknown Category",Bs=$e["Input Taxonomy"]||$e["A. Input Taxonomy"]||rr,Za=$e["End Category (C3)"]||$e["B. End Category (C3)"]||Qa,xr=$e.facet_name||$e["Filter Attributes"]||$e["C. Filter Attributes"]||"",Us=$e.possible_values||$e["Possible Values"]||$e["D. Possible Values"]||"",ga=$e.filling_percentage||$e["Filling Percentage (Approx.)"]||$e["E. Filling Percentage (Approx.)"]||0,jt=$e.priority||$e["Priority (High / Medium / Low)"]||$e["F. Priority (High / Medium / Low)"]||"Medium",Xn=$e.confidence_score||$e["Confidence Score (110)"]||$e["G. Confidence Score (110)"]||5,Fr=$e.num_sources||$e["# of available sources"]||$e["H. # of available sources"]||0,S=$e.source_urls||$e["Source URLs"]||$e["I. Source URLs"]||"N/A",D=`"${String(Bs).replace(/"/g,'""')}"`,N=`"${String(Za).replace(/"/g,'""')}"`,F=`"${String(xr).replace(/"/g,'""')}"`,j=`"${String(Us).replace(/"/g,'""')}"`,B=`"${String(S).replace(/"/g,'""')}"`;return[D,N,F,j,ga,jt,Xn,Fr,B].join(",")})].join(`
`),ge=new Blob([Pe],{type:"text/csv"}),Je=URL.createObjectURL(ge),vt=document.createElement("a");vt.href=Je,vt.download=`facets-${_||C}.csv`,vt.click(),URL.revokeObjectURL(Je),await Ne.from("export_history").insert({job_id:C,client_id:n==null?void 0:n.client_id,category_ids:Array.from(v),format:"csv",exported_by:n==null?void 0:n.id})},on=fe=>{const ke=l.find(Ie=>Ie.category_path.trim().startsWith(fe.trim()));if(ke){at(ke.id);const Ie=v.has(ke.id);r.success(Ie?"Removed from queue":"Added to queue")}},Vi=async(fe=!1)=>{var Ie,Be;if(v.size===0)return;if(!fe){const Pe=await st();if(Pe){const ge=new Date(Pe.created_at).toLocaleDateString();r.confirm(`Idenfical results found from ${ge}.Load them to save credits?`,()=>ht(Pe.id),{confirmText:"Load Existing (Free)",cancelText:"Generate New (Cost)",onCancel:()=>Vi(!0)});return}}if(!n){P("You must be logged in to perform this action.");return}const ke=n.client_id;if(!ke){P("Your user profile is not associated with a client. Cannot create job."),ie(!1);return}ie(!0),P(null);try{ye(null);const Pe=u.filter(jt=>y.has(jt.id));Pe.sort((jt,Xn)=>{const Fr=jt.name.trim(),S=Xn.name.trim();if(Fr==="Industry Analysis")return-1;if(S==="Industry Analysis"||Fr==="Master Prompt")return 1;if(S==="Master Prompt")return-1;const D=pi.indexOf(Fr),N=pi.indexOf(S);return(D===-1?999:D)-(N===-1?999:N)});const ge=Pe.map(jt=>{if(!jt)return null;const Fr=Object.values(Y).filter(Boolean).length,S=Array.from(v).map(D=>{const N=l.find(B=>B.id===D);if(!N)return null;const F=N.category_path.split(" > "),j=F.slice(0,Fr).join(" > ");return{...N,category_path:j,level:Fr,name:F[Fr-1]}}).filter(Boolean);return{id:jt.id,name:jt.name,content:jt.template||"",metadata:jt.metadata,context_categories:S}}).filter(jt=>jt!==null),{data:Je,error:vt}=await Ne.from("facet_generation_jobs").insert({client_id:ke,project_name:_,category_ids:Array.from(v),selected_prompts:Array.from(y),status:"processing",total_categories:v.size,processed_categories:0,created_by:n.id}).select().maybeSingle();if(vt||!Je)throw vt;M(Je.id);const rr=await fetch("https://rqairbvsiwohklvsxyre.supabase.co/functions/v1/generate-facets-ai",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYWlyYnZzaXdvaGtsdnN4eXJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5Nzk2NTcsImV4cCI6MjA4MjU1NTY1N30.6Uyi42A_4Pqe1G40qnx4M8ST38XRgh9x8o7mCtiVr18","Content-Type":"application/json"},body:JSON.stringify({job_id:Je.id,category_ids:Array.from(v),prompts:ge})});if(!rr.ok){const jt=await rr.text();throw new Error(`Generation failed with status ${rr.status}: ${jt}`)}if((await rr.json()).facets_generated===0){ie(!1),P("The AI was unable to generate any facets. Please try again later!"),r.error("Generation Failed: 0 facets produced."),await Ne.from("facet_generation_jobs").update({status:"failed"}).eq("id",Je.id);return}const{data:Bs}=await Ne.from("recommended_facets").select("*").eq("job_id",Je.id).order("sort_order"),Za=Bs||[];T(Za);const{data:xr}=await Ne.from("facet_generation_jobs").select("metadata").eq("id",Je.id).single();(Be=(Ie=xr==null?void 0:xr.metadata)==null?void 0:Ie.output_format)!=null&&Be.columns&&s({input_taxonomy:xr.metadata.output_format.columns[0]||"A. Input Taxonomy",end_category:xr.metadata.output_format.columns[1]||"B. End Category (C3)",facet_name:xr.metadata.output_format.columns[2]||"C. Filter Attributes",possible_values:xr.metadata.output_format.columns[3]||"D. Possible Values",filling_percentage:xr.metadata.output_format.columns[4]||"E. Filling Percentage (Approx.)",priority:xr.metadata.output_format.columns[5]||"F. Priority (High / Medium / Low)",confidence_score:xr.metadata.output_format.columns[6]||"G. Confidence Score (110)",num_sources:xr.metadata.output_format.columns[7]||"H. # of available sources",source_urls:xr.metadata.output_format.columns[8]||"I. Source URLs"});const Us=Za.reduce((jt,Xn)=>{const Fr=Xn.category_id;return jt[Fr]||(jt[Fr]=[]),jt[Fr].push(Xn),jt},{});te(Us);const ga=Object.keys(Us);he(ga.length>0?ga[0]:""),await Ne.from("facet_generation_jobs").update({status:"completed",progress:100,processed_categories:v.size,completed_at:new Date().toISOString()}).eq("id",Je.id),w(new Set)}catch(Pe){console.error("Error generating facets:",Pe),P(`Failed to generate facets: ${Pe.message}`),C&&await Ne.from("facet_generation_jobs").update({status:"failed"}).eq("id",C)}finally{ie(!1)}};if(ee.length>0){const fe=new Map(l.map(ge=>[ge.id,ge.name])),ke=Object.values(R).reduce((ge,Je)=>ge+Je.size,0),Ie=ee.length>0&&ke===ee.length,Be=()=>{if(Ie)Me({});else{const ge={};ee.forEach(Je=>{ge[Je.category_id]||(ge[Je.category_id]=new Set),ge[Je.category_id].add(Je.id)}),Me(ge)}},Pe=q[z]||[];return f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Generated Facets"}),f.jsx("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-semibold text-slate-900",children:[ee.length," facets generated"]}),f.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["For ",v.size," categories"]})]}),f.jsxs("div",{className:"flex items-center gap-2 mr-4 border-r border-slate-200 pr-4",children:[f.jsx("input",{type:"checkbox",id:"global-select",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:Ie,onChange:Be}),f.jsx("label",{htmlFor:"global-select",className:"text-sm font-medium text-slate-700 cursor-pointer select-none",children:"Select All"}),f.jsxs("button",{disabled:De===0,onClick:it,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[f.jsx(Au,{className:"w-4 h-4"})," Export"," ",De>0?`(${De})`:""]}),f.jsx("button",{onClick:e,className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:"Back to Dashboard"})]})]})}),f.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden flex flex-col",children:[f.jsx("div",{className:"bg-slate-50 border-b border-slate-200 px-6 pt-4 sticky top-0 z-10",children:f.jsx("div",{className:"flex gap-6 overflow-x-auto custom-scrollbar",children:Object.keys(q).map(ge=>f.jsxs("button",{onClick:()=>he(ge),className:`pb-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${z===ge?"border-blue-600 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:[fe.get(ge)||"Unknown"," (",q[ge].length,")"]},ge))})}),Pe.length>0?f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-white border-b border-slate-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 w-12 text-left",children:f.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:(((Fl=R[z])==null?void 0:Fl.size)||0)===Pe.length,onChange:()=>xe(z,Pe)})}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.input_taxonomy}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.end_category}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.facet_name}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.possible_values}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.filling_percentage}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.priority}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.confidence_score}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.num_sources}),f.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-slate-900",children:a.source_urls})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:Pe.map(ge=>{var Je;return f.jsxs("tr",{className:"hover:bg-slate-50",children:[f.jsx("td",{className:"px-4 py-4",children:f.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer",checked:(R[z]||new Set).has(ge.id),onChange:()=>U(z,ge.id)})}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-xs truncate",children:ge["Input Taxonomy"]||ge["A. Input Taxonomy"]||((Je=l.find(vt=>vt.id===z))==null?void 0:Je.category_path)||"N/A"}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:ge["End Category (C3)"]||ge["B. End Category (C3)"]||fe.get(z)||"N/A"}),f.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:ge.facet_name||ge["Filter Attributes"]||ge["C. Filter Attributes"]||"N/A"}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-md truncate",children:ge.possible_values||ge["Possible Values"]||ge["D. Possible Values"]||"N/A"}),f.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[ge.filling_percentage||ge["Filling Percentage (Approx.)"]||ge["E. Filling Percentage (Approx.)"]||0,"%"]}),f.jsx("td",{className:"px-6 py-4",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(ge.priority||ge["Priority (High / Medium / Low)"]||ge["F. Priority (High / Medium / Low)"])==="High"?"bg-red-100 text-red-700":(ge.priority||ge["Priority (High / Medium / Low)"]||ge["F. Priority (High / Medium / Low)"])==="Medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:ge.priority||ge["Priority (High / Medium / Low)"]||ge["F. Priority (High / Medium / Low)"]||"Medium"})}),f.jsxs("td",{className:"px-6 py-4 text-sm text-slate-600",children:[ge.confidence_score||ge["Confidence Score (110)"]||ge["G. Confidence Score (110)"]||5,"/10"]}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:ge.num_sources||ge["# of available sources"]||ge["H. # of available sources"]||0}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-xs truncate",children:ge.source_urls||ge["Source URLs"]||ge["I. Source URLs"]||"N/A"})]},ge.id)})})]})}):f.jsx("div",{className:"p-12 text-center text-slate-500",children:"No facets found for this category."})]})]})}return f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Generate Facets"}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[f.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 flex flex-col h-[600px]",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[f.jsx(bm,{className:"w-4 h-4 text-blue-600"})," Category Schema"]}),f.jsx("button",{onClick:be,className:"text-xs text-blue-600 hover:underline font-semibold",children:"Reset Filters"})]}),f.jsxs("div",{className:"relative mb-6",onClick:fe=>fe.stopPropagation(),children:[f.jsx("label",{className:"text-[10px] font-bold text-blue-500 uppercase mb-1 block tracking-widest",children:Y[1]?`Quick Find in ${Y[1]}`:"Quick Find (Full Hierarchy)"}),f.jsxs("div",{className:"relative",children:[f.jsx(Uf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),f.jsx("input",{type:"text",placeholder:"Search full hierarchy...",className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm",value:d,onChange:fe=>{p(fe.target.value),m(!0)},onFocus:()=>m(!0)})]}),x&&f.jsx("div",{className:"absolute z-[70] w-full mt-2 bg-white border border-slate-200 rounded-xl shadow-2xl max-h-72 overflow-y-auto p-2 animate-in fade-in slide-in-from-top-2",children:J.length>0?J.map(fe=>f.jsxs("div",{className:"p-3 hover:bg-blue-50 rounded-lg group border-b border-slate-50 last:border-0 transition-colors flex items-start gap-2",children:[f.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 mt-1 cursor-pointer",checked:v.has(fe.id),onChange:()=>ut(fe.id),onClick:ke=>ke.stopPropagation()}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-[10px] text-slate-400 group-hover:text-blue-400 transition-colors mb-0.5 cursor-pointer",onClick:()=>ue(fe),children:fe.category_path.includes(" > ")?fe.category_path.split(" > ").slice(0,-1).join(" / "):"Root"}),f.jsx("div",{className:"text-sm font-bold text-slate-700 group-hover:text-blue-700 cursor-pointer",onClick:()=>ue(fe),children:fe.name})]})]},fe.id)):f.jsx("div",{className:"p-4 text-center text-xs text-slate-400 italic",children:"No categories found"})})]}),f.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[f.jsx("div",{className:"h-[1px] bg-slate-100 flex-1"}),f.jsx("span",{className:"text-[10px] text-slate-300 font-bold uppercase",children:"Or Find By Level"}),f.jsx("div",{className:"h-[1px] bg-slate-100 flex-1"})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[1,2,3].map(fe=>{const ke=re(fe),Ie=fe>1&&!Y[fe-1],Be=b===fe,Pe=Y[fe];return f.jsxs("div",{className:"relative space-y-1",onClick:ge=>ge.stopPropagation(),children:[f.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:["Level ",fe]}),f.jsxs("div",{onClick:()=>!Ie&&I(Be?null:fe),className:`w-full p-2 text-sm border rounded-lg flex justify-between items-center cursor-pointer transition-all ${Ie?"bg-slate-50 border-slate-100 text-slate-300":"bg-white border-slate-200 hover:border-blue-400"} ${Be?"ring-2 ring-blue-500 border-blue-500":""}`,children:[f.jsx("span",{className:"truncate",children:Pe||"Select Category"}),f.jsx(bm,{className:`w-3 h-3 transition-transform ${Be?"rotate-180":""}`})]}),Be&&f.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-lg shadow-xl animate-in fade-in slide-in-from-top-1",children:[f.jsx("div",{className:"p-2 border-b border-slate-100 sticky top-0 bg-white rounded-t-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Uf,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-slate-400"}),f.jsx("input",{autoFocus:!0,type:"text",placeholder:"Type to search...",value:A[fe],onChange:ge=>E(Je=>({...Je,[fe]:ge.target.value})),className:"w-full pl-7 pr-2 py-1.5 text-xs border border-slate-100 rounded bg-slate-50 outline-none focus:bg-white focus:ring-1 focus:ring-blue-400"})]})}),f.jsx("div",{className:"max-h-48 overflow-y-auto p-1",children:ke.length>0?ke.map(ge=>{const Je=fe===1?ge.name:fe===2?`${Y[1]} > ${ge.name}`:`${Y[1]} > ${Y[2]} > ${ge.name}`,vt=l.find(rr=>rr.category_path.startsWith(Je)),$e=vt&&v.has(vt.id);return f.jsxs("div",{onClick:()=>{if(fe<3)_e(fe,ge.id),I(null);else{const rr=`${Y[1]} > ${Y[2]} > ${ge.name}`;Re(rr)}},className:`px-3 py-2 text-xs rounded cursor-pointer flex items-center justify-between transition-colors ${Pe===ge.id?"bg-blue-50 text-blue-700 font-bold":"hover:bg-slate-50 text-slate-700"}`,children:[f.jsx("span",{children:ge.name}),$e&&f.jsx(Em,{className:"w-3 h-3 text-blue-600"})]},ge.id)}):f.jsx("div",{className:"px-3 py-4 text-xs text-slate-400 text-center italic",children:"No categories found"})})]})]},fe)})}),Object.values(Y).some(fe=>fe!=="")&&f.jsx("div",{className:"mt-2 p-4 bg-blue-50 rounded-xl border border-blue-100 animate-in fade-in slide-in-from-top-2",children:f.jsxs("div",{className:"flex items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-[10px] font-bold text-blue-400 uppercase",children:"Current Selection"}),f.jsx("p",{className:"text-sm font-medium text-blue-900 truncate",children:(()=>{var Ie;const fe=Object.values(Y).filter(Boolean),ke=fe[fe.length-1];return(Ie=l.find(Be=>Be.id===ke))==null?void 0:Ie.category_path})()})]}),f.jsx("button",{onClick:G,disabled:!Y[1]||!Y[2],className:`px-4 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${(()=>{const fe=Object.values(Y).filter(Boolean).join(" > "),ke=l.find(Ie=>Ie.category_path.startsWith(fe));return ke&&v.has(ke.id)})()?"bg-red-100 text-red-600 hover:bg-red-200":"bg-blue-600 text-white hover:bg-blue-700 shadow-md"}`,children:(()=>{const fe=Object.values(Y).filter(Boolean).join(" > "),ke=l.find(Ie=>Ie.category_path===fe);return ke&&v.has(ke.id)?"Remove from Job":"Add to Job"})()})]})}),f.jsxs("div",{className:"mt-auto pt-4 border-t border-slate-100 flex flex-col gap-3",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("div",{className:"flex flex-col",children:f.jsxs("span",{className:"text-xs font-bold text-slate-700 uppercase tracking-tighter",children:["Processing Queue (",v.size,")"]})}),v.size>0&&f.jsx("button",{onClick:He,className:"text-[10px] text-red-500 font-bold hover:underline uppercase",children:"Clear Queue"})]}),f.jsx("div",{className:"max-h-[120px] overflow-y-auto space-y-1 pr-1 custom-scrollbar",children:v.size>0?Array.from(v).map(fe=>{const ke=l.find(Ie=>Ie.id===fe);return f.jsxs("div",{className:"flex items-center justify-between bg-slate-50 border border-slate-200 px-2 py-1.5 rounded-md group hover:border-blue-300 transition-colors",children:[f.jsx("span",{className:"text-[13px] text-slate-600 truncate flex-1 pr-2 font-medium",children:(ke==null?void 0:ke.category_path)||"Unknown Category"}),f.jsx("button",{onClick:()=>Xe(fe,(ke==null?void 0:ke.category_path)||""),className:"text-slate-400 hover:text-red-500 transition-colors",title:"Remove from queue",children:f.jsx(Ua,{className:"w-3 h-3"})})]},fe)}):f.jsx("div",{className:"text-[12px] text-slate-400 py-2 text-center border border-dashed border-slate-200 rounded-md",children:"No categories added to the job yet."})})]})]}),f.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h3",{className:"font-semibold text-slate-900",children:["Select Prompts (",y.size,")"]}),f.jsx("button",{onClick:ze,className:"text-sm text-blue-600 hover:text-blue-700",children:y.size===u.length?"Deselect All":"Select All"})]}),oe&&f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-sm text-yellow-800 px-4 py-2 rounded-lg mb-4",role:"alert",children:oe}),f.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:u.map(fe=>f.jsx("div",{className:"p-3 hover:bg-slate-50 rounded-lg transition-colors",children:f.jsxs("button",{onClick:()=>_t(fe.id),className:"w-full flex items-center gap-3 text-left",children:[y.has(fe.id)?f.jsx(Em,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}):f.jsx(xb,{className:"w-5 h-5 text-slate-400 flex-shrink-0"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-slate-900",children:fe.name}),f.jsxs("p",{className:"text-xs text-slate-500",children:["Level ",fe.level,"  ",fe.type]})]})]})},fe.id))})]})]}),W&&f.jsxs("div",{className:"relative text-center bg-red-50 border border-red-200 text-sm text-red-700 px-10 py-3 rounded-lg mb-4 max-w-4xl mx-auto animate-in fade-in zoom-in duration-300",role:"alert",children:[f.jsx("strong",{className:"font-bold",children:"An error occurred: "}),f.jsx("span",{children:W}),f.jsx("button",{onClick:()=>P(null),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 hover:bg-red-100 rounded-full transition-colors",title:"Dismiss",children:f.jsx(Ua,{className:"w-4 h-4 text-red-400"})})]}),f.jsx("div",{className:"flex justify-center",children:f.jsx("button",{onClick:()=>Vi(!1),disabled:me||v.size===0,className:"inline-flex items-center gap-2 px-8 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:me?f.jsxs(f.Fragment,{children:[f.jsx(_v,{className:"w-5  h-5 animate-spin"}),"Generating..."]}):f.jsxs(f.Fragment,{children:[f.jsx(hb,{className:"w-5 h-5"}),"Generate Facets"]})})})]})}function bb(){const{user:e}=Ka(),t=Ui(),[r,n]=ne.useState("list"),[a,s]=ne.useState(null),[i,o]=ne.useState(""),[l,c]=ne.useState([]),[u,h]=ne.useState([]),[d,p]=ne.useState(null),[x,m]=ne.useState(""),[v,w]=ne.useState(""),[y,g]=ne.useState(""),[b,I]=ne.useState(""),[A,E]=ne.useState("client_user"),[_,k]=ne.useState(!1),[O,H]=ne.useState(!0),[L,V]=ne.useState(null),[Y,de]=ne.useState(""),[me,ie]=ne.useState("client_user");ne.useEffect(()=>{ee()},[e]);const ee=async()=>{e&&(e.role==="super_admin"?(await z(),n("list")):e.role==="client_admin"&&(n("details"),await T()),H(!1))},T=async()=>{if(!(e!=null&&e.client_id))return;const{data:U}=await Ne.from("clients").select("*").eq("id",e.client_id).single();if(U){s(U);const{data:re}=await Ne.from("user_profiles").select("*").eq("client_id",e.client_id);h(re||[])}},q=U=>{p(U),m(U.name),w(U.contact_email||"")},te=async()=>{if(d){k(!0);try{const{error:U}=await Ne.from("clients").update({name:x,contact_email:v}).eq("id",d.id);if(U)throw U;t.success("Company updated successfully"),p(null),z()}catch(U){t.error(U.message)}finally{k(!1)}}},C=U=>{V(U),de(U.full_name||""),ie(U.role)},M=async()=>{if(L){k(!0);try{const{error:U}=await Ne.from("user_profiles").update({full_name:Y,role:me}).eq("id",L.id);if(U)throw U;t.success("User updated successfully"),h(re=>re.map(J=>J.id===L.id?{...J,full_name:Y,role:me}:J)),V(null)}catch(U){t.error(U.message)}finally{k(!1)}}},W=async U=>{if(U.id===(e==null?void 0:e.id)){t.error("You cannot block yourself.");return}const re=!U.is_active;try{const{error:J}=await Ne.from("user_profiles").update({is_active:re}).eq("id",U.id);if(J)throw J;t.success(`User ${re?"Unblocked":"Blocked"}`),h(ue=>ue.map(be=>be.id===U.id?{...be,is_active:re}:be))}catch(J){t.error(J.message)}},P=U=>{t.confirm(`Delete ${U.name}? This will block access for all users under this company.`,async()=>{const{error:re}=await Ne.from("clients").delete().eq("id",U.id);re?t.error("Cannot delete client with existing records."):(t.success("Company deleted successfully"),z())})},z=async()=>{const{data:U,error:re}=await Ne.from("clients").select("*").order("created_at",{ascending:!1});re?t.error("Failed to load clients"):c(U||[])},he=U=>U.toLowerCase().replace(/\s+/g,""),ae=async()=>{if(!y.trim())return;const U=he(y);if(l.some(J=>he(J.name)===U)){t.error(`A client with a similar name to "${y}" already exists.`);return}k(!0);try{const{error:J}=await Ne.from("clients").insert({name:y.trim(),contact_email:i.trim()||null,is_active:!0,created_by:e==null?void 0:e.id});if(J)throw J.code==="23505"?new Error("Client or email already exists."):J;t.success("Client created successfully"),g(""),o(""),z()}catch(J){t.error(J.message)}finally{k(!1)}},se=U=>{if(U.id===(e==null?void 0:e.id)){t.error("You cannot delete your own account.");return}if((e==null?void 0:e.role)==="client_admin"&&U.role!=="client_user"){t.error("You only have permission to delete regular users.");return}t.confirm(`Are you sure you want to remove ${U.email}?`,()=>oe(U),{confirmText:"Delete User",cancelText:"Keep User"})},oe=async U=>{const{data:{session:re}}=await Ne.auth.getSession();if(!re)throw new Error("Authentication required!");k(!0);try{const J=await fetch("https://rqairbvsiwohklvsxyre.supabase.co/functions/v1/delete-user",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${re.access_token}`},body:JSON.stringify({user_id_to_delete:U.id})}),ue=await J.json();if(!J.ok)throw new Error(ue.error||"Failed to delete user from authentication system!");const{error:be}=await Ne.from("user_profiles").delete().eq("id",U.id);if(be)throw be;t.success(`${U.email} has been removed.`);const He=(e==null?void 0:e.role)==="client_admin"?e.client_id:a==null?void 0:a.id,{data:Xe}=await Ne.from("user_profiles").select("*").eq("client_id",He);h(Xe||[])}catch(J){t.error(J.message)}finally{k(!1)}},ye=async U=>{s(U),n("details"),h([]);const{data:re,error:J}=await Ne.from("user_profiles").select("*").eq("client_id",U.id);J?t.error("Failed to load users"):h(re||[])},R=async U=>{const re=!U.is_active;try{const{error:J}=await Ne.from("clients").update({is_active:re}).eq("id",U.id);if(J)throw J;t.success(`${U.name} is now ${re?"Active":"Inactive"}`),c(ue=>ue.map(be=>be.id===U.id?{...be,is_active:re}:be))}catch(J){t.error(J.message)}},Me=async()=>{const U=(e==null?void 0:e.role)==="client_admin"?e.client_id:a==null?void 0:a.id;if(!(!b.trim()||!U)){k(!0);try{const re=await fetch("https://rqairbvsiwohklvsxyre.supabase.co/functions/v1/invite-user",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxYWlyYnZzaXdvaGtsdnN4eXJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5Nzk2NTcsImV4cCI6MjA4MjU1NTY1N30.6Uyi42A_4Pqe1G40qnx4M8ST38XRgh9x8o7mCtiVr18","Content-Type":"application/json"},body:JSON.stringify({email:b,role:A,client_id:U,full_name:b.split("@")[0]})}),J=await re.json();if(!re.ok)throw new Error(J.error);t.success(`Invitation sent to ${b}`),I("");const{data:ue}=await Ne.from("user_profiles").select("*").eq("client_id",U);h(ue||[])}catch(re){t.error(`Invite failed: ${re.message}`)}finally{k(!1)}}};return O?f.jsx("div",{className:"p-8 text-center",children:f.jsx(_l,{className:"animate-spin mx-auto"})}):(e==null?void 0:e.role)!=="super_admin"&&(e==null?void 0:e.role)!=="client_admin"?f.jsx("div",{className:"p-8 text-center text-slate-500",children:"Access Denied"}):r==="list"&&e.role==="super_admin"?f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Client Management"}),f.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[f.jsx("h3",{className:"font-semibold text-slate-900 mb-4",children:"Add New Client"}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsx("input",{type:"text",value:y,onChange:U=>g(U.target.value),placeholder:"Company Name",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("input",{type:"email",value:i,onChange:U=>o(U.target.value),placeholder:"Contact Email",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("button",{onClick:ae,disabled:_||!y,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[f.jsx(Xc,{className:"w-5 h-5 inline mr-1"})," Create"]})]})]}),f.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-900 font-semibold",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3",children:"Company Name"}),f.jsx("th",{className:"px-6 py-3 text-left",children:"Status"}),f.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:l.map(U=>f.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[f.jsx("td",{className:"px-6 py-4 font-medium",children:(d==null?void 0:d.id)===U.id?f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("label",{className:"text-[10px] font-bold text-blue-500 uppercase",children:"Company Name"}),f.jsx("input",{className:"border border-blue-200 rounded px-3 py-2 text-sm w-full outline-none focus:ring-2 focus:ring-blue-500 bg-blue-50/30",value:x,onChange:re=>m(re.target.value),autoFocus:!0})]}):f.jsx("span",{className:"text-slate-900",children:U.name})}),f.jsx("td",{className:"px-6 py-4",children:(d==null?void 0:d.id)===U.id?f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("label",{className:"text-[10px] font-bold text-blue-500 uppercase",children:"Contact Email"}),f.jsx("input",{className:"border border-blue-200 rounded px-3 py-2 text-sm w-full outline-none focus:ring-2 focus:ring-blue-500 bg-blue-50/30",value:v,onChange:re=>w(re.target.value),placeholder:"email@company.com"})]}):f.jsx("button",{onClick:()=>R(U),className:"flex items-center gap-2 group transition-opacity hover:opacity-80",title:U.is_active?"Deactivate Company":"Activate Company",children:U.is_active?f.jsxs(f.Fragment,{children:[f.jsx(Om,{className:"w-7 h-7 text-green-500"}),f.jsx("span",{className:"text-xs font-bold text-green-600 uppercase tracking-tight",children:"Active"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Fm,{className:"w-7 h-7 text-slate-300"}),f.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-tight",children:"Inactive"})]})})}),f.jsx("td",{className:"px-6 py-4 text-right",children:f.jsx("div",{className:"flex justify-end items-center gap-3",children:(d==null?void 0:d.id)===U.id?f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:te,disabled:_||x===U.name&&v===(U.contact_email||""),className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-blue-700 disabled:bg-slate-200 disabled:text-slate-400 disabled:cursor-not-allowed transition-all",children:_?"Saving...":"Save Changes"}),f.jsx("button",{onClick:()=>p(null),className:"bg-slate-100 text-slate-600 px-4 py-2 rounded-lg text-xs font-bold hover:bg-slate-200",children:"Cancel"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>ye(U),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 text-sm font-semibold",children:[f.jsx(Wf,{className:"w-4 h-4"})," Manage Users"]}),f.jsx("div",{className:"h-4 w-[1px] bg-slate-200 mx-1"}),f.jsx("button",{onClick:()=>q(U),className:"text-slate-500 hover:text-slate-700 text-sm font-medium",children:"Edit"}),f.jsx("button",{onClick:()=>P(U),className:"text-red-400 hover:text-red-600 transition-colors p-1",children:f.jsx($f,{className:"w-4 h-4"})})]})})})]},U.id))})]})})]}):f.jsxs("div",{children:[e.role==="super_admin"&&f.jsxs("button",{onClick:()=>n("list"),className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 mb-6",children:[f.jsx(VS,{className:"w-4 h-4"})," Back to Clients"]}),f.jsx("div",{className:"flex items-center justify-between mb-6",children:f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:(a==null?void 0:a.name)||"Loading..."}),f.jsx("p",{className:"text-slate-500",children:"User Management"})]})}),(e.role==="super_admin"||e.role==="client_admin")&&f.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6 mb-6",children:[f.jsxs("h3",{className:"font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[f.jsx(ub,{className:"w-4 h-4 text-blue-600"})," Invite New User"]}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsx("input",{type:"email",value:b,onChange:U=>I(U.target.value),placeholder:"User Email Address",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("select",{value:A,onChange:U=>E(U.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg bg-white",children:[f.jsx("option",{value:"client_user",children:"Regular User"}),e.role==="super_admin"&&f.jsx("option",{value:"client_admin",children:"Client Admin"})]}),f.jsx("button",{onClick:Me,disabled:_||!b,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Send Invite"})]})]}),f.jsx("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:f.jsxs("table",{className:"w-full text-left text-sm",children:[f.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3",children:"User"}),f.jsx("th",{className:"px-6 py-3",children:"Role"}),f.jsx("th",{className:"px-6 py-3",children:"Status"}),f.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:u.map(U=>f.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[f.jsx("td",{className:"px-6 py-4",children:(L==null?void 0:L.id)===U.id?f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("label",{className:"text-[10px] font-bold text-blue-500 uppercase",children:"Full Name"}),f.jsx("input",{className:"border border-blue-200 rounded px-2 py-1 text-sm outline-none focus:ring-2 focus:ring-blue-500",value:Y,onChange:re=>de(re.target.value)}),f.jsx("span",{className:"text-[10px] text-slate-400",children:U.email})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"font-medium text-slate-900",children:U.email}),f.jsx("div",{className:"text-xs text-slate-500",children:U.full_name||"Invited"})]})}),f.jsx("td",{className:"px-6 py-4",children:(L==null?void 0:L.id)===U.id?f.jsxs("select",{className:"border border-blue-200 rounded px-2 py-1 text-sm outline-none focus:ring-2 focus:ring-blue-500",value:me,onChange:re=>ie(re.target.value),children:[f.jsx("option",{value:"client_user",children:"User"}),f.jsx("option",{value:"client_admin",children:"Admin"})]}):f.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${U.role==="client_admin"?"bg-purple-100 text-purple-700":"bg-slate-100 text-slate-700"}`,children:[U.role==="client_admin"&&f.jsx(mb,{className:"w-3 h-3"}),U.role==="client_admin"?"Admin":"User"]})}),f.jsx("td",{className:"px-6 py-4",children:(L==null?void 0:L.id)===U.id?f.jsx("span",{className:"text-xs text-slate-400 italic",children:"Save to see status"}):f.jsx("button",{onClick:()=>W(U),className:"flex items-center gap-2 group",disabled:U.id===(e==null?void 0:e.id),children:U.is_active?f.jsxs(f.Fragment,{children:[f.jsx(Om,{className:"w-7 h-7 text-green-500 group-hover:text-green-600"}),f.jsx("span",{className:"text-xs font-bold text-green-600 uppercase",children:"Active"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Fm,{className:"w-7 h-7 text-red-400 group-hover:text-red-500"}),f.jsx("span",{className:"text-xs font-bold text-red-500 uppercase",children:"Inactive"})]})})}),f.jsx("td",{className:"px-6 py-4 text-right",children:f.jsx("div",{className:"flex justify-end gap-2",children:(L==null?void 0:L.id)===U.id?f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:M,disabled:_||Y===(U.full_name||"")&&me===U.role,className:"text-blue-600 disabled:text-slate-300 disabled:cursor-not-allowed hover:underline text-xs font-bold",children:_?"...":"Save"}),f.jsx("button",{onClick:()=>V(null),className:"text-slate-400 hover:underline text-xs",children:"Cancel"})]}):f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>C(U),className:"text-slate-500 hover:text-slate-700 p-1",disabled:(e==null?void 0:e.role)==="client_admin"&&U.role==="client_admin"&&U.id!==e.id,children:"Edit"}),f.jsx("button",{onClick:()=>se(U),disabled:U.id===(e==null?void 0:e.id)||(e==null?void 0:e.role)==="client_admin"&&U.role!=="client_user",className:`p-1 rounded-md ${U.id===(e==null?void 0:e.id)?"text-slate-200":"text-red-400 hover:text-red-600"}`,children:f.jsx($f,{className:"w-4 h-4"})})]})})})]},U.id))})]})})]})}var Sv={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(Py,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,s=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(_){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(k){var O=I(k);O.chunkSize=parseInt(O.chunkSize),k.step||k.chunk||(O.chunkSize=null),this._handle=new m(O),(this._handle.streamer=this)._config=O}).call(this,_),this.parseChunk=function(k,O){var H=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<H){let V=this._config.newline;V||(L=this._config.quoteChar||'"',V=this._handle.guessLineEndings(k,L)),k=[...k.split(V).slice(H)].join(V)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(L=this._config.beforeFirstChunk(k))!==void 0&&(k=L),this.isFirstChunk=!1,this._halted=!1;var H=this._partialLine+k,L=(this._partialLine="",this._handle.parse(H,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(k=L.meta.cursor,H=(this._finished||(this._partialLine=H.substring(k-this._baseIndex),this._baseIndex=k),L&&L.data&&(this._rowCount+=L.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)n.postMessage({results:L,workerId:c.WORKER_ID,finished:H});else if(E(this._config.chunk)&&!O){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=L=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!H||!E(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),H||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(k){E(this._config.error)?this._config.error(k):i&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:k,finished:!1})}}function h(_){var k;(_=_||{}).chunkSize||(_.chunkSize=c.RemoteChunkSize),u.call(this,_),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(O){this._input=O,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(k=new XMLHttpRequest,this._config.withCredentials&&(k.withCredentials=this._config.withCredentials),s||(k.onload=A(this._chunkLoaded,this),k.onerror=A(this._chunkError,this)),k.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var O,H=this._config.downloadRequestHeaders;for(O in H)k.setRequestHeader(O,H[O])}var L;this._config.chunkSize&&(L=this._start+this._config.chunkSize-1,k.setRequestHeader("Range","bytes="+this._start+"-"+L));try{k.send(this._config.downloadRequestBody)}catch(V){this._chunkError(V.message)}s&&k.status===0&&this._chunkError()}},this._chunkLoaded=function(){k.readyState===4&&(k.status<200||400<=k.status?this._chunkError():(this._start+=this._config.chunkSize||k.responseText.length,this._finished=!this._config.chunkSize||this._start>=(O=>(O=O.getResponseHeader("Content-Range"))!==null?parseInt(O.substring(O.lastIndexOf("/")+1)):-1)(k),this.parseChunk(k.responseText)))},this._chunkError=function(O){O=k.statusText||O,this._sendError(new Error(O))}}function d(_){(_=_||{}).chunkSize||(_.chunkSize=c.LocalChunkSize),u.call(this,_);var k,O,H=typeof FileReader<"u";this.stream=function(L){this._input=L,O=L.slice||L.webkitSlice||L.mozSlice,H?((k=new FileReader).onload=A(this._chunkLoaded,this),k.onerror=A(this._chunkError,this)):k=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var L=this._input,V=(this._config.chunkSize&&(V=Math.min(this._start+this._config.chunkSize,this._input.size),L=O.call(L,this._start,V)),k.readAsText(L,this._config.encoding));H||this._chunkLoaded({target:{result:V}})},this._chunkLoaded=function(L){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(L.target.result)},this._chunkError=function(){this._sendError(k.error)}}function p(_){var k;u.call(this,_=_||{}),this.stream=function(O){return k=O,this._nextChunk()},this._nextChunk=function(){var O,H;if(!this._finished)return O=this._config.chunkSize,k=O?(H=k.substring(0,O),k.substring(O)):(H=k,""),this._finished=!k,this.parseChunk(H)}}function x(_){u.call(this,_=_||{});var k=[],O=!0,H=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(L){this._input=L,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){H&&k.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),k.length?this.parseChunk(k.shift()):O=!0},this._streamData=A(function(L){try{k.push(typeof L=="string"?L:L.toString(this._config.encoding)),O&&(O=!1,this._checkIsFinished(),this.parseChunk(k.shift()))}catch(V){this._streamError(V)}},this),this._streamError=A(function(L){this._streamCleanUp(),this._sendError(L)},this),this._streamEnd=A(function(){this._streamCleanUp(),H=!0,this._streamData("")},this),this._streamCleanUp=A(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(_){var k,O,H,L,V=Math.pow(2,53),Y=-V,de=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,me=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,ie=this,ee=0,T=0,q=!1,te=!1,C=[],M={data:[],errors:[],meta:{}};function W(ae){return _.skipEmptyLines==="greedy"?ae.join("").trim()==="":ae.length===1&&ae[0].length===0}function P(){if(M&&H&&(he("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),H=!1),_.skipEmptyLines&&(M.data=M.data.filter(function(R){return!W(R)})),z()){let R=function(Me,U){E(_.transformHeader)&&(Me=_.transformHeader(Me,U)),C.push(Me)};var ye=R;if(M)if(Array.isArray(M.data[0])){for(var ae=0;z()&&ae<M.data.length;ae++)M.data[ae].forEach(R);M.data.splice(0,1)}else M.data.forEach(R)}function se(R,Me){for(var U=_.header?{}:[],re=0;re<R.length;re++){var J=re,ue=R[re],ue=((be,He)=>(Xe=>(_.dynamicTypingFunction&&_.dynamicTyping[Xe]===void 0&&(_.dynamicTyping[Xe]=_.dynamicTypingFunction(Xe)),(_.dynamicTyping[Xe]||_.dynamicTyping)===!0))(be)?He==="true"||He==="TRUE"||He!=="false"&&He!=="FALSE"&&((Xe=>{if(de.test(Xe)&&(Xe=parseFloat(Xe),Y<Xe&&Xe<V))return 1})(He)?parseFloat(He):me.test(He)?new Date(He):He===""?null:He):He)(J=_.header?re>=C.length?"__parsed_extra":C[re]:J,ue=_.transform?_.transform(ue,J):ue);J==="__parsed_extra"?(U[J]=U[J]||[],U[J].push(ue)):U[J]=ue}return _.header&&(re>C.length?he("FieldMismatch","TooManyFields","Too many fields: expected "+C.length+" fields but parsed "+re,T+Me):re<C.length&&he("FieldMismatch","TooFewFields","Too few fields: expected "+C.length+" fields but parsed "+re,T+Me)),U}var oe;M&&(_.header||_.dynamicTyping||_.transform)&&(oe=1,!M.data.length||Array.isArray(M.data[0])?(M.data=M.data.map(se),oe=M.data.length):M.data=se(M.data,0),_.header&&M.meta&&(M.meta.fields=C),T+=oe)}function z(){return _.header&&C.length===0}function he(ae,se,oe,ye){ae={type:ae,code:se,message:oe},ye!==void 0&&(ae.row=ye),M.errors.push(ae)}E(_.step)&&(L=_.step,_.step=function(ae){M=ae,z()?P():(P(),M.data.length!==0&&(ee+=ae.data.length,_.preview&&ee>_.preview?O.abort():(M.data=M.data[0],L(M,ie))))}),this.parse=function(ae,se,oe){var ye=_.quoteChar||'"',ye=(_.newline||(_.newline=this.guessLineEndings(ae,ye)),H=!1,_.delimiter?E(_.delimiter)&&(_.delimiter=_.delimiter(ae),M.meta.delimiter=_.delimiter):((ye=((R,Me,U,re,J)=>{var ue,be,He,Xe;J=J||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var G=0;G<J.length;G++){for(var _e,Re=J[G],xe=0,De=0,je=0,at=(He=void 0,new w({comments:re,delimiter:Re,newline:Me,preview:10}).parse(R)),ut=0;ut<at.data.length;ut++)U&&W(at.data[ut])?je++:(_e=at.data[ut].length,De+=_e,He===void 0?He=_e:0<_e&&(xe+=Math.abs(_e-He),He=_e));0<at.data.length&&(De/=at.data.length-je),(be===void 0||xe<=be)&&(Xe===void 0||Xe<De)&&1.99<De&&(be=xe,ue=Re,Xe=De)}return{successful:!!(_.delimiter=ue),bestDelimiter:ue}})(ae,_.newline,_.skipEmptyLines,_.comments,_.delimitersToGuess)).successful?_.delimiter=ye.bestDelimiter:(H=!0,_.delimiter=c.DefaultDelimiter),M.meta.delimiter=_.delimiter),I(_));return _.preview&&_.header&&ye.preview++,k=ae,O=new w(ye),M=O.parse(k,se,oe),P(),q?{meta:{paused:!0}}:M||{meta:{paused:!1}}},this.paused=function(){return q},this.pause=function(){q=!0,O.abort(),k=E(_.chunk)?"":k.substring(O.getCharIndex())},this.resume=function(){ie.streamer._halted?(q=!1,ie.streamer.parseChunk(k,!0)):setTimeout(ie.resume,3)},this.aborted=function(){return te},this.abort=function(){te=!0,O.abort(),M.meta.aborted=!0,E(_.complete)&&_.complete(M),k=""},this.guessLineEndings=function(R,ye){R=R.substring(0,1048576);var ye=new RegExp(v(ye)+"([^]*?)"+v(ye),"gm"),oe=(R=R.replace(ye,"")).split("\r"),ye=R.split(`
`),R=1<ye.length&&ye[0].length<oe[0].length;if(oe.length===1||R)return`
`;for(var Me=0,U=0;U<oe.length;U++)oe[U][0]===`
`&&Me++;return Me>=oe.length/2?`\r
`:"\r"}}function v(_){return _.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(_){var k=(_=_||{}).delimiter,O=_.newline,H=_.comments,L=_.step,V=_.preview,Y=_.fastMode,de=null,me=!1,ie=_.quoteChar==null?'"':_.quoteChar,ee=ie;if(_.escapeChar!==void 0&&(ee=_.escapeChar),(typeof k!="string"||-1<c.BAD_DELIMITERS.indexOf(k))&&(k=","),H===k)throw new Error("Comment character same as delimiter");H===!0?H="#":(typeof H!="string"||-1<c.BAD_DELIMITERS.indexOf(H))&&(H=!1),O!==`
`&&O!=="\r"&&O!==`\r
`&&(O=`
`);var T=0,q=!1;this.parse=function(te,C,M){if(typeof te!="string")throw new Error("Input must be a string");var W=te.length,P=k.length,z=O.length,he=H.length,ae=E(L),se=[],oe=[],ye=[],R=T=0;if(!te)return xe();if(Y||Y!==!1&&te.indexOf(ie)===-1){for(var Me=te.split(O),U=0;U<Me.length;U++){if(ye=Me[U],T+=ye.length,U!==Me.length-1)T+=O.length;else if(M)return xe();if(!H||ye.substring(0,he)!==H){if(ae){if(se=[],Xe(ye.split(k)),De(),q)return xe()}else Xe(ye.split(k));if(V&&V<=U)return se=se.slice(0,V),xe(!0)}}return xe()}for(var re=te.indexOf(k,T),J=te.indexOf(O,T),ue=new RegExp(v(ee)+v(ie),"g"),be=te.indexOf(ie,T);;)if(te[T]===ie)for(be=T,T++;;){if((be=te.indexOf(ie,be+1))===-1)return M||oe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:se.length,index:T}),_e();if(be===W-1)return _e(te.substring(T,be).replace(ue,ie));if(ie===ee&&te[be+1]===ee)be++;else if(ie===ee||be===0||te[be-1]!==ee){re!==-1&&re<be+1&&(re=te.indexOf(k,be+1));var He=G((J=J!==-1&&J<be+1?te.indexOf(O,be+1):J)===-1?re:Math.min(re,J));if(te.substr(be+1+He,P)===k){ye.push(te.substring(T,be).replace(ue,ie)),te[T=be+1+He+P]!==ie&&(be=te.indexOf(ie,T)),re=te.indexOf(k,T),J=te.indexOf(O,T);break}if(He=G(J),te.substring(be+1+He,be+1+He+z)===O){if(ye.push(te.substring(T,be).replace(ue,ie)),Re(be+1+He+z),re=te.indexOf(k,T),be=te.indexOf(ie,T),ae&&(De(),q))return xe();if(V&&se.length>=V)return xe(!0);break}oe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:se.length,index:T}),be++}}else if(H&&ye.length===0&&te.substring(T,T+he)===H){if(J===-1)return xe();T=J+z,J=te.indexOf(O,T),re=te.indexOf(k,T)}else if(re!==-1&&(re<J||J===-1))ye.push(te.substring(T,re)),T=re+P,re=te.indexOf(k,T);else{if(J===-1)break;if(ye.push(te.substring(T,J)),Re(J+z),ae&&(De(),q))return xe();if(V&&se.length>=V)return xe(!0)}return _e();function Xe(je){se.push(je),R=T}function G(je){var at=0;return at=je!==-1&&(je=te.substring(be+1,je))&&je.trim()===""?je.length:at}function _e(je){return M||(je===void 0&&(je=te.substring(T)),ye.push(je),T=W,Xe(ye),ae&&De()),xe()}function Re(je){T=je,Xe(ye),ye=[],J=te.indexOf(O,T)}function xe(je){if(_.header&&!C&&se.length&&!me){var at=se[0],ut=Object.create(null),_t=new Set(at);let ze=!1;for(let st=0;st<at.length;st++){let ht=at[st];if(ut[ht=E(_.transformHeader)?_.transformHeader(ht,st):ht]){let it,on=ut[ht];for(;it=ht+"_"+on,on++,_t.has(it););_t.add(it),at[st]=it,ut[ht]++,ze=!0,(de=de===null?{}:de)[it]=ht}else ut[ht]=1,at[st]=ht;_t.add(ht)}ze&&console.warn("Duplicate headers found and renamed."),me=!0}return{data:se,errors:oe,meta:{delimiter:k,linebreak:O,aborted:q,truncated:!!je,cursor:R+(C||0),renamedHeaders:de}}}function De(){L(xe()),se=[],oe=[]}},this.abort=function(){q=!0},this.getCharIndex=function(){return T}}function y(_){var k=_.data,O=o[k.workerId],H=!1;if(k.error)O.userError(k.error,k.file);else if(k.results&&k.results.data){var L={abort:function(){H=!0,g(k.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(E(O.userStep)){for(var V=0;V<k.results.data.length&&(O.userStep({data:k.results.data[V],errors:k.results.errors,meta:k.results.meta},L),!H);V++);delete k.results}else E(O.userChunk)&&(O.userChunk(k.results,L,k.file),delete k.results)}k.finished&&!H&&g(k.workerId,k.results)}function g(_,k){var O=o[_];E(O.userComplete)&&O.userComplete(k),O.terminate(),delete o[_]}function b(){throw new Error("Not implemented.")}function I(_){if(typeof _!="object"||_===null)return _;var k,O=Array.isArray(_)?[]:{};for(k in _)O[k]=I(_[k]);return O}function A(_,k){return function(){_.apply(k,arguments)}}function E(_){return typeof _=="function"}return c.parse=function(_,k){var O=(k=k||{}).dynamicTyping||!1;if(E(O)&&(k.dynamicTypingFunction=O,O={}),k.dynamicTyping=O,k.transform=!!E(k.transform)&&k.transform,!k.worker||!c.WORKERS_SUPPORTED)return O=null,c.NODE_STREAM_INPUT,typeof _=="string"?(_=(H=>H.charCodeAt(0)!==65279?H:H.slice(1))(_),O=new(k.download?h:p)(k)):_.readable===!0&&E(_.read)&&E(_.on)?O=new x(k):(n.File&&_ instanceof File||_ instanceof Object)&&(O=new d(k)),O.stream(_);(O=(()=>{var H;return!!c.WORKERS_SUPPORTED&&(H=(()=>{var L=n.URL||n.webkitURL||null,V=r.toString();return c.BLOB_URL||(c.BLOB_URL=L.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",V,")();"],{type:"text/javascript"})))})(),(H=new n.Worker(H)).onmessage=y,H.id=l++,o[H.id]=H)})()).userStep=k.step,O.userChunk=k.chunk,O.userComplete=k.complete,O.userError=k.error,k.step=E(k.step),k.chunk=E(k.chunk),k.complete=E(k.complete),k.error=E(k.error),delete k.worker,O.postMessage({input:_,config:k,workerId:O.id})},c.unparse=function(_,k){var O=!1,H=!0,L=",",V=`\r
`,Y='"',de=Y+Y,me=!1,ie=null,ee=!1,T=((()=>{if(typeof k=="object"){if(typeof k.delimiter!="string"||c.BAD_DELIMITERS.filter(function(C){return k.delimiter.indexOf(C)!==-1}).length||(L=k.delimiter),typeof k.quotes!="boolean"&&typeof k.quotes!="function"&&!Array.isArray(k.quotes)||(O=k.quotes),typeof k.skipEmptyLines!="boolean"&&typeof k.skipEmptyLines!="string"||(me=k.skipEmptyLines),typeof k.newline=="string"&&(V=k.newline),typeof k.quoteChar=="string"&&(Y=k.quoteChar),typeof k.header=="boolean"&&(H=k.header),Array.isArray(k.columns)){if(k.columns.length===0)throw new Error("Option columns is empty");ie=k.columns}k.escapeChar!==void 0&&(de=k.escapeChar+Y),k.escapeFormulae instanceof RegExp?ee=k.escapeFormulae:typeof k.escapeFormulae=="boolean"&&k.escapeFormulae&&(ee=/^[=+\-@\t\r].*$/)}})(),new RegExp(v(Y),"g"));if(typeof _=="string"&&(_=JSON.parse(_)),Array.isArray(_)){if(!_.length||Array.isArray(_[0]))return q(null,_,me);if(typeof _[0]=="object")return q(ie||Object.keys(_[0]),_,me)}else if(typeof _=="object")return typeof _.data=="string"&&(_.data=JSON.parse(_.data)),Array.isArray(_.data)&&(_.fields||(_.fields=_.meta&&_.meta.fields||ie),_.fields||(_.fields=Array.isArray(_.data[0])?_.fields:typeof _.data[0]=="object"?Object.keys(_.data[0]):[]),Array.isArray(_.data[0])||typeof _.data[0]=="object"||(_.data=[_.data])),q(_.fields||[],_.data||[],me);throw new Error("Unable to serialize unrecognized input");function q(C,M,W){var P="",z=(typeof C=="string"&&(C=JSON.parse(C)),typeof M=="string"&&(M=JSON.parse(M)),Array.isArray(C)&&0<C.length),he=!Array.isArray(M[0]);if(z&&H){for(var ae=0;ae<C.length;ae++)0<ae&&(P+=L),P+=te(C[ae],ae);0<M.length&&(P+=V)}for(var se=0;se<M.length;se++){var oe=(z?C:M[se]).length,ye=!1,R=z?Object.keys(M[se]).length===0:M[se].length===0;if(W&&!z&&(ye=W==="greedy"?M[se].join("").trim()==="":M[se].length===1&&M[se][0].length===0),W==="greedy"&&z){for(var Me=[],U=0;U<oe;U++){var re=he?C[U]:U;Me.push(M[se][re])}ye=Me.join("").trim()===""}if(!ye){for(var J=0;J<oe;J++){0<J&&!R&&(P+=L);var ue=z&&he?C[J]:J;P+=te(M[se][ue],J)}se<M.length-1&&(!W||0<oe&&!R)&&(P+=V)}}return P}function te(C,M){var W,P;return C==null?"":C.constructor===Date?JSON.stringify(C).slice(1,25):(P=!1,ee&&typeof C=="string"&&ee.test(C)&&(C="'"+C,P=!0),W=C.toString().replace(T,de),(P=P||O===!0||typeof O=="function"&&O(C,M)||Array.isArray(O)&&O[M]||((z,he)=>{for(var ae=0;ae<he.length;ae++)if(-1<z.indexOf(he[ae]))return!0;return!1})(W,c.BAD_DELIMITERS)||-1<W.indexOf(L)||W.charAt(0)===" "||W.charAt(W.length-1)===" ")?Y+W+Y:W)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!s&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=w,c.ParserHandle=m,c.NetworkStreamer=h,c.FileStreamer=d,c.StringStreamer=p,c.ReadableStreamStreamer=x,n.jQuery&&((a=n.jQuery).fn.parse=function(_){var k=_.config||{},O=[];return this.each(function(V){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Y=0;Y<this.files.length;Y++)O.push({file:this.files[Y],inputElem:this,instanceConfig:a.extend({},k)})}),H(),this;function H(){if(O.length===0)E(_.complete)&&_.complete();else{var V,Y,de,me,ie=O[0];if(E(_.before)){var ee=_.before(ie.file,ie.inputElem);if(typeof ee=="object"){if(ee.action==="abort")return V="AbortError",Y=ie.file,de=ie.inputElem,me=ee.reason,void(E(_.error)&&_.error({name:V},Y,de,me));if(ee.action==="skip")return void L();typeof ee.config=="object"&&(ie.instanceConfig=a.extend(ie.instanceConfig,ee.config))}else if(ee==="skip")return void L()}var T=ie.instanceConfig.complete;ie.instanceConfig.complete=function(q){E(T)&&T(q,ie.file,ie.inputElem),L()},c.parse(ie.file,ie.instanceConfig)}}function L(){O.splice(0,1),H()}}),i&&(n.onmessage=function(_){_=_.data,c.WORKER_ID===void 0&&_&&(c.WORKER_ID=_.workerId),typeof _.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(_.input,_.config),finished:!0}):(n.File&&_.input instanceof File||_.input instanceof Object)&&(_=c.parse(_.input,_.config))&&n.postMessage({workerId:c.WORKER_ID,results:_,finished:!0})}),(h.prototype=Object.create(u.prototype)).constructor=h,(d.prototype=Object.create(u.prototype)).constructor=d,(p.prototype=Object.create(p.prototype)).constructor=p,(x.prototype=Object.create(u.prototype)).constructor=x,c})})(Sv);var Tb=Sv.exports;const Rm=Dy(Tb);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Yc={};Yc.version="0.18.5";var bv=1252,Cb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},nd=function(e){Cb.indexOf(e)!=-1&&(bv=rd[0]=e)};function Ab(){nd(1252)}var On=function(e){nd(e)};function ad(){On(1200),Ab()}function Im(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Nb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Tv(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var co=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Nb(e.slice(2)):t==254&&r==255?Tv(e.slice(2)):t==65279?e.slice(1):e},Ql=function(t){return String.fromCharCode(t)},Pm=function(t){return String.fromCharCode(t)},tl,Aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rl(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Aa.charAt(s)+Aa.charAt(i)+Aa.charAt(o)+Aa.charAt(l);return t}function nn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Aa.indexOf(e.charAt(c++)),i=Aa.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Aa.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Aa.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var tt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),pa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function $a(e){return tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Dm(e){return tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qr=function(t){return tt?pa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Nu(e){if(typeof ArrayBuffer>"u")return Qr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Xa(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Fb(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function sd(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return sd(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var sr=tt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:pa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Ob(e){for(var t=[],r=0,n=e.length+250,a=$a(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=$a(65535),n=65530)}return t.push(a.slice(0,r)),sr(t)}var Dr=/\u0000/g,uo=/[\u0001-\u0006]/g;function Ei(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Rn(e,t){var r=""+e;return r.length>=t?r:Bt("0",t-r.length)+r}function id(e,t){var r=""+e;return r.length>=t?r:Bt(" ",t-r.length)+r}function Jc(e,t){var r=""+e;return r.length>=t?r:r+Bt(" ",t-r.length)}function Rb(e,t){var r=""+Math.round(e);return r.length>=t?r:Bt("0",t-r.length)+r}function Ib(e,t){var r=""+e;return r.length>=t?r:Bt("0",t-r.length)+r}var jm=Math.pow(2,32);function Ks(e,t){if(e>jm||e<-jm)return Rb(e,t);var r=Math.round(e);return Ib(r,t)}function Qc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Lm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],k0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Pb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Mm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Db={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zc(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(h=Math.floor(a),o=h*i+s,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function ds(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=$b(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Cv=new Date(1899,11,31,0,0,0),jb=Cv.getTime(),Lb=new Date(1900,2,1,0,0,0);function Av(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Lb&&(r+=24*60*60*1e3),(r-(jb+(e.getTimezoneOffset()-Cv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function od(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Mb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Bb(e){var t=e<0?12:11,r=od(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ub(e){var t=od(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function nl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Bb(e):t===10?r=e.toFixed(10).substr(0,12):r=Ub(e),od(Mb(r.toUpperCase()))}function bs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):nl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return _n(14,Av(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function $b(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Wb(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return k0[r.m-1][1];case 5:return k0[r.m-1][0];default:return k0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Lm[r.q][0];default:return Lm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Rn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Rn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Rn(l,c):"";return u}function Na(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Nv=/%/g;function Hb(e,t,r){var n=t.replace(Nv,""),a=t.length-n.length;return aa(e,n,r*Math.pow(10,2*a))+Bt("%",a)}function zb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return aa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Fv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Fv(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ov=/# (\?+)( ?)\/( ?)(\d+)/;function Vb(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Bt(" ",e[1].length+1+e[4].length):id(i,e[1].length)+e[2]+"/"+e[3]+Rn(o,e[4].length))}function Gb(e,t,r){return r+(t===0?"":""+t)+Bt(" ",e[1].length+2+e[4].length)}var Rv=/^#*0*\.([0#]+)/,Iv=/\).*[0#]/,Pv=/\(###\) ###\\?-####/;function Rr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Bm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Um(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Kb(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Iv)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cn("n",n,r):"("+cn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return zb(e,t,r);if(t.indexOf("%")!==-1)return Hb(e,t,r);if(t.indexOf("E")!==-1)return Fv(t,r);if(t.charCodeAt(0)===36)return"$"+cn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ks(l,t.length);if(t.match(/^[#?]+$/))return a=Ks(r,0),a==="0"&&(a=""),a.length>t.length?a:Rr(t.substr(0,t.length-a.length))+a;if(s=t.match(Ov))return Vb(s,l,c);if(t.match(/^#+0+$/))return c+Ks(l,t.length-t.indexOf("0"));if(s=t.match(Rv))return a=Bm(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Rr(s[1])).replace(/\.$/,"."+Rr(s[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+Bt("0",Rr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Bm(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Na(Ks(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cn(e,t,-r):Na(""+(Math.floor(r)+qb(r,s[1].length)))+"."+Rn(Um(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return cn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ei(cn(e,t.replace(/[\\-]/g,""),r)),i=0,Ei(Ei(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(t.match(Pv))return a=cn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Zc(l,Math.pow(10,i)-1,!1),a=""+c,u=aa("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Jc(o[2],i),u.length<s[4].length&&(u=Rr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Zc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?id(o[1],i)+s[2]+"/"+s[3]+Jc(o[2],i):Bt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Ks(r,0),t.length<=a.length?a:Rr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,d=t.length-a.length-h;return Rr(t.substr(0,h)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Um(r,s[1].length),r<0?"-"+cn(e,t,-r):Na(Kb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Rn(0,3-x.length):"")+x})+"."+Rn(i,s[1].length);switch(t){case"###,##0.00":return cn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Na(Ks(l,0));return p!=="0"?c+p:"";case"###,###.00":return cn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return cn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Xb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return aa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Yb(e,t,r){var n=t.replace(Nv,""),a=t.length-n.length;return aa(e,n,r*Math.pow(10,2*a))+Bt("%",a)}function Dv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Dv(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Un(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Iv)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Un("n",n,r):"("+Un("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Xb(e,t,r);if(t.indexOf("%")!==-1)return Yb(e,t,r);if(t.indexOf("E")!==-1)return Dv(t,r);if(t.charCodeAt(0)===36)return"$"+Un(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Rn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Rr(t.substr(0,t.length-a.length))+a;if(s=t.match(Ov))return Gb(s,l,c);if(t.match(/^#+0+$/))return c+Rn(l,t.length-t.indexOf("0"));if(s=t.match(Rv))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Rr(s[1])).replace(/\.$/,"."+Rr(s[1])),a=a.replace(/\.(\d*)$/,function(x,m){return"."+m+Bt("0",Rr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Na(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Un(e,t,-r):Na(""+r)+"."+Bt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Un(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ei(Un(e,t.replace(/[\\-]/g,""),r)),i=0,Ei(Ei(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(t.match(Pv))return a=Un(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Zc(l,Math.pow(10,i)-1,!1),a=""+c,u=aa("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Jc(o[2],i),u.length<s[4].length&&(u=Rr(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Zc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?id(o[1],i)+s[2]+"/"+s[3]+Jc(o[2],i):Bt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Rr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,d=t.length-a.length-h;return Rr(t.substr(0,h)+a+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Un(e,t,-r):Na(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Rn(0,3-x.length):"")+x})+"."+Rn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Na(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return Un(e,t.slice(0,t.lastIndexOf(".")),r)+Rr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function aa(e,t,r){return(r|0)===r?Un(e,t,r):cn(e,t,r)}function Jb(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var jv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $i(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Qc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(jv))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Qb(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,u,h,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Qc(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(h=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(h);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";a[a.length]={t:x,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ds(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ds(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=ds(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",i+=5,d="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(jv)){if(c==null&&(c=ds(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",$i(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var v=0,w=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=d,l="h",v<1&&(v=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[i].v.match(/[Hh]/)&&(v=1),v<2&&a[i].v.match(/[Mm]/)&&(v=2),v<3&&a[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",b;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=Wb(a[i].t.charCodeAt(0),a[i].v,c,w),a[i].t="t";break;case"n":case"?":for(b=i+1;a[b]!=null&&((o=a[b].t)==="?"||o==="D"||(o===" "||o==="t")&&a[b+1]!=null&&(a[b+1].t==="?"||a[b+1].t==="t"&&a[b+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[b].v==="/"||a[b].v===" "&&a[b+1]!=null&&a[b+1].t=="?"));)a[i].v+=a[b].v,a[b]={v:"",t:";"},++b;g+=a[i].v,i=b-1;break;case"G":a[i].t="t",a[i].v=bs(t,r);break}var I="",A,E;if(g.length>0){g.charCodeAt(0)==40?(A=t<0&&g.charCodeAt(0)===45?-t:t,E=aa("n",g,A)):(A=t<0&&n>1?-t:t,E=aa("n",g,A),A<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),b=E.length-1;var _=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){_=i;break}var k=a.length;if(_===a.length&&E.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(b>=a[i].v.length-1?(b-=a[i].v.length,a[i].v=E.substr(b+1,a[i].v.length)):b<0?a[i].v="":(a[i].v=E.substr(0,b+1),b=-1),a[i].t="t",k=i);b>=0&&k<a.length&&(a[k].v=E.substr(0,b+1)+a[k].v)}else if(_!==a.length&&E.indexOf("E")===-1){for(b=E.indexOf(".")-1,i=_;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===_?a[i].v.indexOf(".")-1:a[i].v.length-1,I=a[i].v.substr(u+1);u>=0;--u)b>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(I=E.charAt(b--)+I);a[i].v=I,a[i].t="t",k=i}for(b>=0&&k<a.length&&(a[k].v=E.substr(0,b+1)+a[k].v),b=E.indexOf(".")+1,i=_;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==_)){for(u=a[i].v.indexOf(".")>-1&&i===_?a[i].v.indexOf(".")+1:0,I=a[i].v.substr(0,u);u<a[i].v.length;++u)b<E.length&&(I+=E.charAt(b++));a[i].v=I,a[i].t="t",k=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(A=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=aa(a[i].t,a[i].v,A),a[i].t="t");var O="";for(i=0;i!==a.length;++i)a[i]!=null&&(O+=a[i].v);return O}var $m=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Wm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Zb(e,t){var r=Jb(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match($m),o=r[1].match($m);return Wm(t,i)?[n,r[0]]:Wm(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function _n(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:qe)[e],n==null&&(n=r.table&&r.table[Mm[e]]||qe[Mm[e]]),n==null&&(n=Db[e]||"General");break}if(Qc(n,0))return bs(t,r);t instanceof Date&&(t=Av(t,r.date1904));var a=Zb(n,t);if(Qc(a[1]))return bs(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Qb(a[1],t,r,a[0])}function sa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(qe[r]==null){t<0&&(t=r);continue}if(qe[r]==e){t=r;break}}t<0&&(t=391)}return qe[t]=e,t}function Fu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&sa(e[t],t)}function Wi(){qe=Pb()}var eT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Lv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function tT(e){var t=typeof e=="number"?qe[e]:e;return t=t.replace(Lv,"(\\d+)"),new RegExp("^"+t+"$")}function rT(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(Lv)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:a=p;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var nT=function(){var e={};e.version="1.2.0";function t(){for(var E=0,_=new Array(256),k=0;k!=256;++k)E=k,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,_[k]=E;return typeof Int32Array<"u"?new Int32Array(_):_}var r=t();function n(E){var _=0,k=0,O=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)H[O]=E[O];for(O=0;O!=256;++O)for(k=E[O],_=256+O;_<4096;_+=256)k=H[_]=k>>>8^E[k&255];var L=[];for(O=1;O!=16;++O)L[O-1]=typeof Int32Array<"u"?H.subarray(O*256,O*256+256):H.slice(O*256,O*256+256);return L}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],u=a[5],h=a[6],d=a[7],p=a[8],x=a[9],m=a[10],v=a[11],w=a[12],y=a[13],g=a[14];function b(E,_){for(var k=_^-1,O=0,H=E.length;O<H;)k=k>>>8^r[(k^E.charCodeAt(O++))&255];return~k}function I(E,_){for(var k=_^-1,O=E.length-15,H=0;H<O;)k=g[E[H++]^k&255]^y[E[H++]^k>>8&255]^w[E[H++]^k>>16&255]^v[E[H++]^k>>>24]^m[E[H++]]^x[E[H++]]^p[E[H++]]^d[E[H++]]^h[E[H++]]^u[E[H++]]^c[E[H++]]^l[E[H++]]^o[E[H++]]^i[E[H++]]^s[E[H++]]^r[E[H++]];for(O+=15;H<O;)k=k>>>8^r[(k^E[H++])&255];return~k}function A(E,_){for(var k=_^-1,O=0,H=E.length,L=0,V=0;O<H;)L=E.charCodeAt(O++),L<128?k=k>>>8^r[(k^L)&255]:L<2048?(k=k>>>8^r[(k^(192|L>>6&31))&255],k=k>>>8^r[(k^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,V=E.charCodeAt(O++)&1023,k=k>>>8^r[(k^(240|L>>8&7))&255],k=k>>>8^r[(k^(128|L>>2&63))&255],k=k>>>8^r[(k^(128|V>>6&15|(L&3)<<4))&255],k=k>>>8^r[(k^(128|V&63))&255]):(k=k>>>8^r[(k^(224|L>>12&15))&255],k=k>>>8^r[(k^(128|L>>6&63))&255],k=k>>>8^r[(k^(128|L&63))&255]);return~k}return e.table=r,e.bstr=b,e.buf=I,e.str=A,e}(),Ue=function(){var t={};t.version="1.2.1";function r(S,D){for(var N=S.split("/"),F=D.split("/"),j=0,B=0,K=Math.min(N.length,F.length);j<K;++j){if(B=N[j].length-F[j].length)return B;if(N[j]!=F[j])return N[j]<F[j]?-1:1}return N.length-F.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var D=S.lastIndexOf("/");return D===-1?S:S.slice(0,D+1)}function a(S){if(S.charAt(S.length-1)=="/")return a(S.slice(0,-1));var D=S.lastIndexOf("/");return D===-1?S:S.slice(D+1)}function s(S,D){typeof D=="string"&&(D=new Date(D));var N=D.getHours();N=N<<6|D.getMinutes(),N=N<<5|D.getSeconds()>>>1,S.write_shift(2,N);var F=D.getFullYear()-1980;F=F<<4|D.getMonth()+1,F=F<<5|D.getDate(),S.write_shift(2,F)}function i(S){var D=S.read_shift(2)&65535,N=S.read_shift(2)&65535,F=new Date,j=N&31;N>>>=5;var B=N&15;N>>>=4,F.setMilliseconds(0),F.setFullYear(N+1980),F.setMonth(B-1),F.setDate(j);var K=D&31;D>>>=5;var ce=D&63;return D>>>=6,F.setHours(D),F.setMinutes(ce),F.setSeconds(K<<1),F}function o(S){hr(S,0);for(var D={},N=0;S.l<=S.length-4;){var F=S.read_shift(2),j=S.read_shift(2),B=S.l+j,K={};switch(F){case 21589:N=S.read_shift(1),N&1&&(K.mtime=S.read_shift(4)),j>5&&(N&2&&(K.atime=S.read_shift(4)),N&4&&(K.ctime=S.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}S.l=B,D[F]=K}return D}var l;function c(){return l||(l={})}function u(S,D){if(S[0]==80&&S[1]==75)return Be(S,D);if((S[0]|32)==109&&(S[1]|32)==105)return Za(S,D);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var N=3,F=512,j=0,B=0,K=0,ce=0,X=0,Q=[],Z=S.slice(0,512);hr(Z,0);var ve=h(Z);switch(N=ve[0],N){case 3:F=512;break;case 4:F=4096;break;case 0:if(ve[1]==0)return Be(S,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}F!==512&&(Z=S.slice(0,F),hr(Z,28));var Ce=S.slice(0,F);d(Z,N);var Fe=Z.read_shift(4,"i");if(N===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);Z.l+=4,K=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),ce=Z.read_shift(4,"i"),j=Z.read_shift(4,"i"),X=Z.read_shift(4,"i"),B=Z.read_shift(4,"i");for(var Ee=-1,Ae=0;Ae<109&&(Ee=Z.read_shift(4,"i"),!(Ee<0));++Ae)Q[Ae]=Ee;var Qe=p(S,F);v(X,B,Qe,F,Q);var At=y(Qe,K,Q,F);At[K].name="!Directory",j>0&&ce!==V&&(At[ce].name="!MiniFAT"),At[Q[0]].name="!FAT",At.fat_addrs=Q,At.ssz=F;var Nt={},gr=[],Gi=[],qi=[];g(K,At,Qe,gr,j,Nt,Gi,ce),x(Gi,qi,gr),gr.shift();var Ki={FileIndex:Gi,FullPaths:qi};return D&&D.raw&&(Ki.raw={header:Ce,sectors:Qe}),Ki}function h(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(Y,"Header Signature: "),S.l+=16;var D=S.read_shift(2,"u");return[S.read_shift(2,"u"),D]}function d(S,D){var N=9;switch(S.l+=2,N=S.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function p(S,D){for(var N=Math.ceil(S.length/D)-1,F=[],j=1;j<N;++j)F[j-1]=S.slice(j*D,(j+1)*D);return F[N-1]=S.slice(N*D),F}function x(S,D,N){for(var F=0,j=0,B=0,K=0,ce=0,X=N.length,Q=[],Z=[];F<X;++F)Q[F]=Z[F]=F,D[F]=N[F];for(;ce<Z.length;++ce)F=Z[ce],j=S[F].L,B=S[F].R,K=S[F].C,Q[F]===F&&(j!==-1&&Q[j]!==j&&(Q[F]=Q[j]),B!==-1&&Q[B]!==B&&(Q[F]=Q[B])),K!==-1&&(Q[K]=F),j!==-1&&F!=Q[F]&&(Q[j]=Q[F],Z.lastIndexOf(j)<ce&&Z.push(j)),B!==-1&&F!=Q[F]&&(Q[B]=Q[F],Z.lastIndexOf(B)<ce&&Z.push(B));for(F=1;F<X;++F)Q[F]===F&&(B!==-1&&Q[B]!==B?Q[F]=Q[B]:j!==-1&&Q[j]!==j&&(Q[F]=Q[j]));for(F=1;F<X;++F)if(S[F].type!==0){if(ce=F,ce!=Q[ce])do ce=Q[ce],D[F]=D[ce]+"/"+D[F];while(ce!==0&&Q[ce]!==-1&&ce!=Q[ce]);Q[F]=-1}for(D[0]+="/",F=1;F<X;++F)S[F].type!==2&&(D[F]+="/")}function m(S,D,N){for(var F=S.start,j=S.size,B=[],K=F;N&&j>0&&K>=0;)B.push(D.slice(K*L,K*L+L)),j-=L,K=ls(N,K*4);return B.length===0?le(0):sr(B).slice(0,S.size)}function v(S,D,N,F,j){var B=V;if(S===V){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var K=N[S],ce=(F>>>2)-1;if(!K)return;for(var X=0;X<ce&&(B=ls(K,X*4))!==V;++X)j.push(B);v(ls(K,F-4),D-1,N,F,j)}}function w(S,D,N,F,j){var B=[],K=[];j||(j=[]);var ce=F-1,X=0,Q=0;for(X=D;X>=0;){j[X]=!0,B[B.length]=X,K.push(S[X]);var Z=N[Math.floor(X*4/F)];if(Q=X*4&ce,F<4+Q)throw new Error("FAT boundary crossed: "+X+" 4 "+F);if(!S[Z])break;X=ls(S[Z],Q)}return{nodes:B,data:ex([K])}}function y(S,D,N,F){var j=S.length,B=[],K=[],ce=[],X=[],Q=F-1,Z=0,ve=0,Ce=0,Fe=0;for(Z=0;Z<j;++Z)if(ce=[],Ce=Z+D,Ce>=j&&(Ce-=j),!K[Ce]){X=[];var Ee=[];for(ve=Ce;ve>=0;){Ee[ve]=!0,K[ve]=!0,ce[ce.length]=ve,X.push(S[ve]);var Ae=N[Math.floor(ve*4/F)];if(Fe=ve*4&Q,F<4+Fe)throw new Error("FAT boundary crossed: "+ve+" 4 "+F);if(!S[Ae]||(ve=ls(S[Ae],Fe),Ee[ve]))break}B[Ce]={nodes:ce,data:ex([X])}}return B}function g(S,D,N,F,j,B,K,ce){for(var X=0,Q=F.length?2:0,Z=D[S].data,ve=0,Ce=0,Fe;ve<Z.length;ve+=128){var Ee=Z.slice(ve,ve+128);hr(Ee,64),Ce=Ee.read_shift(2),Fe=pd(Ee,0,Ce-Q),F.push(Fe);var Ae={name:Fe,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Qe=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Qe!==0&&(Ae.ct=b(Ee,Ee.l-8));var At=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);At!==0&&(Ae.mt=b(Ee,Ee.l-8)),Ae.start=Ee.read_shift(4,"i"),Ae.size=Ee.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=V,Ae.name=""),Ae.type===5?(X=Ae.start,j>0&&X!==V&&(D[X].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",D[Ae.start]===void 0&&(D[Ae.start]=w(N,Ae.start,D.fat_addrs,D.ssz)),D[Ae.start].name=Ae.name,Ae.content=D[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:X!==V&&Ae.start!==V&&D[X]&&(Ae.content=m(Ae,D[X].data,(D[ce]||{}).data))),Ae.content&&hr(Ae.content,0),B[Fe]=Ae,K.push(Ae)}}function b(S,D){return new Date((Xr(S,D+4)/1e7*Math.pow(2,32)+Xr(S,D)/1e7-11644473600)*1e3)}function I(S,D){return c(),u(l.readFileSync(S),D)}function A(S,D){var N=D&&D.type;switch(N||tt&&Buffer.isBuffer(S)&&(N="buffer"),N||"base64"){case"file":return I(S,D);case"base64":return u(Qr(nn(S)),D);case"binary":return u(Qr(S),D)}return u(S,D)}function E(S,D){var N=D||{},F=N.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=F+"/",S.FileIndex[0]={name:F,type:5}),N.CLSID&&(S.FileIndex[0].clsid=N.CLSID),_(S)}function _(S){var D="Sh33tJ5";if(!Ue.find(S,"/"+D)){var N=le(4);N[0]=55,N[1]=N[3]=50,N[2]=54,S.FileIndex.push({name:D,type:2,content:N,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+D),k(S)}}function k(S,D){E(S);for(var N=!1,F=!1,j=S.FullPaths.length-1;j>=0;--j){var B=S.FileIndex[j];switch(B.type){case 0:F?N=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(B.R*B.L*B.C)&&(N=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!D)){var K=new Date(1987,1,19),ce=0,X=Object.create?Object.create(null):{},Q=[];for(j=0;j<S.FullPaths.length;++j)X[S.FullPaths[j]]=!0,S.FileIndex[j].type!==0&&Q.push([S.FullPaths[j],S.FileIndex[j]]);for(j=0;j<Q.length;++j){var Z=n(Q[j][0]);F=X[Z],F||(Q.push([Z,{name:a(Z).replace("/",""),type:1,clsid:me,ct:K,mt:K,content:null}]),X[Z]=!0)}for(Q.sort(function(Fe,Ee){return r(Fe[0],Ee[0])}),S.FullPaths=[],S.FileIndex=[],j=0;j<Q.length;++j)S.FullPaths[j]=Q[j][0],S.FileIndex[j]=Q[j][1];for(j=0;j<Q.length;++j){var ve=S.FileIndex[j],Ce=S.FullPaths[j];if(ve.name=a(Ce).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||me,j===0)ve.C=Q.length>1?1:-1,ve.size=0,ve.type=5;else if(Ce.slice(-1)=="/"){for(ce=j+1;ce<Q.length&&n(S.FullPaths[ce])!=Ce;++ce);for(ve.C=ce>=Q.length?-1:ce,ce=j+1;ce<Q.length&&n(S.FullPaths[ce])!=n(Ce);++ce);ve.R=ce>=Q.length?-1:ce,ve.type=1}else n(S.FullPaths[j+1]||"")==n(Ce)&&(ve.R=j+1),ve.type=2}}}function O(S,D){var N=D||{};if(N.fileType=="mad")return xr(S,N);switch(k(S),N.fileType){case"zip":return ge(S,N)}var F=function(Fe){for(var Ee=0,Ae=0,Qe=0;Qe<Fe.FileIndex.length;++Qe){var At=Fe.FileIndex[Qe];if(At.content){var Nt=At.content.length;Nt>0&&(Nt<4096?Ee+=Nt+63>>6:Ae+=Nt+511>>9)}}for(var gr=Fe.FullPaths.length+3>>2,Gi=Ee+7>>3,qi=Ee+127>>7,Ki=Gi+Ae+gr+qi,es=Ki+127>>7,Mu=es<=109?0:Math.ceil((es-109)/127);Ki+es+Mu+127>>7>es;)Mu=++es<=109?0:Math.ceil((es-109)/127);var Yn=[1,Mu,es,qi,gr,Ae,Ee,0];return Fe.FileIndex[0].size=Ee<<6,Yn[7]=(Fe.FileIndex[0].start=Yn[0]+Yn[1]+Yn[2]+Yn[3]+Yn[4]+Yn[5])+(Yn[6]+7>>3),Yn}(S),j=le(F[7]<<9),B=0,K=0;{for(B=0;B<8;++B)j.write_shift(1,de[B]);for(B=0;B<8;++B)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),B=0;B<3;++B)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,F[2]),j.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:V),j.write_shift(4,F[3]),j.write_shift(-4,F[1]?F[0]-1:V),j.write_shift(4,F[1]),B=0;B<109;++B)j.write_shift(-4,B<F[2]?F[1]+B:-1)}if(F[1])for(K=0;K<F[1];++K){for(;B<236+K*127;++B)j.write_shift(-4,B<F[2]?F[1]+B:-1);j.write_shift(-4,K===F[1]-1?V:K+1)}var ce=function(Fe){for(K+=Fe;B<K-1;++B)j.write_shift(-4,B+1);Fe&&(++B,j.write_shift(-4,V))};for(K=B=0,K+=F[1];B<K;++B)j.write_shift(-4,ie.DIFSECT);for(K+=F[2];B<K;++B)j.write_shift(-4,ie.FATSECT);ce(F[3]),ce(F[4]);for(var X=0,Q=0,Z=S.FileIndex[0];X<S.FileIndex.length;++X)Z=S.FileIndex[X],Z.content&&(Q=Z.content.length,!(Q<4096)&&(Z.start=K,ce(Q+511>>9)));for(ce(F[6]+7>>3);j.l&511;)j.write_shift(-4,ie.ENDOFCHAIN);for(K=B=0,X=0;X<S.FileIndex.length;++X)Z=S.FileIndex[X],Z.content&&(Q=Z.content.length,!(!Q||Q>=4096)&&(Z.start=K,ce(Q+63>>6)));for(;j.l&511;)j.write_shift(-4,ie.ENDOFCHAIN);for(B=0;B<F[4]<<2;++B){var ve=S.FullPaths[B];if(!ve||ve.length===0){for(X=0;X<17;++X)j.write_shift(4,0);for(X=0;X<3;++X)j.write_shift(4,-1);for(X=0;X<12;++X)j.write_shift(4,0);continue}Z=S.FileIndex[B],B===0&&(Z.start=Z.size?Z.start-1:V);var Ce=B===0&&N.root||Z.name;if(Q=2*(Ce.length+1),j.write_shift(64,Ce,"utf16le"),j.write_shift(2,Q),j.write_shift(1,Z.type),j.write_shift(1,Z.color),j.write_shift(-4,Z.L),j.write_shift(-4,Z.R),j.write_shift(-4,Z.C),Z.clsid)j.write_shift(16,Z.clsid,"hex");else for(X=0;X<4;++X)j.write_shift(4,0);j.write_shift(4,Z.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,Z.start),j.write_shift(4,Z.size),j.write_shift(4,0)}for(B=1;B<S.FileIndex.length;++B)if(Z=S.FileIndex[B],Z.size>=4096)if(j.l=Z.start+1<<9,tt&&Buffer.isBuffer(Z.content))Z.content.copy(j,j.l,0,Z.size),j.l+=Z.size+511&-512;else{for(X=0;X<Z.size;++X)j.write_shift(1,Z.content[X]);for(;X&511;++X)j.write_shift(1,0)}for(B=1;B<S.FileIndex.length;++B)if(Z=S.FileIndex[B],Z.size>0&&Z.size<4096)if(tt&&Buffer.isBuffer(Z.content))Z.content.copy(j,j.l,0,Z.size),j.l+=Z.size+63&-64;else{for(X=0;X<Z.size;++X)j.write_shift(1,Z.content[X]);for(;X&63;++X)j.write_shift(1,0)}if(tt)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function H(S,D){var N=S.FullPaths.map(function(X){return X.toUpperCase()}),F=N.map(function(X){var Q=X.split("/");return Q[Q.length-(X.slice(-1)=="/"?2:1)]}),j=!1;D.charCodeAt(0)===47?(j=!0,D=N[0].slice(0,-1)+D):j=D.indexOf("/")!==-1;var B=D.toUpperCase(),K=j===!0?N.indexOf(B):F.indexOf(B);if(K!==-1)return S.FileIndex[K];var ce=!B.match(uo);for(B=B.replace(Dr,""),ce&&(B=B.replace(uo,"!")),K=0;K<N.length;++K)if((ce?N[K].replace(uo,"!"):N[K]).replace(Dr,"")==B||(ce?F[K].replace(uo,"!"):F[K]).replace(Dr,"")==B)return S.FileIndex[K];return null}var L=64,V=-2,Y="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(S,D,N){c();var F=O(S,N);l.writeFileSync(D,F)}function T(S){for(var D=new Array(S.length),N=0;N<S.length;++N)D[N]=String.fromCharCode(S[N]);return D.join("")}function q(S,D){var N=O(S,D);switch(D&&D.type||"buffer"){case"file":return c(),l.writeFileSync(D.filename,N),N;case"binary":return typeof N=="string"?N:T(N);case"base64":return rl(typeof N=="string"?N:T(N));case"buffer":if(tt)return Buffer.isBuffer(N)?N:pa(N);case"array":return typeof N=="string"?Qr(N):N}return N}var te;function C(S){try{var D=S.InflateRaw,N=new D;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)te=S;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function M(S,D){if(!te)return ke(S,D);var N=te.InflateRaw,F=new N,j=F._processChunk(S.slice(S.l),F._finishFlushFlag);return S.l+=F.bytesRead,j}function W(S){return te?te.deflateRawSync(S):ze(S)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(S){var D=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(D>>16|D>>8|D)&255}for(var se=typeof Uint8Array<"u",oe=se?new Uint8Array(256):[],ye=0;ye<256;++ye)oe[ye]=ae(ye);function R(S,D){var N=oe[S&255];return D<=8?N>>>8-D:(N=N<<8|oe[S>>8&255],D<=16?N>>>16-D:(N=N<<8|oe[S>>16&255],N>>>24-D))}function Me(S,D){var N=D&7,F=D>>>3;return(S[F]|(N<=6?0:S[F+1]<<8))>>>N&3}function U(S,D){var N=D&7,F=D>>>3;return(S[F]|(N<=5?0:S[F+1]<<8))>>>N&7}function re(S,D){var N=D&7,F=D>>>3;return(S[F]|(N<=4?0:S[F+1]<<8))>>>N&15}function J(S,D){var N=D&7,F=D>>>3;return(S[F]|(N<=3?0:S[F+1]<<8))>>>N&31}function ue(S,D){var N=D&7,F=D>>>3;return(S[F]|(N<=1?0:S[F+1]<<8))>>>N&127}function be(S,D,N){var F=D&7,j=D>>>3,B=(1<<N)-1,K=S[j]>>>F;return N<8-F||(K|=S[j+1]<<8-F,N<16-F)||(K|=S[j+2]<<16-F,N<24-F)||(K|=S[j+3]<<24-F),K&B}function He(S,D,N){var F=D&7,j=D>>>3;return F<=5?S[j]|=(N&7)<<F:(S[j]|=N<<F&255,S[j+1]=(N&7)>>8-F),D+3}function Xe(S,D,N){var F=D&7,j=D>>>3;return N=(N&1)<<F,S[j]|=N,D+1}function G(S,D,N){var F=D&7,j=D>>>3;return N<<=F,S[j]|=N&255,N>>>=8,S[j+1]=N,D+8}function _e(S,D,N){var F=D&7,j=D>>>3;return N<<=F,S[j]|=N&255,N>>>=8,S[j+1]=N&255,S[j+2]=N>>>8,D+16}function Re(S,D){var N=S.length,F=2*N>D?2*N:D+5,j=0;if(N>=D)return S;if(tt){var B=Dm(F);if(S.copy)S.copy(B);else for(;j<S.length;++j)B[j]=S[j];return B}else if(se){var K=new Uint8Array(F);if(K.set)K.set(S);else for(;j<N;++j)K[j]=S[j];return K}return S.length=F,S}function xe(S){for(var D=new Array(S),N=0;N<S;++N)D[N]=0;return D}function De(S,D,N){var F=1,j=0,B=0,K=0,ce=0,X=S.length,Q=se?new Uint16Array(32):xe(32);for(B=0;B<32;++B)Q[B]=0;for(B=X;B<N;++B)S[B]=0;X=S.length;var Z=se?new Uint16Array(X):xe(X);for(B=0;B<X;++B)Q[j=S[B]]++,F<j&&(F=j),Z[B]=0;for(Q[0]=0,B=1;B<=F;++B)Q[B+16]=ce=ce+Q[B-1]<<1;for(B=0;B<X;++B)ce=S[B],ce!=0&&(Z[B]=Q[ce+16]++);var ve=0;for(B=0;B<X;++B)if(ve=S[B],ve!=0)for(ce=R(Z[B],F)>>F-ve,K=(1<<F+4-ve)-1;K>=0;--K)D[ce|K<<ve]=ve&15|B<<4;return F}var je=se?new Uint16Array(512):xe(512),at=se?new Uint16Array(32):xe(32);if(!se){for(var ut=0;ut<512;++ut)je[ut]=0;for(ut=0;ut<32;++ut)at[ut]=0}(function(){for(var S=[],D=0;D<32;D++)S.push(5);De(S,at,32);var N=[];for(D=0;D<=143;D++)N.push(8);for(;D<=255;D++)N.push(9);for(;D<=279;D++)N.push(7);for(;D<=287;D++)N.push(8);De(N,je,288)})();var _t=function(){for(var D=se?new Uint8Array(32768):[],N=0,F=0;N<he.length-1;++N)for(;F<he[N+1];++F)D[F]=N;for(;F<32768;++F)D[F]=29;var j=se?new Uint8Array(259):[];for(N=0,F=0;N<z.length-1;++N)for(;F<z[N+1];++F)j[F]=N;function B(ce,X){for(var Q=0;Q<ce.length;){var Z=Math.min(65535,ce.length-Q),ve=Q+Z==ce.length;for(X.write_shift(1,+ve),X.write_shift(2,Z),X.write_shift(2,~Z&65535);Z-- >0;)X[X.l++]=ce[Q++]}return X.l}function K(ce,X){for(var Q=0,Z=0,ve=se?new Uint16Array(32768):[];Z<ce.length;){var Ce=Math.min(65535,ce.length-Z);if(Ce<10){for(Q=He(X,Q,+(Z+Ce==ce.length)),Q&7&&(Q+=8-(Q&7)),X.l=Q/8|0,X.write_shift(2,Ce),X.write_shift(2,~Ce&65535);Ce-- >0;)X[X.l++]=ce[Z++];Q=X.l*8;continue}Q=He(X,Q,+(Z+Ce==ce.length)+2);for(var Fe=0;Ce-- >0;){var Ee=ce[Z];Fe=(Fe<<5^Ee)&32767;var Ae=-1,Qe=0;if((Ae=ve[Fe])&&(Ae|=Z&-32768,Ae>Z&&(Ae-=32768),Ae<Z))for(;ce[Ae+Qe]==ce[Z+Qe]&&Qe<250;)++Qe;if(Qe>2){Ee=j[Qe],Ee<=22?Q=G(X,Q,oe[Ee+1]>>1)-1:(G(X,Q,3),Q+=5,G(X,Q,oe[Ee-23]>>5),Q+=3);var At=Ee<8?0:Ee-4>>2;At>0&&(_e(X,Q,Qe-z[Ee]),Q+=At),Ee=D[Z-Ae],Q=G(X,Q,oe[Ee]>>3),Q-=3;var Nt=Ee<4?0:Ee-2>>1;Nt>0&&(_e(X,Q,Z-Ae-he[Ee]),Q+=Nt);for(var gr=0;gr<Qe;++gr)ve[Fe]=Z&32767,Fe=(Fe<<5^ce[Z])&32767,++Z;Ce-=Qe-1}else Ee<=143?Ee=Ee+48:Q=Xe(X,Q,1),Q=G(X,Q,oe[Ee]),ve[Fe]=Z&32767,++Z}Q=G(X,Q,0)-1}return X.l=(Q+7)/8|0,X.l}return function(X,Q){return X.length<8?B(X,Q):K(X,Q)}}();function ze(S){var D=le(50+Math.floor(S.length*1.1)),N=_t(S,D);return D.slice(0,N)}var st=se?new Uint16Array(32768):xe(32768),ht=se?new Uint16Array(32768):xe(32768),it=se?new Uint16Array(128):xe(128),on=1,Vi=1;function Fl(S,D){var N=J(S,D)+257;D+=5;var F=J(S,D)+1;D+=5;var j=re(S,D)+4;D+=4;for(var B=0,K=se?new Uint8Array(19):xe(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=1,Q=se?new Uint8Array(8):xe(8),Z=se?new Uint8Array(8):xe(8),ve=K.length,Ce=0;Ce<j;++Ce)K[P[Ce]]=B=U(S,D),X<B&&(X=B),Q[B]++,D+=3;var Fe=0;for(Q[0]=0,Ce=1;Ce<=X;++Ce)Z[Ce]=Fe=Fe+Q[Ce-1]<<1;for(Ce=0;Ce<ve;++Ce)(Fe=K[Ce])!=0&&(ce[Ce]=Z[Fe]++);var Ee=0;for(Ce=0;Ce<ve;++Ce)if(Ee=K[Ce],Ee!=0){Fe=oe[ce[Ce]]>>8-Ee;for(var Ae=(1<<7-Ee)-1;Ae>=0;--Ae)it[Fe|Ae<<Ee]=Ee&7|Ce<<3}var Qe=[];for(X=1;Qe.length<N+F;)switch(Fe=it[ue(S,D)],D+=Fe&7,Fe>>>=3){case 16:for(B=3+Me(S,D),D+=2,Fe=Qe[Qe.length-1];B-- >0;)Qe.push(Fe);break;case 17:for(B=3+U(S,D),D+=3;B-- >0;)Qe.push(0);break;case 18:for(B=11+ue(S,D),D+=7;B-- >0;)Qe.push(0);break;default:Qe.push(Fe),X<Fe&&(X=Fe);break}var At=Qe.slice(0,N),Nt=Qe.slice(N);for(Ce=N;Ce<286;++Ce)At[Ce]=0;for(Ce=F;Ce<30;++Ce)Nt[Ce]=0;return on=De(At,st,286),Vi=De(Nt,ht,30),D}function fe(S,D){if(S[0]==3&&!(S[1]&3))return[$a(D),2];for(var N=0,F=0,j=Dm(D||1<<18),B=0,K=j.length>>>0,ce=0,X=0;!(F&1);){if(F=U(S,N),N+=3,F>>>1)F>>1==1?(ce=9,X=5):(N=Fl(S,N),ce=on,X=Vi);else{N&7&&(N+=8-(N&7));var Q=S[N>>>3]|S[(N>>>3)+1]<<8;if(N+=32,Q>0)for(!D&&K<B+Q&&(j=Re(j,B+Q),K=j.length);Q-- >0;)j[B++]=S[N>>>3],N+=8;continue}for(;;){!D&&K<B+32767&&(j=Re(j,B+32767),K=j.length);var Z=be(S,N,ce),ve=F>>>1==1?je[Z]:st[Z];if(N+=ve&15,ve>>>=4,!(ve>>>8&255))j[B++]=ve;else{if(ve==256)break;ve-=257;var Ce=ve<8?0:ve-4>>2;Ce>5&&(Ce=0);var Fe=B+z[ve];Ce>0&&(Fe+=be(S,N,Ce),N+=Ce),Z=be(S,N,X),ve=F>>>1==1?at[Z]:ht[Z],N+=ve&15,ve>>>=4;var Ee=ve<4?0:ve-2>>1,Ae=he[ve];for(Ee>0&&(Ae+=be(S,N,Ee),N+=Ee),!D&&K<Fe&&(j=Re(j,Fe+100),K=j.length);B<Fe;)j[B]=j[B-Ae],++B}}}return D?[j,N+7>>>3]:[j.slice(0,B),N+7>>>3]}function ke(S,D){var N=S.slice(S.l||0),F=fe(N,D);return S.l+=F[1],F[0]}function Ie(S,D){if(S)typeof console<"u"&&console.error(D);else throw new Error(D)}function Be(S,D){var N=S;hr(N,0);var F=[],j=[],B={FileIndex:F,FullPaths:j};E(B,{root:D.root});for(var K=N.length-4;(N[K]!=80||N[K+1]!=75||N[K+2]!=5||N[K+3]!=6)&&K>=0;)--K;N.l=K+4,N.l+=4;var ce=N.read_shift(2);N.l+=6;var X=N.read_shift(4);for(N.l=X,K=0;K<ce;++K){N.l+=20;var Q=N.read_shift(4),Z=N.read_shift(4),ve=N.read_shift(2),Ce=N.read_shift(2),Fe=N.read_shift(2);N.l+=8;var Ee=N.read_shift(4),Ae=o(N.slice(N.l+ve,N.l+ve+Ce));N.l+=ve+Ce+Fe;var Qe=N.l;N.l=Ee+4,Pe(N,Q,Z,B,Ae),N.l=Qe}return B}function Pe(S,D,N,F,j){S.l+=2;var B=S.read_shift(2),K=S.read_shift(2),ce=i(S);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var X=S.read_shift(4),Q=S.read_shift(4),Z=S.read_shift(4),ve=S.read_shift(2),Ce=S.read_shift(2),Fe="",Ee=0;Ee<ve;++Ee)Fe+=String.fromCharCode(S[S.l++]);if(Ce){var Ae=o(S.slice(S.l,S.l+Ce));(Ae[21589]||{}).mt&&(ce=Ae[21589].mt),((j||{})[21589]||{}).mt&&(ce=j[21589].mt)}S.l+=Ce;var Qe=S.slice(S.l,S.l+Q);switch(K){case 8:Qe=M(S,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var At=!1;B&8&&(X=S.read_shift(4),X==134695760&&(X=S.read_shift(4),At=!0),Q=S.read_shift(4),Z=S.read_shift(4)),Q!=D&&Ie(At,"Bad compressed size: "+D+" != "+Q),Z!=N&&Ie(At,"Bad uncompressed size: "+N+" != "+Z),ga(F,Fe,Qe,{unsafe:!0,mt:ce})}function ge(S,D){var N=D||{},F=[],j=[],B=le(1),K=N.compression?8:0,ce=0,X=0,Q=0,Z=0,ve=0,Ce=S.FullPaths[0],Fe=Ce,Ee=S.FileIndex[0],Ae=[],Qe=0;for(X=1;X<S.FullPaths.length;++X)if(Fe=S.FullPaths[X].slice(Ce.length),Ee=S.FileIndex[X],!(!Ee.size||!Ee.content||Fe=="Sh33tJ5")){var At=Z,Nt=le(Fe.length);for(Q=0;Q<Fe.length;++Q)Nt.write_shift(1,Fe.charCodeAt(Q)&127);Nt=Nt.slice(0,Nt.l),Ae[ve]=nT.buf(Ee.content,0);var gr=Ee.content;K==8&&(gr=W(gr)),B=le(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,ce),B.write_shift(2,K),Ee.mt?s(B,Ee.mt):B.write_shift(4,0),B.write_shift(-4,Ae[ve]),B.write_shift(4,gr.length),B.write_shift(4,Ee.content.length),B.write_shift(2,Nt.length),B.write_shift(2,0),Z+=B.length,F.push(B),Z+=Nt.length,F.push(Nt),Z+=gr.length,F.push(gr),B=le(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,ce),B.write_shift(2,K),B.write_shift(4,0),B.write_shift(-4,Ae[ve]),B.write_shift(4,gr.length),B.write_shift(4,Ee.content.length),B.write_shift(2,Nt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,At),Qe+=B.l,j.push(B),Qe+=Nt.length,j.push(Nt),++ve}return B=le(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,ve),B.write_shift(2,ve),B.write_shift(4,Qe),B.write_shift(4,Z),B.write_shift(2,0),sr([sr(F),sr(j),B])}var Je={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vt(S,D){if(S.ctype)return S.ctype;var N=S.name||"",F=N.match(/\.([^\.]+)$/);return F&&Je[F[1]]||D&&(F=(N=D).match(/[\.\\]([^\.\\])+$/),F&&Je[F[1]])?Je[F[1]]:"application/octet-stream"}function $e(S){for(var D=rl(S),N=[],F=0;F<D.length;F+=76)N.push(D.slice(F,F+76));return N.join(`\r
`)+`\r
`}function rr(S){var D=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var Z=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],F=D.split(`\r
`),j=0;j<F.length;++j){var B=F[j];if(B.length==0){N.push("");continue}for(var K=0;K<B.length;){var ce=76,X=B.slice(K,K+ce);X.charAt(ce-1)=="="?ce--:X.charAt(ce-2)=="="?ce-=2:X.charAt(ce-3)=="="&&(ce-=3),X=B.slice(K,K+ce),K+=ce,K<B.length&&(X+="="),N.push(X)}}return N.join(`\r
`)}function Qa(S){for(var D=[],N=0;N<S.length;++N){for(var F=S[N];N<=S.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+S[++N];D.push(F)}for(var j=0;j<D.length;++j)D[j]=D[j].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return Qr(D.join(`\r
`))}function Bs(S,D,N){for(var F="",j="",B="",K,ce=0;ce<10;++ce){var X=D[ce];if(!X||X.match(/^\s*$/))break;var Q=X.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":F=Q[2].trim();break;case"content-type":B=Q[2].trim();break;case"content-transfer-encoding":j=Q[2].trim();break}}switch(++ce,j.toLowerCase()){case"base64":K=Qr(nn(D.slice(ce).join("")));break;case"quoted-printable":K=Qa(D.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var Z=ga(S,F.slice(N.length),K,{unsafe:!0});B&&(Z.ctype=B)}function Za(S,D){if(T(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=D&&D.root||"",F=(tt&&Buffer.isBuffer(S)?S.toString("binary"):T(S)).split(`\r
`),j=0,B="";for(j=0;j<F.length;++j)if(B=F[j],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),N||(N=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),B.slice(0,N.length)!=N););var K=(F[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var ce="--"+(K[1]||""),X=[],Q=[],Z={FileIndex:X,FullPaths:Q};E(Z);var ve,Ce=0;for(j=0;j<F.length;++j){var Fe=F[j];Fe!==ce&&Fe!==ce+"--"||(Ce++&&Bs(Z,F.slice(ve,j),N),ve=j)}return Z}function xr(S,D){var N=D||{},F=N.boundary||"SheetJS";F="------="+F;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],B=S.FullPaths[0],K=B,ce=S.FileIndex[0],X=1;X<S.FullPaths.length;++X)if(K=S.FullPaths[X].slice(B.length),ce=S.FileIndex[X],!(!ce.size||!ce.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var Q=ce.content,Z=tt&&Buffer.isBuffer(Q)?Q.toString("binary"):T(Q),ve=0,Ce=Math.min(1024,Z.length),Fe=0,Ee=0;Ee<=Ce;++Ee)(Fe=Z.charCodeAt(Ee))>=32&&Fe<128&&++ve;var Ae=ve>=Ce*4/5;j.push(F),j.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+K),j.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),j.push("Content-Type: "+vt(ce,K)),j.push(""),j.push(Ae?rr(Z):$e(Z))}return j.push(F+`--\r
`),j.join(`\r
`)}function Us(S){var D={};return E(D,S),D}function ga(S,D,N,F){var j=F&&F.unsafe;j||E(S);var B=!j&&Ue.find(S,D);if(!B){var K=S.FullPaths[0];D.slice(0,K.length)==K?K=D:(K.slice(-1)!="/"&&(K+="/"),K=(K+D).replace("//","/")),B={name:a(D),type:2},S.FileIndex.push(B),S.FullPaths.push(K),j||Ue.utils.cfb_gc(S)}return B.content=N,B.size=N?N.length:0,F&&(F.CLSID&&(B.clsid=F.CLSID),F.mt&&(B.mt=F.mt),F.ct&&(B.ct=F.ct)),B}function jt(S,D){E(S);var N=Ue.find(S,D);if(N){for(var F=0;F<S.FileIndex.length;++F)if(S.FileIndex[F]==N)return S.FileIndex.splice(F,1),S.FullPaths.splice(F,1),!0}return!1}function Xn(S,D,N){E(S);var F=Ue.find(S,D);if(F){for(var j=0;j<S.FileIndex.length;++j)if(S.FileIndex[j]==F)return S.FileIndex[j].name=a(N),S.FullPaths[j]=N,!0}return!1}function Fr(S){k(S,!0)}return t.find=H,t.read=A,t.parse=u,t.write=q,t.writeFile=ee,t.utils={cfb_new:Us,cfb_add:ga,cfb_del:jt,cfb_mov:Xn,cfb_gc:Fr,ReadShift:So,CheckField:sw,prep_blob:hr,bconcat:sr,use_zlib:C,_deflateRaw:ze,_inflateRaw:ke,consts:ie},t}();function aT(e){return typeof e=="string"?Nu(e):Array.isArray(e)?Fb(e):e}function kl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Nu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?zn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([aT(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Xa(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function sT(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function $t(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Hm(e,t){for(var r=[],n=$t(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Ou(e){for(var t=[],r=$t(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Ru(e){for(var t=[],r=$t(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function iT(e){for(var t=[],r=$t(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var eu=new Date(1899,11,30,0,0,0);function tr(e,t){var r=e.getTime(),n=eu.getTime()+(e.getTimezoneOffset()-eu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Mv=new Date,oT=eu.getTime()+(Mv.getTimezoneOffset()-eu.getTimezoneOffset())*6e4,zm=Mv.getTimezoneOffset();function Iu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+oT),t.getTimezoneOffset()!==zm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-zm)*6e4),t}function lT(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Vm=new Date("2017-02-19T19:06:09.000Z"),Bv=isNaN(Vm.getFullYear())?new Date("2/19/17"):Vm,cT=Bv.getFullYear()==2017;function bt(e,t){var r=new Date(e);if(cT)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Bv.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ts(e,t){if(tt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return zn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return zn(Tv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return zn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return zn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Tt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Tt(e[r]));return t}function Bt(e,t){for(var r="";r.length<t;)r+=e;return r}function Dn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var uT=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&uT.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var fT=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function Uv(e){return e?e.content&&e.type?Ts(e.content,!0):e.data?co(e.data):e.asNodeBuffer&&tt?co(e.asNodeBuffer().toString("binary")):e.asBinary?co(e.asBinary()):e._data&&e._data.getContent?co(Ts(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function $v(e){if(!e)return null;if(e.data)return Im(e.data);if(e.asNodeBuffer&&tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Im(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function hT(e){return e&&e.name.slice(-4)===".bin"?$v(e):Uv(e)}function hn(e,t){for(var r=e.FullPaths||$t(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function ld(e,t){var r=hn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function qt(e,t,r){if(!r)return hT(ld(e,t));if(!t)return null;try{return qt(e,t)}catch{return null}}function Zr(e,t,r){if(!r)return Uv(ld(e,t));if(!t)return null;try{return Zr(e,t)}catch{return null}}function dT(e,t,r){return $v(ld(e,t))}function Gm(e){for(var t=e.FullPaths||$t(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function et(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return tt?n=pa(r):n=Ob(r),Ue.utils.cfb_add(e,t,n)}Ue.utils.cfb_add(e,t,r)}else e.file(t,r)}function cd(){return Ue.utils.cfb_new()}function Wv(e,t){switch(t.type){case"base64":return Ue.read(e,{type:"base64"});case"binary":return Ue.read(e,{type:"binary"});case"buffer":case"array":return Ue.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function fo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,pT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,mT=/<[^>]*>/g,Nr=Vt.match(qm)?qm:mT,xT=/<\w*:/,gT=/<(\/?)\w+:/;function Ye(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(pT),o=0,l="",c=0,u="",h="",d=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(a=h.charCodeAt(s+1))==34||a==39?1:0,l=h.slice(s+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function qn(e){return e.replace(gT,"<$1")}var Hv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ud=Ou(Hv),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return Hv[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),fd=/[&<>'"]/g,vT=/[\u0000-\u0008\u000b-\u001f]/g;function mt(e){var t=e+"";return t.replace(fd,function(r){return ud[r]}).replace(vT,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Km(e){return mt(e).replace(/ /g,"_x0020_")}var zv=/[\u0000-\u001f]/g;function hd(e){var t=e+"";return t.replace(fd,function(r){return ud[r]}).replace(/\n/g,"<br/>").replace(zv,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function wT(e){var t=e+"";return t.replace(fd,function(r){return ud[r]}).replace(zv,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Xm=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function yT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Et(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function E0(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Ym(e){var t=$a(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Jm(e){return pa(e,"binary").toString("utf8")}var Zl="foo bar baz",gt=tt&&(Jm(Zl)==E0(Zl)&&Jm||Ym(Zl)==E0(Zl)&&Ym)||E0,zn=tt?function(e){return pa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},al=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Vv=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),_T=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),kT=/<\/?(?:vt:)?variant>/g,ET=/<(?:vt:)([^>]*)>([\s\S]*)</;function Qm(e,t){var r=Ye(e),n=e.match(_T(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(kT,"").match(ET);i&&a.push({v:gt(i[2]),t:i[1]})}),a}var Gv=/(^\s|\s$|\n)/;function dr(e,t){return"<"+e+(t.match(Gv)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function sl(e){return $t(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Se(e,t,r){return"<"+e+(r!=null?sl(r):"")+(t!=null?(t.match(Gv)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Hf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ST(e,t){switch(typeof e){case"string":var r=Se("vt:lpwstr",mt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Se((e|0)==e?"vt:i4":"vt:r8",mt(String(e)));case"boolean":return Se("vt:bool",e?"true":"false")}if(e instanceof Date)return Se("vt:filetime",Hf(e));throw new Error("Unable to serialize "+e)}function dd(e){if(tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return gt(Xa(sd(e)));throw new Error("Bad input format: expected Buffer or string")}var il=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Is=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bT(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function TT(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Zm=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},ex=tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:pa(t)})):Zm(e)}:Zm,tx=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ra(e,a)));return n.join("").replace(Dr,"")},pd=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Dr,""):tx(e,t,r)}:tx,rx=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},qv=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):rx(e,t,r)}:rx,nx=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ei(e,a)));return n.join("")},El=tt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):nx(t,r,n)}:nx,Kv=function(e,t){var r=Xr(e,t);return r>0?El(e,t+4,t+4+r-1):""},Xv=Kv,Yv=function(e,t){var r=Xr(e,t);return r>0?El(e,t+4,t+4+r-1):""},Jv=Yv,Qv=function(e,t){var r=2*Xr(e,t);return r>0?El(e,t+4,t+4+r-1):""},Zv=Qv,ew=function(t,r){var n=Xr(t,r);return n>0?pd(t,r+4,r+4+n):""},tw=ew,rw=function(e,t){var r=Xr(e,t);return r>0?El(e,t+4,t+4+r):""},nw=rw,aw=function(e,t){return bT(e,t)},tu=aw,md=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};tt&&(Xv=function(t,r){if(!Buffer.isBuffer(t))return Kv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Jv=function(t,r){if(!Buffer.isBuffer(t))return Yv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Zv=function(t,r){if(!Buffer.isBuffer(t))return Qv(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},tw=function(t,r){if(!Buffer.isBuffer(t))return ew(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},nw=function(t,r){if(!Buffer.isBuffer(t))return rw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},tu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):aw(t,r)},md=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ei=function(e,t){return e[t]},ra=function(e,t){return e[t+1]*256+e[t]},CT=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Xr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ls=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},AT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function So(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ra(this,c)),c+=2;e*=2;break;case"utf8":r=El(this,this.l,this.l+e);break;case"utf16le":e*=2,r=pd(this,this.l,this.l+e);break;case"wstr":return So.call(this,e,"dbcs");case"lpstr-ansi":r=Xv(this,this.l),e=4+Xr(this,this.l);break;case"lpstr-cp":r=Jv(this,this.l),e=4+Xr(this,this.l);break;case"lpwstr":r=Zv(this,this.l),e=4+2*Xr(this,this.l);break;case"lpp4":e=4+Xr(this,this.l),r=tw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Xr(this,this.l),r=nw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=ei(this,this.l+e++))!==0;)s.push(Ql(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=ra(this,this.l+e))!==0;)s.push(Ql(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=ei(this,c),this.l=c+1,o=So.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ql(ra(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=ei(this,c),this.l=c+1,o=So.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ql(ei(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=ei(this,this.l),this.l++,n;case 2:return n=(t==="i"?CT:ra)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ls:AT)(this,this.l),this.l+=4,n):(a=Xr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=tu(this,this.l):a=tu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=qv(this,this.l,e);break}}return this.l+=e,r}var NT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},FT=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},OT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function RT(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)OT(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,NT(this,t,this.l);break;case 8:if(n=8,r==="f"){TT(this,t,this.l);break}case 16:break;case-4:n=4,FT(this,t,this.l);break}return this.l+=n,this}function sw(e,t){var r=qv(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hr(e,t){e.l=t,e.read_shift=So,e.chk=sw,e.write_shift=RT}function Ar(e,t){e.l+=t}function le(e){var t=$a(e);return hr(t,0),t}function ma(e,t,r){if(e){var n,a,s;hr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=hl[o]||hl[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function zr(){var e=[],t=tt?256:2048,r=function(c){var u=le(c);return hr(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),sr(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function pe(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=hl[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&md(r)&&e.push(r)}}function bo(e,t,r){var n=Tt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ax(e,t,r){var n=Tt(e);return n.s=bo(n.s,t.s,r),n.e=bo(n.e,t.s,r),n}function To(e,t){if(e.cRel&&e.c<0)for(e=Tt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Tt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ke(e);return!e.cRel&&e.cRel!=null&&(r=DT(r)),!e.rRel&&e.rRel!=null&&(r=IT(r)),r}function S0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Rt(e.s.c)+":"+(e.e.cRel?"":"$")+Rt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zt(e.s.r)+":"+(e.e.rRel?"":"$")+zt(e.e.r):To(e.s,t.biff)+":"+To(e.e,t.biff)}function xd(e){return parseInt(PT(e),10)-1}function zt(e){return""+(e+1)}function IT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function PT(e){return e.replace(/\$(\d+)$/,"$1")}function gd(e){for(var t=jT(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Rt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function DT(e){return e.replace(/^([A-Z])/,"$$$1")}function jT(e){return e.replace(/^\$([A-Z])/,"$1")}function LT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function It(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ke(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Vr(e){var t=e.indexOf(":");return t==-1?{s:It(e),e:It(e)}:{s:It(e.slice(0,t)),e:It(e.slice(t+1))}}function Ze(e,t){return typeof t>"u"||typeof t=="number"?Ze(e.s,e.e):(typeof e!="string"&&(e=Ke(e)),typeof t!="string"&&(t=Ke(t)),e==t?e:e+":"+t)}function ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function sx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=_n(e.z,r?tr(t):t)}catch{}try{return e.w=_n((e.XF||{}).numFmtId||(r?14:0),r?tr(t):t)}catch{return""+t}}function fa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xa[e.v]||e.v:t==null?sx(e,e.v):sx(e,t))}function Ya(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function iw(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?It(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=ct(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var p={v:t[h][d]},x=i+h,m=o+d;if(c.s.r>x&&(c.s.r=x),c.s.c>m&&(c.s.c=m),c.e.r<x&&(c.e.r=x),c.e.c<m&&(c.e.c=m),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))p=t[h][d];else if(Array.isArray(p.v)&&(p.f=t[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||qe[14],n.cellDates?(p.t="d",p.w=_n(p.z,tr(p.v))):(p.t="n",p.v=tr(p.v),p.w=_n(p.z,p.v))):p.t="s";if(a)s[x]||(s[x]=[]),s[x][m]&&s[x][m].z&&(p.z=s[x][m].z),s[x][m]=p;else{var v=Ke({c:m,r:x});s[v]&&s[v].z&&(p.z=s[v].z),s[v]=p}}}return c.s.c<1e7&&(s["!ref"]=Ze(c)),s}function Hi(e,t){return iw(null,e,t)}function MT(e){return e.read_shift(4,"i")}function jn(e,t){return t||(t=le(4)),t.write_shift(4,e),t}function Tr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ir(e,t){var r=!1;return t==null&&(r=!0,t=le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function BT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function UT(e,t){return t||(t=le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function vd(e,t){var r=e.l,n=e.read_shift(1),a=Tr(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(BT(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function $T(e,t){var r=!1;return t==null&&(r=!0,t=le(15+4*e.t.length)),t.write_shift(1,0),ir(e.t,t),r?t.slice(0,t.l):t}var WT=vd;function HT(e,t){var r=!1;return t==null&&(r=!0,t=le(23+4*e.t.length)),t.write_shift(1,1),ir(e.t,t),t.write_shift(4,1),UT({},t),r?t.slice(0,t.l):t}function kn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ps(e,t){return t==null&&(t=le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ds(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function js(e,t){return t==null&&(t=le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var zT=Tr,ow=ir;function wd(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ru(e,t){var r=!1;return t==null&&(r=!0,t=le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var VT=Tr,zf=wd,yd=ru;function _d(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?tu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ls(t,0)>>2;return r?a/100:a}function lw(e,t){t==null&&(t=le(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function cw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function GT(e,t){return t||(t=le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ls=cw,zi=GT;function br(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Cs(e,t){return(t||le(8)).write_shift(8,e,"f")}function qT(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=xs[a];c&&(t.rgb=ll(c));break;case 2:t.rgb=ll([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function nu(e,t){if(t||(t=le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function KT(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function XT(e,t){t||(t=le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function uw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function YT(e){return uw(e,1)}function JT(e){return uw(e,2)}var kd=2,Mr=3,ec=11,ix=12,au=19,tc=64,QT=65,ZT=71,e4=4108,t4=4126,nr=80,fw=81,r4=[nr,fw],Vf={1:{n:"CodePage",t:kd},2:{n:"Category",t:nr},3:{n:"PresentationFormat",t:nr},4:{n:"ByteCount",t:Mr},5:{n:"LineCount",t:Mr},6:{n:"ParagraphCount",t:Mr},7:{n:"SlideCount",t:Mr},8:{n:"NoteCount",t:Mr},9:{n:"HiddenCount",t:Mr},10:{n:"MultimediaClipCount",t:Mr},11:{n:"ScaleCrop",t:ec},12:{n:"HeadingPairs",t:e4},13:{n:"TitlesOfParts",t:t4},14:{n:"Manager",t:nr},15:{n:"Company",t:nr},16:{n:"LinksUpToDate",t:ec},17:{n:"CharacterCount",t:Mr},19:{n:"SharedDoc",t:ec},22:{n:"HyperlinksChanged",t:ec},23:{n:"AppVersion",t:Mr,p:"version"},24:{n:"DigSig",t:QT},26:{n:"ContentType",t:nr},27:{n:"ContentStatus",t:nr},28:{n:"Language",t:nr},29:{n:"Version",t:nr},255:{},2147483648:{n:"Locale",t:au},2147483651:{n:"Behavior",t:au},1919054434:{}},Gf={1:{n:"CodePage",t:kd},2:{n:"Title",t:nr},3:{n:"Subject",t:nr},4:{n:"Author",t:nr},5:{n:"Keywords",t:nr},6:{n:"Comments",t:nr},7:{n:"Template",t:nr},8:{n:"LastAuthor",t:nr},9:{n:"RevNumber",t:nr},10:{n:"EditTime",t:tc},11:{n:"LastPrinted",t:tc},12:{n:"CreatedDate",t:tc},13:{n:"ModifiedDate",t:tc},14:{n:"PageCount",t:Mr},15:{n:"WordCount",t:Mr},16:{n:"CharCount",t:Mr},17:{n:"Thumbnail",t:ZT},18:{n:"Application",t:nr},19:{n:"DocSecurity",t:Mr},255:{},2147483648:{n:"Locale",t:au},2147483651:{n:"Behavior",t:au},1919054434:{}},ox={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},n4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function a4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var s4=a4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xs=Tt(s4),xa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},hw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},qf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},rc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ed(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function i4(e){var t=Ed();if(!e||!e.match)return t;var r={};if((e.match(Nr)||[]).forEach(function(n){var a=Ye(n);switch(a[0].replace(xT,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[qf[a.ContentType]]!==void 0&&t[qf[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Zt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function dw(e,t){var r=iT(qf),n=[],a;n[n.length]=Vt,n[n.length]=Se("Types",null,{xmlns:Zt.CT,"xmlns:xsd":Zt.xsd,"xmlns:xsi":Zt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Se("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Se("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:rc[l][t.bookType]||rc[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:rc[l][t.bookType]||rc[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ol(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Co(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Nr)||[]).forEach(function(a){var s=Ye(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:fo(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function Si(e){var t=[Vt,Se("Relationships",null,{xmlns:Zt.RELS})];return $t(e["!id"]).forEach(function(r){t[t.length]=Se("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function pt(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[rt.HLINK,rt.XPATH,rt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var o4="application/vnd.oasis.opendocument.spreadsheet";function l4(e,t){for(var r=dd(e),n,a;n=il.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ye(n[0],!1),a.path=="/"&&a.type!==o4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function c4(e){var t=[Vt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function lx(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function u4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function f4(e){var t=[Vt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(lx(e[r][0],e[r][1])),t.push(u4("",e[r][0]));return t.push(lx("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function pw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Yc.version+"</meta:generator></office:meta></office:document-meta>"}var vn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],h4=function(){for(var e=new Array(vn.length),t=0;t<vn.length;++t){var r=vn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function mw(e){var t={};e=gt(e);for(var r=0;r<vn.length;++r){var n=vn[r],a=e.match(h4[r]);a!=null&&a.length>0&&(t[n[1]]=lt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=bt(t[n[1]]))}return t}function b0(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=mt(t),n[n.length]=r?Se(e,t,r):dr(e,t))}function xw(e,t){var r=t||{},n=[Vt,Se("cp:coreProperties",null,{"xmlns:cp":Zt.CORE_PROPS,"xmlns:dc":Zt.dc,"xmlns:dcterms":Zt.dcterms,"xmlns:dcmitype":Zt.dcmitype,"xmlns:xsi":Zt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&b0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Hf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&b0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Hf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=vn.length;++s){var i=vn[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&b0(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var gs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vw(e,t,r,n){var a=[];if(typeof e=="string")a=Qm(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var i=typeof t=="string"?Qm(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function d4(e,t,r){var n={};return t||(t={}),e=gt(e),gs.forEach(function(a){var s=(e.match(al(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=lt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&vw(n.HeadingPairs,n.TitlesOfParts,t,r),t}function ww(e){var t=[],r=Se;return e||(e={}),e.Application="SheetJS",t[t.length]=Vt,t[t.length]=Se("Properties",null,{xmlns:Zt.EXT_PROPS,"xmlns:vt":Zt.vt}),gs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=mt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+mt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var p4=/<[^>]+>[^<]*/g;function m4(e,t){var r={},n="",a=e.match(p4);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Ye(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=lt(u);break;case"bool":r[n]=Et(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=bt(u);break;case"cy":case"error":r[n]=lt(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function yw(e){var t=[Vt,Se("Properties",null,{xmlns:Zt.CUST_PROPS,"xmlns:vt":Zt.vt})];if(!e)return t.join("");var r=1;return $t(e).forEach(function(a){++r,t[t.length]=Se("property",ST(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:mt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Kf={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},T0;function x4(e,t,r){T0||(T0=Ou(Kf)),t=T0[t]||t,e[t]=r}function g4(e,t){var r=[];return $t(Kf).map(function(n){for(var a=0;a<vn.length;++a)if(vn[a][1]==n)return vn[a];for(a=0;a<gs.length;++a)if(gs[a][1]==n)return gs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(dr(Kf[n[1]]||n[1],a))}}),Se("DocumentProperties",r.join(""),{xmlns:Kr.o})}function v4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&$t(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<vn.length;++i)if(s==vn[i][1])return;for(i=0;i<gs.length;++i)if(s==gs[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Se(Km(s),o,{"dt:dt":l}))}}),t&&$t(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(Se(Km(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Kr.o+'">'+a.join("")+"</"+n+">"}function Sd(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function w4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=le(8);return i.write_shift(4,n),i.write_shift(4,a),i}function _w(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function kw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Ew(e,t,r){return t===31?kw(e):_w(e,t,r)}function Xf(e,t,r){return Ew(e,t,r===!1?0:4)}function y4(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ew(e,t,0)}function _4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Dr,""),e.l-a&2&&(e.l+=2)}return r}function k4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Dr,"");return r}function E4(e){var t=e.l,r=su(e,fw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=su(e,Mr);return[r,n]}function S4(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(E4(e));return r}function cx(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Dr,"").replace(uo,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Sw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function b4(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function su(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==ix&&n!==t&&r4.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===ix?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return _w(e,n,4).replace(Dr,"");case 31:return kw(e);case 64:return Sd(e);case 65:return Sw(e);case 71:return b4(e);case 80:return Xf(e,n,!s.raw).replace(Dr,"");case 81:return y4(e,n).replace(Dr,"");case 4108:return S4(e);case 4126:case 4127:return n==4127?_4(e):k4(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ux(e,t){var r=le(4),n=le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=le(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=w4(t);break;case 31:case 80:for(n=le(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return sr([r,n])}function fx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),h=e.read_shift(4);s[i]=[u,h+r]}s.sort(function(y,g){return y[1]-g[1]});var d={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[s[i][0]];if(d[x.n]=su(e,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:On(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(s[i][0]===1){if(o=d.CodePage=su(e,kd),On(o),l!==-1){var m=e.l;e.l=s[l][1],c=cx(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=cx(e,o)}else{var v=c[s[i][0]],w;switch(e[e.l]){case 65:e.l+=4,w=Sw(e);break;case 30:e.l+=4,w=Xf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=Xf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=Wt(e,4);break;case 64:e.l+=4,w=bt(Sd(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[v]=w}}return e.l=r+n,d}var bw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function T4(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function hx(e,t,r){var n=le(8),a=[],s=[],i=8,o=0,l=le(8),c=le(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),a.push(c),i+=8+l.length,!t){c=le(8),c.write_shift(4,0),a.unshift(c);var u=[le(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=le(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=sr(u),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(bw.indexOf(e[o][0])>-1||gw.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=ux(x.t,d)}else{var v=T4(d);v==-1&&(v=31,d=String(d)),l=ux(v,d)}s.push(l),c=le(8),c.write_shift(4,t?p:2+o),a.push(c),i+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),sr([n].concat(a).concat(s))}function dx(e,t,r){var n=e.content;if(!n)return{};hr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Ue.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=fx(n,t),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=s,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=fx(n,null)}catch{}for(p in x)d[p]=x[p];return d.FMTID=[s,i],d}function px(e,t,r,n,a,s){var i=le(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ue.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=hx(e,r,n);if(o.push(l),a){var c=hx(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return sr(o)}function wa(e,t){return e.read_shift(t),null}function C4(e,t){t||(t=le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function A4(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Wt(e,t){return e.read_shift(t)===1}function Ir(e,t){return t||(t=le(2)),t.write_shift(2,+!!e),t}function Kt(e){return e.read_shift(2,"u")}function dn(e,t){return t||(t=le(2)),t.write_shift(2,e),t}function Tw(e,t){return A4(e,t,Kt)}function N4(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Cw(e,t,r){return r||(r=le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Sl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function F4(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function O4(e){var t=e.t||"",r=le(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=le(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return sr(a)}function As(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function bl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):As(e,n,r)}function Ms(e,t,r){if(r.biff>5)return bl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Aw(e,t,r){return r||(r=le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function R4(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function I4(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Dr,"");return n&&(e.l+=24),a}function P4(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Dr,"");return r+i}function D4(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return I4(e);case"0303000000000000c000000000000046":return P4(e);default:throw new Error("Unsupported Moniker "+r)}}function nc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Dr,""):"";return r}function mx(e,t){t||(t=le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function j4(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",u,h;a&16&&(s=nc(e,r-e.l)),a&128&&(i=nc(e,r-e.l)),(a&257)===257&&(o=nc(e,r-e.l)),(a&257)===1&&(l=D4(e,r-e.l)),a&8&&(c=nc(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(h=Sd(e)),e.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return u&&(p.guid=u),h&&(p.time=h),s&&(p.Tooltip=s),p}function L4(e){var t=le(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),mx(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&mx(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Nw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Fw(e,t){var r=Nw(e);return r[3]=0,r}function Kn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ns(e,t,r,n){return n||(n=le(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function M4(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function B4(e,t,r){return t===0?"":Ms(e,t,r)}function U4(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Ow(e){var t=e.read_shift(2),r=_d(e);return[t,r]}function $4(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Sl(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Pu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Rw(e,t){return t||(t=le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Iw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var W4=Iw;function Pw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function H4(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function z4(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function yr(e){e.l+=2,e.l+=e.read_shift(2)}var V4={0:yr,4:yr,5:yr,6:yr,7:z4,8:yr,9:yr,10:yr,11:yr,12:yr,13:H4,14:yr,15:yr,16:yr,17:yr,18:yr,19:yr,20:yr,21:Pw};function G4(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(V4[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ac(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function bd(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=le(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function q4(e,t){return t===0||e.read_shift(2),1200}function K4(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ms(e,0,r);return e.read_shift(t+n-e.l),a}function X4(e,t){var r=!t||t.biff==8,n=le(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Y4(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function J4(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Sl(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function Q4(e,t){var r=!t||t.biff>=8?2:1,n=le(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Z4(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(F4(e));return s.Count=n,s.Unique=a,s}function e3(e,t){var r=le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=O4(e[a]);var s=sr([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function t3(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function r3(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function n3(e){var t=M4(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function a3(e){return e.read_shift(2),e.read_shift(4)}function xx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function s3(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function i3(){var e=le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function o3(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function l3(e){var t=le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function c3(){}function u3(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Sl(e,0,r),n}function f3(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=le(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function h3(e){var t=Kn(e);return t.isst=e.read_shift(4),t}function d3(e,t,r,n){var a=le(10);return Ns(e,t,n,a),a.write_shift(4,r),a}function p3(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Kn(e);r.biff==2&&e.l++;var s=bl(e,n-e.l,r);return a.val=s,a}function m3(e,t,r,n,a){var s=!a||a.biff==8,i=le(8+ +s+(1+s)*r.length);return Ns(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function x3(e,t,r){var n=e.read_shift(2),a=Ms(e,0,r);return[n,a]}function g3(e,t,r,n){var a=r&&r.biff==5;n||(n=le(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var v3=Ms;function gx(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function w3(e,t){var r=t.biff==8||!t.biff?4:2,n=le(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function y3(e){var t=e.read_shift(2),r=e.read_shift(2),n=Ow(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function _3(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Ow(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function k3(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function E3(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=n4[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function S3(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=E3(e,t,n.fStyle,r),n}function vx(e,t,r,n){var a=r&&r.biff==5;n||(n=le(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function b3(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function T3(e){var t=le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function wx(e,t,r){var n=Kn(e);(r.biff==2||t==9)&&++e.l;var a=N4(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function C3(e,t,r,n,a,s){var i=le(8);return Ns(e,t,n,i),Cw(r,s,i),i}function A3(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Kn(e),a=br(e);return n.val=a,n}function N3(e,t,r,n){var a=le(14);return Ns(e,t,n,a),Cs(r,a),a}var yx=B4;function F3(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=As(e,s),o=[];n>e.l;)o.push(bl(e));return[s,a,i,o]}function _x(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=$4(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var O3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kx(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=As(e,i,r);a&32&&(c=O3[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||o===0||!(u>0)?[]:GF(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function Dw(e,t,r){if(r.biff<8)return R3(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(U4(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function R3(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Sl(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function I3(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=As(e,n,r),i=As(e,a,r);return[s,i]}function P3(e,t,r){var n=Iw(e);e.l++;var a=e.read_shift(1);return t-=8,[qF(e,t,r),a,n]}function Ex(e,t,r){var n=W4(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,zF(e,t,r)]}function D3(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function j3(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Ms(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function L3(e,t,r){return j3(e,t,r)}function M3(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Pu(e));return r}function B3(e){var t=le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Rw(e[r],t);return t}function U3(e,t,r){if(r&&r.biff<8)return W3(e,t,r);var n=Pw(e),a=G4(e,t-22,n[1]);return{cmo:n,ft:a}}var $3={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function W3(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push(($3[n]||Ar)(e,t,r)),{cmo:[a,n,s],ft:i}}function H3(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=R4(e,6,r);var o=e.read_shift(2);e.read_shift(2),Kt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],h=As(e,e.lens[c+1]-e.lens[c]-1);if(a+=h,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function z3(e,t){var r=Pu(e);e.l+=16;var n=j4(e,t-24);return[r,n]}function V3(e){var t=le(24),r=It(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return sr([t,L4(e[1])])}function G3(e,t){e.read_shift(2);var r=Pu(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Dr,""),[r,n]}function q3(e){var t=e[1].Tooltip,r=le(10+2*(t.length+1));r.write_shift(2,2048);var n=It(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function K3(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ox[r]||r,r=e.read_shift(2),t[1]=ox[r]||r,t}function X3(e){return e||(e=le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Y3(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Fw(e));return r}function J3(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Fw(e));return r}function Q3(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function jw(e,t,r){if(!r.cellStyles)return Ar(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Z3(e,t){var r=le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function eC(e,t){var r={};return t<32||(e.l+=16,r.header=br(e),r.footer=br(e),e.l+=2),r}function tC(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function rC(e){for(var t=le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var nC=Kn,aC=Tw,sC=bl;function iC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function oC(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Kn(e);++e.l;var a=Ms(e,t-7,r);return n.t="str",n.val=a,n}function lC(e){var t=Kn(e);++e.l;var r=br(e);return t.t="n",t.val=r,t}function cC(e,t,r){var n=le(15);return Nl(n,e,t),n.write_shift(8,r,"f"),n}function uC(e){var t=Kn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function fC(e,t,r){var n=le(9);return Nl(n,e,t),n.write_shift(2,r),n}function hC(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function dC(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function pC(e,t,r){var n=e.l+t,a=Kn(e),s=e.read_shift(2),i=As(e,s,r);return e.l=n,a.t="str",a.val=i,a}var mC=[2,3,48,49,131,139,140,245],Yf=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ou({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=$a(1);switch(l.type){case"base64":u=Qr(nn(o));break;case"binary":u=Qr(o);break;case"buffer":case"array":u=o;break}hr(u,0);var h=u.read_shift(1),d=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,v=521;h==2&&(m=u.read_shift(2)),u.l+=3,h!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(v=u.read_shift(2));var w=u.read_shift(2),y=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var g=[],b={},I=Math.min(u.length,h==2?521:v-10-(p?264:0)),A=x?32:11;u.l<I&&u[u.l]!=13;)switch(b={},b.name=tl.utils.decode(y,u.slice(u.l,u.l+A)).replace(/[\u0000\r\n].*$/g,""),u.l+=A,b.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(b.offset=u.read_shift(4)),b.len=u.read_shift(1),h==2&&(b.offset=u.read_shift(2)),b.dec=u.read_shift(1),b.name.length&&g.push(b),h!=2&&(u.l+=x?13:14),b.type){case"B":(!p||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var E=0,_=0;for(c[0]=[],_=0;_!=g.length;++_)c[0][_]=g[_].name;for(;m-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++E]=[],_=0,_=0;_!=g.length;++_){var k=u.slice(u.l,u.l+g[_].len);u.l+=g[_].len,hr(k,0);var O=tl.utils.decode(y,k);switch(g[_].type){case"C":O.trim().length&&(c[E][_]=O.replace(/\s+$/,""));break;case"D":O.length===8?c[E][_]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):c[E][_]=O;break;case"F":c[E][_]=parseFloat(O.trim());break;case"+":case"I":c[E][_]=x?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":c[E][_]=!0;break;case"N":case"F":c[E][_]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[E][_]="##MEMO##"+(x?parseInt(O.trim(),10):k.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(c[E][_]=+O||0);break;case"@":c[E][_]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[E][_]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[E][_]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][_]=-k.read_shift(-8,"f");break;case"B":if(p&&g[_].len==8){c[E][_]=k.read_shift(8,"f");break}case"G":case"P":k.l+=g[_].len;break;case"0":if(g[_].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[_].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Hi(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function a(o,l){try{return Ya(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&On(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=zr(),h=lu(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),x=o["!cols"]||[],m=0,v=0,w=0,y=1;for(m=0;m<d.length;++m){if(((x[m]||{}).DBF||{}).name){d[m]=x[m].DBF.name,++w;continue}if(d[m]!=null){if(++w,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(v=0;v<1024;++v)if(d.indexOf(d[m]+"_"+v)==-1){d[m]+="_"+v;break}}}}var g=ct(o["!ref"]),b=[],I=[],A=[];for(m=0;m<=g.e.c-g.s.c;++m){var E="",_="",k=0,O=[];for(v=0;v<p.length;++v)p[v][m]!=null&&O.push(p[v][m]);if(O.length==0||d[m]==null){b[m]="?";continue}for(v=0;v<O.length;++v){switch(typeof O[v]){case"number":_="B";break;case"string":_="C";break;case"boolean":_="L";break;case"object":_=O[v]instanceof Date?"D":"C";break;default:_="C"}k=Math.max(k,String(O[v]).length),E=E&&E!=_?"C":_}k>250&&(k=250),_=((x[m]||{}).DBF||{}).type,_=="C"&&x[m].DBF.len>k&&(k=x[m].DBF.len),E=="B"&&_=="N"&&(E="N",A[m]=x[m].DBF.dec,k=x[m].DBF.len),I[m]=E=="C"||_=="N"?k:s[E]||0,y+=I[m],b[m]=E}var H=u.next(32);for(H.write_shift(4,318902576),H.write_shift(4,p.length),H.write_shift(2,296+32*w),H.write_shift(2,y),m=0;m<4;++m)H.write_shift(4,0);for(H.write_shift(4,0|(+t[bv]||3)<<8),m=0,v=0;m<d.length;++m)if(d[m]!=null){var L=u.next(32),V=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,V,"sbcs"),L.write_shift(1,b[m]=="?"?"C":b[m],"sbcs"),L.write_shift(4,v),L.write_shift(1,I[m]||s[b[m]]||0),L.write_shift(1,A[m]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),v+=I[m]||s[b[m]]||0}var Y=u.next(264);for(Y.write_shift(4,13),m=0;m<65;++m)Y.write_shift(4,0);for(m=0;m<p.length;++m){var de=u.next(y);for(de.write_shift(1,0),v=0;v<d.length;++v)if(d[v]!=null)switch(b[v]){case"L":de.write_shift(1,p[m][v]==null?63:p[m][v]?84:70);break;case"B":de.write_shift(8,p[m][v]||0,"f");break;case"N":var me="0";for(typeof p[m][v]=="number"&&(me=p[m][v].toFixed(A[v]||0)),w=0;w<I[v]-me.length;++w)de.write_shift(1,32);de.write_shift(1,me,"sbcs");break;case"D":p[m][v]?(de.write_shift(4,("0000"+p[m][v].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(p[m][v].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+p[m][v].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(p[m][v]!=null?p[m][v]:"").slice(0,I[v]);for(de.write_shift(1,ie,"sbcs"),w=0;w<I[v]-ie.length;++w)de.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),Lw=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+$t(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var x=e[p];return typeof x=="number"?Pm(x):x},n=function(d,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?d:Pm(m)};e["|"]=254;function a(d,p){switch(p.type){case"base64":return s(nn(d),p);case"binary":return s(d,p);case"buffer":return s(tt&&Buffer.isBuffer(d)?d.toString("binary"):Xa(d),p);case"array":return s(Ts(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var x=d.split(/[\n\r]+/),m=-1,v=-1,w=0,y=0,g=[],b=[],I=null,A={},E=[],_=[],k=[],O=0,H;for(+p.codepage>=0&&On(+p.codepage);w!==x.length;++w){O=0;var L=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=L.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),Y=V[0],de;if(L.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&b.push(L.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,ie=!1,ee=!1,T=!1,q=-1,te=-1;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"A":break;case"X":v=parseInt(V[y].slice(1))-1,ie=!0;break;case"Y":for(m=parseInt(V[y].slice(1))-1,ie||(v=0),H=g.length;H<=m;++H)g[H]=[];break;case"K":de=V[y].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Dn(de))?isNaN(Pi(de).getDate())||(de=bt(de)):(de=Dn(de),I!==null&&$i(I)&&(de=Iu(de))),me=!0;break;case"E":T=!0;var C=bi(V[y].slice(1),{r:m,c:v});g[m][v]=[g[m][v],C];break;case"S":ee=!0,g[m][v]=[g[m][v],"S5S"];break;case"G":break;case"R":q=parseInt(V[y].slice(1))-1;break;case"C":te=parseInt(V[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}if(me&&(g[m][v]&&g[m][v].length==2?g[m][v][0]=de:g[m][v]=de,I=null),ee){if(T)throw new Error("SYLK shared formula cannot have own formula");var M=q>-1&&g[q][te];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");g[m][v][1]=ty(M[1],{r:m-q,c:v-te})}break;case"F":var W=0;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"X":v=parseInt(V[y].slice(1))-1,++W;break;case"Y":for(m=parseInt(V[y].slice(1))-1,H=g.length;H<=m;++H)g[H]=[];break;case"M":O=parseInt(V[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=b[parseInt(V[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=V[y].slice(1).split(" "),H=parseInt(k[0],10);H<=parseInt(k[1],10);++H)O=parseInt(k[2],10),_[H-1]=O===0?{hidden:!0}:{wch:O},Wa(_[H-1]);break;case"C":v=parseInt(V[y].slice(1))-1,_[v]||(_[v]={});break;case"R":m=parseInt(V[y].slice(1))-1,E[m]||(E[m]={}),O>0?(E[m].hpt=O,E[m].hpx=ji(O)):O===0&&(E[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}W<1&&(I=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}}return E.length>0&&(A["!rows"]=E),_.length>0&&(A["!cols"]=_),p&&p.sheetRows&&(g=g.slice(0,p.sheetRows)),[g,A]}function i(d,p){var x=a(d,p),m=x[0],v=x[1],w=Hi(m,p);return $t(v).forEach(function(y){w[y]=v[y]}),w}function o(d,p){return Ya(i(d,p),p)}function l(d,p,x,m){var v="C;Y"+(x+1)+";X"+(m+1)+";K";switch(d.t){case"n":v+=d.v||0,d.f&&!d.F&&(v+=";E"+Od(d.f,{r:x,c:m}));break;case"b":v+=d.v?"TRUE":"FALSE";break;case"e":v+=d.w||d.v;break;case"d":v+='"'+(d.w||d.v)+'"';break;case"s":v+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(d,p){p.forEach(function(x,m){var v="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?v+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=cl(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ul(x.wpx)),typeof x.wch=="number"&&(v+=Math.round(x.wch))),v.charAt(v.length-1)!=" "&&d.push(v)})}function u(d,p){p.forEach(function(x,m){var v="F;";x.hidden?v+="M0;":x.hpt?v+="M"+20*x.hpt+";":x.hpx&&(v+="M"+20*fl(x.hpx)+";"),v.length>2&&d.push(v+"R"+(m+1))})}function h(d,p){var x=["ID;PWXL;N;E"],m=[],v=ct(d["!ref"]),w,y=Array.isArray(d),g=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&c(x,d["!cols"]),d["!rows"]&&u(x,d["!rows"]),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var b=v.s.r;b<=v.e.r;++b)for(var I=v.s.c;I<=v.e.c;++I){var A=Ke({r:b,c:I});w=y?(d[b]||[])[I]:d[A],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,d,b,I))}return x.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),Mw=function(){function e(s,i){switch(i.type){case"base64":return t(nn(s),i);case"binary":return t(s,i);case"buffer":return t(tt&&Buffer.isBuffer(s)?s.toString("binary"):Xa(s),i);case"array":return t(Ts(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),p=d[0],x=d[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(Dn(x))?isNaN(Pi(x).getDate())?h[l][c]=x:h[l][c]=bt(x):h[l][c]=Dn(x),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(s,i){return Hi(e(s,i),i)}function n(s,i){return Ya(r(s,i),i)}var a=function(){var s=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},i=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=ct(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var m=Ke({r:p,c:x});if(h=d?(l[p]||[])[x]:l[m],!h){i(c,1,0,"");continue}switch(h.t){case"n":var v=h.w;!v&&h.v!=null&&(v=h.v),v==null?h.f&&!h.F?i(c,1,0,"="+h.f):i(c,1,0,""):i(c,0,v,"V");break;case"b":i(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=_n(h.z||qe[14],tr(bt(h.v)))),i(c,0,h.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var w=`\r
`,y=c.join(w);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Bw=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),x=-1,m=-1,v=0,w=[];v!==p.length;++v){var y=p[v].trim().split(":");if(y[0]==="cell"){var g=It(y[1]);if(w.length<=g.r)for(x=w.length;x<=g.r;++x)w[x]||(w[x]=[]);switch(x=g.r,m=g.c,y[2]){case"t":w[x][m]=e(y[3]);break;case"v":w[x][m]=+y[3];break;case"vtf":var b=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[x][m]=!!+y[4];break;default:w[x][m]=+y[4];break}y[2]=="vtf"&&(w[x][m]=[w[x][m],b])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return Hi(r(h,d),d)}function a(h,d){return Ya(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],x,m="",v=Vr(h["!ref"]),w=Array.isArray(h),y=v.s.r;y<=v.e.r;++y)for(var g=v.s.c;g<=v.e.c;++g)if(m=Ke({r:y,c:g}),x=w?(h[y]||[])[g]:h[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var b=tr(bt(x.v));p[2]="vtc",p[3]="nd",p[4]=""+b,p[5]=x.w||_n(x.z||qe[14],b);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[s,i,o,i,c(h),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Di=function(){function e(u,h,d,p,x){x.raw?h[d][p]=u:u===""||(u==="TRUE"?h[d][p]=!0:u==="FALSE"?h[d][p]=!1:isNaN(Dn(u))?isNaN(Pi(u).getDate())?h[d][p]=u:h[d][p]=bt(u):h[d][p]=Dn(u))}function t(u,h){var d=h||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var v=10,w=0,y=0;y<=m;++y)w=x[y].indexOf(" "),w==-1?w=x[y].length:w++,v=Math.max(v,w);for(y=0;y<=m;++y){p[y]=[];var g=0;for(e(x[y].slice(0,v).trim(),p,y,g,d),g=1;g<=(x[y].length-v)/10+1;++g)e(x[y].slice(v+(g-1)*10,v+g*10).trim(),p,y,g,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var h={},d=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?d=!d:!d&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[x.pop()[1]]||44}function s(u,h){var d=h||{},p="",x=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=a(u.slice(0,1024)):d&&d.FS?p=d.FS:p=a(u.slice(0,1024));var v=0,w=0,y=0,g=0,b=0,I=p.charCodeAt(0),A=!1,E=0,_=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var k=d.dateNF!=null?tT(d.dateNF):null;function O(){var H=u.slice(g,b),L={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)L.t="z";else if(d.raw)L.t="s",L.v=H;else if(H.trim().length===0)L.t="s",L.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(L.t="s",L.v=H.slice(2,-1).replace(/""/g,'"')):FN(H)?(L.t="n",L.f=H.slice(1)):(L.t="s",L.v=H);else if(H=="TRUE")L.t="b",L.v=!0;else if(H=="FALSE")L.t="b",L.v=!1;else if(!isNaN(y=Dn(H)))L.t="n",d.cellText!==!1&&(L.w=H),L.v=y;else if(!isNaN(Pi(H).getDate())||k&&H.match(k)){L.z=d.dateNF||qe[14];var V=0;k&&H.match(k)&&(H=rT(H,d.dateNF,H.match(k)||[]),V=1),d.cellDates?(L.t="d",L.v=bt(H,V)):(L.t="n",L.v=tr(bt(H,V))),d.cellText!==!1&&(L.w=_n(L.z,L.v instanceof Date?tr(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=H;if(L.t=="z"||(d.dense?(x[v]||(x[v]=[]),x[v][w]=L):x[Ke({c:w,r:v})]=L),g=b+1,_=u.charCodeAt(g),m.e.c<w&&(m.e.c=w),m.e.r<v&&(m.e.r=v),E==I)++w;else if(w=0,++v,d.sheetRows&&d.sheetRows<=v)return!0}e:for(;b<u.length;++b)switch(E=u.charCodeAt(b)){case 34:_===34&&(A=!A);break;case I:case 10:case 13:if(!A&&O())break e;break}return b-g>0&&O(),x["!ref"]=Ze(m),x}function i(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):Hi(t(u,h),h)}function o(u,h){var d="",p=h.type=="string"?[0,0,0,0]:Bd(u,h);switch(h.type){case"base64":d=nn(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof tl<"u"||(d=tt&&Buffer.isBuffer(u)?u.toString("binary"):Xa(u));break;case"array":d=Ts(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=gt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=gt(d):h.type=="binary"&&typeof tl<"u",d.slice(0,19)=="socialcalc:version:"?Bw.to_sheet(h.type=="string"?d:gt(d),h):i(d,h)}function l(u,h){return Ya(o(u,h),h)}function c(u){for(var h=[],d=ct(u["!ref"]),p,x=Array.isArray(u),m=d.s.r;m<=d.e.r;++m){for(var v=[],w=d.s.c;w<=d.e.c;++w){var y=Ke({r:m,c:w});if(p=x?(u[m]||[])[w]:u[y],!p||p.v==null){v.push("          ");continue}for(var g=(p.w||(fa(p),p.w)||"").slice(0,10);g.length<10;)g+=" ";v.push(g+(w===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function xC(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Lw.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Di.to_workbook(e,t)}}var vs=function(){function e(C,M,W){if(C){hr(C,C.l||0);for(var P=W.Enum||q;C.l<C.length;){var z=C.read_shift(2),he=P[z]||P[65535],ae=C.read_shift(2),se=C.l+ae,oe=he.f&&he.f(C,ae,W);if(C.l=se,M(oe,he,z))return}}}function t(C,M){switch(M.type){case"base64":return r(Qr(nn(C)),M);case"binary":return r(Qr(C),M);case"buffer":case"array":return r(C,M)}throw"Unsupported type "+M.type}function r(C,M){if(!C)return C;var W=M||{},P=W.dense?[]:{},z="Sheet1",he="",ae=0,se={},oe=[],ye=[],R={s:{r:0,c:0},e:{r:0,c:0}},Me=W.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)W.Enum=q,e(C,function(ue,be,He){switch(He){case 0:W.vers=ue,ue>=4096&&(W.qpro=!0);break;case 6:R=ue;break;case 204:ue&&(he=ue);break;case 222:he=ue;break;case 15:case 51:W.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:He==14&&(ue[2]&112)==112&&(ue[2]&15)>1&&(ue[2]&15)<15&&(ue[1].z=W.dateNF||qe[14],W.cellDates&&(ue[1].t="d",ue[1].v=Iu(ue[1].v))),W.qpro&&ue[3]>ae&&(P["!ref"]=Ze(R),se[z]=P,oe.push(z),P=W.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},ae=ue[3],z=he||"Sheet"+(ae+1),he="");var Xe=W.dense?(P[ue[0].r]||[])[ue[0].c]:P[Ke(ue[0])];if(Xe){Xe.t=ue[1].t,Xe.v=ue[1].v,ue[1].z!=null&&(Xe.z=ue[1].z),ue[1].f!=null&&(Xe.f=ue[1].f);break}W.dense?(P[ue[0].r]||(P[ue[0].r]=[]),P[ue[0].r][ue[0].c]=ue[1]):P[Ke(ue[0])]=ue[1];break}},W);else if(C[2]==26||C[2]==14)W.Enum=te,C[2]==14&&(W.qpro=!0,C.l=0),e(C,function(ue,be,He){switch(He){case 204:z=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>ae&&(P["!ref"]=Ze(R),se[z]=P,oe.push(z),P=W.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},ae=ue[3],z="Sheet"+(ae+1)),Me>0&&ue[0].r>=Me)break;W.dense?(P[ue[0].r]||(P[ue[0].r]=[]),P[ue[0].r][ue[0].c]=ue[1]):P[Ke(ue[0])]=ue[1],R.e.c<ue[0].c&&(R.e.c=ue[0].c),R.e.r<ue[0].r&&(R.e.r=ue[0].r);break;case 27:ue[14e3]&&(ye[ue[14e3][0]]=ue[14e3][1]);break;case 1537:ye[ue[0]]=ue[1],ue[0]==ae&&(z=ue[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(P["!ref"]=Ze(R),se[he||z]=P,oe.push(he||z),!ye.length)return{SheetNames:oe,Sheets:se};for(var U={},re=[],J=0;J<ye.length;++J)se[oe[J]]?(re.push(ye[J]||oe[J]),U[ye[J]]=se[ye[J]]||se[oe[J]]):(re.push(ye[J]),U[ye[J]]={"!ref":"A1"});return{SheetNames:re,Sheets:U}}function n(C,M){var W=M||{};if(+W.codepage>=0&&On(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var P=zr(),z=ct(C["!ref"]),he=Array.isArray(C),ae=[];Te(P,0,s(1030)),Te(P,6,l(z));for(var se=Math.min(z.e.r,8191),oe=z.s.r;oe<=se;++oe)for(var ye=zt(oe),R=z.s.c;R<=z.e.c;++R){oe===z.s.r&&(ae[R]=Rt(R));var Me=ae[R]+ye,U=he?(C[oe]||[])[R]:C[Me];if(!(!U||U.t=="z"))if(U.t=="n")(U.v|0)==U.v&&U.v>=-32768&&U.v<=32767?Te(P,13,p(oe,R,U.v)):Te(P,14,m(oe,R,U.v));else{var re=fa(U);Te(P,15,h(oe,R,re.slice(0,239)))}}return Te(P,1),P.end()}function a(C,M){var W=M||{};if(+W.codepage>=0&&On(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var P=zr();Te(P,0,i(C));for(var z=0,he=0;z<C.SheetNames.length;++z)(C.Sheets[C.SheetNames[z]]||{})["!ref"]&&Te(P,27,T(C.SheetNames[z],he++));var ae=0;for(z=0;z<C.SheetNames.length;++z){var se=C.Sheets[C.SheetNames[z]];if(!(!se||!se["!ref"])){for(var oe=ct(se["!ref"]),ye=Array.isArray(se),R=[],Me=Math.min(oe.e.r,8191),U=oe.s.r;U<=Me;++U)for(var re=zt(U),J=oe.s.c;J<=oe.e.c;++J){U===oe.s.r&&(R[J]=Rt(J));var ue=R[J]+re,be=ye?(se[U]||[])[J]:se[ue];if(!(!be||be.t=="z"))if(be.t=="n")Te(P,23,O(U,J,ae,be.v));else{var He=fa(be);Te(P,22,E(U,J,ae,He.slice(0,239)))}}++ae}}return Te(P,1),P.end()}function s(C){var M=le(2);return M.write_shift(2,C),M}function i(C){var M=le(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var W=0,P=0,z=0,he=0;he<C.SheetNames.length;++he){var ae=C.SheetNames[he],se=C.Sheets[ae];if(!(!se||!se["!ref"])){++z;var oe=Vr(se["!ref"]);W<oe.e.r&&(W=oe.e.r),P<oe.e.c&&(P=oe.e.c)}}return W>8191&&(W=8191),M.write_shift(2,W),M.write_shift(1,z),M.write_shift(1,P),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function o(C,M,W){var P={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&W.qpro?(P.s.c=C.read_shift(1),C.l++,P.s.r=C.read_shift(2),P.e.c=C.read_shift(1),C.l++,P.e.r=C.read_shift(2),P):(P.s.c=C.read_shift(2),P.s.r=C.read_shift(2),M==12&&W.qpro&&(C.l+=2),P.e.c=C.read_shift(2),P.e.r=C.read_shift(2),M==12&&W.qpro&&(C.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(C){var M=le(8);return M.write_shift(2,C.s.c),M.write_shift(2,C.s.r),M.write_shift(2,C.e.c),M.write_shift(2,C.e.r),M}function c(C,M,W){var P=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(P[0].c=C.read_shift(1),P[3]=C.read_shift(1),P[0].r=C.read_shift(2),C.l+=2):(P[2]=C.read_shift(1),P[0].c=C.read_shift(2),P[0].r=C.read_shift(2)),P}function u(C,M,W){var P=C.l+M,z=c(C,M,W);if(z[1].t="s",W.vers==20768){C.l++;var he=C.read_shift(1);return z[1].v=C.read_shift(he,"utf8"),z}return W.qpro&&C.l++,z[1].v=C.read_shift(P-C.l,"cstr"),z}function h(C,M,W){var P=le(7+W.length);P.write_shift(1,255),P.write_shift(2,M),P.write_shift(2,C),P.write_shift(1,39);for(var z=0;z<P.length;++z){var he=W.charCodeAt(z);P.write_shift(1,he>=128?95:he)}return P.write_shift(1,0),P}function d(C,M,W){var P=c(C,M,W);return P[1].v=C.read_shift(2,"i"),P}function p(C,M,W){var P=le(7);return P.write_shift(1,255),P.write_shift(2,M),P.write_shift(2,C),P.write_shift(2,W,"i"),P}function x(C,M,W){var P=c(C,M,W);return P[1].v=C.read_shift(8,"f"),P}function m(C,M,W){var P=le(13);return P.write_shift(1,255),P.write_shift(2,M),P.write_shift(2,C),P.write_shift(8,W,"f"),P}function v(C,M,W){var P=C.l+M,z=c(C,M,W);if(z[1].v=C.read_shift(8,"f"),W.qpro)C.l=P;else{var he=C.read_shift(2);b(C.slice(C.l,C.l+he),z),C.l+=he}return z}function w(C,M,W){var P=M&32768;return M&=-32769,M=(P?C:0)+(M>=8192?M-16384:M),(P?"":"$")+(W?Rt(M):zt(M))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(C,M){hr(C,0);for(var W=[],P=0,z="",he="",ae="",se="";C.l<C.length;){var oe=C[C.l++];switch(oe){case 0:W.push(C.read_shift(8,"f"));break;case 1:he=w(M[0].c,C.read_shift(2),!0),z=w(M[0].r,C.read_shift(2),!1),W.push(he+z);break;case 2:{var ye=w(M[0].c,C.read_shift(2),!0),R=w(M[0].r,C.read_shift(2),!1);he=w(M[0].c,C.read_shift(2),!0),z=w(M[0].r,C.read_shift(2),!1),W.push(ye+R+":"+he+z)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(C.read_shift(2));break;case 6:{for(var Me="";oe=C[C.l++];)Me+=String.fromCharCode(oe);W.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:se=W.pop(),ae=W.pop(),W.push(["AND","OR"][oe-20]+"("+ae+","+se+")");break;default:if(oe<32&&g[oe])se=W.pop(),ae=W.pop(),W.push(ae+g[oe]+se);else if(y[oe]){if(P=y[oe][1],P==69&&(P=C[C.l++]),P>W.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+W.join("|")+"|");return}var U=W.slice(-P);W.length-=P,W.push(y[oe][0]+"("+U.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}W.length==1?M[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function I(C){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=C.read_shift(2),M[3]=C[C.l++],M[0].c=C[C.l++],M}function A(C,M){var W=I(C);return W[1].t="s",W[1].v=C.read_shift(M-4,"cstr"),W}function E(C,M,W,P){var z=le(6+P.length);z.write_shift(2,C),z.write_shift(1,W),z.write_shift(1,M),z.write_shift(1,39);for(var he=0;he<P.length;++he){var ae=P.charCodeAt(he);z.write_shift(1,ae>=128?95:ae)}return z.write_shift(1,0),z}function _(C,M){var W=I(C);W[1].v=C.read_shift(2);var P=W[1].v>>1;if(W[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return W[1].v=P,W}function k(C,M){var W=I(C),P=C.read_shift(4),z=C.read_shift(4),he=C.read_shift(2);if(he==65535)return P===0&&z===3221225472?(W[1].t="e",W[1].v=15):P===0&&z===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var ae=he&32768;return he=(he&32767)-16446,W[1].v=(1-ae*2)*(z*Math.pow(2,he+32)+P*Math.pow(2,he)),W}function O(C,M,W,P){var z=le(14);if(z.write_shift(2,C),z.write_shift(1,W),z.write_shift(1,M),P==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var he=0,ae=0,se=0,oe=0;return P<0&&(he=1,P=-P),ae=Math.log2(P)|0,P/=Math.pow(2,ae-31),oe=P>>>0,oe&2147483648||(P/=2,++ae,oe=P>>>0),P-=oe,oe|=2147483648,oe>>>=0,P*=Math.pow(2,32),se=P>>>0,z.write_shift(4,se),z.write_shift(4,oe),ae+=16383+(he?32768:0),z.write_shift(2,ae),z}function H(C,M){var W=k(C);return C.l+=M-14,W}function L(C,M){var W=I(C),P=C.read_shift(4);return W[1].v=P>>6,W}function V(C,M){var W=I(C),P=C.read_shift(8,"f");return W[1].v=P,W}function Y(C,M){var W=V(C);return C.l+=M-10,W}function de(C,M){return C[C.l+M-1]==0?C.read_shift(M,"cstr"):""}function me(C,M){var W=C[C.l++];W>M-1&&(W=M-1);for(var P="";P.length<W;)P+=String.fromCharCode(C[C.l++]);return P}function ie(C,M,W){if(!(!W.qpro||M<21)){var P=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var z=C.read_shift(M-21,"cstr");return[P,z]}}function ee(C,M){for(var W={},P=C.l+M;C.l<P;){var z=C.read_shift(2);if(z==14e3){for(W[z]=[0,""],W[z][0]=C.read_shift(2);C[C.l];)W[z][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return W}function T(C,M){var W=le(5+C.length);W.write_shift(2,14e3),W.write_shift(2,M);for(var P=0;P<C.length;++P){var z=C.charCodeAt(P);W[W.l++]=z>127?95:z}return W[W.l++]=0,W}var q={0:{n:"BOF",f:Kt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:_},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function gC(e){var t={},r=e.match(Nr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ye(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=rd[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var vC=function(){var e=al("t"),t=al("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:lt(i[1])},l=s.match(t);return l&&(o.s=gC(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),wC=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),yC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_C=/<(?:\w+:)?r>/,kC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Td(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=gt(e),r&&(n.h=hd(n.t))):e.match(_C)&&(n.r=gt(e),n.t=lt(gt((e.replace(kC,"").match(yC)||[]).join("").replace(Nr,""))),r&&(n.h=wC(vC(n.r)))),n):{t:""}}var EC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,SC=/<(?:\w+:)?(?:si|sstItem)>/g,bC=/<\/(?:\w+:)?(?:si|sstItem)>/;function TC(e,t){var r=[],n="";if(!e)return r;var a=e.match(EC);if(a){n=a[2].replace(SC,"").split(bC);for(var s=0;s!=n.length;++s){var i=Td(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ye(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var CC=/^\s|\s$|[\t\n\r]/;function Uw(e,t){if(!t.bookSST)return"";var r=[Vt];r[r.length]=Se("sst",null,{xmlns:Is[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(CC)&&(s+=' xml:space="preserve"'),s+=">"+mt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function AC(e){return[e.read_shift(4),e.read_shift(4)]}function NC(e,t){var r=[],n=!1;return ma(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function FC(e,t){return t||(t=le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var OC=$T;function RC(e){var t=zr();pe(t,159,FC(e));for(var r=0;r<e.length;++r)pe(t,19,OC(e[r]));return pe(t,160),t.end()}function $w(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ia(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function IC(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ia(e,4),t.U=ia(e,4),t.W=ia(e,4),t}function PC(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function DC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(PC(e));return t}function jC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function LC(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ia(e,4),t.U=ia(e,4),t.W=ia(e,4),t}function MC(e){var t=LC(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Ww(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Hw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function BC(e){var t=ia(e);switch(t.Minor){case 2:return[t.Minor,UC(e)];case 3:return[t.Minor,$C()];case 4:return[t.Minor,WC(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function UC(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Ww(e,r),a=Hw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function $C(){throw new Error("File is password-protected: ECMA-376 Extensible")}function WC(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Nr,function(s){var i=Ye(s);switch(qn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function HC(e,t){var r={},n=r.EncryptionVersionInfo=ia(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Ww(e,a),t-=a,r.EncryptionVerifier=Hw(e,t),r}function zC(e){var t={},r=t.EncryptionVersionInfo=ia(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Cd(e){var t=0,r,n=$w(e),a=n.length+1,s,i,o,l,c;for(r=$a(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var zw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=$w(i),l=s(o),c=o.length,u=$a(16),h=0;h!=16;++h)u[h]=0;var d,p,x;for((c&1)===1&&(d=l>>8,u[c]=a(e[0],d),--c,d=l&255,p=o[o.length-1],u[c]=a(p,d));c>0;)--c,d=l>>8,u[c]=a(o[c],d),--c,d=l&255,u[c]=a(o[c],d);for(c=15,x=15-o.length;x>0;)d=l>>8,u[c]=a(e[x],d),--c,--x,d=l&255,u[c]=a(o[c],d),--c,--x;return u}}(),VC=function(e,t,r,n,a){a||(a=t),n||(n=zw(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},GC=function(e){var t=0,r=zw(e);return function(n){var a=VC("",n,t,r);return t=a[1],a[0]}};function qC(e,t,r,n){var a={key:Kt(e),verificationBytes:Kt(e)};return r.password&&(a.verifier=Cd(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=GC(r.password)),a}function KC(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=zC(e):n.Data=HC(e,t),n}function XC(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?KC(e,t-2,n):qC(e,r.biff>=8?t:t-2,r,n),n}var Vw=function(){function e(a,s){switch(s.type){case"base64":return t(nn(a),s);case"binary":return t(a,s);case"buffer":return t(tt&&Buffer.isBuffer(a)?a.toString("binary"):Xa(a),s);case"array":return t(Ts(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,x,m=-1;x=d.exec(u);){switch(x[0]){case"\\cell":var v=u.slice(p,d.lastIndex-x[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var w={v,t:"s"};Array.isArray(o)?o[h][m]=w:o[Ke({r:h,c:m})]=w}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ze(c),o}function r(a,s){return Ya(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=ct(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var h=Ke({r:c,c:u});o=l?(a[c]||[])[u]:a[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(fa(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function YC(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ll(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function JC(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function QC(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function iu(e,t){if(t===0)return e;var r=JC(YC(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ll(QC(r))}var Gw=6,ZC=15,eA=1,Sr=Gw;function cl(e){return Math.floor((e+Math.round(128/Sr)/256)*Sr)}function ul(e){return Math.floor((e-5)/Sr*100+.5)/100}function ou(e){return Math.round((e*Sr+5)/Sr*256)/256}function C0(e){return ou(ul(cl(e)))}function Ad(e){var t=Math.abs(e-C0(e)),r=Sr;if(t>.005)for(Sr=eA;Sr<ZC;++Sr)Math.abs(e-C0(e))<=t&&(t=Math.abs(e-C0(e)),r=Sr);Sr=r}function Wa(e){e.width?(e.wpx=cl(e.width),e.wch=ul(e.wpx),e.MDW=Sr):e.wpx?(e.wch=ul(e.wpx),e.width=ou(e.wch),e.MDW=Sr):typeof e.wch=="number"&&(e.width=ou(e.wch),e.wpx=cl(e.width),e.MDW=Sr),e.customWidth&&delete e.customWidth}var tA=96,qw=tA;function fl(e){return e*96/qw}function ji(e){return e*qw/96}var rA={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function nA(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Nr)||[]).forEach(function(i){var o=Ye(i);switch(qn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Et(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Et(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function aA(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Nr)||[]).forEach(function(i){var o=Ye(i);switch(qn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function sA(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Nr)||[]).forEach(function(i){var o=Ye(i);switch(qn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=gt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Et(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Et(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Et(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Et(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Et(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Et(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Et(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=rd[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Et(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=xs[a.color.index];a.color.index==81&&(l=xs[1]),l||(l=xs[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=iu(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function iA(e,t,r){t.NumberFmt=[];for(var n=$t(qe),a=0;a<n.length;++a)t.NumberFmt[n[a]]=qe[n[a]];var s=e[0].match(Nr);if(s)for(a=0;a<s.length;++a){var i=Ye(s[a]);switch(qn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=lt(gt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}sa(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function oA(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Se("numFmt",null,{numFmtId:n,formatCode:mt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var sc=["numFmtId","fillId","fontId","borderId","xfId"],ic=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function lA(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Nr)||[]).forEach(function(s){var i=Ye(s),o=0;switch(qn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<sc.length;++o)n[sc[o]]&&(n[sc[o]]=parseInt(n[sc[o]],10));for(o=0;o<ic.length;++o)n[ic[o]]&&(n[ic[o]]=Et(n[ic[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Et(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function cA(e){var t=[];return t[t.length]=Se("cellXfs",null),e.forEach(function(r){t[t.length]=Se("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var uA=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&iA(h,u,c),(h=o.match(a))&&sA(h,u,l,c),(h=o.match(n))&&aA(h,u,l,c),(h=o.match(s))&&nA(h,u,l,c),(h=o.match(r))&&lA(h,u,c),u}}();function Kw(e,t){var r=[Vt,Se("styleSheet",null,{xmlns:Is[0],"xmlns:vt":Zt.vt})],n;return e.SSF&&(n=oA(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=cA(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function fA(e,t){var r=e.read_shift(2),n=Tr(e);return[r,n]}function hA(e,t,r){r||(r=le(6+4*t.length)),r.write_shift(2,e),ir(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function dA(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=KT(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=qT(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Tr(e),n}function pA(e,t){t||(t=le(25+4*32)),t.write_shift(2,e.sz*20),XT(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),nu(e.color,t);var n=0;return n=2,t.write_shift(1,n),ir(e.name,t),t.length>t.l?t.slice(0,t.l):t}var mA=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],A0,xA=Ar;function Sx(e,t){t||(t=le(4*3+8*7+16*1)),A0||(A0=Ou(mA));var r=A0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(nu({auto:1},t),nu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function gA(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Xw(e,t,r){r||(r=le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function no(e,t){return t||(t=le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var vA=Ar;function wA(e,t){return t||(t=le(51)),t.write_shift(1,0),no(null,t),no(null,t),no(null,t),no(null,t),no(null,t),t.length>t.l?t.slice(0,t.l):t}function yA(e,t){return t||(t=le(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ru(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function _A(e,t,r){var n=le(2052);return n.write_shift(4,e),ru(t,n),ru(r,n),n.length>n.l?n.slice(0,n.l):n}function kA(e,t,r){var n={};n.NumberFmt=[];for(var a in qe)n.NumberFmt[a]=qe[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return ma(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],sa(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=iu(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function EA(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(pe(e,615,jn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&pe(e,44,hA(a,t[a]))}),pe(e,616))}}function SA(e){var t=1;pe(e,611,jn(t)),pe(e,43,pA({sz:12,color:{theme:1},name:"Calibri",family:2})),pe(e,612)}function bA(e){var t=2;pe(e,603,jn(t)),pe(e,45,Sx({patternType:"none"})),pe(e,45,Sx({patternType:"gray125"})),pe(e,604)}function TA(e){var t=1;pe(e,613,jn(t)),pe(e,46,wA()),pe(e,614)}function CA(e){var t=1;pe(e,626,jn(t)),pe(e,47,Xw({numFmtId:0},65535)),pe(e,627)}function AA(e,t){pe(e,617,jn(t.length)),t.forEach(function(r){pe(e,47,Xw(r,0))}),pe(e,618)}function NA(e){var t=1;pe(e,619,jn(t)),pe(e,48,yA({xfId:0,name:"Normal"})),pe(e,620)}function FA(e){var t=0;pe(e,505,jn(t)),pe(e,506)}function OA(e){var t=0;pe(e,508,_A(t,"TableStyleMedium9","PivotStyleMedium4")),pe(e,509)}function RA(e,t){var r=zr();return pe(r,278),EA(r,e.SSF),SA(r),bA(r),TA(r),CA(r),AA(r,t.cellXfs),NA(r),FA(r),OA(r),pe(r,279),r.end()}var IA=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function PA(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Nr)||[]).forEach(function(a){var s=Ye(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[IA.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function DA(){}function jA(){}var LA=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MA=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,BA=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UA(e,t,r){t.themeElements={};var n;[["clrScheme",LA,PA],["fontScheme",MA,DA],["fmtScheme",BA,jA]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var $A=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Yw(e,t){(!e||e.length===0)&&(e=Nd());var r,n={};if(!(r=e.match($A)))throw new Error("themeElements not found in theme");return UA(r[0],n,t),n.raw=e,n}function Nd(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Vt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function WA(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=Wv(s,{type:"array"})}catch{return}var o=Zr(i,"theme/theme/theme1.xml",!0);if(o)return Yw(o,r)}}function HA(e){return e.read_shift(4)}function zA(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=VA(e,4);break;case 2:t.xclrValue=Nw(e);break;case 3:t.xclrValue=HA(e);break;case 4:e.l+=4;break}return e.l+=8,t}function VA(e,t){return Ar(e,t)}function GA(e,t){return Ar(e,t)}function qA(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=zA(e);break;case 6:n[1]=GA(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function KA(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(qA(e,r-e.l));return{ixfe:n,ext:s}}function XA(e,t){t.forEach(function(r){switch(r[0]){}})}function YA(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Tr(e)}}function JA(e){var t=le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ir(e.name,t),t.slice(0,t.l)}function QA(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function ZA(e){var t=le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function eN(e,t){var r=le(8+2*t.length);return r.write_shift(4,e),ir(t,r),r.slice(0,r.l)}function tN(e){return e.l+=4,e.read_shift(4)!=0}function rN(e,t){var r=le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function nN(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return ma(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function aN(){var e=zr();return pe(e,332),pe(e,334,jn(1)),pe(e,335,JA({name:"XLDAPR",version:12e4,flags:3496657072})),pe(e,336),pe(e,339,eN(1,"XLDAPR")),pe(e,52),pe(e,35,jn(514)),pe(e,4096,jn(0)),pe(e,4097,dn(1)),pe(e,36),pe(e,53),pe(e,340),pe(e,337,rN(1)),pe(e,51,ZA([[1,0]])),pe(e,338),pe(e,333),e.end()}function sN(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Nr,function(o){var l=Ye(o);switch(qn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Jw(){var e=[Vt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function iN(e){var t=[];if(!e)return t;var r=1;return(e.match(Nr)||[]).forEach(function(n){var a=Ye(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function oN(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ke(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function lN(e,t,r){var n=[];return ma(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function cN(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ma(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function uN(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var mi=1024;function Qw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Se("xml",null,{"xmlns:v":Kr.v,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:mv":Kr.mv}).replace(/\/>/,">"),Se("o:shapelayout",Se("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Se("v:shapetype",[Se("v:stroke",null,{joinstyle:"miter"}),Se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];mi<e*1e3;)mi+=1e3;return t.forEach(function(s){var i=It(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Se("v:fill",l,o),u={on:"t",obscured:"t"};++mi,a=a.concat(["<v:shape"+sl({id:"_x0000_s"+mi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Se("v:shadow",null,u),Se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",dr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),dr("x:AutoFill","False"),dr("x:Row",String(i.r)),dr("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function bx(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=It(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=ct(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ze(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function fN(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ye(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=It(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Td(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function Zw(e){var t=[Vt,Se("comments",null,{xmlns:Is[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=mt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(mt(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(dr("t",mt(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(dr("t",mt(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function hN(e,t){var r=[],n=!1,a={},s=0;return e.replace(Nr,function(o,l){var c=Ye(o);switch(qn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function dN(e,t,r){var n=[Vt,Se("ThreadedComments",null,{xmlns:Zt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Se("threadedComment",dr("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function pN(e,t){var r=[],n=!1;return e.replace(Nr,function(s){var i=Ye(s);switch(qn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function mN(e){var t=[Vt,Se("personList",null,{xmlns:Zt.TCMNT,"xmlns:x":Is[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Se("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function xN(e){var t={};t.iauthor=e.read_shift(4);var r=Ls(e);return t.rfx=r.s,t.ref=Ke(r.s),e.l+=16,t}function gN(e,t){return t==null&&(t=le(36)),t.write_shift(4,e[1].iauthor),zi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var vN=Tr;function wN(e){return ir(e.slice(0,54))}function yN(e,t){var r=[],n=[],a={},s=!1;return ma(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function _N(e){var t=zr(),r=[];return pe(t,628),pe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),pe(t,632,wN(a.a)))})}),pe(t,631),pe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:It(n[0]),e:It(n[0])};pe(t,635,gN([s,a])),a.t&&a.t.length>0&&pe(t,637,HT(a)),pe(t,636),delete a.iauthor})}),pe(t,634),pe(t,629),t.end()}var kN="application/vnd.ms-office.vbaProject";function EN(e){var t=Ue.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ue.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ue.write(t)}function SN(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ue.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var ey=["xlsb","xlsm","xlam","biff8","xla"];function bN(){return{"!type":"dialog"}}function TN(){return{"!type":"dialog"}}function CN(){return{"!type":"macro"}}function AN(){return{"!type":"macro"}}var bi=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+Rt(u)+(l?"":"$")+zt(c)}return function(a,s){return t=s,a.replace(e,r)}}(),Fd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Od=function(){return function(t,r){return t.replace(Fd,function(n,a,s,i,o,l){var c=gd(i)-(s?0:r.c),u=xd(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return a+"R"+h+"C"+d})}}();function ty(e,t){return e.replace(Fd,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Rt(gd(s)+t.c))+(i=="$"?i+o:zt(xd(o)+t.r))})}function NN(e,t,r){var n=Vr(t),a=n.s,s=It(r),i={r:s.r-a.r,c:s.c-a.c};return ty(e,i)}function FN(e){return e.length!=1}function Tx(e){return e.replace(/_xlfn\./g,"")}function Gt(e){e.l+=1}function Ha(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ry(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ny(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Ha(e),o=Ha(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ny(e){var t=Ha(e),r=Ha(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function ON(e,t,r){if(r.biff<8)return ny(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Ha(e),i=Ha(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function ay(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return RN(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Ha(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function RN(e){var t=Ha(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function IN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function PN(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return DN(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function DN(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function jN(e,t,r){var n=(e[e.l++]&96)>>5,a=ry(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function LN(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=ry(e,s,r);return[n,a,i]}function MN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function BN(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function UN(e,t,r){var n=(e[e.l++]&96)>>5,a=ON(e,t-1,r);return[n,a]}function $N(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Cx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function WN(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function HN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function zN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function VN(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function GN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function sy(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function qN(e){return e.read_shift(2),sy(e)}function KN(e){return e.read_shift(2),sy(e)}function XN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=ay(e,0,r);return[n,a]}function YN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=PN(e,0,r);return[n,a]}function JN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=ay(e,0,r);return[n,a,s]}function QN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[t6[a],ly[a],n]}function ZN(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:eF(e);return[a,(s[0]===0?ly:e6)[s[1]]]}function eF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function tF(e,t,r){e.l+=r&&r.biff==2?3:4}function rF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function nF(e){return e.l++,xa[e.read_shift(1)]}function aF(e){return e.l++,e.read_shift(2)}function sF(e){return e.l++,e.read_shift(1)!==0}function iF(e){return e.l++,br(e)}function oF(e,t,r){return e.l++,Sl(e,t-1,r)}function lF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Wt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=br(e);break;case 2:r[1]=Ms(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function cF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Ls:Pu)(e));return a}function uF(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=lF(e,r.biff);return i}function fF(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function hF(e,t,r){if(r.biff==5)return dF(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function dF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function pF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function mF(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function xF(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function gF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var vF=Ar,wF=Ar,yF=Ar;function Tl(e,t,r){return e.l+=2,[IN(e)]}function Rd(e){return e.l+=6,[]}var _F=Tl,kF=Rd,EF=Rd,SF=Tl;function iy(e){return e.l+=2,[Kt(e),e.read_shift(2)&1]}var bF=Tl,TF=iy,CF=Rd,AF=Tl,NF=Tl,FF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function OF(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=FF[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function RF(e){return e.l+=2,[e.read_shift(4)]}function IF(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function PF(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function DF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function LF(e){return e.l+=4,[0,0]}var Ax={1:{n:"PtgExp",f:rF},2:{n:"PtgTbl",f:yF},3:{n:"PtgAdd",f:Gt},4:{n:"PtgSub",f:Gt},5:{n:"PtgMul",f:Gt},6:{n:"PtgDiv",f:Gt},7:{n:"PtgPower",f:Gt},8:{n:"PtgConcat",f:Gt},9:{n:"PtgLt",f:Gt},10:{n:"PtgLe",f:Gt},11:{n:"PtgEq",f:Gt},12:{n:"PtgGe",f:Gt},13:{n:"PtgGt",f:Gt},14:{n:"PtgNe",f:Gt},15:{n:"PtgIsect",f:Gt},16:{n:"PtgUnion",f:Gt},17:{n:"PtgRange",f:Gt},18:{n:"PtgUplus",f:Gt},19:{n:"PtgUminus",f:Gt},20:{n:"PtgPercent",f:Gt},21:{n:"PtgParen",f:Gt},22:{n:"PtgMissArg",f:Gt},23:{n:"PtgStr",f:oF},26:{n:"PtgSheet",f:IF},27:{n:"PtgEndSheet",f:PF},28:{n:"PtgErr",f:nF},29:{n:"PtgBool",f:sF},30:{n:"PtgInt",f:aF},31:{n:"PtgNum",f:iF},32:{n:"PtgArray",f:$N},33:{n:"PtgFunc",f:QN},34:{n:"PtgFuncVar",f:ZN},35:{n:"PtgName",f:fF},36:{n:"PtgRef",f:XN},37:{n:"PtgArea",f:jN},38:{n:"PtgMemArea",f:pF},39:{n:"PtgMemErr",f:vF},40:{n:"PtgMemNoMem",f:wF},41:{n:"PtgMemFunc",f:mF},42:{n:"PtgRefErr",f:xF},43:{n:"PtgAreaErr",f:MN},44:{n:"PtgRefN",f:YN},45:{n:"PtgAreaN",f:UN},46:{n:"PtgMemAreaN",f:DF},47:{n:"PtgMemNoMemN",f:jF},57:{n:"PtgNameX",f:hF},58:{n:"PtgRef3d",f:JN},59:{n:"PtgArea3d",f:LN},60:{n:"PtgRefErr3d",f:gF},61:{n:"PtgAreaErr3d",f:BN},255:{}},MF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},BF={1:{n:"PtgElfLel",f:iy},2:{n:"PtgElfRw",f:AF},3:{n:"PtgElfCol",f:_F},6:{n:"PtgElfRwV",f:NF},7:{n:"PtgElfColV",f:SF},10:{n:"PtgElfRadical",f:bF},11:{n:"PtgElfRadicalS",f:CF},13:{n:"PtgElfColS",f:kF},15:{n:"PtgElfColSV",f:EF},16:{n:"PtgElfRadicalLel",f:TF},25:{n:"PtgList",f:OF},29:{n:"PtgSxName",f:RF},255:{}},UF={0:{n:"PtgAttrNoop",f:LF},1:{n:"PtgAttrSemi",f:GN},2:{n:"PtgAttrIf",f:zN},4:{n:"PtgAttrChoose",f:WN},8:{n:"PtgAttrGoto",f:HN},16:{n:"PtgAttrSum",f:tF},32:{n:"PtgAttrBaxcel",f:Cx},33:{n:"PtgAttrBaxcel",f:Cx},64:{n:"PtgAttrSpace",f:qN},65:{n:"PtgAttrSpaceSemi",f:KN},128:{n:"PtgAttrIfError",f:VN},255:{}};function Cl(e,t,r,n){if(n.biff<8)return Ar(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=uF(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=cF(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Ar(e,t)),s}function Al(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Ax[s]||Ax[MF[s]],(s===24||s===25)&&(a=(s===24?BF:UF)[e[e.l+1]]),!a||!a.f?Ar(e,t):i.push([a.n,a.f(e,t,r)]);return i}function $F(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var WF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HF(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function oy(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Nx(e,t,r){var n=oy(e,t,r);return n=="#REF"?n:HF(n,r)}function kr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,c,u,h=0,d=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",w=0,y=e[0].length;w<y;++w){var g=e[0][w];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=Bt(" ",e[0][m][1][1]);break;case 1:v=Bt("\r",e[0][m][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+v,m=-1}o.push(c+WF[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=bo(g[1][1],i,a),o.push(To(u,s));break;case"PtgRefN":u=r?bo(g[1][1],r,a):g[1][1],o.push(To(u,s));break;case"PtgRef3d":h=g[1][1],u=bo(g[1][2],i,a),x=Nx(n,h,a),o.push(x+"!"+To(u,s));break;case"PtgFunc":case"PtgFuncVar":var b=g[1][0],I=g[1][1];b||(b=0),b&=127;var A=b==0?[]:o.slice(-b);o.length-=b,I==="User"&&(I=A.shift()),o.push(I+"("+A.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":p=ax(g[1][1],r?{s:r}:i,a),o.push(S0(p,a));break;case"PtgArea":p=ax(g[1][1],i,a),o.push(S0(p,a));break;case"PtgArea3d":h=g[1][1],p=g[1][2],x=Nx(n,h,a),o.push(x+"!"+S0(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=g[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],_=E?E.Name:"SH33TJSNAME"+String(d);_&&_.slice(0,6)=="_xlfn."&&!a.xlfn&&(_=_.slice(6)),o.push(_);break;case"PtgNameX":var k=g[1][1];d=g[1][2];var O;if(a.biff<=5)k<0&&(k=-k),n[k]&&(O=n[k][d]);else{var H="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][d]&&n[k][d].itab>0&&(H=n.SheetNames[n[k][d].itab-1]+"!"):H=n.SheetNames[d-1]+"!"),n[k]&&n[k][d])H+=n[k][d].Name;else if(n[0]&&n[0][d])H+=n[0][d].Name;else{var L=(oy(n,k,a)||"").split(";;");L[d-1]?H=L[d-1]:H+="SH33TJSERRX"}o.push(H);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var V="(",Y=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:V=Bt(" ",e[0][m][1][1])+V;break;case 3:V=Bt("\r",e[0][m][1][1])+V;break;case 4:Y=Bt(" ",e[0][m][1][1])+Y;break;case 5:Y=Bt("\r",e[0][m][1][1])+Y;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(V+o.pop()+Y);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:g[1][1],r:g[1][0]};var de={c:r.c,r:r.r};if(n.sharedf[Ke(u)]){var me=n.sharedf[Ke(u)];o.push(kr(me,i,de,n,a))}else{var ie=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(kr(c[1],i,de,n,a)),ie=!0;break}ie||o.push(g[1])}break;case"PtgArray":o.push("{"+$F(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&ee.indexOf(e[0][w][0])==-1){g=e[0][m];var T=!0;switch(g[1][0]){case 4:T=!1;case 0:v=Bt(" ",g[1][1]);break;case 5:T=!1;case 1:v=Bt("\r",g[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((T?v:"")+o.pop()+(T?"":v)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function zF(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Ar(e,t-2)];var o=Al(e,i,r);return t!==i+a&&(s=Cl(e,t-i-a,o,r)),e.l=n,[o,s]}function VF(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Ar(e,t-2)];var o=Al(e,i,r);return t!==i+a&&(s=Cl(e,t-i-a,o,r)),e.l=n,[o,s]}function GF(e,t,r,n){var a=e.l+t,s=Al(e,n,r),i;return a!==e.l&&(i=Cl(e,a-e.l,s,r)),[s,i]}function qF(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Al(e,s,r);return s==65535?[[],Ar(e,t-2)]:(t!==s+2&&(a=Cl(e,n-s-2,i,r)),[i,a])}function KF(e){var t;if(ra(e,e.l+6)!==65535)return[br(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function XF(e){if(e==null){var t=le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Cs(e);return Cs(0)}function N0(e,t,r){var n=e.l+t,a=Kn(e);r.biff==2&&++e.l;var s=KF(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=VF(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function YF(e,t,r,n,a){var s=Ns(t,r,a),i=XF(e.v),o=le(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=le(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=sr([s,i,o,c]);return h}function Du(e,t,r){var n=e.read_shift(4),a=Al(e,n,r),s=e.read_shift(4),i=s>0?Cl(e,s,a,r):null;return[a,i]}var JF=Du,ju=Du,QF=Du,ZF=Du,e6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ly={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function r6(e){var t="of:="+e.replace(Fd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function F0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function n6(e){return e.replace(/\./,"!")}var Ao={},Ti={},No=typeof Map<"u";function Id(e,t,r){var n=0,a=e.length;if(r){if(No?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=No?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(No?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Lu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Sr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ul(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=ou(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ws(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ja(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){sa(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function cy(e,t,r,n,a,s){try{n.cellNF&&(e.z=qe[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=bt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(qe[t]==null&&sa(eT[t]||"General",t),e.t==="e")e.w=e.w||xa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nl(e.v);else if(e.t==="d"){var i=tr(e.v);(i|0)===i?e.w=i.toString(10):e.w=nl(i)}else{if(e.v===void 0)return"";e.w=bs(e.v,Ti)}else e.t==="d"?e.w=_n(t,tr(e.v),Ti):e.w=_n(t,e.v,Ti)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=iu(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=iu(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function a6(e,t,r){if(e&&e["!ref"]){var n=ct(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function s6(e,t){var r=ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ze(r))}var i6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,o6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,l6=/<(?:\w:)?hyperlink [^>]*>/mg,c6=/"(\w*:\w*)"/,u6=/<(?:\w:)?col\b[^>]*[\/]?>/g,f6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,h6=/<(?:\w:)?pageMargins[^>]*\/>/g,uy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,d6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,p6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function m6(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(o6);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var d=c.match(uy);d?Pd(d[0],o,a,r):(d=c.match(d6))&&g6(d[0],d[1]||"",o,a,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(c6);x&&s6(o,x[1])}var m=c.match(p6);m&&m[1]&&F6(m[1],a);var v=[];if(t.cellStyles){var w=c.match(u6);w&&b6(v,w)}h&&I6(h[1],o,t,l,s,i);var y=u.match(f6);y&&(o["!autofilter"]=C6(y[0]));var g=[],b=u.match(i6);if(b)for(p=0;p!=b.length;++p)g[p]=ct(b[p].slice(b[p].indexOf('"')+1));var I=u.match(l6);I&&k6(o,I,n);var A=u.match(h6);if(A&&(o["!margins"]=E6(Ye(A[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ze(l)),t.sheetRows>0&&o["!ref"]){var E=ct(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ze(E))}return v.length>0&&(o["!cols"]=v),g.length>0&&(o["!merges"]=g),o}function x6(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ze(e[r])+'"/>';return t+"</mergeCells>"}function Pd(e,t,r,n){var a=Ye(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=lt(gt(a.codeName)))}function g6(e,t,r,n,a){Pd(e.slice(0,e.indexOf(">")),r,n,a)}function v6(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=zn(mt(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Se("outlinePr",null,c)}!s&&!o||(a[a.length]=Se("sheetPr",o,i))}var w6=["objects","scenarios","selectLockedCells","selectUnlockedCells"],y6=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _6(e){var t={sheet:1};return w6.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),y6.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Cd(e.password).toString(16).toUpperCase()),Se("sheetProtection",null,t)}function k6(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ye(gt(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+lt(s.location))):(s.Target="#"+lt(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ct(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ke({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function E6(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function S6(e){return ws(e),Se("pageMargins",null,e)}function b6(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ye(t[n],!0);a.hidden&&(a.hidden=Et(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Ad(a.width)),Wa(a);s<=i;)e[s++]=Tt(a)}}function T6(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Se("col",null,Lu(a,n)));return r[r.length]="</cols>",r.join("")}function C6(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function A6(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ze(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Vr(a);i.s.r==i.e.r&&(i.e.r=Vr(t["!ref"]).e.r,a=Ze(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Se("autoFilter",null,{ref:a})}var N6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function F6(e,t){t.Views||(t.Views=[{}]),(e.match(N6)||[]).forEach(function(r,n){var a=Ye(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Et(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function O6(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Se("sheetViews",Se("sheetView",null,a),{})}function R6(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=xa[e.v];break;case"d":n&&n.cellDates?a=bt(e.v,-1).toISOString():(e=Tt(e),e.t="n",a=""+(e.v=tr(bt(e.v)))),typeof e.z>"u"&&(e.z=qe[14]);break;default:a=e.v;break}var o=dr("v",mt(a)),l={r:t},c=Ja(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=dr("v",""+Id(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Se("f",mt(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Se("c",o,l)}var I6=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=al("v"),i=al("f");return function(l,c,u,h,d,p){for(var x=0,m="",v=[],w=[],y=0,g=0,b=0,I="",A,E,_=0,k=0,O,H,L=0,V=0,Y=Array.isArray(p.CellXf),de,me=[],ie=[],ee=Array.isArray(c),T=[],q={},te=!1,C=!!u.sheetStubs,M=l.split(t),W=0,P=M.length;W!=P;++W){m=M[W].trim();var z=m.length;if(z!==0){var he=0;e:for(x=0;x<z;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(E=Ye(m.slice(he,x),!0),_=E.r!=null?parseInt(E.r,10):_+1,k=-1,u.sheetRows&&u.sheetRows<_)continue;q={},te=!1,E.ht&&(te=!0,q.hpt=parseFloat(E.ht),q.hpx=ji(q.hpt)),E.hidden=="1"&&(te=!0,q.hidden=!0),E.outlineLevel!=null&&(te=!0,q.level=+E.outlineLevel),te&&(T[_-1]=q)}break;case"<":he=x;break}if(he>=x)break;if(E=Ye(m.slice(he,x),!0),_=E.r!=null?parseInt(E.r,10):_+1,k=-1,!(u.sheetRows&&u.sheetRows<_)){h.s.r>_-1&&(h.s.r=_-1),h.e.r<_-1&&(h.e.r=_-1),u&&u.cellStyles&&(q={},te=!1,E.ht&&(te=!0,q.hpt=parseFloat(E.ht),q.hpx=ji(q.hpt)),E.hidden=="1"&&(te=!0,q.hidden=!0),E.outlineLevel!=null&&(te=!0,q.level=+E.outlineLevel),te&&(T[_-1]=q)),v=m.slice(x).split(e);for(var ae=0;ae!=v.length&&v[ae].trim().charAt(0)=="<";++ae);for(v=v.slice(ae),x=0;x!=v.length;++x)if(m=v[x].trim(),m.length!==0){if(w=m.match(r),y=x,g=0,b=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,w!=null&&w.length===2){for(y=0,I=w[1],g=0;g!=I.length&&!((b=I.charCodeAt(g)-64)<1||b>26);++g)y=26*y+b;--y,k=y}else++k;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,E=Ye(m.slice(0,g),!0),E.r||(E.r=Ke({r:_-1,c:k})),I=m.slice(g),A={t:""},(w=I.match(s))!=null&&w[1]!==""&&(A.v=lt(w[1])),u.cellFormula){if((w=I.match(i))!=null&&w[1]!==""){if(A.f=lt(gt(w[1])).replace(/\r\n/g,`
`),u.xlfn||(A.f=Tx(A.f)),w[0].indexOf('t="array"')>-1)A.F=(I.match(a)||[])[1],A.F.indexOf(":")>-1&&me.push([ct(A.F),A.F]);else if(w[0].indexOf('t="shared"')>-1){H=Ye(w[0]);var se=lt(gt(w[1]));u.xlfn||(se=Tx(se)),ie[parseInt(H.si,10)]=[H,se,E.r]}}else(w=I.match(/<f[^>]*\/>/))&&(H=Ye(w[0]),ie[H.si]&&(A.f=NN(ie[H.si][1],ie[H.si][2],E.r)));var oe=It(E.r);for(g=0;g<me.length;++g)oe.r>=me[g][0].s.r&&oe.r<=me[g][0].e.r&&oe.c>=me[g][0].s.c&&oe.c<=me[g][0].e.c&&(A.F=me[g][1])}if(E.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(C)A.t="z";else continue;else A.t=E.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),A.t){case"n":if(A.v==""||A.v==null){if(!C)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!C)continue;A.t="z"}else O=Ao[parseInt(A.v,10)],A.v=O.t,A.r=O.r,u.cellHTML&&(A.h=O.h);break;case"str":A.t="s",A.v=A.v!=null?gt(A.v):"",u.cellHTML&&(A.h=hd(A.v));break;case"inlineStr":w=I.match(n),A.t="s",w!=null&&(O=Td(w[1]))?(A.v=O.t,u.cellHTML&&(A.h=O.h)):A.v="";break;case"b":A.v=Et(A.v);break;case"d":u.cellDates?A.v=bt(A.v,1):(A.v=tr(bt(A.v,1)),A.t="n");break;case"e":(!u||u.cellText!==!1)&&(A.w=A.v),A.v=hw[A.v];break}if(L=V=0,de=null,Y&&E.s!==void 0&&(de=p.CellXf[E.s],de!=null&&(de.numFmtId!=null&&(L=de.numFmtId),u.cellStyles&&de.fillId!=null&&(V=de.fillId))),cy(A,L,V,u,d,p),u.cellDates&&Y&&A.t=="n"&&$i(qe[L])&&(A.t="d",A.v=Iu(A.v)),E.cm&&u.xlmeta){var ye=(u.xlmeta.Cell||[])[+E.cm-1];ye&&ye.type=="XLDAPR"&&(A.D=!0)}if(ee){var R=It(E.r);c[R.r]||(c[R.r]=[]),c[R.r][R.c]=A}else c[E.r]=A}}}}T.length>0&&(c["!rows"]=T)}}();function P6(e,t,r,n){var a=[],s=[],i=ct(e["!ref"]),o="",l,c="",u=[],h=0,d=0,p=e["!rows"],x=Array.isArray(e),m={r:c},v,w=-1;for(d=i.s.c;d<=i.e.c;++d)u[d]=Rt(d);for(h=i.s.r;h<=i.e.r;++h){for(s=[],c=zt(h),d=i.s.c;d<=i.e.c;++d){l=u[d]+c;var y=x?(e[h]||[])[d]:e[l];y!==void 0&&(o=R6(y,l,e,t))!=null&&s.push(o)}(s.length>0||p&&p[h])&&(m={r:c},p&&p[h]&&(v=p[h],v.hidden&&(m.hidden=1),w=-1,v.hpx?w=fl(v.hpx):v.hpt&&(w=v.hpt),w>-1&&(m.ht=w,m.customHeight=1),v.level&&(m.outlineLevel=v.level)),a[a.length]=Se("row",s.join(""),m))}if(p)for(;h<p.length;++h)p&&p[h]&&(m={r:h+1},v=p[h],v.hidden&&(m.hidden=1),w=-1,v.hpx?w=fl(v.hpx):v.hpt&&(w=v.hpt),w>-1&&(m.ht=w,m.customHeight=1),v.level&&(m.outlineLevel=v.level),a[a.length]=Se("row","",m));return a.join("")}function fy(e,t,r,n){var a=[Vt,Se("worksheet",null,{xmlns:Is[0],"xmlns:r":Zt.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=ct(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ze(u)}n||(n={}),l["!comments"]=[];var h=[];v6(l,r,e,t,a),a[a.length]=Se("dimension",null,{ref:c}),a[a.length]=O6(l,t,e,r),t.sheetFormat&&(a[a.length]=Se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=T6(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=P6(l,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=_6(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=A6(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=x6(l["!merges"]));var d=-1,p,x=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(x=pt(n,-1,mt(m[1].Target).replace(/#.*$/,""),rt.HLINK),p["r:id"]="rId"+x),(d=m[1].Target.indexOf("#"))>-1&&(p.location=mt(m[1].Target.slice(d+1))),m[1].Tooltip&&(p.tooltip=mt(m[1].Tooltip)),a[a.length]=Se("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=S6(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=dr("ignoredErrors",Se("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(x=pt(n,-1,"../drawings/drawing"+(e+1)+".xml",rt.DRAW),a[a.length]=Se("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=h),l["!comments"].length>0&&(x=pt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",rt.VML),a[a.length]=Se("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function D6(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function j6(e,t,r){var n=le(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=fl(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var x=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ke(c)];x&&(h<0&&(h=p),d=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function L6(e,t,r,n){var a=j6(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&pe(e,0,a)}var M6=Ls,B6=zi;function U6(){}function $6(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=zT(e),r}function W6(e,t,r){r==null&&(r=le(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return nu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ow(e,r),r.slice(0,r.l)}function H6(e){var t=kn(e);return[t]}function z6(e,t,r){return r==null&&(r=le(8)),Ps(t,r)}function V6(e){var t=Ds(e);return[t]}function G6(e,t,r){return r==null&&(r=le(4)),js(t,r)}function q6(e){var t=kn(e),r=e.read_shift(1);return[t,r,"b"]}function K6(e,t,r){return r==null&&(r=le(9)),Ps(t,r),r.write_shift(1,e.v?1:0),r}function X6(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"b"]}function Y6(e,t,r){return r==null&&(r=le(5)),js(t,r),r.write_shift(1,e.v?1:0),r}function J6(e){var t=kn(e),r=e.read_shift(1);return[t,r,"e"]}function Q6(e,t,r){return r==null&&(r=le(9)),Ps(t,r),r.write_shift(1,e.v),r}function Z6(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"e"]}function e8(e,t,r){return r==null&&(r=le(8)),js(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function t8(e){var t=kn(e),r=e.read_shift(4);return[t,r,"s"]}function r8(e,t,r){return r==null&&(r=le(12)),Ps(t,r),r.write_shift(4,t.v),r}function n8(e){var t=Ds(e),r=e.read_shift(4);return[t,r,"s"]}function a8(e,t,r){return r==null&&(r=le(8)),js(t,r),r.write_shift(4,t.v),r}function s8(e){var t=kn(e),r=br(e);return[t,r,"n"]}function i8(e,t,r){return r==null&&(r=le(16)),Ps(t,r),Cs(e.v,r),r}function hy(e){var t=Ds(e),r=br(e);return[t,r,"n"]}function o8(e,t,r){return r==null&&(r=le(12)),js(t,r),Cs(e.v,r),r}function l8(e){var t=kn(e),r=_d(e);return[t,r,"n"]}function c8(e,t,r){return r==null&&(r=le(12)),Ps(t,r),lw(e.v,r),r}function u8(e){var t=Ds(e),r=_d(e);return[t,r,"n"]}function f8(e,t,r){return r==null&&(r=le(8)),js(t,r),lw(e.v,r),r}function h8(e){var t=kn(e),r=vd(e);return[t,r,"is"]}function d8(e){var t=kn(e),r=Tr(e);return[t,r,"str"]}function p8(e,t,r){return r==null&&(r=le(12+4*e.v.length)),Ps(t,r),ir(e.v,r),r.length>r.l?r.slice(0,r.l):r}function m8(e){var t=Ds(e),r=Tr(e);return[t,r,"str"]}function x8(e,t,r){return r==null&&(r=le(8+4*e.v.length)),js(t,r),ir(e.v,r),r.length>r.l?r.slice(0,r.l):r}function g8(e,t,r){var n=e.l+t,a=kn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=ju(e,n-e.l,r);i[3]=kr(o,null,a,r.supbooks,r)}else e.l=n;return i}function v8(e,t,r){var n=e.l+t,a=kn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=ju(e,n-e.l,r);i[3]=kr(o,null,a,r.supbooks,r)}else e.l=n;return i}function w8(e,t,r){var n=e.l+t,a=kn(e);a.r=r["!row"];var s=br(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=ju(e,n-e.l,r);i[3]=kr(o,null,a,r.supbooks,r)}else e.l=n;return i}function y8(e,t,r){var n=e.l+t,a=kn(e);a.r=r["!row"];var s=Tr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=ju(e,n-e.l,r);i[3]=kr(o,null,a,r.supbooks,r)}else e.l=n;return i}var _8=Ls,k8=zi;function E8(e,t){return t==null&&(t=le(4)),t.write_shift(4,e),t}function S8(e,t){var r=e.l+t,n=Ls(e),a=wd(e),s=Tr(e),i=Tr(e),o=Tr(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function b8(e,t){var r=le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));zi({s:It(e[0]),e:It(e[0])},r),yd("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return ir(a||"",r),ir(e[1].Tooltip||"",r),ir("",r),r.slice(0,r.l)}function T8(){}function C8(e,t,r){var n=e.l+t,a=cw(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=JF(e,n-e.l,r);i[1]=o}else e.l=n;return i}function A8(e,t,r){var n=e.l+t,a=Ls(e),s=[a];if(r.cellFormula){var i=ZF(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function N8(e,t,r){r==null&&(r=le(18));var n=Lu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var dy=["left","right","top","bottom","header","footer"];function F8(e){var t={};return dy.forEach(function(r){t[r]=br(e)}),t}function O8(e,t){return t==null&&(t=le(6*8)),ws(e),dy.forEach(function(r){Cs(e[r],t)}),t}function R8(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function I8(e,t,r){r==null&&(r=le(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function P8(e){var t=le(24);return t.write_shift(4,4),t.write_shift(4,1),zi(e,t),t}function D8(e,t){return t==null&&(t=le(16*4+2)),t.write_shift(2,e.password?Cd(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function j8(){}function L8(){}function M8(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,x,m,v,w,y,g,b,I,A=[];o.biff=12,o["!row"]=0;var E=0,_=!1,k=[],O={},H=o.supbooks||a.supbooks||[[]];if(H.sharedf=O,H.arrayf=k,H.SheetNames=a.SheetNames||a.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=H,a.Names))for(var L=0;L<a.Names.length;++L)H[0][L+1]=a.Names[L];var V=[],Y=[],de=!1;hl[16]={n:"BrtShortReal",f:hy};var me;if(ma(e,function(T,q,te){if(!d)switch(te){case 148:c=T;break;case 0:p=T,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),b=zt(v=p.r),o["!row"]=p.r,(T.hidden||T.hpt||T.level!=null)&&(T.hpt&&(T.hpx=ji(T.hpt)),Y[T.r]=T);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:T[2]},T[2]){case"n":x.v=T[1];break;case"s":g=Ao[T[1]],x.v=g.t,x.r=g.r;break;case"b":x.v=!!T[1];break;case"e":x.v=T[1],o.cellText!==!1&&(x.w=xa[x.v]);break;case"str":x.t="s",x.v=T[1];break;case"is":x.t="s",x.v=T[1].t;break}if((m=i.CellXf[T[0].iStyleRef])&&cy(x,m.numFmtId,null,o,s,i),w=T[0].c==-1?w+1:T[0].c,o.dense?(l[v]||(l[v]=[]),l[v][w]=x):l[Rt(w)+b]=x,o.cellFormula){for(_=!1,E=0;E<k.length;++E){var C=k[E];p.r>=C[0].s.r&&p.r<=C[0].e.r&&w>=C[0].s.c&&w<=C[0].e.c&&(x.F=Ze(C[0]),_=!0)}!_&&T.length>3&&(x.f=T[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>w&&(u.s.c=w),u.e.r<p.r&&(u.e.r=p.r),u.e.c<w&&(u.e.c=w),o.cellDates&&m&&x.t=="n"&&$i(qe[m.numFmtId])){var M=ds(x.v);M&&(x.t="d",x.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}me&&(me.type=="XLDAPR"&&(x.D=!0),me=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},w=T[0].c==-1?w+1:T[0].c,o.dense?(l[v]||(l[v]=[]),l[v][w]=x):l[Rt(w)+b]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>w&&(u.s.c=w),u.e.r<p.r&&(u.e.r=p.r),u.e.c<w&&(u.e.c=w),me&&(me.type=="XLDAPR"&&(x.D=!0),me=void 0);break;case 176:A.push(T);break;case 49:me=((o.xlmeta||{}).Cell||[])[T-1];break;case 494:var W=n["!id"][T.relId];for(W?(T.Target=W.Target,T.loc&&(T.Target+="#"+T.loc),T.Rel=W):T.relId==""&&(T.Target="#"+T.loc),v=T.rfx.s.r;v<=T.rfx.e.r;++v)for(w=T.rfx.s.c;w<=T.rfx.e.c;++w)o.dense?(l[v]||(l[v]=[]),l[v][w]||(l[v][w]={t:"z",v:void 0}),l[v][w].l=T):(y=Ke({c:w,r:v}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=T);break;case 426:if(!o.cellFormula)break;k.push(T),I=o.dense?l[v][w]:l[Rt(w)+b],I.f=kr(T[1],u,{r:p.r,c:w},H,o),I.F=Ze(T[0]);break;case 427:if(!o.cellFormula)break;O[Ke(T[0].s)]=T[1],I=o.dense?l[v][w]:l[Rt(w)+b],I.f=kr(T[1],u,{r:p.r,c:w},H,o);break;case 60:if(!o.cellStyles)break;for(;T.e>=T.s;)V[T.e--]={width:T.w/256,hidden:!!(T.flags&1),level:T.level},de||(de=!0,Ad(T.w/256)),Wa(V[T.e+1]);break;case 161:l["!autofilter"]={ref:Ze(T)};break;case 476:l["!margins"]=T;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),T.name&&(a.Sheets[r].CodeName=T.name),(T.above||T.left)&&(l["!outline"]={above:T.above,left:T.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),T.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!q.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ze(c||u)),o.sheetRows&&l["!ref"]){var ie=ct(l["!ref"]);o.sheetRows<=+ie.e.r&&(ie.e.r=o.sheetRows-1,ie.e.r>u.e.r&&(ie.e.r=u.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>u.e.c&&(ie.e.c=u.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ze(ie))}return A.length>0&&(l["!merges"]=A),V.length>0&&(l["!cols"]=V),Y.length>0&&(l["!rows"]=Y),l}function B8(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Tt(t),t.z=t.z||qe[14],t.v=tr(bt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ja(a.cellXfs,t,a),t.l&&s["!links"].push([Ke(l),t.l]),t.c&&s["!comments"].push([Ke(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Id(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?pe(e,18,a8(t,l)):pe(e,7,r8(t,l))):(l.t="str",i?pe(e,17,x8(t,l)):pe(e,6,p8(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?pe(e,13,f8(t,l)):pe(e,2,c8(t,l)):i?pe(e,16,o8(t,l)):pe(e,5,i8(t,l)),!0;case"b":return l.t="b",i?pe(e,15,Y6(t,l)):pe(e,4,K6(t,l)),!0;case"e":return l.t="e",i?pe(e,14,e8(t,l)):pe(e,3,Q6(t,l)),!0}return i?pe(e,12,G6(t,l)):pe(e,1,z6(t,l)),!0}function U8(e,t,r,n){var a=ct(t["!ref"]||"A1"),s,i="",o=[];pe(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){i=zt(u),L6(e,t,a,u);var h=!1;if(u<=a.e.r)for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(o[d]=Rt(d)),s=o[d]+i;var p=l?(t[u]||[])[d]:t[s];if(!p){h=!1;continue}h=B8(e,p,u,d,n,t,h)}}pe(e,146)}function $8(e,t){!t||!t["!merges"]||(pe(e,177,E8(t["!merges"].length)),t["!merges"].forEach(function(r){pe(e,176,k8(r))}),pe(e,178))}function W8(e,t){!t||!t["!cols"]||(pe(e,390),t["!cols"].forEach(function(r,n){r&&pe(e,60,N8(n,r))}),pe(e,391))}function H8(e,t){!t||!t["!ref"]||(pe(e,648),pe(e,649,P8(ct(t["!ref"]))),pe(e,650))}function z8(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=pt(r,-1,n[1].Target.replace(/#.*$/,""),rt.HLINK);pe(e,494,b8(n,a))}}),delete t["!links"]}function V8(e,t,r,n){if(t["!comments"].length>0){var a=pt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rt.VML);pe(e,551,yd("rId"+a)),t["!legacy"]=a}}function G8(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Ze(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Vr(s);o.s.r==o.e.r&&(o.e.r=Vr(t["!ref"]).e.r,s=Ze(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),pe(e,161,zi(ct(s))),pe(e,162)}}function q8(e,t,r){pe(e,133),pe(e,137,I8(t,r)),pe(e,138),pe(e,134)}function K8(e,t){t["!protect"]&&pe(e,535,D8(t["!protect"]))}function X8(e,t,r,n){var a=zr(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=ct(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],pe(a,129),(r.vbaraw||i["!outline"])&&pe(a,147,W6(o,i["!outline"])),pe(a,148,B6(l)),q8(a,i,r.Workbook),W8(a,i),U8(a,i,e,t),K8(a,i),G8(a,i,r,e),$8(a,i),z8(a,i,n),i["!margins"]&&pe(a,476,O8(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&H8(a,i),V8(a,i,e,n),pe(a,130),a.end()}function Y8(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function J8(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=Y8(h);u.s.r=u.s.c=0,u.e.c=o,c=Rt(o),d[0].forEach(function(p,x){i[c+zt(x)]={t:"n",v:p,z:d[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=Ze(u)),i}function Q8(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(uy);return o&&Pd(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Z8(e,t){e.l+=10;var r=Tr(e);return{name:r}}function eO(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ma(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Dd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tO=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],rO=[],nO=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ox(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Et(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Rx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Et(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function py(e){Rx(e.WBProps,Dd),Rx(e.CalcPr,nO),Ox(e.WBView,tO),Ox(e.Sheets,rO),Ti.date1904=Et(e.WBProps.date1904)}function aO(e){return!e.Workbook||!e.Workbook.WBProps?"false":Et(e.Workbook.WBProps.date1904)?"true":"false"}var sO="][*?/\\".split("");function my(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return sO.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function iO(e,t,r){e.forEach(function(n,a){my(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function oO(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];iO(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)a6(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var lO=/<\w+:workbook/;function cO(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Nr,function(l,c){var u=Ye(l);switch(qn(u[0])){case"<?xml":break;case"<workbook":l.match(lO)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Dd.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Et(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=gt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=lt(gt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=gt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Et(u.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=lt(gt(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Is.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return py(r),r}function xy(e){var t=[Vt];t[t.length]=Se("workbook",null,{xmlns:Is[0],"xmlns:r":Zt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Dd.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Se("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:mt(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Se("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Se("definedName",mt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function uO(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=zf(e),r.name=Tr(e),r}function fO(e,t){return t||(t=le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),yd(e.strRelID,t),ir(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function hO(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Tr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function dO(e,t){t||(t=le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),ow(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function pO(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function mO(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=VT(e),i=QF(e,0,r),o=wd(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function xO(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],hl[16]={n:"BrtFRTArchID$",f:pO},ma(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=kr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),py(r),r.Names=s,r.supbooks=i,r}function gO(e,t){pe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};pe(e,156,fO(a))}pe(e,144)}function vO(e,t){t||(t=le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ir("SheetJS",t),ir(Yc.version,t),ir(Yc.version,t),ir("7262",t),t.length>t.l?t.slice(0,t.l):t}function wO(e,t){t||(t=le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function yO(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(pe(e,135),pe(e,158,wO(a)),pe(e,136))}}function _O(e,t){var r=zr();return pe(r,131),pe(r,128,vO()),pe(r,153,dO(e.Workbook&&e.Workbook.WBProps||null)),yO(r,e),gO(r,e),pe(r,132),r.end()}function kO(e,t,r){return t.slice(-4)===".bin"?xO(e,r):cO(e,r)}function EO(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?M8(e,n,r,a,s,i,o):m6(e,n,r,a,s,i,o)}function SO(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?eO(e,n,r,a,s):Q8(e,n,r,a,s)}function bO(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?CN():AN()}function TO(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?bN():TN()}function CO(e,t,r,n){return t.slice(-4)===".bin"?kA(e,r,n):uA(e,r,n)}function AO(e,t,r){return Yw(e,r)}function NO(e,t,r){return t.slice(-4)===".bin"?NC(e,r):TC(e,r)}function FO(e,t,r){return t.slice(-4)===".bin"?yN(e,r):fN(e,r)}function OO(e,t,r){return t.slice(-4)===".bin"?lN(e):iN(e)}function RO(e,t,r,n){return r.slice(-4)===".bin"?cN(e,t,r,n):void 0}function IO(e,t,r){return t.slice(-4)===".bin"?nN(e,t,r):sN(e,t,r)}function PO(e,t,r){return(t.slice(-4)===".bin"?_O:xy)(e)}function DO(e,t,r,n,a){return(t.slice(-4)===".bin"?X8:fy)(e,r,n,a)}function jO(e,t,r){return(t.slice(-4)===".bin"?RA:Kw)(e,r)}function LO(e,t,r){return(t.slice(-4)===".bin"?RC:Uw)(e,r)}function MO(e,t,r){return(t.slice(-4)===".bin"?_N:Zw)(e)}function BO(e){return(e.slice(-4)===".bin"?aN:Jw)()}var gy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,vy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Sn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(gy),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(vy),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function UO(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(gy),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(vy),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var Fo;function $O(e,t){var r=Fo[e]||lt(e);return r==="General"?bs(t):_n(r,t)}function WO(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Et(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=bt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[lt(t)]=a}function HO(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nl(e.v):e.w=bs(e.v):e.w=$O(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Fo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&$i(n)){var a=ds(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function zO(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=rA[n.Pattern]||n.Pattern)}e[t.ID]=t}function VO(e,t,r,n,a,s,i,o,l,c){var u="General",h=n.StyleID,d={};c=c||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&p.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Et(e);break;case"String":n.t="s",n.r=Xm(lt(e)),n.v=e.indexOf("<")>-1?lt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(bt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=hw[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Xm(t||e));break}if(HO(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=lt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=bi(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=bi("RC:RC",a):n.ArrayRange&&(n.F=bi(n.ArrayRange,a),l.push([ct(n.F),n.F]))}else for(x=0;x<l.length;++x)a.r>=l[x][0].s.r&&a.r<=l[x][0].e.r&&a.c>=l[x][0].s.c&&a.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(v){!d.patternType&&v.patternType&&(d.patternType=v.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function GO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function O0(e,t){var r=t||{};Wi();var n=co(dd(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=gt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Tt(r);return i.type="string",Di.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(be){a.indexOf("<"+be)>=0&&(s=!0)}),s)return OR(n,r);Fo={"General Number":"General","General Date":qe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":qe[15],"Short Date":qe[14],"Long Time":qe[19],"Medium Time":qe[18],"Short Time":qe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:qe[2],Standard:qe[4],Percent:qe[10],Scientific:qe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],d=r.dense?[]:{},p="",x={},m={},v=Sn('<Data ss:Type="String">'),w=0,y=0,g=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},A={},E="",_=0,k=[],O={},H={},L=0,V=[],Y=[],de={},me=[],ie,ee=!1,T=[],q=[],te={},C=0,M=0,W={Sheets:[],WBProps:{date1904:!1}},P={};il.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";o=il.exec(n);)switch(o[3]=(z=o[3]).toLowerCase()){case"data":if(z=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?VO(n.slice(w,o.index),E,v,l[l.length-1][0]=="comment"?de:x,{c:y,r:g},I,me[y],m,T,r):(E="",v=Sn(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Y.length>0&&(x.c=Y),(!r.sheetRows||r.sheetRows>g)&&x.v!==void 0&&(r.dense?(d[g]||(d[g]=[]),d[g][y]=x):d[Rt(y)+zt(g)]=x),x.HRef&&(x.l={Target:lt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(C=y+(parseInt(x.MergeAcross,10)|0),M=g+(parseInt(x.MergeDown,10)|0),k.push({s:{c:y,r:g},e:{c:C,r:M}})),!r.sheetStubs)x.MergeAcross?y=C+1:++y;else if(x.MergeAcross||x.MergeDown){for(var he=y;he<=C;++he)for(var ae=g;ae<=M;++ae)(he>y||ae>g)&&(r.dense?(d[ae]||(d[ae]=[]),d[ae][he]={t:"z"}):d[Rt(he)+zt(ae)]={t:"z"});y=C+1}else++y;else x=UO(o[0]),x.Index&&(y=+x.Index-1),y<b.s.c&&(b.s.c=y),y>b.e.c&&(b.e.c=y),o[0].slice(-2)==="/>"&&++y,Y=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<b.s.r&&(b.s.r=g),g>b.e.r&&(b.e.r=g),o[0].slice(-2)==="/>"&&(m=Sn(o[0]),m.Index&&(g=+m.Index-1)),y=0,++g):(m=Sn(o[0]),m.Index&&(g=+m.Index-1),te={},(m.AutoFitHeight=="0"||m.Height)&&(te.hpx=parseInt(m.Height,10),te.hpt=fl(te.hpx),q[g]=te),m.Hidden=="1"&&(te.hidden=!0,q[g]=te));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(d["!ref"]=Ze(b),r.sheetRows&&r.sheetRows<=b.e.r&&(d["!fullref"]=d["!ref"],b.e.r=r.sheetRows-1,d["!ref"]=Ze(b))),k.length&&(d["!merges"]=k),me.length>0&&(d["!cols"]=me),q.length>0&&(d["!rows"]=q),u[p]=d}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=y=0,l.push([o[3],!1]),c=Sn(o[0]),p=lt(c.Name),d=r.dense?[]:{},k=[],T=[],q=[],P={name:p,Hidden:0},W.Sheets.push(P);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),me=[],ee=!1}break;case"style":o[1]==="/"?zO(I,A,r):A=Sn(o[0]);break;case"numberformat":A.nf=lt(Sn(o[0]).Format||"General"),Fo[A.nf]&&(A.nf=Fo[A.nf]);for(var se=0;se!=392&&qe[se]!=A.nf;++se);if(se==392){for(se=57;se!=392;++se)if(qe[se]==null){sa(A.nf,se);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ie=Sn(o[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!ee&&ie.wpx>10){ee=!0,Sr=Gw;for(var oe=0;oe<me.length;++oe)me[oe]&&Wa(me[oe])}ee&&Wa(ie),me[ie.Index-1||me.length]=ie;for(var ye=0;ye<+ie.Span;++ye)me[me.length]=Tt(ie);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var R=Ye(o[0]),Me={Name:R.Name,Ref:bi(R.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(Me.Sheet=W.Sheets.length-1),W.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(_,o.index):_=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;A.Interior=Sn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x4(O,z,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));GO(de),Y.push(de)}else l.push([o[3],!1]),c=Sn(o[0]),de={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var U=Sn(o[0]);d["!autofilter"]={ref:bi(U.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Lx(n,r);var re=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:re=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else L=o.index+o[0].length;break;case"header":d["!margins"]||ws(d["!margins"]={},"xlml"),isNaN(+Ye(o[0]).Margin)||(d["!margins"].header=+Ye(o[0]).Margin);break;case"footer":d["!margins"]||ws(d["!margins"]={},"xlml"),isNaN(+Ye(o[0]).Margin)||(d["!margins"].footer=+Ye(o[0]).Margin);break;case"pagemargins":var J=Ye(o[0]);d["!margins"]||ws(d["!margins"]={},"xlml"),isNaN(+J.Top)||(d["!margins"].top=+J.Top),isNaN(+J.Left)||(d["!margins"].left=+J.Left),isNaN(+J.Right)||(d["!margins"].right=+J.Right),isNaN(+J.Bottom)||(d["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:re=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:re=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:re=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1;break}if(re||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?WO(H,z,V,n.slice(L,o.index)):(V=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ue={};return!r.bookSheets&&!r.bookProps&&(ue.Sheets=u),ue.SheetNames=h,ue.Workbook=W,ue.SSF=Tt(qe),ue.Props=O,ue.Custprops=H,ue}function Jf(e,t){switch(Ld(t=t||{}),t.type||"base64"){case"base64":return O0(nn(e),t);case"binary":case"buffer":case"file":return O0(e,t);case"array":return O0(Xa(e),t)}}function qO(e,t){var r=[];return e.Props&&r.push(g4(e.Props,t)),e.Custprops&&r.push(v4(e.Props,e.Custprops)),r.join("")}function KO(){return""}function XO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Se("NumberFormat",null,{"ss:Format":mt(qe[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(Se("Style",s.join(""),i))}),Se("Styles",r.join(""))}function wy(e){return Se("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Od(e.Ref,{r:0,c:0})})}function YO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(wy(a)))}return Se("Names",r.join(""))}function JO(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(wy(o)))}return s.join("")}function QO(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Se("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Se("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Se("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Se("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(dr("ProtectContents","True")),e["!protect"].objects&&a.push(dr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(dr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(dr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(dr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":Se("WorksheetOptions",a.join(""),{xmlns:Kr.x})}function ZO(e){return e.map(function(t){var r=yT(t.t||""),n=Se("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Se("Comment",n,{"ss:Author":t.a})}).join("")}function eR(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+mt(Od(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=It(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=mt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=mt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=i.c||c[u].s.r!=i.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=xa[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qe[14]);break;case"s":h="String",d=wT(e.v||"");break}var p=Ja(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=e.v!=null?d:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(m+=ZO(e.c)),Se("Cell",m,o)}function tR(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ji(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function rR(e,t,r,n){if(!e["!ref"])return"";var a=ct(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,w){Wa(v);var y=!!v.width,g=Lu(w,v),b={"ss:Index":w+1};y&&(b["ss:Width"]=cl(g.width)),v.hidden&&(b["ss:Hidden"]="1"),o.push(Se("Column",null,b))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[tR(c,(e["!rows"]||[])[c])],h=a.s.c;h<=a.e.c;++h){var d=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>h)&&!(s[i].s.r>c)&&!(s[i].e.c<h)&&!(s[i].e.r<c)){(s[i].s.c!=h||s[i].s.r!=c)&&(d=!0);break}if(!d){var p={r:c,c:h},x=Ke(p),m=l?(e[c]||[])[h]:e[x];u.push(eR(m,x,e,t,r,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function nR(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?JO(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?rR(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(QO(s,t,e,r)),n.join("")}function aR(e,t){t||(t={}),e.SSF||(e.SSF=Tt(qe)),e.SSF&&(Wi(),Fu(e.SSF),t.revssf=Ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ja(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(qO(e,t)),r.push(KO()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Se("Worksheet",nR(n,t,e),{"ss:Name":mt(e.SheetNames[n])}));return r[2]=XO(e,t),r[3]=YO(e),Vt+Se("Workbook",r.join(""),{xmlns:Kr.ss,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:ss":Kr.ss,"xmlns:dt":Kr.dt,"xmlns:html":Kr.html})}function sR(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=YT(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=JT(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var iR=[60,1084,2066,2165,2175];function oR(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=ra(r,r.l),c=Qf[l],u=0;c!=null&&iR.indexOf(l)>-1;)s=ra(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),i.push(o),r.l+=4+s,c=Qf[l=ra(r,r.l)];var h=sr(i);hr(h,0);var d=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(d),d+=i[p].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function Bn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=qe[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nl(e.v):e.w=bs(e.v):e.w=_n(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&$i(qe[n]||String(n))){var a=ds(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function oc(e,t,r){return{v:e,ixfe:t,t:r}}function lR(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",u={},h,d="",p,x,m,v,w={},y=[],g,b,I=[],A=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},k=function(ze){return ze<8?xs[ze]:ze<64&&A[ze-8]||xs[ze]},O=function(ze,st,ht){var it=st.XF.data;if(!(!it||!it.patternType||!ht||!ht.cellStyles)){st.s={},st.s.patternType=it.patternType;var on;(on=ll(k(it.icvFore)))&&(st.s.fgColor={rgb:on}),(on=ll(k(it.icvBack)))&&(st.s.bgColor={rgb:on})}},H=function(ze,st,ht){if(!(te>1)&&!(ht.sheetRows&&ze.r>=ht.sheetRows)){if(ht.cellStyles&&st.XF&&st.XF.data&&O(ze,st,ht),delete st.ixfe,delete st.XF,h=ze,d=Ke(ze),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),ze.r<i.s.r&&(i.s.r=ze.r),ze.c<i.s.c&&(i.s.c=ze.c),ze.r+1>i.e.r&&(i.e.r=ze.r+1),ze.c+1>i.e.c&&(i.e.c=ze.c+1),ht.cellFormula&&st.f){for(var it=0;it<y.length;++it)if(!(y[it][0].s.c>ze.c||y[it][0].s.r>ze.r)&&!(y[it][0].e.c<ze.c||y[it][0].e.r<ze.r)){st.F=Ze(y[it][0]),(y[it][0].s.c!=ze.c||y[it][0].s.r!=ze.r)&&delete st.f,st.f&&(st.f=""+kr(y[it][1],i,ze,T,L));break}}ht.dense?(a[ze.r]||(a[ze.r]=[]),a[ze.r][ze.c]=st):a[d]=st}},L={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var V,Y=[],de=[],me=[],ie=[],ee=!1,T=[];T.SheetNames=L.snames,T.sharedf=L.sharedf,T.arrayf=L.arrayf,T.names=[],T.XTI=[];var q=0,te=0,C=0,M=[],W=[],P;L.codepage=1200,On(1200);for(var z=!1;e.l<e.length-1;){var he=e.l,ae=e.read_shift(2);if(ae===0&&q===10)break;var se=e.l===e.length?0:e.read_shift(2),oe=Qf[ae];if(oe&&oe.f){if(t.bookSheets&&q===133&&ae!==133)break;if(q=ae,oe.r===2||oe.r==12){var ye=e.read_shift(2);if(se-=2,!L.enc&&ye!==ae&&((ye&255)<<8|ye>>8)!==ae)throw new Error("rt mismatch: "+ye+"!="+ae);oe.r==12&&(e.l+=10,se-=10)}var R={};if(ae===10?R=oe.f(e,se,L):R=oR(ae,oe,e,se,L),te==0&&[9,521,1033,2057].indexOf(q)===-1)continue;switch(ae){case 34:r.opts.Date1904=E.WBProps.date1904=R;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=R,!t.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=R;break;case 66:var Me=Number(R);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}On(L.codepage=Me),z=!0;break;case 317:L.rrtabid=R;break;case 25:L.winlocked=R;break;case 439:r.opts.RefreshAll=R;break;case 12:r.opts.CalcCount=R;break;case 16:r.opts.CalcDelta=R;break;case 17:r.opts.CalcIter=R;break;case 13:r.opts.CalcMode=R;break;case 14:r.opts.CalcPrecision=R;break;case 95:r.opts.CalcSaveRecalc=R;break;case 15:L.CalcRefMode=R;break;case 2211:r.opts.FullCalc=R;break;case 129:R.fDialog&&(a["!type"]="dialog"),R.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),R.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(R);break;case 430:T.push([R]),T[T.length-1].XTI=[];break;case 35:case 547:T[T.length-1].push(R);break;case 24:case 536:P={Name:R.Name,Ref:kr(R.rgce,i,null,T,L)},R.itab>0&&(P.Sheet=R.itab-1),T.names.push(P),T[0]||(T[0]=[],T[0].XTI=[]),T[T.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(W[R.itab-1]={ref:Ze(R.rgce[0][0][1][2])});break;case 22:L.ExternCount=R;break;case 23:T.length==0&&(T[0]=[],T[0].XTI=[]),T[T.length-1].XTI=T[T.length-1].XTI.concat(R),T.XTI=T.XTI.concat(R);break;case 2196:if(L.biff<8)break;P!=null&&(P.Comment=R[1]);break;case 18:a["!protect"]=R;break;case 19:R!==0&&L.WTF&&console.error("Password verifier: "+R);break;case 133:s[R.pos]=R,L.snames.push(R.name);break;case 10:{if(--te)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ze(i),t.sheetRows&&t.sheetRows<=i.e.r){var U=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ze(i),i.e.r=U}i.e.r++,i.e.c++}Y.length>0&&(a["!merges"]=Y),de.length>0&&(a["!objects"]=de),me.length>0&&(a["!cols"]=me),ie.length>0&&(a["!rows"]=ie),E.Sheets.push(_)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),L.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(L.biff=5,z=!0,On(L.codepage=28591)),L.biff==8&&R.BIFFVer==0&&R.dt==16&&(L.biff=2),te++)break;if(a=t.dense?[]:{},L.biff<8&&!z&&(z=!0,On(L.codepage=t.codepage||1252)),L.biff<5||R.BIFFVer==0&&R.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var re={pos:e.l-se,name:c};s[re.pos]=re,L.snames.push(c)}else c=(s[he]||{name:""}).name;R.dt==32&&(a["!type"]="chart"),R.dt==64&&(a["!type"]="macro"),Y=[],de=[],L.arrayf=y=[],me=[],ie=[],ee=!1,_={Hidden:(s[he]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[R.r]||[])[R.c]:a[Ke({c:R.c,r:R.r})])&&++R.c,g={ixfe:R.ixfe,XF:I[R.ixfe]||{},v:R.val,t:"n"},C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:R.c,r:R.r},g,t);break;case 5:case 517:g={ixfe:R.ixfe,XF:I[R.ixfe],v:R.val,t:R.t},C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:R.c,r:R.r},g,t);break;case 638:g={ixfe:R.ixfe,XF:I[R.ixfe],v:R.rknum,t:"n"},C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:R.c,r:R.r},g,t);break;case 189:for(var J=R.c;J<=R.C;++J){var ue=R.rkrec[J-R.c][0];g={ixfe:ue,XF:I[ue],v:R.rkrec[J-R.c][1],t:"n"},C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:J,r:R.r},g,t)}break;case 6:case 518:case 1030:{if(R.val=="String"){o=R;break}if(g=oc(R.val,R.cell.ixfe,R.tt),g.XF=I[g.ixfe],t.cellFormula){var be=R.formula;if(be&&be[0]&&be[0][0]&&be[0][0][0]=="PtgExp"){var He=be[0][0][1][0],Xe=be[0][0][1][1],G=Ke({r:He,c:Xe});w[G]?g.f=""+kr(R.formula,i,R.cell,T,L):g.F=((t.dense?(a[He]||[])[Xe]:a[G])||{}).F}else g.f=""+kr(R.formula,i,R.cell,T,L)}C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H(R.cell,g,t),o=R}break;case 7:case 519:if(o)o.val=R,g=oc(R,o.cell.ixfe,"s"),g.XF=I[g.ixfe],t.cellFormula&&(g.f=""+kr(o.formula,i,o.cell,T,L)),C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H(o.cell,g,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(R);var _e=Ke(R[0].s);if(p=t.dense?(a[R[0].s.r]||[])[R[0].s.c]:a[_e],t.cellFormula&&p){if(!o||!_e||!p)break;p.f=""+kr(R[1],i,R[0],T,L),p.F=Ze(R[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;w[Ke(o.cell)]=R[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Ke(o.cell)],(p||{}).f=""+kr(R[0],i,h,T,L)}}break;case 253:g=oc(l[R.isst].t,R.ixfe,"s"),l[R.isst].h&&(g.h=l[R.isst].h),g.XF=I[g.ixfe],C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:R.c,r:R.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:R.ixfe,XF:I[R.ixfe],t:"z"},C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:R.c,r:R.r},g,t));break;case 190:if(t.sheetStubs)for(var Re=R.c;Re<=R.C;++Re){var xe=R.ixfe[Re-R.c];g={ixfe:xe,XF:I[xe],t:"z"},C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:Re,r:R.r},g,t)}break;case 214:case 516:case 4:g=oc(R.val,R.ixfe,"s"),g.XF=I[g.ixfe],C>0&&(g.z=M[g.ixfe>>8&63]),Bn(g,t,r.opts.Date1904),H({c:R.c,r:R.r},g,t);break;case 0:case 512:te===1&&(i=R);break;case 252:l=R;break;case 1054:if(L.biff==4){M[C++]=R[1];for(var De=0;De<C+163&&qe[De]!=R[1];++De);De>=163&&sa(R[1],C+163)}else sa(R[1],R[0]);break;case 30:{M[C++]=R;for(var je=0;je<C+163&&qe[je]!=R;++je);je>=163&&sa(R,C+163)}break;case 229:Y=Y.concat(R);break;case 93:de[R.cmo[0]]=L.lastobj=R;break;case 438:L.lastobj.TxO=R;break;case 127:L.lastobj.ImData=R;break;case 440:for(v=R[0].s.r;v<=R[0].e.r;++v)for(m=R[0].s.c;m<=R[0].e.c;++m)p=t.dense?(a[v]||[])[m]:a[Ke({c:m,r:v})],p&&(p.l=R[1]);break;case 2048:for(v=R[0].s.r;v<=R[0].e.r;++v)for(m=R[0].s.c;m<=R[0].e.c;++m)p=t.dense?(a[v]||[])[m]:a[Ke({c:m,r:v})],p&&p.l&&(p.l.Tooltip=R[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;p=t.dense?(a[R[0].r]||[])[R[0].c]:a[Ke(R[0])];var at=de[R[2]];p||(t.dense?(a[R[0].r]||(a[R[0].r]=[]),p=a[R[0].r][R[0].c]={t:"z"}):p=a[Ke(R[0])]={t:"z"},i.e.r=Math.max(i.e.r,R[0].r),i.s.r=Math.min(i.s.r,R[0].r),i.e.c=Math.max(i.e.c,R[0].c),i.s.c=Math.min(i.s.c,R[0].c)),p.c||(p.c=[]),x={a:R[1],t:at.TxO.t},p.c.push(x)}break;case 2173:XA(I[R.ixfe],R.ext);break;case 125:{if(!L.cellStyles)break;for(;R.e>=R.s;)me[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},ee||(ee=!0,Ad(R.w/256)),Wa(me[R.e+1])}break;case 520:{var ut={};R.level!=null&&(ie[R.r]=ut,ut.level=R.level),R.hidden&&(ie[R.r]=ut,ut.hidden=!0),R.hpt&&(ie[R.r]=ut,ut.hpt=R.hpt,ut.hpx=ji(R.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ws(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=R;break;case 161:a["!margins"]||ws(a["!margins"]={}),a["!margins"].header=R.header,a["!margins"].footer=R.footer;break;case 574:R.RTL&&(E.Views[0].RTL=!0);break;case 146:A=R;break;case 2198:V=R;break;case 140:b=R;break;case 442:c?_.CodeName=R||_.name:E.WBProps.CodeName=R||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=se}return r.SheetNames=$t(s).sort(function(_t,ze){return Number(_t)-Number(ze)}).map(function(_t){return s[_t].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&W.forEach(function(_t,ze){r.Sheets[r.SheetNames[ze]]["!autofilter"]=_t}),r.Strings=l,r.SSF=Tt(qe),L.enc&&(r.Encryption=L.enc),V&&(r.Themes=V),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),T.names.length>0&&(E.Names=T.names),r.Workbook=E,r}var Oo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cR(e,t,r){var n=Ue.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=dx(n,Vf,Oo.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Ue.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=dx(i,Gf,Oo.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(vw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function uR(e,t){var r=[],n=[],a=[],s=0,i,o=Hm(Vf,"n"),l=Hm(Gf,"n");if(e.Props)for(i=$t(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=$t(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var c=[];for(s=0;s<a.length;++s)bw.indexOf(a[s][0])>-1||gw.indexOf(a[s][0])>-1||a[s][1]!=null&&c.push(a[s]);n.length&&Ue.utils.cfb_add(t,"/SummaryInformation",px(n,Oo.SI,l,Gf)),(r.length||c.length)&&Ue.utils.cfb_add(t,"/DocumentSummaryInformation",px(r,Oo.DSI,o,Vf,c.length?c:null,Oo.UDI))}function yy(e,t){t||(t={}),Ld(t),ad(),t.codepage&&nd(t.codepage);var r,n;if(e.FullPaths){if(Ue.find(e,"/encryption"))throw new Error("File is password-protected");r=Ue.find(e,"!CompObj"),n=Ue.find(e,"/Workbook")||Ue.find(e,"/Book")}else{switch(t.type){case"base64":e=Qr(nn(e));break;case"binary":e=Qr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}hr(e,0),n={content:e}}var a,s;if(r&&sR(r),t.bookProps&&!t.bookSheets)a={};else{var i=tt?"buffer":"array";if(n&&n.content)a=lR(n.content,t);else if((s=Ue.find(e,"PerfectOffice_MAIN"))&&s.content)a=vs.to_workbook(s.content,(t.type=i,t));else if((s=Ue.find(e,"NativeContent_MAIN"))&&s.content)a=vs.to_workbook(s.content,(t.type=i,t));else throw(s=Ue.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ue.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=EN(e))}var o={};return e.FullPaths&&cR(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function fR(e,t){var r=t||{},n=Ue.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ue.utils.cfb_add(n,a,_y(e,r)),r.biff==8&&(e.Props||e.Custprops)&&uR(e,n),r.biff==8&&e.vbaraw&&SN(n,Ue.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var hl={0:{f:D6},1:{f:H6},2:{f:l8},3:{f:J6},4:{f:q6},5:{f:s8},6:{f:d8},7:{f:t8},8:{f:y8},9:{f:w8},10:{f:g8},11:{f:v8},12:{f:V6},13:{f:u8},14:{f:Z6},15:{f:X6},16:{f:hy},17:{f:m8},18:{f:n8},19:{f:vd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:mO},40:{},42:{},43:{f:dA},44:{f:fA},45:{f:xA},46:{f:vA},47:{f:gA},48:{},49:{f:MT},50:{},51:{f:QA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jw},62:{f:h8},63:{f:oN},64:{f:j8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ar,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:R8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$6},148:{f:M6,p:16},151:{f:T8},152:{},153:{f:hO},154:{},155:{},156:{f:uO},157:{},158:{},159:{T:1,f:AC},160:{T:-1},161:{T:1,f:Ls},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:YA},336:{T:-1},337:{f:tN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Dw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:C8},427:{f:A8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:F8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:U6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:S8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vN},633:{T:1},634:{T:-1},635:{T:1,f:xN},636:{T:-1},637:{f:WT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Z8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:L8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Qf={6:{f:N0},10:{f:wa},12:{f:Kt},13:{f:Kt},14:{f:Wt},15:{f:Wt},16:{f:br},17:{f:Wt},18:{f:Wt},19:{f:Kt},20:{f:yx},21:{f:yx},23:{f:Dw},24:{f:kx},25:{f:Wt},26:{},27:{},28:{f:L3},29:{},34:{f:Wt},35:{f:_x},38:{f:br},39:{f:br},40:{f:br},41:{f:br},42:{f:Wt},43:{f:Wt},47:{f:XC},49:{f:u3},51:{f:Kt},60:{},61:{f:s3},64:{f:Wt},65:{f:c3},66:{f:Kt},77:{},80:{},81:{},82:{},85:{f:Kt},89:{},90:{},91:{},92:{f:K4},93:{f:U3},94:{},95:{f:Wt},96:{},97:{},99:{f:Wt},125:{f:jw},128:{f:b3},129:{f:Y4},130:{f:Kt},131:{f:Wt},132:{f:Wt},133:{f:J4},134:{},140:{f:K3},141:{f:Kt},144:{},146:{f:J3},151:{},152:{},153:{},154:{},155:{},156:{f:Kt},157:{},158:{},160:{f:aC},161:{f:eC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_3},190:{f:k3},193:{f:wa},197:{},198:{},199:{},200:{},201:{},202:{f:Wt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Kt},220:{},221:{f:Wt},222:{},224:{f:S3},225:{f:q4},226:{f:wa},227:{},229:{f:M3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z4},253:{f:h3},255:{f:t3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Tw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wt},353:{f:wa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:F3},431:{f:Wt},432:{},433:{},434:{},437:{},438:{f:H3},439:{f:Wt},440:{f:z3},441:{},442:{f:bl},443:{},444:{f:Kt},445:{},446:{},448:{f:wa},449:{f:a3,r:2},450:{f:wa},512:{f:gx},513:{f:nC},515:{f:A3},516:{f:p3},517:{f:wx},519:{f:sC},520:{f:r3},523:{},545:{f:Ex},549:{f:xx},566:{},574:{f:o3},638:{f:y3},659:{},1048:{},1054:{f:x3},1084:{},1212:{f:P3},2048:{f:G3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ac},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Q3,r:12},2173:{f:KA,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:I3,r:12},2197:{},2198:{f:WA,r:12},2199:{},2200:{},2201:{},2202:{f:D3,r:12},2203:{f:wa},2204:{},2205:{},2206:{},2207:{},2211:{f:n3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Kt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Y3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gx},1:{},2:{f:uC},3:{f:lC},4:{f:oC},5:{f:wx},7:{f:hC},8:{},9:{f:ac},11:{},22:{f:Kt},30:{f:v3},31:{},32:{},33:{f:Ex},36:{},37:{f:xx},50:{f:dC},62:{},52:{},67:{},68:{f:Kt},69:{},86:{},126:{},127:{f:iC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pC},223:{},234:{},354:{},421:{},518:{f:N0},521:{f:ac},536:{f:kx},547:{f:_x},561:{},579:{},1030:{f:N0},1033:{f:ac},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Te(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&md(r)&&e.push(r)}}function hR(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Te(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Nl(e,t,r){return e||(e=le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function dR(e,t,r,n){var a=le(9);return Nl(a,e,t),Cw(r,n||"b",a),a}function pR(e,t,r){var n=le(8+2*r.length);return Nl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function mR(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?tr(bt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Te(e,2,fC(r,n,a)):Te(e,3,cC(r,n,a));return;case"b":case"e":Te(e,5,dR(r,n,t.v,t.t));return;case"s":case"str":Te(e,4,pR(r,n,(t.v||"").slice(0,255)));return}Te(e,1,Nl(null,r,n))}function xR(e,t,r,n){var a=Array.isArray(t),s=ct(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Ze(s)}for(var c=s.s.r;c<=s.e.r;++c){o=zt(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=Rt(u)),i=l[u]+o;var h=a?(t[c]||[])[u]:t[i];h&&mR(e,h,c,u)}}}function gR(e,t){for(var r=t||{},n=zr(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Te(n,r.biff==4?1033:r.biff==3?521:9,bd(e,16,r)),xR(n,e.Sheets[e.SheetNames[a]],a,r),Te(n,10),n.end()}function vR(e,t,r){Te(e,49,f3({sz:12,name:"Arial"},r))}function wR(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Te(e,1054,g3(a,t[a],r))})}function yR(e,t){var r=le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Te(e,2151,r),r=le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Rw(ct(t["!ref"]||"A1"),r),r.write_shift(4,4),Te(e,2152,r)}function _R(e,t){for(var r=0;r<16;++r)Te(e,224,vx({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Te(e,224,vx(n,0,t))})}function kR(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Te(e,440,V3(n)),n[1].Tooltip&&Te(e,2048,q3(n))}delete t["!links"]}function ER(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Te(e,125,Z3(Lu(a,n),a))})}}function SR(e,t,r,n,a){var s=16+Ja(a.cellXfs,t,a);if(t.v==null&&!t.bf){Te(e,513,Ns(r,n,s));return}if(t.bf)Te(e,6,YF(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?tr(bt(t.v)):t.v;Te(e,515,N3(r,n,i,s));break;case"b":case"e":Te(e,517,C3(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Id(a.Strings,t.v,a.revStrings);Te(e,253,d3(r,n,o,s))}else Te(e,516,m3(r,n,(t.v||"").slice(0,255),s,a));break;default:Te(e,513,Ns(r,n,s))}}function bR(e,t,r){var n=zr(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,h="",d=[],p=ct(s["!ref"]||"A1"),x=c?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}Te(n,2057,bd(r,16,t)),Te(n,13,dn(1)),Te(n,12,dn(100)),Te(n,15,Ir(!0)),Te(n,17,Ir(!1)),Te(n,16,Cs(.001)),Te(n,95,Ir(!0)),Te(n,42,Ir(!1)),Te(n,43,Ir(!1)),Te(n,130,dn(1)),Te(n,128,T3()),Te(n,131,Ir(!1)),Te(n,132,Ir(!1)),c&&ER(n,s["!cols"]),Te(n,512,w3(p,t)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){h=zt(m);for(var v=p.s.c;v<=p.e.c;++v){m===p.s.r&&(d[v]=Rt(v)),u=d[v]+h;var w=l?(s[m]||[])[v]:s[u];w&&(SR(n,w,m,v,t),c&&w.l&&s["!links"].push([u,w.l]))}}var y=o.CodeName||o.name||a;return c&&Te(n,574,l3((i.Views||[])[0])),c&&(s["!merges"]||[]).length&&Te(n,229,B3(s["!merges"])),c&&kR(n,s),Te(n,442,Aw(y)),c&&yR(n,s),Te(n,10),n.end()}function TR(e,t,r){var n=zr(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(Te(n,2057,bd(e,5,r)),r.bookType=="xla"&&Te(n,135),Te(n,225,o?dn(1200):null),Te(n,193,C4(2)),l&&Te(n,191),l&&Te(n,192),Te(n,226),Te(n,92,X4("SheetJS",r)),Te(n,66,dn(o?1200:1252)),o&&Te(n,353,dn(0)),o&&Te(n,448),Te(n,317,rC(e.SheetNames.length)),o&&e.vbaraw&&Te(n,211),o&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";Te(n,442,Aw(c))}Te(n,156,dn(17)),Te(n,25,Ir(!1)),Te(n,18,Ir(!1)),Te(n,19,dn(0)),o&&Te(n,431,Ir(!1)),o&&Te(n,444,dn(0)),Te(n,61,i3()),Te(n,64,Ir(!1)),Te(n,141,dn(0)),Te(n,34,Ir(aO(e)=="true")),Te(n,14,Ir(!0)),o&&Te(n,439,Ir(!1)),Te(n,218,dn(0)),vR(n,e,r),wR(n,e.SSF,r),_R(n,r),o&&Te(n,352,Ir(!1));var u=n.end(),h=zr();o&&Te(h,140,X3()),o&&r.Strings&&hR(h,252,e3(r.Strings)),Te(h,10);var d=h.end(),p=zr(),x=0,m=0;for(m=0;m<e.SheetNames.length;++m)x+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var v=u.length+x+d.length;for(m=0;m<e.SheetNames.length;++m){var w=s[m]||{};Te(p,133,Q4({pos:v,hs:w.Hidden||0,dt:0,name:e.SheetNames[m]},r)),v+=t[m].length}var y=p.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var g=[];return u.length&&g.push(u),y.length&&g.push(y),d.length&&g.push(d),sr(g)}function CR(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Tt(qe)),e&&e.SSF&&(Wi(),Fu(e.SSF),r.revssf=Ru(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Md(r),r.cellXfs=[],Ja(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=bR(a,r,e);return n.unshift(TR(e,n,r)),sr(n)}function _y(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Vr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return CR(e,t);case 4:case 3:case 2:return gR(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Ix(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=fT(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var m=l[i].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var w=m.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var y=w[o].trim();if(y.match(/<t[dh]/i)){for(var g=y,b=0;g.charAt(0)=="<"&&(b=g.indexOf(">"))>-1;)g=g.slice(b+1);for(var I=0;I<x.length;++I){var A=x[I];A.s.c==u&&A.s.r<c&&c<=A.e.r&&(u=A.e.c+1,I=-1)}var E=Ye(y.slice(0,y.indexOf(">")));d=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||d>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var _=E.t||E["data-t"]||"";if(!g.length){u+=d;continue}if(g=Vv(g),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!g.length){u+=d;continue}var k={t:"s",v:g};r.raw||!g.trim().length||_=="s"||(g==="TRUE"?k={t:"b",v:!0}:g==="FALSE"?k={t:"b",v:!1}:isNaN(Dn(g))?isNaN(Pi(g).getDate())||(k={t:"d",v:bt(g)},r.cellDates||(k={t:"n",v:tr(k.v)}),k.z=r.dateNF||qe[14]):k={t:"n",v:Dn(g)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=k):n[Ke({r:c,c:u})]=k,u+=d}}}}return n["!ref"]=Ze(p),x.length&&(n["!merges"]=x),n}function AR(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Ke({r,c:i}),h=n.dense?(e[r]||[])[i]:e[u],d=h&&h.v!=null&&(h.h||hd(h.w||(fa(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(Se("td",d,p))}}var x="<tr>";return x+s.join("")+"</tr>"}var NR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',FR="</body></html>";function OR(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ya(Ix(r[0],t),t);var n=$d();return r.forEach(function(a,s){Wd(n,Ix(a,t),"Sheet"+(s+1))}),n}function RR(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ky(e,t){var r=t||{},n=r.header!=null?r.header:NR,a=r.footer!=null?r.footer:FR,s=[n],i=Vr(e["!ref"]);r.dense=Array.isArray(e),s.push(RR(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(AR(e,i,o,r));return s.push("</table>"+a),s.join("")}function Ey(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?It(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=Vr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var h=[],d=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,v=0,w=0,y=0,g=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&m<l;++x){var b=o[x];if(Px(b)){if(n.display)continue;p[m]={hidden:!0}}var I=b.children;for(v=w=0;v<I.length;++v){var A=I[v];if(!(n.display&&Px(A))){var E=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):Vv(A.innerHTML),_=A.getAttribute("data-z")||A.getAttribute("z");for(d=0;d<h.length;++d){var k=h[d];k.s.c==w+s&&k.s.r<m+a&&m+a<=k.e.r&&(w=k.e.c+1-s,d=-1)}g=+A.getAttribute("colspan")||1,((y=+A.getAttribute("rowspan")||1)>1||g>1)&&h.push({s:{r:m+a,c:w+s},e:{r:m+a+(y||1)-1,c:w+s+(g||1)-1}});var O={t:"s",v:E},H=A.getAttribute("data-t")||A.getAttribute("t")||"";E!=null&&(E.length==0?O.t=H||"z":n.raw||E.trim().length==0||H=="s"||(E==="TRUE"?O={t:"b",v:!0}:E==="FALSE"?O={t:"b",v:!1}:isNaN(Dn(E))?isNaN(Pi(E).getDate())||(O={t:"d",v:bt(E)},n.cellDates||(O={t:"n",v:tr(O.v)}),O.z=n.dateNF||qe[14]):O={t:"n",v:Dn(E)})),O.z===void 0&&_!=null&&(O.z=_);var L="",V=A.getElementsByTagName("A");if(V&&V.length)for(var Y=0;Y<V.length&&!(V[Y].hasAttribute("href")&&(L=V[Y].getAttribute("href"),L.charAt(0)!="#"));++Y);L&&L.charAt(0)!="#"&&(O.l={Target:L}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][w+s]=O):e[Ke({c:w+s,r:m+a})]=O,c.e.c<w+s&&(c.e.c=w+s),w+=g}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Ze(c),m>=l&&(e["!fullref"]=Ze((c.e.r=o.length-x+m-1+a,c))),e}function Sy(e,t){var r=t||{},n=r.dense?[]:{};return Ey(n,e,t)}function IR(e,t){return Ya(Sy(e,t),t)}function Px(e){var t="",r=PR(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function PR(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function DR(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(t.replace(/<[^>]*>/g,""));return[r]}var Dx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function by(e,t){var r=t||{},n=dd(e),a=[],s,i,o={name:""},l="",c=0,u,h,d={},p=[],x=r.dense?[]:{},m,v,w={value:""},y="",g=0,b=[],I=-1,A=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},_=0,k={},O=[],H={},L=0,V=0,Y=[],de=1,me=1,ie=[],ee={Names:[]},T={},q=["",""],te=[],C={},M="",W=0,P=!1,z=!1,he=0;for(il.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=il.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?x["!ref"]=Ze(E):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(x["!fullref"]=x["!ref"],E.e.r=r.sheetRows-1,x["!ref"]=Ze(E)),O.length&&(x["!merges"]=O),Y.length&&(x["!rows"]=Y),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),d[u.name]=x,z=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=Ye(m[0],!1),I=A=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,x=r.dense?[]:{},O=[],Y=[],z=!0);break;case"table-row-group":m[1]==="/"?--_:++_;break;case"table-row":case"":if(m[1]==="/"){I+=de,de=1;break}if(h=Ye(m[0],!1),h.?I=h.-1:I==-1&&(I=0),de=+h["number-rows-repeated"]||1,de<10)for(he=0;he<de;++he)_>0&&(Y[I+he]={level:_});A=-1;break;case"covered-table-cell":m[1]!=="/"&&++A,r.sheetStubs&&(r.dense?(x[I]||(x[I]=[]),x[I][A]={t:"z"}):x[Ke({r:I,c:A})]={t:"z"}),y="",b=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++A,w=Ye(m[0],!1),me=parseInt(w["number-columns-repeated"]||"1",10),v={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(v.f=Fx(lt(w.formula))),(w.||w["value-type"])=="string"&&(v.t="s",v.v=lt(w["string-value"]||""),r.dense?(x[I]||(x[I]=[]),x[I][A]=v):x[Ke({r:I,c:A})]=v),A+=me-1;else if(m[1]!=="/"){++A,y="",g=0,b=[],me=1;var ae=de?I+de-1:I;if(A>E.e.c&&(E.e.c=A),A<E.s.c&&(E.s.c=A),I<E.s.r&&(E.s.r=I),ae>E.e.r&&(E.e.r=ae),w=Ye(m[0],!1),te=[],C={},v={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=lt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(L=parseInt(w["number-matrix-rows-spanned"],10)||0,V=parseInt(w["number-matrix-columns-spanned"],10)||0,H={s:{r:I,c:A},e:{r:I+L-1,c:A+V-1}},v.F=Ze(H),ie.push([H,v.F])),w.formula)v.f=Fx(w.formula);else for(he=0;he<ie.length;++he)I>=ie[he][0].s.r&&I<=ie[he][0].e.r&&A>=ie[he][0].s.c&&A<=ie[he][0].e.c&&(v.F=ie[he][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(L=parseInt(w["number-rows-spanned"],10)||0,V=parseInt(w["number-columns-spanned"],10)||0,H={s:{r:I,c:A},e:{r:I+L-1,c:A+V-1}},O.push(H)),w["number-columns-repeated"]&&(me=parseInt(w["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Et(w["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(w.value);break;case"percentage":v.t="n",v.v=parseFloat(w.value);break;case"currency":v.t="n",v.v=parseFloat(w.value);break;case"date":v.t="d",v.v=bt(w["date-value"]),r.cellDates||(v.t="n",v.v=tr(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=lT(w["time-value"])/86400,r.cellDates&&(v.t="d",v.v=Iu(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(w.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",w["string-value"]!=null&&(y=lt(w["string-value"]),b=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(P=!1,v.t==="s"&&(v.v=y||"",b.length&&(v.R=b),P=g==0),T.Target&&(v.l=T),te.length>0&&(v.c=te,te=[]),y&&r.cellText!==!1&&(v.w=y),P&&(v.t="z",delete v.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var se=0;se<de;++se){if(me=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(x[I+se]||(x[I+se]=[]),x[I+se][A]=se==0?v:Tt(v);--me>0;)x[I+se][A+me]=Tt(v);else for(x[Ke({r:I+se,c:A})]=v;--me>0;)x[Ke({r:I+se,c:A+me})]=Tt(v);E.e.c<=A&&(E.e.c=A)}me=parseInt(w["number-columns-repeated"]||"1",10),A+=me-1,me=0,v={},y="",b=[]}T={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;C.t=y,b.length&&(C.R=b),C.a=M,te.push(C)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);M="",W=0,y="",g=0,b=[];break;case"creator":m[1]==="/"?M=n.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);y="",g=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(k[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Ye(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ye(m[0],!1),l+=Dx[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ye(m[0],!1),l+=Dx[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=Ye(m[0],!1),q=F0(i["cell-range-address"]);var oe={Name:i.name,Ref:q[0]+"!"+q[1]};z&&(oe.Sheet=p.length),ee.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!w||!w["string-value"])){var ye=DR(n.slice(g,m.index));y=(y.length>0?y+`
`:"")+ye[0]}else Ye(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{q=F0(Ye(m[0])["target-range-address"]),d[q[0]]["!autofilter"]={ref:q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(T=Ye(m[0],!1),!T.href)break;T.Target=lt(T.href),delete T.href,T.Target.charAt(0)=="#"&&T.Target.indexOf(".")>-1?(q=F0(T.Target.slice(1)),T.Target="#"+q[0]+"!"+q[1]):T.Target.match(/^\.\.[\\\/]/)&&(T.Target=T.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var R={Sheets:d,SheetNames:p,Workbook:ee};return r.bookSheets&&delete R.Sheets,R}function jx(e,t){t=t||{},hn(e,"META-INF/manifest.xml")&&l4(qt(e,"META-INF/manifest.xml"),t);var r=Zr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=by(gt(r),t);return hn(e,"meta.xml")&&(n.Props=mw(qt(e,"meta.xml"))),n}function Lx(e,t){return by(e,t)}var jR=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+sl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Vt+t}}(),Mx=function(){var e=function(s){return mt(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var l=[];l.push('      <table:table table:name="'+mt(i.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=Vr(s["!ref"]||"A1"),d=s["!merges"]||[],p=0,x=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",v=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var w=!1,y={},g="";for(p=0;p!=d.length;++p)if(!(d[p].s.c>u)&&!(d[p].s.r>c)&&!(d[p].e.c<u)&&!(d[p].e.r<c)){(d[p].s.c!=u||d[p].s.r!=c)&&(w=!0),y["table:number-columns-spanned"]=d[p].e.c-d[p].s.c+1,y["table:number-rows-spanned"]=d[p].e.r-d[p].s.r+1;break}if(w){l.push(r);continue}var b=Ke({r:c,c:u}),I=x?(s[c]||[])[u]:s[b];if(I&&I.f&&(y["table:formula"]=mt(r6(I.f)),I.F&&I.F.slice(0,b.length)==b)){var A=Vr(I.F);y["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,y["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!I){l.push(t);continue}switch(I.t){case"b":g=I.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=I.v?"true":"false";break;case"n":g=I.w||String(I.v||0),y["office:value-type"]="float",y["office:value"]=I.v||0;break;case"s":case"str":g=I.v==null?"":I.v,y["office:value-type"]="string";break;case"d":g=I.w||bt(I.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=bt(I.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var E=e(g);if(I.l&&I.l.Target){var _=I.l.Target;_=_.charAt(0)=="#"?"#"+n6(_.slice(1)):_,_.charAt(0)!="#"&&!_.match(/^\w+:/)&&(_="../"+_),E=Se("text:a",E,{"xlink:href":_.replace(/&/g,"&amp;")})}l.push("          "+Se("table:table-cell",Se("text:p",E,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Wa(h),h.ods=o;var d=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var l=[Vt],c=sl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=sl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(pw().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)l.push(n(i.Sheets[i.SheetNames[h]],i,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Ty(e,t){if(t.bookType=="fods")return Mx(e,t);var r=cd(),n="",a=[],s=[];return n="mimetype",et(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",et(r,n,Mx(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",et(r,n,jR(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",et(r,n,Vt+pw()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",et(r,n,f4(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",et(r,n,c4(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):gt(Xa(e))}function LR(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qr(zn(e))}function MR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function za(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Bx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function BR(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function UR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function dl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function dt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ut(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ft(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=dl(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=dl(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function ur(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(dt(n*8+a.type)),a.type==2&&t.push(dt(a.data.length)),t.push(a.data))})}),za(t)}function jd(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function un(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=dl(e,n),s=ft(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Ut(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=ft(o.data),c=Ut(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=Ut(s[3][0].data)>>>0>0),r.push(i)}return r}function Xs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:dt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:dt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:dt(i.data.length)}],n[2].push({data:ur(i.meta),type:2})});var s=ur(n);t.push(dt(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),za(t)}function $R(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=dl(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[za(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=za(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function fn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push($R(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return za(t)}function Ys(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=dt(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return za(t)}function WR(e,t,r,n){var a=Fs(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Bx(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Bx(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function HR(e,t,r){var n=Fs(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=BR(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return h}function R0(e,t){var r=new Uint8Array(32),n=Fs(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,UR(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function I0(e,t){var r=new Uint8Array(32),n=Fs(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function zR(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return WR(e,t,r,e[0]);case 5:return HR(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function _r(e){var t=ft(e);return dl(t[1][0].data)}function Ux(e,t){var r=ft(t.data),n=Ut(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=ft(i.data),l=Ut(o[1][0].data)>>>0;switch(n){case 1:s[l]=Zf(o[3][0].data);break;case 8:{var c=e[_r(o[9][0].data)][0],u=ft(c.data),h=e[_r(u[1][0].data)][0],d=Ut(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=ft(h.data);s[l]=p[3].map(function(x){return Zf(x.data)}).join("")}break}}),s}function VR(e,t){var r,n,a,s,i,o,l,c,u,h,d,p,x,m,v=ft(e),w=Ut(v[1][0].data)>>>0,y=Ut(v[2][0].data)>>>0,g=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&Ut(v[8][0].data)>0||!1,b,I;if((s=(a=v[7])==null?void 0:a[0])!=null&&s.data&&t!=0)b=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,I=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=v[4])==null?void 0:u[0])!=null&&h.data&&t!=1)b=(p=(d=v[4])==null?void 0:d[0])==null?void 0:p.data,I=(m=(x=v[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var A=g?4:1,E=Fs(b),_=[],k=0;k<b.length/2;++k){var O=E.getUint16(k*2,!0);O<65535&&_.push([k,O])}if(_.length!=y)throw"Expected ".concat(y," cells, found ").concat(_.length);var H=[];for(k=0;k<_.length-1;++k)H[_[k][0]]=I.subarray(_[k][1]*A,_[k+1][1]*A);return _.length>=1&&(H[_[_.length-1][0]]=I.subarray(_[_.length-1][1]*A)),{R:w,cells:H}}function GR(e,t){var r,n=ft(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ut(n[7][0].data)>>>0>0?1:0:-1,s=jd(n[5],function(i){return VR(i,a)});return{nrows:Ut(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function qR(e,t,r){var n,a=ft(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ut(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ut(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ze(s);var i=ft(a[4][0].data),o=Ux(e,e[_r(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Ux(e,e[_r(i[17][0].data)][0]):[],c=ft(i[3][0].data),u=0;c[1].forEach(function(h){var d=ft(h.data),p=e[_r(d[2][0].data)][0],x=Ut(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=GR(e,p);m.data.forEach(function(v,w){v.forEach(function(y,g){var b=Ke({r:u+w,c:g}),I=zR(y,o,l);I&&(r[b]=I)})}),u+=m.nrows})}function KR(e,t){var r=ft(t.data),n={"!ref":"A1"},a=e[_r(r[2][0].data)],s=Ut(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return qR(e,a[0],n),n}function XR(e,t){var r,n=ft(t.data),a={name:(r=n[1])!=null&&r[0]?Zf(n[1][0].data):"",sheets:[]},s=jd(n[2],_r);return s.forEach(function(i){e[i].forEach(function(o){var l=Ut(o.meta[1][0].data);l==6e3&&a.sheets.push(KR(e,o))})}),a}function YR(e,t){var r=$d(),n=ft(t.data),a=jd(n[1],_r);if(a.forEach(function(s){e[s].forEach(function(i){var o=Ut(i.meta[1][0].data);if(o==2){var l=XR(e,i);l.sheets.forEach(function(c,u){Wd(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function P0(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=fn(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=un(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ut(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var u=Ut(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return YR(s,o)}function JR(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Ut(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Fs(e[7][0].data),u=0,h=[],d=Fs(e[4][0].data),p=0,x=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),d.setUint16(m*2,p,!0);var v,w;switch(typeof t[m]){case"string":v=R0({t:"s",v:t[m]},r),w=I0({t:"s",v:t[m]},r);break;case"number":v=R0({t:"n",v:t[m]},r),w=I0({t:"n",v:t[m]},r);break;case"boolean":v=R0({t:"b",v:t[m]},r),w=I0({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(v),u+=v.length,x.push(w),p+=w.length,++l}for(e[2][0].data=dt(l);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return e[6][0].data=za(h),e[3][0].data=za(x),l}function QR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Vr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ze(n)));var s=lu(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(M){return M.forEach(function(W){typeof W=="string"&&i.push(W)})});var o={},l=[],c=Ue.read(t.numbers,{type:"base64"});c.FileIndex.map(function(M,W){return[M,c.FullPaths[W]]}).forEach(function(M){var W=M[0],P=M[1];if(W.type==2&&W.name.match(/\.iwa/)){var z=W.content,he=fn(z),ae=un(he);ae.forEach(function(se){l.push(se.id),o[se.id]={deps:[],location:P,type:Ut(se.messages[0].meta[1][0].data)}})}}),l.sort(function(M,W){return M-W});var u=l.filter(function(M){return M>1}).map(function(M){return[M,dt(M)]});c.FileIndex.map(function(M,W){return[M,c.FullPaths[W]]}).forEach(function(M){var W=M[0];if(M[1],!!W.name.match(/\.iwa/)){var P=un(fn(W.content));P.forEach(function(z){z.messages.forEach(function(he){u.forEach(function(ae){z.messages.some(function(se){return Ut(se.meta[1][0].data)!=11006&&MR(se.data,ae[1])})&&o[ae[0]].deps.push(z.id)})})})}});for(var h=Ue.find(c,o[1].location),d=un(fn(h.content)),p,x=0;x<d.length;++x){var m=d[x];m.id==1&&(p=m)}var v=_r(ft(p.messages[0].data)[1][0].data);for(h=Ue.find(c,o[v].location),d=un(fn(h.content)),x=0;x<d.length;++x)m=d[x],m.id==v&&(p=m);for(v=_r(ft(p.messages[0].data)[2][0].data),h=Ue.find(c,o[v].location),d=un(fn(h.content)),x=0;x<d.length;++x)m=d[x],m.id==v&&(p=m);for(v=_r(ft(p.messages[0].data)[2][0].data),h=Ue.find(c,o[v].location),d=un(fn(h.content)),x=0;x<d.length;++x)m=d[x],m.id==v&&(p=m);var w=ft(p.messages[0].data);{w[6][0].data=dt(n.e.r+1),w[7][0].data=dt(n.e.c+1);var y=_r(w[46][0].data),g=Ue.find(c,o[y].location),b=un(fn(g.content));{for(var I=0;I<b.length&&b[I].id!=y;++I);if(b[I].id!=y)throw"Bad ColumnRowUIDMapArchive";var A=ft(b[I].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var E=0;E<=n.e.c;++E){var _=[];_[1]=_[2]=[{type:0,data:dt(E+420690)}],A[1].push({type:2,data:ur(_)}),A[2].push({type:0,data:dt(E)}),A[3].push({type:0,data:dt(E)})}A[4]=[],A[5]=[],A[6]=[];for(var k=0;k<=n.e.r;++k)_=[],_[1]=_[2]=[{type:0,data:dt(k+726270)}],A[4].push({type:2,data:ur(_)}),A[5].push({type:0,data:dt(k)}),A[6].push({type:0,data:dt(k)});b[I].messages[0].data=ur(A)}g.content=Ys(Xs(b)),g.size=g.content.length,delete w[46];var O=ft(w[4][0].data);{O[7][0].data=dt(n.e.r+1);var H=ft(O[1][0].data),L=_r(H[2][0].data);g=Ue.find(c,o[L].location),b=un(fn(g.content));{if(b[0].id!=L)throw"Bad HeaderStorageBucket";var V=ft(b[0].messages[0].data);for(k=0;k<s.length;++k){var Y=ft(V[2][0].data);Y[1][0].data=dt(k),Y[4][0].data=dt(s[k].length),V[2][k]={type:V[2][0].type,data:ur(Y)}}b[0].messages[0].data=ur(V)}g.content=Ys(Xs(b)),g.size=g.content.length;var de=_r(O[2][0].data);g=Ue.find(c,o[de].location),b=un(fn(g.content));{if(b[0].id!=de)throw"Bad HeaderStorageBucket";for(V=ft(b[0].messages[0].data),E=0;E<=n.e.c;++E)Y=ft(V[2][0].data),Y[1][0].data=dt(E),Y[4][0].data=dt(n.e.r+1),V[2][E]={type:V[2][0].type,data:ur(Y)};b[0].messages[0].data=ur(V)}g.content=Ys(Xs(b)),g.size=g.content.length;var me=_r(O[4][0].data);(function(){for(var M=Ue.find(c,o[me].location),W=un(fn(M.content)),P,z=0;z<W.length;++z){var he=W[z];he.id==me&&(P=he)}var ae=ft(P.messages[0].data);{ae[3]=[];var se=[];i.forEach(function(R,Me){se[1]=[{type:0,data:dt(Me)}],se[2]=[{type:0,data:dt(1)}],se[3]=[{type:2,data:LR(R)}],ae[3].push({type:2,data:ur(se)})})}P.messages[0].data=ur(ae);var oe=Xs(W),ye=Ys(oe);M.content=ye,M.size=M.content.length})();var ie=ft(O[3][0].data);{var ee=ie[1][0];delete ie[2];var T=ft(ee.data);{var q=_r(T[2][0].data);(function(){for(var M=Ue.find(c,o[q].location),W=un(fn(M.content)),P,z=0;z<W.length;++z){var he=W[z];he.id==q&&(P=he)}var ae=ft(P.messages[0].data);{delete ae[6],delete ie[7];var se=new Uint8Array(ae[5][0].data);ae[5]=[];for(var oe=0,ye=0;ye<=n.e.r;++ye){var R=ft(se);oe+=JR(R,s[ye],i),R[1][0].data=dt(ye),ae[5].push({data:ur(R),type:2})}ae[1]=[{type:0,data:dt(n.e.c+1)}],ae[2]=[{type:0,data:dt(n.e.r+1)}],ae[3]=[{type:0,data:dt(oe)}],ae[4]=[{type:0,data:dt(n.e.r+1)}]}P.messages[0].data=ur(ae);var Me=Xs(W),U=Ys(Me);M.content=U,M.size=M.content.length})()}ee.data=ur(T)}O[3][0].data=ur(ie)}w[4][0].data=ur(O)}p.messages[0].data=ur(w);var te=Xs(d),C=Ys(te);return h.content=C,h.size=h.content.length,c}function Cy(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Ld(e){Cy([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Md(e){Cy([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ZR(e){return rt.WS.indexOf(e)>-1?"sheet":e==rt.CS?"chart":e==rt.DS?"dialog":e==rt.MS?"macro":e&&e.length?e:"sheet"}function e5(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,ZR(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function t5(e,t,r,n,a,s,i,o,l,c,u,h){try{s[n]=Co(Zr(e,r,!0),t);var d=qt(e,t),p;switch(o){case"sheet":p=EO(d,t,a,l,s[n],c,u,h);break;case"chart":if(p=SO(d,t,a,l,s[n],c,u,h),!p||!p["!drawel"])break;var x=fo(p["!drawel"].Target,t),m=ol(x),v=uN(Zr(e,x,!0),Co(Zr(e,m,!0),x)),w=fo(v,x),y=ol(w);p=J8(Zr(e,w,!0),w,l,Co(Zr(e,y,!0),w),c,p);break;case"macro":p=bO(d,t,a,l,s[n],c,u,h);break;case"dialog":p=TO(d,t,a,l,s[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var g=[];s&&s[n]&&$t(s[n]).forEach(function(b){var I="";if(s[n][b].Type==rt.CMNT){I=fo(s[n][b].Target,t);var A=FO(qt(e,I,!0),I,l);if(!A||!A.length)return;bx(p,A,!1)}s[n][b].Type==rt.TCMNT&&(I=fo(s[n][b].Target,t),g=g.concat(hN(qt(e,I,!0),l)))}),g&&g.length&&bx(p,g,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function ln(e){return e.charAt(0)=="/"?e.slice(1):e}function r5(e,t){if(Wi(),t=t||{},Ld(t),hn(e,"META-INF/manifest.xml")||hn(e,"objectdata.xml"))return jx(e,t);if(hn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof P0<"u"){if(e.FileIndex)return P0(e);var r=Ue.utils.cfb_new();return Gm(e).forEach(function(Y){et(r,Y,dT(e,Y))}),P0(r)}throw new Error("Unsupported NUMBERS file")}if(!hn(e,"[Content_Types].xml"))throw hn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):hn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Gm(e),a=i4(Zr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",qt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!qt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Ao=[],a.sst)try{Ao=NO(qt(e,ln(a.sst)),a.sst,t)}catch(Y){if(t.WTF)throw Y}t.cellStyles&&a.themes.length&&(l=AO(Zr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=CO(qt(e,ln(a.style)),a.style,l,t))}a.links.map(function(Y){try{var de=Co(Zr(e,ol(ln(Y))),Y);return RO(qt(e,ln(Y)),de,Y,t)}catch{}});var u=kO(qt(e,ln(a.workbooks[0])),a.workbooks[0],t),h={},d="";a.coreprops.length&&(d=qt(e,ln(a.coreprops[0]),!0),d&&(h=mw(d)),a.extprops.length!==0&&(d=qt(e,ln(a.extprops[0]),!0),d&&d4(d,h,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=Zr(e,ln(a.custprops[0]),!0),d&&(p=m4(d,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(de){return de.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(x.Props=h,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var m={};t.bookDeps&&a.calcchain&&(m=OO(qt(e,ln(a.calcchain)),a.calcchain));var v=0,w={},y,g;{var b=u.Sheets;h.Worksheets=b.length,h.SheetNames=[];for(var I=0;I!=b.length;++I)h.SheetNames[I]=b[I].name}var A=s?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),_=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");hn(e,_)||(_="xl/_rels/workbook."+A+".rels");var k=Co(Zr(e,_,!0),_.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=IO(qt(e,ln(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=pN(qt(e,ln(a.people[0])),t)),k&&(k=e5(k,u.Sheets));var O=qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=h.Worksheets;++v){var H="sheet";if(k&&k[v]?(y="xl/"+k[v][1].replace(/[\/]?xl\//,""),hn(e,y)||(y=k[v][1]),hn(e,y)||(y=_.replace(/_rels\/.*$/,"")+k[v][1]),H=k[v][2]):(y="xl/worksheets/sheet"+(v+1-O)+"."+A,y=y.replace(/sheet0\./,"sheet.")),g=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(h.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==v&&(L=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==h.SheetNames[v].toLowerCase()&&(L=1);if(!L)continue e}}t5(e,y,g,h.SheetNames[v],v,w,i,H,t,u,l,c)}return x={Directory:a,Workbook:u,Props:h,Custprops:p,Deps:m,Sheets:i,SheetNames:h.SheetNames,Strings:Ao,Styles:c,Themes:l,SSF:Tt(qe)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(Y,de){Y=Y.replace(/^Root Entry[\/]/,""),x.keys.push(Y),x.files[Y]=e.FileIndex[de]}))),t&&t.bookVBA&&(a.vba.length>0?x.vbaraw=qt(e,ln(a.vba[0]),!0):a.defaults&&a.defaults.bin===kN&&(x.vbaraw=qt(e,"xl/vbaProject.bin",!0))),x}function n5(e,t){var r=t||{},n="Workbook",a=Ue.find(e,n);try{if(n="/!DataSpaces/Version",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(IC(a.content),n="/!DataSpaces/DataSpaceMap",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=DC(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=jC(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);MC(a.content)}catch{}if(n="/EncryptionInfo",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=BC(a.content);if(n="/EncryptedPackage",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function a5(e,t){return t.bookType=="ods"?Ty(e,t):t.bookType=="numbers"?QR(e,t):t.bookType=="xlsb"?s5(e,t):i5(e,t)}function s5(e,t){mi=1024,e&&!e.SSF&&(e.SSF=Tt(qe)),e&&e.SSF&&(Wi(),Fu(e.SSF),t.revssf=Ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,No?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=ey.indexOf(t.bookType)>-1,a=Ed();Md(t=t||{});var s=cd(),i="",o=0;if(t.cellXfs=[],Ja(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",et(s,i,xw(e.Props,t)),a.coreprops.push(i),pt(t.rels,2,i,rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,et(s,i,ww(e.Props)),a.extprops.push(i),pt(t.rels,3,i,rt.EXT_PROPS),e.Custprops!==e.Props&&$t(e.Custprops||{}).length>0&&(i="docProps/custom.xml",et(s,i,yw(e.Custprops)),a.custprops.push(i),pt(t.rels,4,i,rt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,et(s,i,DO(o-1,i,t,e,u)),a.sheets.push(i),pt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(h){var p=h["!comments"],x=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,et(s,m,MO(p,m)),a.comments.push(m),pt(u,-1,"../comments"+o+"."+r,rt.CMNT),x=!0),h["!legacy"]&&x&&et(s,"xl/drawings/vmlDrawing"+o+".vml",Qw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&et(s,ol(i),Si(u))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,et(s,i,LO(t.Strings,i,t)),a.strs.push(i),pt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),i="xl/workbook."+r,et(s,i,PO(e,i)),a.workbooks.push(i),pt(t.rels,1,i,rt.WB),i="xl/theme/theme1.xml",et(s,i,Nd(e.Themes,t)),a.themes.push(i),pt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),i="xl/styles."+r,et(s,i,jO(e,i,t)),a.styles.push(i),pt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",et(s,i,e.vbaraw),a.vba.push(i),pt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),i="xl/metadata."+r,et(s,i,BO(i)),a.metadata.push(i),pt(t.wbrels,-1,"metadata."+r,rt.XLMETA),et(s,"[Content_Types].xml",dw(a,t)),et(s,"_rels/.rels",Si(t.rels)),et(s,"xl/_rels/workbook."+r+".rels",Si(t.wbrels)),delete t.revssf,delete t.ssf,s}function i5(e,t){mi=1024,e&&!e.SSF&&(e.SSF=Tt(qe)),e&&e.SSF&&(Wi(),Fu(e.SSF),t.revssf=Ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,No?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=ey.indexOf(t.bookType)>-1,a=Ed();Md(t=t||{});var s=cd(),i="",o=0;if(t.cellXfs=[],Ja(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",et(s,i,xw(e.Props,t)),a.coreprops.push(i),pt(t.rels,2,i,rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,et(s,i,ww(e.Props)),a.extprops.push(i),pt(t.rels,3,i,rt.EXT_PROPS),e.Custprops!==e.Props&&$t(e.Custprops||{}).length>0&&(i="docProps/custom.xml",et(s,i,yw(e.Custprops)),a.custprops.push(i),pt(t.rels,4,i,rt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,et(s,i,fy(o-1,t,e,h)),a.sheets.push(i),pt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(d){var x=d["!comments"],m=!1,v="";if(x&&x.length>0){var w=!1;x.forEach(function(y){y[1].forEach(function(g){g.T==!0&&(w=!0)})}),w&&(v="xl/threadedComments/threadedComment"+o+"."+r,et(s,v,dN(x,u,t)),a.threadedcomments.push(v),pt(h,-1,"../threadedComments/threadedComment"+o+"."+r,rt.TCMNT)),v="xl/comments"+o+"."+r,et(s,v,Zw(x)),a.comments.push(v),pt(h,-1,"../comments"+o+"."+r,rt.CMNT),m=!0}d["!legacy"]&&m&&et(s,"xl/drawings/vmlDrawing"+o+".vml",Qw(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&et(s,ol(i),Si(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,et(s,i,Uw(t.Strings,t)),a.strs.push(i),pt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),i="xl/workbook."+r,et(s,i,xy(e)),a.workbooks.push(i),pt(t.rels,1,i,rt.WB),i="xl/theme/theme1.xml",et(s,i,Nd(e.Themes,t)),a.themes.push(i),pt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),i="xl/styles."+r,et(s,i,Kw(e,t)),a.styles.push(i),pt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",et(s,i,e.vbaraw),a.vba.push(i),pt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),i="xl/metadata."+r,et(s,i,Jw()),a.metadata.push(i),pt(t.wbrels,-1,"metadata."+r,rt.XLMETA),u.length>1&&(i="xl/persons/person.xml",et(s,i,mN(u)),a.people.push(i),pt(t.wbrels,-1,"persons/person.xml",rt.PEOPLE)),et(s,"[Content_Types].xml",dw(a,t)),et(s,"_rels/.rels",Si(t.rels)),et(s,"xl/_rels/workbook."+r+".rels",Si(t.wbrels)),delete t.revssf,delete t.ssf,s}function Bd(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=nn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function o5(e,t){return Ue.find(e,"EncryptedPackage")?n5(e,t):yy(e,t)}function l5(e,t){var r,n=e,a=t||{};return a.type||(a.type=tt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Wv(n,a),r5(r,a)}function Ay(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Jf(e.slice(r),t);default:break e}return Di.to_workbook(e,t)}function c5(e,t){var r="",n=Bd(e,t);switch(t.type){case"base64":r=nn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ts(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=gt(r)),t.type="binary",Ay(r,t)}function u5(e,t){var r=e;return t.type=="base64"&&(r=nn(r)),r=tl.utils.decode(1200,r.slice(2),"str"),t.type="binary",Ay(r,t)}function f5(e){return e.match(/[^\x00-\x7F]/)?zn(e):e}function D0(e,t,r,n){return n?(r.type="string",Di.to_workbook(e,r)):Di.to_workbook(t,r)}function eh(e,t){ad();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return eh(new Uint8Array(e),(r=Tt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ti={},r.dateNF&&(Ti.dateNF=r.dateNF),r.type||(r.type=tt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=tt?"buffer":"binary",n=sT(e),typeof Uint8Array<"u"&&!tt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=f5(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Tt(r),r.type="array",eh(sd(n),r)}switch((a=Bd(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return o5(Ue.read(n,r),r);break;case 9:if(a[1]<=8)return yy(n,r);break;case 60:return Jf(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return xC(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Mw.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?l5(n,r):D0(e,n,r,s);case 239:return a[3]===60?Jf(n,r):D0(e,n,r,s);case 255:if(a[1]===254)return u5(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return vs.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return vs.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Yf.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Vw.to_workbook(n,r);break;case 10:case 13:case 32:return c5(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return mC.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Yf.to_workbook(n,r):D0(e,n,r,s)}function Ny(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return kl(t.file,Ue.write(e,{type:tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ue.write(e,t)}function h5(e,t){var r=Tt(t||{}),n=a5(e,r);return d5(n,r)}function d5(e,t){var r={},n=tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ue.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Nu(a))}return t.password&&typeof encrypt_agile<"u"?Ny(encrypt_agile(a,t.password),t):t.type==="file"?kl(t.file,a):t.type=="string"?gt(a):a}function p5(e,t){var r=t||{},n=fR(e,r);return Ny(n,r)}function $n(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return rl(zn(n));case"binary":return zn(n);case"string":return e;case"file":return kl(t.file,n,"utf8");case"buffer":return tt?pa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$n(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function m5(e,t){switch(t.type){case"base64":return rl(e);case"binary":return e;case"string":return e;case"file":return kl(t.file,e,"binary");case"buffer":return tt?pa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function lc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?rl(r):t.type=="string"?gt(r):r;case"file":return kl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Fy(e,t){ad(),oO(e);var r=Tt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Fy(e,r);return r.type="array",Nu(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $n(aR(e,r),r);case"slk":case"sylk":return $n(Lw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return $n(ky(e.Sheets[e.SheetNames[a]],r),r);case"txt":return m5(Oy(e.Sheets[e.SheetNames[a]],r),r);case"csv":return $n(Ud(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return $n(Mw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return lc(Yf.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return $n(Di.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return $n(Vw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return $n(Bw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return $n(Ty(e,r),r);case"wk1":return lc(vs.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return lc(vs.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),lc(_y(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),p5(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return h5(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function x5(e,t,r,n,a,s,i,o){var l=zt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[p]!=null&&(d[s[p]]=c);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[p]!=null){if(m==null)if(x.t=="e"&&m===null)d[s[p]]=null;else if(c!==void 0)d[s[p]]=c;else if(u&&m===null)d[s[p]]=null;else continue;else d[s[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:fa(x,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function lu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=ct(u);break;case"number":l=ct(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var h=zt(l.s.r),d=[],p=[],x=0,m=0,v=Array.isArray(e),w=l.s.r,y=0,g={};v&&!e[w]&&(e[w]=[]);var b=c.skipHidden&&e["!cols"]||[],I=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(b[y]||{}).hidden)switch(d[y]=Rt(y),r=v?e[w][y]:e[d[y]+h],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=d[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=fa(r,null,c),m=g[i]||0,!m)g[i]=1;else{do o=i+"_"+m++;while(g[o]);g[i]=m,g[o]=1}s[y]=o}for(w=l.s.r+a;w<=l.e.r;++w)if(!(I[w]||{}).hidden){var A=x5(e,l,w,d,n,s,v,c);(A.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=A.row)}return p.length=x,p}var $x=/"/g;function g5(e,t,r,n,a,s,i,o){for(var l=!0,c=[],u="",h=zt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var p=o.dense?(e[r]||[])[d]:e[n[d]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:fa(p,null,o));for(var x=0,m=0;x!==u.length;++x)if((m=u.charCodeAt(x))===a||m===s||m===34||o.forceQuotes){u='"'+u.replace($x,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace($x,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function Ud(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ct(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(d[x]||{}).hidden||(h[x]=Rt(x));for(var m=0,v=a.s.r;v<=a.e.r;++v)(p[v]||{}).hidden||(u=g5(e,a,v,h,i,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function Oy(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ud(e,t);return r}function v5(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ct(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Rt(o);for(var u=a.s.r;u<=a.e.r;++u)for(s=zt(u),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function Ry(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?It(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var h=ct(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),i==-1&&(i=h.e.r+1,u.e.r=i+t.length-1+a)}else i==-1&&(i=0,u.e.r=t.length-1+a);var d=n.header||[],p=0;t.forEach(function(m,v){$t(m).forEach(function(w){(p=d.indexOf(w))==-1&&(d[p=d.length]=w);var y=m[w],g="z",b="",I=Ke({c:o+p,r:i+v+a});c=pl(s,I),y&&typeof y=="object"&&!(y instanceof Date)?s[I]=y:(typeof y=="number"?g="n":typeof y=="boolean"?g="b":typeof y=="string"?g="s":y instanceof Date?(g="d",n.cellDates||(g="n",y=tr(y)),b=n.dateNF||qe[14]):y===null&&n.nullError&&(g="e",y=0),c?(c.t=g,c.v=y,delete c.w,delete c.R,b&&(c.z=b)):s[I]=c={t:g,v:y},b&&(c.z=b))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var x=zt(i);if(a)for(p=0;p<d.length;++p)s[Rt(p+o)+x]={t:"s",v:d[p]};return s["!ref"]=Ze(u),s}function w5(e,t){return Ry(null,e,t)}function pl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=It(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?pl(e,Ke(t)):pl(e,Ke({r:t,c:r||0}))}function y5(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $d(){return{SheetNames:[],Sheets:{}}}function Wd(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(my(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function _5(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=y5(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function k5(e,t){return e.z=t,e}function Iy(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function E5(e,t,r){return Iy(e,"#"+t,r)}function S5(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function b5(e,t,r,n){for(var a=typeof t!="string"?t:ct(t),s=typeof t=="string"?t:Ze(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=pl(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var cc={encode_col:Rt,encode_row:zt,encode_cell:Ke,encode_range:Ze,decode_col:gd,decode_row:xd,split_cell:LT,decode_cell:It,decode_range:Vr,format_cell:fa,sheet_add_aoa:iw,sheet_add_json:Ry,sheet_add_dom:Ey,aoa_to_sheet:Hi,json_to_sheet:w5,table_to_sheet:Sy,table_to_book:IR,sheet_to_csv:Ud,sheet_to_txt:Oy,sheet_to_json:lu,sheet_to_html:ky,sheet_to_formulae:v5,sheet_to_row_object_array:lu,sheet_get_cell:pl,book_new:$d,book_append_sheet:Wd,book_set_sheet_visibility:_5,cell_set_number_format:k5,cell_set_hyperlink:Iy,cell_set_internal_link:E5,cell_add_comment:S5,sheet_set_array_formula:b5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function T5({options:e,value:t,onChange:r,placeholder:n,disabled:a}){const[s,i]=ne.useState(""),[o,l]=ne.useState(!1),c=e.filter(u=>u.toLowerCase().includes(s.toLowerCase()));return f.jsxs("div",{className:"relative w-full",children:[f.jsx("input",{disabled:a,type:"text",className:"w-full px-4 py-2.5 border border-slate-200 rounded-xl text-sm text-black bg-white focus:ring-2 focus:ring-blue-500 outline-none disabled:opacity-40",placeholder:t||n,value:s,onChange:u=>{i(u.target.value),l(!0)},onFocus:()=>l(!0),onBlur:()=>setTimeout(()=>l(!1),200)}),o&&!a&&f.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-xl max-h-48 overflow-y-auto",children:c.length>0?c.map(u=>f.jsx("div",{className:"px-4 py-2 text-sm hover:bg-blue-50 cursor-pointer transition-colors",onClick:()=>{r(u),i(""),l(!1)},children:u},u)):f.jsx("div",{className:"px-4 py-2 text-xs text-slate-400 italic",children:"No results found"})})]})}function C5(){const{user:e}=Ka(),t=Ui(),[r,n]=ne.useState("file"),[a,s]=ne.useState({1:"",2:"",3:""}),[i,o]=ne.useState(null),[l,c]=ne.useState([]),[u,h]=ne.useState(!1),[d,p]=ne.useState(""),[x,m]=ne.useState([]),[v,w]=ne.useState([]),[y,g]=ne.useState(null),[b,I]=ne.useState(!1),[A,E]=ne.useState(!1),[_,k]=ne.useState(""),[O,H]=ne.useState("created_at"),[L,V]=ne.useState("desc"),[Y,de]=ne.useState(1),[me,ie]=ne.useState("all"),[ee,T]=ne.useState("all"),q=15,te=["industry_name","level-1","level-2","level-3","level-4","level-5","level-6","breadcrumbs","end_category"];ne.useEffect(()=>{const G=Object.values(a).some(_e=>_e!=="");if(i===null&&G){const _e=setTimeout(()=>{s({1:"",2:"",3:""}),t.info("Selections cleared due to inactivity")},5e3);return()=>clearTimeout(_e)}},[a,i]);const C=ne.useMemo(()=>{let G=[...v];if(_.trim()){const _e=_.toLowerCase();G=G.filter(Re=>{var xe,De,je,at;return((xe=Re.name)==null?void 0:xe.toLowerCase().includes(_e))||((De=Re.category_path)==null?void 0:De.toLowerCase().includes(_e))||((at=(je=Re.metadata)==null?void 0:je.industry)==null?void 0:at.toLowerCase().includes(_e))})}return me!=="all"&&(G=G.filter(_e=>_e.level===me)),ee==="visible"?G=G.filter(_e=>_e.is_visible!==!1):ee==="hidden"&&(G=G.filter(_e=>_e.is_visible===!1)),G.sort((_e,Re)=>{let xe=_e[O],De=Re[O];return O==="created_at"?(xe=new Date(xe||0).getTime(),De=new Date(De||0).getTime()):typeof xe=="string"&&(xe=(xe==null?void 0:xe.toLowerCase())||"",De=(De==null?void 0:De.toLowerCase())||""),xe<De?L==="asc"?-1:1:xe>De?L==="asc"?1:-1:0}),G},[v,_,O,L,me,ee]),M=Math.ceil(C.length/q),W=ne.useMemo(()=>{const G=(Y-1)*q;return C.slice(G,G+q)},[C,Y]);ne.useEffect(()=>{de(1)},[_,me,ee,O,L]);const P=G=>{O===G?V(L==="asc"?"desc":"asc"):(H(G),V("asc"))},z=({field:G})=>O!==G?f.jsx(Sm,{className:"w-3 h-3 opacity-30"}):L==="asc"?f.jsx(Sm,{className:"w-3 h-3 text-blue-600"}):f.jsx(GS,{className:"w-3 h-3 text-blue-600"}),he=()=>C.map(G=>{var _e;return{ID:G.id,Name:G.name||"","Full Path":G.category_path||"",Level:G.level||0,Industry:((_e=G.metadata)==null?void 0:_e.industry)||"",Visible:G.is_visible!==!1?"Yes":"No","Created At":G.created_at?new Date(G.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}}),ae=()=>{E(!0);try{const G=he(),_e=Rm.unparse(G),Re=new Blob([_e],{type:"text/csv;charset=utf-8;"});ye(Re,"categories_export.csv"),t.success(`Exported ${G.length} categories to CSV`)}catch(G){t.error("Failed to export CSV: "+G.message)}finally{E(!1)}},se=()=>{E(!0);try{const G=he(),_e=cc.json_to_sheet(G),Re=cc.book_new();_e["!cols"]=[{wch:36},{wch:25},{wch:50},{wch:8},{wch:20},{wch:10},{wch:22}],cc.book_append_sheet(Re,_e,"Categories");const xe=Fy(Re,{bookType:"xlsx",type:"array"}),De=new Blob([xe],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});ye(De,"categories_export.xlsx"),t.success(`Exported ${G.length} categories to Excel`)}catch(G){t.error("Failed to export Excel: "+G.message)}finally{E(!1)}},oe=()=>{E(!0);try{const G=C.map(xe=>({id:xe.id,name:xe.name,category_path:xe.category_path,level:xe.level,is_visible:xe.is_visible,metadata:xe.metadata,created_at:xe.created_at})),_e=JSON.stringify(G,null,2),Re=new Blob([_e],{type:"application/json"});ye(Re,"categories_export.json"),t.success(`Exported ${G.length} categories to JSON`)}catch(G){t.error("Failed to export JSON: "+G.message)}finally{E(!1)}},ye=(G,_e)=>{const Re=URL.createObjectURL(G),xe=document.createElement("a");xe.href=Re,xe.download=_e,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(Re)},R=async()=>{if(!e)return;const G=e.role==="super_admin"?{}:{client_id:e.client_id},{data:_e}=await Ne.from("categories").select("*").match(G).order("created_at",{ascending:!1});_e&&(w(_e),m(_e.filter(Re=>Re.is_visible!==!1)),c(_e.filter(Re=>Re.is_visible===!1)))},Me=async G=>{try{const{error:_e}=await Ne.from("categories").update({is_visible:!0}).eq("id",G.id);if(_e)throw _e;t.success(`Restored: ${G.name}`),await R()}catch(_e){t.error(_e.message)}},U=async G=>{const _e=G.is_visible===!1,Re=_e?"restore":"hide";try{const{error:xe}=await Ne.from("categories").update({is_visible:_e}).eq("id",G.id);if(xe)throw xe;t.success(`Category ${Re}d successfully`),await R()}catch(xe){t.error(xe.message)}};ne.useEffect(()=>{R()},[e]);const re=G=>{if(G.target.files&&G.target.files[0]){const _e=G.target.files[0],Re=_e.name.toLowerCase();if(!Re.endsWith(".csv")&&!Re.endsWith(".xlsx")&&!Re.endsWith(".txt")){t.error("Invalid file type. Please upload .csv, .xlsx, or .txt");return}g(_e)}},J=async G=>{if(G.length===0)throw new Error("The file is empty.");const _e=Object.keys(G[0]).map(je=>je.trim().toLowerCase()),Re=te.filter(je=>!_e.includes(je));if(Re.length>0)throw new Error(`Invalid Format. Missing columns: ${Re.join(", ")}`);const xe=G.map((je,at)=>{const ut=Object.keys(je).find(it=>it.trim().toLowerCase()==="breadcrumbs")||"breadcrumbs",_t=Object.keys(je).find(it=>it.trim().toLowerCase()==="industry_name")||"industry_name",ze=String(je[ut]||"").trim(),st=String(je[_t]||"").trim();if(!ze||!st)return null;const ht=ze.split(">").map(it=>it.trim());return{client_id:(e==null?void 0:e.client_id)||(e==null?void 0:e.id),category_path:ze,level:ht.length,name:ht[ht.length-1],metadata:{industry:st,source:y==null?void 0:y.name,row_index:at+2}}}).filter(Boolean);if(xe.length===0)throw new Error("No valid data found in the required columns.");const{error:De}=await Ne.from("categories").insert(xe);if(De)throw De;return xe.length},ue=async()=>{if(!(!y||!e)){I(!0);try{let G=[];if(y.name.endsWith(".xlsx")){const Re=await y.arrayBuffer(),xe=eh(Re);G=cc.sheet_to_json(xe.Sheets[xe.SheetNames[0]])}else await new Promise((Re,xe)=>{Rm.parse(y,{header:!0,skipEmptyLines:!0,complete:De=>{G=De.data,Re(null)},error:xe})});const _e=await J(G);t.success(`Imported ${_e} categories successfully!`),g(null),await R()}catch(G){t.error(G.message)}finally{I(!1)}}},be=async()=>{const _e=Object.values(a).filter(Boolean).join(" > "),Re=x.find(xe=>xe.category_path===_e);if(!Re){t.error("Please select a specific category from the dropdowns first.");return}t.confirm(`Hide "${Re.name}"? It will be removed from all generation dropdowns.`,async()=>{try{const{error:xe}=await Ne.from("categories").update({is_visible:!1}).eq("id",Re.id);if(xe)throw xe;t.success("Category hidden successfully"),await R(),s({1:"",2:"",3:""})}catch(xe){t.error(xe.message)}},{confirmText:"Hide Now",cancelText:"Keep Visible"})},He=()=>{const G=te.join(","),_e="Marine,Boat Care,Anodes,Anodes - Hull,,,,Boat Care > Anodes > Anodes - Hull,Anodes - Hull",Re=new Blob([`${G}
${_e}`],{type:"text/csv;charset=utf-8;"}),xe=URL.createObjectURL(Re),De=document.createElement("a");De.href=xe,De.download="required_template.csv",De.click()},Xe=ne.useMemo(()=>{const G=new Set(v.map(_e=>_e.level).filter(Boolean));return Array.from(G).sort((_e,Re)=>_e-Re)},[v]);return f.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[f.jsxs("div",{className:"flex items-center justify-between mb-8",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Category Management"}),f.jsx("p",{className:"text-slate-500 text-sm",children:"Upload bulk files, enter manually, or view all categories"})]}),f.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[f.jsxs("button",{onClick:()=>n("file"),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${r==="file"?"bg-white shadow-sm text-blue-600":"text-slate-600 hover:text-slate-900"}`,children:[f.jsx(eb,{className:"w-4 h-4"})," File Upload"]}),f.jsxs("button",{onClick:()=>n("manual"),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${r==="manual"?"bg-white shadow-sm text-blue-600":"text-slate-600 hover:text-slate-900"}`,children:[f.jsx(ib,{className:"w-4 h-4"})," Manual Entry"]}),f.jsxs("button",{onClick:()=>n("all"),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${r==="all"?"bg-white shadow-sm text-blue-600":"text-slate-600 hover:text-slate-900"}`,children:[f.jsx(lb,{className:"w-4 h-4"})," All Categories"]})]})]}),r==="all"?f.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-in fade-in duration-300",children:[f.jsx("div",{className:"p-6 border-b border-slate-100 bg-gradient-to-r from-slate-50 to-white",children:f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"All Categories"}),f.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[C.length," of ",v.length," ","categories",_&&` matching "${_}"`]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-xs text-slate-500 mr-2",children:"Export:"}),f.jsxs("button",{onClick:ae,disabled:A||C.length===0,className:"flex items-center gap-1.5 px-3 py-2 bg-green-50 text-green-700 border border-green-200 rounded-lg text-xs font-bold hover:bg-green-100 transition-colors disabled:opacity-50",children:[f.jsx(yv,{className:"w-3.5 h-3.5"})," CSV"]}),f.jsxs("button",{onClick:se,disabled:A||C.length===0,className:"flex items-center gap-1.5 px-3 py-2 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg text-xs font-bold hover:bg-blue-100 transition-colors disabled:opacity-50",children:[f.jsx(ZS,{className:"w-3.5 h-3.5"})," Excel"]}),f.jsxs("button",{onClick:oe,disabled:A||C.length===0,className:"flex items-center gap-1.5 px-3 py-2 bg-purple-50 text-purple-700 border border-purple-200 rounded-lg text-xs font-bold hover:bg-purple-100 transition-colors disabled:opacity-50",children:[f.jsx(QS,{className:"w-3.5 h-3.5"})," JSON"]})]})]})}),f.jsx("div",{className:"p-4 border-b border-slate-100 bg-slate-50/50",children:f.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[f.jsxs("div",{className:"relative flex-1",children:[f.jsx(Uf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),f.jsx("input",{type:"text",placeholder:"Search by name, path, or industry...",value:_,onChange:G=>k(G.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-500"}),_&&f.jsx("button",{onClick:()=>k(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:f.jsx(Ua,{className:"w-4 h-4 text-slate-400 hover:text-slate-600"})})]}),f.jsxs("select",{value:me,onChange:G=>ie(G.target.value==="all"?"all":Number(G.target.value)),className:"px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[f.jsx("option",{value:"all",children:"All Levels"}),Xe.map(G=>f.jsxs("option",{value:G,children:["Level ",G]},G))]}),f.jsxs("select",{value:ee,onChange:G=>T(G.target.value),className:"px-4 py-2 border border-slate-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[f.jsx("option",{value:"all",children:"All Status"}),f.jsx("option",{value:"visible",children:"Visible Only"}),f.jsx("option",{value:"hidden",children:"Hidden Only"})]}),f.jsx("button",{onClick:R,className:"px-4 py-2 border border-slate-200 rounded-lg text-sm hover:bg-slate-100 transition-colors",children:f.jsx(Am,{className:"w-4 h-4"})})]})}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:f.jsxs("tr",{children:[f.jsx("th",{onClick:()=>P("name"),className:"px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",children:f.jsxs("div",{className:"flex items-center gap-1",children:["Name ",f.jsx(z,{field:"name"})]})}),f.jsx("th",{onClick:()=>P("category_path"),className:"px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",children:f.jsxs("div",{className:"flex items-center gap-1",children:["Full Path ",f.jsx(z,{field:"category_path"})]})}),f.jsx("th",{onClick:()=>P("level"),className:"px-6 py-3 text-center text-xs font-bold text-slate-600 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Level ",f.jsx(z,{field:"level"})]})}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Industry"}),f.jsx("th",{className:"px-6 py-3 text-center text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Status"}),f.jsx("th",{onClick:()=>P("created_at"),className:"px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",children:f.jsxs("div",{className:"flex items-center gap-1",children:["Created ",f.jsx(z,{field:"created_at"})]})}),f.jsx("th",{className:"px-6 py-3 text-center text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-100",children:W.length>0?W.map(G=>{var _e;return f.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[f.jsx("td",{className:"px-6 py-4 text-sm font-medium text-slate-900",children:G.name}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-md",children:f.jsx("div",{className:"truncate",title:G.category_path,children:G.category_path})}),f.jsx("td",{className:"px-6 py-4 text-center",children:f.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-blue-100 text-blue-700 rounded-full text-xs font-bold",children:G.level})}),f.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:((_e=G.metadata)==null?void 0:_e.industry)||"-"}),f.jsx("td",{className:"px-6 py-4 text-center",children:G.is_visible!==!1?f.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-50 text-green-700 rounded-full text-xs font-medium",children:[f.jsx(wv,{className:"w-3 h-3"})," Visible"]}):f.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-slate-100 text-slate-500 rounded-full text-xs font-medium",children:[f.jsx(_0,{className:"w-3 h-3"})," Hidden"]})}),f.jsx("td",{className:"px-6 py-4 text-xs text-slate-500",children:G.created_at?new Date(G.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}),f.jsx("td",{className:"px-6 py-4 text-center",children:f.jsx("button",{onClick:()=>U(G),className:`text-xs font-bold px-3 py-1.5 rounded-lg transition-colors ${G.is_visible!==!1?"text-amber-700 bg-amber-50 hover:bg-amber-100":"text-blue-700 bg-blue-50 hover:bg-blue-100"}`,children:G.is_visible!==!1?"Hide":"Restore"})})]},G.id)}):f.jsx("tr",{children:f.jsx("td",{colSpan:7,className:"px-6 py-16 text-center text-slate-400 italic",children:_||me!=="all"||ee!=="all"?"No categories match your filters":"No categories found"})})})]})}),M>1&&f.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50/50 flex items-center justify-between",children:[f.jsxs("p",{className:"text-xs text-slate-500",children:["Showing ",(Y-1)*q+1," to"," ",Math.min(Y*q,C.length)," ","of ",C.length," results"]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:()=>de(1),disabled:Y===1,className:"p-2 rounded-lg hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:f.jsx(XS,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>de(G=>Math.max(1,G-1)),disabled:Y===1,className:"p-2 rounded-lg hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:f.jsx(qS,{className:"w-4 h-4"})}),f.jsxs("span",{className:"px-4 py-2 text-sm font-medium",children:[Y," / ",M]}),f.jsx("button",{onClick:()=>de(G=>Math.min(M,G+1)),disabled:Y===M,className:"p-2 rounded-lg hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:f.jsx(KS,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>de(M),disabled:Y===M,className:"p-2 rounded-lg hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:f.jsx(YS,{className:"w-4 h-4"})})]})]})]}):f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[r==="file"?f.jsxs("div",{className:"bg-white p-8 rounded-xl border border-slate-200 shadow-sm animate-in fade-in duration-300",children:[f.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800",children:"Import File"}),f.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-56 border-2 border-dashed border-slate-300 rounded-xl cursor-pointer hover:bg-blue-50 transition-all mb-6",children:[f.jsx(kv,{className:"w-10 h-10 text-slate-400 mb-2"}),f.jsx("span",{className:"text-sm text-slate-600 font-medium",children:y?y.name:"Select CSV, XLSX, or TXT"}),f.jsx("input",{type:"file",className:"hidden",accept:".csv,.xlsx,.txt",onChange:re})]}),f.jsx("button",{onClick:ue,disabled:!y||b,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold disabled:opacity-50 flex items-center justify-center gap-2",children:b?f.jsx(_l,{className:"animate-spin"}):"Start Import"})]}):f.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-in fade-in duration-300",children:[f.jsxs("div",{className:"p-6 border-b border-slate-100 bg-slate-50/50",children:[f.jsx("h3",{className:"font-semibold text-slate-800",children:"Hierarchical Category Entry"}),f.jsx("p",{className:"text-xs text-slate-500",children:"Select existing levels or add new ones using the (+) button"})]}),f.jsx("div",{className:"p-8 space-y-8",children:[1,2,3].map(G=>{let _e=[];if(G===1)_e=Array.from(new Set(x.map(xe=>{var De;return(De=xe.category_path.split(" > ")[0])==null?void 0:De.trim()}))).filter(Boolean);else{const xe=[];for(let je=1;je<G;je++)a[je]&&xe.push(a[je]);const De=xe.join(" > ");a[G-1]&&(_e=Array.from(new Set(x.filter(je=>je.category_path.startsWith(De+" >")).map(je=>{var at;return(at=je.category_path.split(" > ")[G-1])==null?void 0:at.trim()}))).filter(Boolean))}_e.sort();const Re=G>1&&!a[G-1];return f.jsxs("div",{className:`space-y-2 ${Re?"opacity-40":""}`,children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("label",{className:"text-[10px] font-bold text-blue-500 uppercase tracking-widest",children:["Level ",G]}),!Re&&i!==G&&f.jsx("button",{onClick:()=>o(G),className:"p-1 hover:bg-blue-50 rounded-full text-blue-600",children:f.jsx(Xc,{className:"w-4 h-4"})})]}),i===G?f.jsxs("div",{className:"flex gap-2 animate-in slide-in-from-left-2",children:[f.jsx("input",{autoFocus:!0,placeholder:"Name...",className:"flex-1 px-4 py-2 border rounded-lg text-sm outline-none",value:d,onChange:xe=>p(xe.target.value)}),f.jsx("button",{onClick:async()=>{if(!d.trim())return;const xe=[];for(let _t=1;_t<G;_t++)a[_t]&&xe.push(a[_t]);const De=xe.join(" > ");if(G>1&&xe.length!==G-1){t.error("Please select all parent levels first");return}const je=G===1?d.trim():`${De} > ${d.trim()}`,{data:at,error:ut}=await Ne.from("categories").insert({category_path:je,name:d.trim(),level:G,client_id:(e==null?void 0:e.client_id)||(e==null?void 0:e.id),is_visible:!0}).select().single();if(ut)t.error(ut.message);else{t.success(`"${je}" created successfully`);const _t={...a,[G]:d.trim()};s(_t),m(ze=>[...ze,at]),w(ze=>[...ze,at]),o(null),p(""),R()}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-xs font-bold",children:"Create"}),f.jsx("button",{onClick:()=>{o(null),p("")},children:f.jsx(Ua,{className:"w-4 h-4 text-slate-400"})})]}):f.jsx(T5,{disabled:Re,options:_e,value:a[G],placeholder:`Search Level ${G}...`,onChange:xe=>{const De={...a,[G]:xe};for(let je=G+1;je<=3;je++)De[je]="";s(De)}})]},G)})}),a[1]&&f.jsxs("div",{className:"p-6 bg-slate-50 border-t border-slate-100 flex items-center justify-between",children:[f.jsx("p",{className:"text-sm font-medium text-slate-700",children:Object.values(a).filter(Boolean).join(" > ")}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:be,className:"px-3 py-1.5 bg-amber-50 text-amber-700 border border-amber-200 rounded-lg text-xs font-bold flex items-center gap-1",children:[f.jsx(_0,{className:"w-3.5 h-3.5"})," Hide"]}),f.jsx("button",{onClick:()=>s({1:"",2:"",3:""}),className:"px-3 py-1.5 text-xs text-red-500 font-bold hover:underline",children:"Reset"})]})]})]}),f.jsxs("div",{className:"mt-8",children:[f.jsx("div",{className:"flex justify-center",children:f.jsxs("button",{onClick:()=>h(!u),className:"text-xs font-bold text-slate-400 hover:text-blue-600 flex items-center gap-2 transition-colors",children:[f.jsx(_0,{className:"w-4 h-4"})," ",u?"Hide Archive":`View Hidden Categories (${l.length})`]})}),u&&f.jsxs("div",{className:"mt-4 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-in slide-in-from-bottom-2",children:[f.jsx("div",{className:"p-4 bg-slate-50 border-b border-slate-100",children:f.jsx("h3",{className:"text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Archived Categories"})}),f.jsx("div",{className:"max-h-64 overflow-y-auto",children:l.length>0?f.jsx("table",{className:"w-full text-left",children:f.jsx("tbody",{className:"divide-y divide-slate-50",children:l.map(G=>f.jsxs("tr",{className:"hover:bg-slate-50/50",children:[f.jsx("td",{className:"px-6 py-3 text-xs text-slate-600 truncate max-w-md",children:G.category_path}),f.jsx("td",{className:"px-6 py-3 text-right",children:f.jsxs("button",{onClick:()=>Me(G),className:"text-blue-600 text-xs font-bold flex items-center gap-1 ml-auto",children:[f.jsx(Am,{className:"w-3 h-3"})," Restore"]})})]},G.id))})}):f.jsx("div",{className:"p-8 text-center text-slate-400 italic text-sm",children:"No hidden categories found."})})]})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-slate-900 text-white p-6 rounded-xl shadow-lg",children:[f.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(td,{className:"w-5 h-5 text-blue-400"})," Validation Rules"]}),f.jsxs("div",{className:"space-y-4 text-sm text-slate-300",children:[f.jsxs("p",{children:["1. ",f.jsx("strong",{children:"Path Format:"})," Use the ",f.jsxs("code",{children:[" ",">"," "]})," ","symbol to separate levels (e.g., Electronics ",">"," Phones)."]}),f.jsxs("p",{children:["2. ",f.jsx("strong",{children:"Headers:"})," Files must include all 9 required columns, even if some levels are empty."]}),f.jsxs("p",{children:["3. ",f.jsx("strong",{children:"Industry:"})," Every row must have an industry name for identification."]}),f.jsxs("button",{onClick:He,className:"w-full mt-4 flex items-center justify-center gap-2 bg-white/10 hover:bg-white/20 py-2 rounded-lg transition-colors text-white font-medium border border-white/10",children:[f.jsx(Au,{className:"w-4 h-4"})," Download Template"]})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[f.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-4",children:"Quick Stats"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs text-slate-500",children:"Total Categories"}),f.jsx("span",{className:"text-sm font-bold text-slate-900",children:v.length})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs text-slate-500",children:"Visible"}),f.jsx("span",{className:"text-sm font-bold text-green-600",children:x.length})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs text-slate-500",children:"Hidden"}),f.jsx("span",{className:"text-sm font-bold text-amber-600",children:l.length})]}),f.jsx("div",{className:"pt-2 border-t border-slate-100",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs text-slate-500",children:"Unique Levels"}),f.jsx("span",{className:"text-sm font-bold text-slate-900",children:Xe.length})]})})]})]})]})]})]})}function A5(){const{user:e,signOut:t}=Ka(),[r,n]=ne.useState("dashboard"),[a,s]=ne.useState(null),[i,o]=ne.useState({facets_recommended:0,jobs_in_progress:0,jobs_yet_to_start:0,pending_categories:0,downloads:0,total_projects:0,queue_count:0});ne.useEffect(()=>{const p=x=>{x.state&&x.state.view?n(x.state.view):n("dashboard")};return window.addEventListener("popstate",p),()=>window.removeEventListener("popstate",p)},[]);const l=p=>{p!==r&&(window.history.pushState({view:p},"",""),n(p))};ne.useEffect(()=>{c(),e&&e.role!=="super_admin"&&u()},[e]);const c=async()=>{var H,L,V,Y,de,me,ie;if(!e)return;const p=e.role==="super_admin"?{}:{client_id:e.client_id},[x,m,v,w,y,g]=await Promise.all([Ne.from("facet_generation_jobs").select("status").match(p),Ne.from("categories").select("id").match(p),Ne.from("export_history").select("id").match(p),Ne.from("facet_generation_jobs").select("id").match(p),e.role==="super_admin"?Ne.from("clients").select("id"):e.role==="client_admin"?Ne.from("user_profiles").select("id").eq("client_id",e.client_id):Promise.resolve({data:[]}),Ne.from("user_queues").select("queue").eq("user_id",e.id).maybeSingle()]),b=x.data||[],I=b.filter(ee=>ee.status==="completed").length,A=b.filter(ee=>ee.status==="processing").length,E=b.filter(ee=>ee.status==="pending").length,_=((L=(H=g.data)==null?void 0:H.queue)==null?void 0:L.length)||0,k=e.role==="super_admin"&&((V=y.data)==null?void 0:V.length)||0,O=e.role==="client_admin"&&((Y=y.data)==null?void 0:Y.length)||0;o({facets_recommended:I,jobs_in_progress:A,jobs_yet_to_start:E,pending_categories:((de=m.data)==null?void 0:de.length)||0,downloads:((me=v.data)==null?void 0:me.length)||0,total_projects:((ie=w.data)==null?void 0:ie.length)||0,total_users:O,total_active_clients:k,queue_count:_})},u=async()=>{if(!(e!=null&&e.client_id))return;const{data:p,error:x}=await Ne.from("clients").select("*").eq("id",e.client_id).single();!x&&p&&s(p)},h=[{id:"dashboard",label:"Dashboard",icon:ob},{id:"projects",label:"Projects",icon:Tm},{id:"upload",label:"Upload Categories",icon:kv},{id:"prompts",label:"Prompt Templates",icon:yv},{id:"generate",label:"Generate Facets",icon:_v}];((e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="client_admin")&&h.push({id:"clients",label:e.role==="super_admin"?"Manage Clients":"Manage Team",icon:Wf});const d=()=>{switch(r){case"dashboard":return f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:(e==null?void 0:e.role)==="super_admin"?"Admin Dashboard":"Dashboard"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[f.jsxs("div",{onClick:()=>l("generate"),className:"bg-white p-6 rounded-lg border border-slate-200 cursor-pointer hover:shadow-md hover:border-blue-200 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:f.jsx(td,{className:"w-6 h-6 text-green-600"})}),f.jsx("span",{className:"text-3xl font-bold text-slate-900",children:i.facets_recommended})]}),f.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Facets Recommended"}),f.jsx("p",{className:"text-sm text-slate-600",children:"Successfully generated"})]}),f.jsxs("div",{onClick:()=>l("generate"),className:"bg-white p-6 rounded-lg border border-slate-200 cursor-pointer hover:shadow-md hover:border-blue-200 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:f.jsx(vb,{className:"w-6 h-6 text-blue-600"})}),f.jsx("div",{className:"text-right",children:f.jsx("span",{className:"text-3xl font-bold text-slate-900 block",children:i.queue_count})})]}),f.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"In Progress"}),f.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[f.jsx("span",{children:"Processing"}),i.queue_count>0&&f.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:["+ ",i.queue_count," in queue"]})]})]}),f.jsxs("div",{onClick:()=>l("generate"),className:"bg-white p-6 rounded-lg border border-slate-200 cursor-pointer hover:shadow-md hover:border-blue-200 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:f.jsx(JS,{className:"w-6 h-6 text-yellow-600"})}),f.jsx("span",{className:"text-3xl font-bold text-slate-900",children:i.jobs_yet_to_start})]}),f.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Yet to Start"}),f.jsx("p",{className:"text-sm text-slate-600",children:"Pending jobs"})]}),((e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="client_admin")&&f.jsxs("div",{onClick:()=>l("clients"),className:"bg-white p-6 rounded-lg border border-slate-200 cursor-pointer hover:shadow-md hover:border-blue-200 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:`p-3 rounded-lg ${e.role==="super_admin"?"bg-teal-100":"bg-purple-100"}`,children:e.role==="super_admin"?f.jsx(km,{className:"w-6 h-6 text-teal-600"}):f.jsx(Wf,{className:"w-6 h-6 text-purple-600"})}),f.jsx("span",{className:"text-3xl font-bold text-slate-900",children:e.role==="super_admin"?i.total_active_clients:i.total_users})]}),f.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:e.role==="super_admin"?"Total Clients":"Team Members"}),f.jsx("p",{className:"text-sm text-slate-600",children:e.role==="super_admin"?"Active companies":"Managed users"})]}),f.jsxs("div",{onClick:()=>l("upload"),className:"bg-white p-6 rounded-lg border border-slate-200 cursor-pointer hover:shadow-md hover:border-blue-200 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"p-3 bg-slate-100 rounded-lg",children:f.jsx(ed,{className:"w-6 h-6 text-slate-600"})}),f.jsx("span",{className:"text-3xl font-bold text-slate-900",children:i.pending_categories})]}),f.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Categories"}),f.jsx("p",{className:"text-sm text-slate-600",children:"Total uploaded"})]}),f.jsxs("div",{onClick:()=>l("projects"),className:"bg-white p-6 rounded-lg border border-slate-200 cursor-pointer hover:shadow-md hover:border-blue-200 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:f.jsx(Au,{className:"w-6 h-6 text-indigo-600"})}),f.jsx("span",{className:"text-3xl font-bold text-slate-900",children:i.downloads})]}),f.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Downloaded Outputs"}),f.jsx("p",{className:"text-sm text-slate-600",children:"Export history"})]}),f.jsxs("div",{onClick:()=>l("projects"),className:"bg-white p-6 rounded-lg border border-slate-200 cursor-pointer hover:shadow-md hover:border-blue-200 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:f.jsx(Tm,{className:"w-6 h-6 text-purple-600"})}),f.jsx("span",{className:"text-3xl font-bold text-slate-900",children:i.total_projects})]}),f.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:"Total Projects"}),f.jsx("p",{className:"text-sm text-slate-600",children:"All time"})]})]}),f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[f.jsx("h3",{className:"font-semibold text-slate-900 mb-2",children:"Quick Actions"}),f.jsxs("div",{className:"flex flex-wrap gap-3",children:[f.jsx("button",{onClick:()=>l("projects"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create New Project"}),f.jsx("button",{onClick:()=>l("upload"),className:"px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Upload Categories"}),f.jsx("button",{onClick:()=>l("generate"),className:"px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Generate Facets"})]})]})]});case"projects":return f.jsx(kb,{});case"upload":return f.jsx(C5,{});case"prompts":return f.jsx(Eb,{});case"generate":return f.jsx(Sb,{onComplete:()=>n("dashboard")});case"clients":return(e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="client_admin"?f.jsx(bb,{}):null;default:return null}};return f.jsxs("div",{className:"h-screen bg-slate-50 flex overflow-hidden",children:[f.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 flex flex-col h-full shrink-0",children:[f.jsxs("div",{className:"p-6 border-b border-slate-200",children:[f.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Facet Builder Pro"}),f.jsx("p",{className:"text-sm text-slate-600 mt-1 truncate",children:e==null?void 0:e.email}),(e==null?void 0:e.role)==="super_admin"&&f.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded",children:"Super Admin"}),(e==null?void 0:e.role)==="client_admin"&&f.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:"Admin"}),(e==null?void 0:e.role)!=="super_admin"&&a&&f.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1 bg-slate-100 rounded text-xs",children:[f.jsx(km,{className:"w-3 h-3 text-slate-500"}),f.jsx("span",{className:"text-slate-700 font-medium truncate",children:a.name||a.company_name||"Unknown client"})]})]}),f.jsx("nav",{className:"p-4 flex-1 overflow-y-auto",children:h.map(p=>{const x=p.icon;return f.jsxs("button",{onClick:()=>l(p.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg mb-1 transition-colors ${r===p.id?"bg-blue-50 text-blue-700 font-medium":"text-slate-700 hover:bg-slate-50"}`,children:[f.jsx(x,{className:"w-5 h-5"}),p.label]},p.id)})}),f.jsx("div",{className:"p-4 border-t border-slate-200 bg-white",children:f.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[f.jsx(cb,{className:"w-5 h-5"}),"Sign Out"]})})]}),f.jsx("main",{className:"flex-1 p-8 overflow-y-auto h-full scroll-smooth",children:d()})]})}function N5({onComplete:e}){const[t,r]=ne.useState(""),[n,a]=ne.useState(!1),[s,i]=ne.useState(null),o=Ui(),l=async c=>{c.preventDefault(),a(!0),i(null);try{const{error:u}=await Ne.auth.updateUser({password:t});if(u)throw s;const{data:{user:h}}=await Ne.auth.getUser();h&&await Ne.from("user_profiles").update({is_active:!0}).eq("id",h.id),o.success("Account activated successfully!"),e()}catch(u){i(u.message)}finally{a(!1)}};return f.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8 border border-slate-200",children:[f.jsx("div",{className:"flex justify-center mb-6",children:f.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:f.jsx(sb,{className:"w-8 h-8 text-blue-600"})})}),f.jsx("h2",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Set Your Password"}),f.jsx("p",{className:"text-center text-slate-500 mb-8",children:"Welcome! Please choose a password to complete your account setup."}),f.jsxs("form",{onSubmit:l,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"New Password"}),f.jsx("input",{type:"password",required:!0,minLength:6,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:t,onChange:c=>r(c.target.value),placeholder:""})]}),s&&f.jsx("p",{className:"text-red-500 text-sm",children:s}),f.jsx("button",{type:"submit",disabled:n||t.length<6,className:"w-full bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition disabled:opacity-50 flex items-center justify-center gap-2",children:n?f.jsx(_l,{className:"w-5 h-5 animate-spin"}):"Finish Setup"})]})]})})}function F5(){const{user:e,loading:t}=Ka(),[r,n]=ne.useState(!1);return ne.useEffect(()=>{const a=window.location.hash;a&&(a.includes("access_token")||a.includes("type=invite"))&&n(!0)},[]),t?f.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(_l,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-4"}),f.jsx("p",{className:"text-slate-600",children:"Loading..."})]})}):r?f.jsx(N5,{onComplete:()=>n(!1)}):e?f.jsx(A5,{}):f.jsx(wb,{})}ev(document.getElementById("root")).render(f.jsx(ne.StrictMode,{children:f.jsx(WS,{children:f.jsx(yb,{children:f.jsx(F5,{})})})}));
